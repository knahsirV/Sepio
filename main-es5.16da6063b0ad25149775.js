function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)})(e)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _objectDestructuringEmpty(e){if(null==e)throw new TypeError("Cannot destructure undefined")}function asyncGeneratorStep(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){asyncGeneratorStep(i,r,a,o,s,"next",e)}function s(e){asyncGeneratorStep(i,r,a,o,s,"throw",e)}o(void 0)}))}}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _templateObject35(){var e=_taggedTemplateLiteral([":@@ngb.toast.close-aria\u241ff4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8\u241f7819314041543176992:Close"]);return _templateObject35=function(){return e},e}function _templateObject34(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.AM\u241f69a1f176a93998876952adac57c3bc3863b6105e\u241f4592818992509942761:",":INTERPOLATION:"]);return _templateObject34=function(){return e},e}function _templateObject33(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.PM\u241f8d6e691e10306c1b34c6b26805151aaea320ef7f\u241f3564199131264287502:",":INTERPOLATION:"]);return _templateObject33=function(){return e},e}function _templateObject32(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.decrement-seconds\u241f5db47ac104294243a70eb9124fbea9d0004ddf69\u241f753633511487974857:Decrement seconds"]);return _templateObject32=function(){return e},e}function _templateObject31(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.increment-seconds\u241f912322ecee7d659d04dcf494a70e22e49d334b26\u241f5364772110539092174:Increment seconds"]);return _templateObject31=function(){return e},e}function _templateObject30(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.seconds\u241f4f2ed9e71a7c981db3e50ae2fedb28aff2ec4e6c\u241f8874012390997067175:Seconds"]);return _templateObject30=function(){return e},e}function _templateObject29(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.SS\u241febe38d36a40a2383c5fefa9b4608ffbda08bd4a3\u241f3628127143071124194:SS"]);return _templateObject29=function(){return e},e}function _templateObject28(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.decrement-minutes\u241fc1a6899e529c096da5b660385d4e77fe1f7ad271\u241f7447789825403243588:Decrement minutes"]);return _templateObject28=function(){return e},e}function _templateObject27(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.increment-minutes\u241ff5a4a3bc05e053f6732475d0e74875ec01c3a348\u241f180147720391025024:Increment minutes"]);return _templateObject27=function(){return e},e}function _templateObject26(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.decrement-hours\u241f147c7a19429da7d999e247d22e33fee370b1691b\u241f3651829882940481818:Decrement hours"]);return _templateObject26=function(){return e},e}function _templateObject25(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.increment-hours\u241fcb74bc1d625a6c1742f0d7d47306cf495780c218\u241f5939278348542933629:Increment hours"]);return _templateObject25=function(){return e},e}function _templateObject24(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.minutes\u241f41e62daa962947c0d23ded0981975d1bddf0bf38\u241f5531237363767747080:Minutes"]);return _templateObject24=function(){return e},e}function _templateObject23(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.MM\u241f72c8edf6a50068a05bde70991e36b1e881f4ca54\u241f1647282246509919852:MM"]);return _templateObject23=function(){return e},e}function _templateObject22(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.hours\u241f3bbce5fef7e1151da052a4e529453edb340e3912\u241f8070396816726827304:Hours"]);return _templateObject22=function(){return e},e}function _templateObject21(){var e=_taggedTemplateLiteral([":@@ngb.timepicker.HH\u241fce676ab1d6d98f85c836381cf100a4a91ef95a1f\u241f4043638465245303811:HH"]);return _templateObject21=function(){return e},e}function _templateObject20(){var e=_taggedTemplateLiteral([":@@ngb.progressbar.value\u241f04d611d19c117c60c9e14d0a04399a027184bc77\u241f5214781723415385277:",":INTERPOLATION:%"]);return _templateObject20=function(){return e},e}function _templateObject19(){var e=_taggedTemplateLiteral([":@@ngb.pagination.last-aria\u241f5c729788ba138508aca1bec050b610f7bf81db3e\u241f4882268002141858767:Last"]);return _templateObject19=function(){return e},e}function _templateObject18(){var e=_taggedTemplateLiteral([":@@ngb.pagination.next-aria\u241ff732c304c7433e5a83ffcd862c3dce709a0f4982\u241f3885497195825665706:Next"]);return _templateObject18=function(){return e},e}function _templateObject17(){var e=_taggedTemplateLiteral([":@@ngb.pagination.previous-aria\u241f680d5c75b7fd8d37961083608b9fcdc4167b4c43\u241f4452427314943113135:Previous"]);return _templateObject17=function(){return e},e}function _templateObject16(){var e=_taggedTemplateLiteral([":@@ngb.pagination.first-aria\u241ff2f852318759c6396b5d3d17031d53817d7b38cc\u241f2241508602425256033:First"]);return _templateObject16=function(){return e},e}function _templateObject15(){var e=_taggedTemplateLiteral([":@@ngb.pagination.last\u241f49f27a460bc97e7e00be5b37098bfa79884fc7d9\u241f5277020320267646988:\xbb\xbb"]);return _templateObject15=function(){return e},e}function _templateObject14(){var e=_taggedTemplateLiteral([":@@ngb.pagination.next\u241fba9cbb4ff311464308a3627e4f1c3345d9fe6d7d\u241f5458177150283468089:\xbb"]);return _templateObject14=function(){return e},e}function _templateObject13(){var e=_taggedTemplateLiteral([":@@ngb.pagination.previous\u241f6e52b6ee77a4848d899dd21b591c6fd499e3aef3\u241f6479320895410098858:\xab"]);return _templateObject13=function(){return e},e}function _templateObject12(){var e=_taggedTemplateLiteral([":@@ngb.pagination.first\u241f656506dfd46380956a655f919f1498d018f75ca0\u241f6867721956102594380:\xab\xab"]);return _templateObject12=function(){return e},e}function _templateObject11(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.select-year\u241f8ceb09d002bf0c5d1cac171dfbffe1805d2b3962\u241f8852264961585484321:Select year"]);return _templateObject11=function(){return e},e}function _templateObject10(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.select-year\u241f8ceb09d002bf0c5d1cac171dfbffe1805d2b3962\u241f8852264961585484321:Select year"]);return _templateObject10=function(){return e},e}function _templateObject9(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.select-month\u241f1dbc84807f35518112f62e5775d1daebd3d8462b\u241f2253869508135064750:Select month"]);return _templateObject9=function(){return e},e}function _templateObject8(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.select-month\u241f1dbc84807f35518112f62e5775d1daebd3d8462b\u241f2253869508135064750:Select month"]);return _templateObject8=function(){return e},e}function _templateObject7(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.next-month\u241f4bd046985cfe13040d5ef0cd881edce0968a111a\u241f3628374603023447227:Next month"]);return _templateObject7=function(){return e},e}function _templateObject6(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.next-month\u241f4bd046985cfe13040d5ef0cd881edce0968a111a\u241f3628374603023447227:Next month"]);return _templateObject6=function(){return e},e}function _templateObject5(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.previous-month\u241fc3b08b07b5ab98e7cdcf18df39355690ab7d3884\u241f8586908745456864217:Previous month"]);return _templateObject5=function(){return e},e}function _templateObject4(){var e=_taggedTemplateLiteral([":@@ngb.datepicker.previous-month\u241fc3b08b07b5ab98e7cdcf18df39355690ab7d3884\u241f8586908745456864217:Previous month"]);return _templateObject4=function(){return e},e}function _templateObject3(){var e=_taggedTemplateLiteral([":@@ngb.carousel.next\u241ff732c304c7433e5a83ffcd862c3dce709a0f4982\u241f3885497195825665706:Next"]);return _templateObject3=function(){return e},e}function _templateObject2(){var e=_taggedTemplateLiteral([":@@ngb.carousel.previous\u241f680d5c75b7fd8d37961083608b9fcdc4167b4c43\u241f4452427314943113135:Previous"]);return _templateObject2=function(){return e},e}function _templateObject(){var e=_taggedTemplateLiteral([":@@ngb.alert.close\u241ff4e529ae5ffd73001d1ff4bbdeeb0a72e342e5c8\u241f7819314041543176992:Close"]);return _templateObject=function(){return e},e}function _taggedTemplateLiteral(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){a=!0,i=u}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,i=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw i}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(a,n.prototype),a}).apply(null,arguments)}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=_superPropBase(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,r=_getPrototypeOf(e);if(t){var a=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{0:function(e,t,n){e.exports=n("zUnb")},1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},B9Yq:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},EhIR:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function u(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.alea=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},PDX0:function(e,t){(function(t){e.exports=t}).call(this,{})},YSVl:function(e,t,n){var r=n("EhIR"),a=n("uDiL"),i=n("pJ6O"),o=n("yuCN"),s=n("euyF"),u=n("ie1u"),c=n("pJ3+");c.alea=r,c.xor128=a,c.xorwow=i,c.xorshift7=o,c.xor4096=s,c.tychei=u,e.exports=c},YuTi:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},crnd:function(e,t){function n(e){return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="crnd"},euyF:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n=a[i]=(n^=n>>>15)^(e^=e>>>12),t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=0==(n=s[127&i]^=r+(o=o+1640531527|0))?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,s[a]=(r^=r>>>15)^(n^=n>>>12);e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xor4096=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},ie1u:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.tychei=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},"pJ3+":function(e,t,n){var r;!function(a,i){var o,s=this,u=i.pow(256,6),c=i.pow(2,52),l=2*c;function h(e,t,n){var r=[],h=p(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(o){}return a.length?a:"string"==i?t:t+"\0"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(256):(e=new Uint8Array(256),(s.crypto||s.msCrypto).getRandomValues(e)),v(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,v(a)]}}():e,3),r),m=new f(r),g=function(){for(var e=m.g(6),t=u,n=0;e<c;)e=256*(e+n),t*=256,n=m.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return g.int32=function(){return 0|m.g(4)},g.quick=function(){return m.g(4)/4294967296},g.double=g,p(v(m.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&d(r,m),e.state=function(){return d(m,{})}),n?(i.random=e,t):e})(g,h,"global"in t?t.global:this==i,t.state)}function f(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<256;)o[a]=a++;for(a=0;a<256;a++)o[a]=o[i=255&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=255&a+1],n=256*n+o[255&(o[a]=o[i=255&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(256)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function p(e,t){for(var n,r=e+"",a=0;a<r.length;)t[255&a]=255&(n^=19*t[255&a])+r.charCodeAt(a++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=h,p(i.random(),a),e.exports){e.exports=h;try{o=n(3)}catch(m){}}else void 0===(r=(function(){return h}).call(t,n,t,e))||(e.exports=r)}([],Math)},pJ6O:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xorwow=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},uDiL:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function u(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xor128=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},yuCN:function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],r[a]=n^=(e^=e<<13)^e<<9,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n&&(r[7]=-1),e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function u(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=u:n("B9Yq")&&n("PDX0")?void 0===(r=(function(){return u}).call(t,n,t,a))||(a.exports=r):this.xorshift7=u}(0,e,n("B9Yq"))}).call(this,n("YuTi")(e))},zUnb:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"shuffle",(function(){return xy})),n.d(r,"clamp",(function(){return Sy})),n.d(r,"nearestLargerEven",(function(){return Ay})),n.d(r,"sum",(function(){return Iy})),n.d(r,"randUniform",(function(){return Ty})),n.d(r,"distSquared",(function(){return Ey})),n.d(r,"assert",(function(){return Ry})),n.d(r,"assertShapesMatch",(function(){return Ny})),n.d(r,"assertNonNull",(function(){return Oy})),n.d(r,"flatten",(function(){return Dy})),n.d(r,"sizeFromShape",(function(){return Fy})),n.d(r,"isScalarShape",(function(){return My})),n.d(r,"arraysEqual",(function(){return Py})),n.d(r,"isInt",(function(){return zy})),n.d(r,"tanh",(function(){return Ly})),n.d(r,"sizeToSquarishShape",(function(){return By})),n.d(r,"createShuffledIndices",(function(){return Vy})),n.d(r,"rightPad",(function(){return Wy})),n.d(r,"repeatedTry",(function(){return Uy})),n.d(r,"inferFromImplicitShape",(function(){return jy})),n.d(r,"parseAxisParam",(function(){return Hy})),n.d(r,"squeezeShape",(function(){return Gy})),n.d(r,"getTypedArrayFromDType",(function(){return qy})),n.d(r,"getArrayFromDType",(function(){return Ky})),n.d(r,"checkConversionForErrors",(function(){return Xy})),n.d(r,"isValidDtype",(function(){return Zy})),n.d(r,"hasEncodingLoss",(function(){return Yy})),n.d(r,"isTypedArray",(function(){return $y})),n.d(r,"bytesPerElement",(function(){return Jy})),n.d(r,"bytesFromStringArray",(function(){return Qy})),n.d(r,"isString",(function(){return eb})),n.d(r,"isBoolean",(function(){return tb})),n.d(r,"isNumber",(function(){return nb})),n.d(r,"inferDtype",(function(){return rb})),n.d(r,"isFunction",(function(){return ab})),n.d(r,"nearestDivisor",(function(){return ib})),n.d(r,"computeStrides",(function(){return ob})),n.d(r,"toTypedArray",(function(){return sb})),n.d(r,"toNestedArray",(function(){return ub})),n.d(r,"makeOnesTypedArray",(function(){return cb})),n.d(r,"makeZerosTypedArray",(function(){return lb})),n.d(r,"now",(function(){return hb})),n.d(r,"assertNonNegativeIntegerDimensions",(function(){return fb})),n.d(r,"fetch",(function(){return db})),n.d(r,"encodeString",(function(){return pb})),n.d(r,"decodeString",(function(){return vb})),n.d(r,"locToIndex",(function(){return mb})),n.d(r,"indexToLoc",(function(){return gb}));var a={};n.r(a),n.d(a,"makeTypesMatch",(function(){return Pb})),n.d(a,"assertTypesMatch",(function(){return zb})),n.d(a,"isTensorInList",(function(){return Lb})),n.d(a,"getTensorsInContainer",(function(){return Bb}));var i={};n.r(i),n.d(i,"isMobile",(function(){return jb})),n.d(i,"isBrowser",(function(){return Hb}));var o={};n.r(o),n.d(o,"assertParamsValid",(function(){return Lx})),n.d(o,"maskToAxes",(function(){return Bx})),n.d(o,"computeOutShape",(function(){return Vx})),n.d(o,"stridesWithElidedDims",(function(){return Wx})),n.d(o,"startIndicesWithElidedDims",(function(){return Ux})),n.d(o,"stopIndicesWithElidedDims",(function(){return jx})),n.d(o,"stridesForAxis",(function(){return Hx})),n.d(o,"startForAxis",(function(){return Gx})),n.d(o,"stopForAxis",(function(){return qx})),n.d(o,"isSliceContinous",(function(){return Kx})),n.d(o,"computeFlatOffset",(function(){return Xx}));var s={};n.r(s),n.d(s,"copyModel",(function(){return IS})),n.d(s,"listModels",(function(){return CS})),n.d(s,"moveModel",(function(){return ES})),n.d(s,"removeModel",(function(){return SS})),n.d(s,"browserFiles",(function(){return YS})),n.d(s,"browserHTTPRequest",(function(){return sA})),n.d(s,"concatenateArrayBuffers",(function(){return lS})),n.d(s,"decodeWeights",(function(){return oS})),n.d(s,"encodeWeights",(function(){return aS})),n.d(s,"fromMemory",(function(){return lA})),n.d(s,"getLoadHandlers",(function(){return yS})),n.d(s,"getModelArtifactsInfoForJSON",(function(){return fS})),n.d(s,"getSaveHandlers",(function(){return gS})),n.d(s,"http",(function(){return oA})),n.d(s,"isHTTPScheme",(function(){return aA})),n.d(s,"loadWeights",(function(){return eA})),n.d(s,"registerLoadRouter",(function(){return mS})),n.d(s,"registerSaveRouter",(function(){return vS})),n.d(s,"weightsLoaderFactory",(function(){return nA})),n.d(s,"withSaveHandler",(function(){return hA}));var u={};n.r(u),n.d(u,"confusionMatrix",(function(){return pA}));var c={};n.r(c),n.d(c,"toPixels",(function(){return vA})),n.d(c,"fromPixels",(function(){return gA}));var l={};n.r(l),n.d(l,"prepareAndValidate",(function(){return yA}));var h={};n.r(h),n.d(h,"validateUpdateShape",(function(){return bA})),n.d(h,"validateInput",(function(){return kA})),n.d(h,"calculateShapes",(function(){return _A}));var f={};n.r(f),n.d(f,"Serializable",(function(){return wA})),n.d(f,"SerializationMap",(function(){return CA})),n.d(f,"registerClass",(function(){return xA}));var d={};n.r(d),n.d(d,"TEST_EPSILON_FLOAT16",(function(){return SA})),n.d(d,"expectArraysClose",(function(){return AA})),n.d(d,"testEpsilon",(function(){return IA})),n.d(d,"expectPromiseToFail",(function(){return EA})),n.d(d,"expectArraysEqual",(function(){return RA})),n.d(d,"expectNumbersClose",(function(){return NA})),n.d(d,"expectValuesInRange",(function(){return DA})),n.d(d,"expectArrayBuffersEqual",(function(){return FA}));var p={};n.r(p),n.d(p,"segOpComputeOptimalWindowSize",(function(){return hT})),n.d(p,"computeOutShape",(function(){return fT})),n.d(p,"collectGatherOpShapeInfo",(function(){return dT}));var v={};n.r(v),n.d(v,"fft",(function(){return XT})),n.d(v,"ifft",(function(){return ZT})),n.d(v,"rfft",(function(){return YT})),n.d(v,"irfft",(function(){return $T}));var m={};n.r(m),n.d(m,"hannWindow",(function(){return rE})),n.d(m,"hammingWindow",(function(){return aE})),n.d(m,"frame",(function(){return iE})),n.d(m,"stft",(function(){return oE}));var g={};n.r(g),n.d(g,"Reduction",(function(){return nE})),n.d(g,"absoluteDifference",(function(){return uE})),n.d(g,"computeWeightedLoss",(function(){return cE})),n.d(g,"cosineDistance",(function(){return lE})),n.d(g,"hingeLoss",(function(){return hE})),n.d(g,"huberLoss",(function(){return fE})),n.d(g,"logLoss",(function(){return dE})),n.d(g,"meanSquaredError",(function(){return pE})),n.d(g,"sigmoidCrossEntropy",(function(){return vE})),n.d(g,"softmaxCrossEntropy",(function(){return mE}));var y={};n.r(y),n.d(y,"bandPart",(function(){return yE})),n.d(y,"gramSchmidt",(function(){return bE})),n.d(y,"qr",(function(){return kE}));var b={};n.r(b),n.d(b,"nonMaxSuppression",(function(){return RE})),n.d(b,"resizeBilinear",(function(){return NE})),n.d(b,"resizeNearestNeighbor",(function(){return OE})),n.d(b,"nonMaxSuppressionAsync",(function(){return DE})),n.d(b,"nonMaxSuppressionWithScore",(function(){return FE})),n.d(b,"nonMaxSuppressionWithScoreAsync",(function(){return ME})),n.d(b,"cropAndResize",(function(){return PE}));var k={};n.r(k),n.d(k,"matMul",(function(){return WE})),n.d(k,"conv2d",(function(){return UE})),n.d(k,"depthwiseConv2d",(function(){return jE}));var _={};n.r(_),n.d(_,"add",(function(){return b_})),n.d(_,"addN",(function(){return rI})),n.d(_,"atan2",(function(){return aI})),n.d(_,"avgPool",(function(){return iI})),n.d(_,"avgPool3d",(function(){return oI})),n.d(_,"batchToSpaceND",(function(){return Nx})),n.d(_,"batchNorm",(function(){return uI})),n.d(_,"batchNorm2d",(function(){return cI})),n.d(_,"batchNorm3d",(function(){return lI})),n.d(_,"batchNorm4d",(function(){return hI})),n.d(_,"broadcastTo",(function(){return dI})),n.d(_,"clone",(function(){return fI})),n.d(_,"complex",(function(){return w_})),n.d(_,"concat",(function(){return W_})),n.d(_,"concat1d",(function(){return pI})),n.d(_,"concat2d",(function(){return vI})),n.d(_,"concat3d",(function(){return mI})),n.d(_,"concat4d",(function(){return gI})),n.d(_,"conv1d",(function(){return yI})),n.d(_,"conv2d",(function(){return FC})),n.d(_,"conv2dTranspose",(function(){return bI})),n.d(_,"conv3d",(function(){return kI})),n.d(_,"conv3dTranspose",(function(){return _I})),n.d(_,"cumsum",(function(){return VC})),n.d(_,"depthToSpace",(function(){return wI})),n.d(_,"depthwiseConv2d",(function(){return CI})),n.d(_,"diag",(function(){return xI})),n.d(_,"div",(function(){return J_})),n.d(_,"divNoNan",(function(){return SI})),n.d(_,"dot",(function(){return AI})),n.d(_,"elu",(function(){return II})),n.d(_,"equal",(function(){return TI})),n.d(_,"eye",(function(){return EI})),n.d(_,"fill",(function(){return RI})),n.d(_,"floorDiv",(function(){return $_})),n.d(_,"greater",(function(){return cx})),n.d(_,"greaterEqual",(function(){return nx})),n.d(_,"imag",(function(){return C_})),n.d(_,"leakyRelu",(function(){return OI})),n.d(_,"less",(function(){return rx})),n.d(_,"lessEqual",(function(){return lx})),n.d(_,"localResponseNormalization",(function(){return DI})),n.d(_,"matMul",(function(){return xC})),n.d(_,"max",(function(){return FI})),n.d(_,"maxPool",(function(){return MI})),n.d(_,"maxPool3d",(function(){return PI})),n.d(_,"maxPoolWithArgmax",(function(){return zI})),n.d(_,"maximum",(function(){return NI})),n.d(_,"minimum",(function(){return LI})),n.d(_,"mod",(function(){return BI})),n.d(_,"mul",(function(){return Q_})),n.d(_,"multinomial",(function(){return VI})),n.d(_,"notEqual",(function(){return WI})),n.d(_,"oneHot",(function(){return dA})),n.d(_,"outerProduct",(function(){return UI})),n.d(_,"pad",(function(){return zx})),n.d(_,"pad1d",(function(){return jI})),n.d(_,"pad2d",(function(){return HI})),n.d(_,"pad3d",(function(){return GI})),n.d(_,"pad4d",(function(){return qI})),n.d(_,"pool",(function(){return KI})),n.d(_,"pow",(function(){return Cx})),n.d(_,"prelu",(function(){return XI})),n.d(_,"rand",(function(){return ZI})),n.d(_,"randomGamma",(function(){return eT})),n.d(_,"randomNormal",(function(){return tT})),n.d(_,"randomUniform",(function(){return nT})),n.d(_,"real",(function(){return x_})),n.d(_,"relu",(function(){return rT})),n.d(_,"relu6",(function(){return aT})),n.d(_,"selu",(function(){return iT})),n.d(_,"separableConv2d",(function(){return oT})),n.d(_,"spaceToBatchND",(function(){return AC})),n.d(_,"split",(function(){return EC})),n.d(_,"square",(function(){return Aw})),n.d(_,"squaredDifference",(function(){return sT})),n.d(_,"sub",(function(){return XC})),n.d(_,"tile",(function(){return ZC})),n.d(_,"truncatedNormal",(function(){return uT})),n.d(_,"op",(function(){return y_})),n.d(_,"image",(function(){return b})),n.d(_,"linalg",(function(){return y})),n.d(_,"losses",(function(){return g})),n.d(_,"spectral",(function(){return v})),n.d(_,"fused",(function(){return k})),n.d(_,"signal",(function(){return m})),n.d(_,"booleanMaskAsync",(function(){return yT})),n.d(_,"reverse",(function(){return bT})),n.d(_,"reverse1d",(function(){return kT})),n.d(_,"reverse2d",(function(){return _T})),n.d(_,"reverse3d",(function(){return wT})),n.d(_,"reverse4d",(function(){return CT})),n.d(_,"slice",(function(){return Yx})),n.d(_,"slice1d",(function(){return $x})),n.d(_,"slice2d",(function(){return Jx})),n.d(_,"slice3d",(function(){return Qx})),n.d(_,"slice4d",(function(){return eS})),n.d(_,"abs",(function(){return Iw})),n.d(_,"acos",(function(){return Tw})),n.d(_,"acosh",(function(){return Ew})),n.d(_,"asin",(function(){return Rw})),n.d(_,"asinh",(function(){return Nw})),n.d(_,"atan",(function(){return Ow})),n.d(_,"atanh",(function(){return Dw})),n.d(_,"ceil",(function(){return Fw})),n.d(_,"clipByValue",(function(){return Mw})),n.d(_,"cos",(function(){return Pw})),n.d(_,"cosh",(function(){return zw})),n.d(_,"erf",(function(){return Lw})),n.d(_,"exp",(function(){return Bw})),n.d(_,"expm1",(function(){return Vw})),n.d(_,"floor",(function(){return Ww})),n.d(_,"log",(function(){return Uw})),n.d(_,"log1p",(function(){return jw})),n.d(_,"logSigmoid",(function(){return Hw})),n.d(_,"neg",(function(){return Gw})),n.d(_,"reciprocal",(function(){return qw})),n.d(_,"round",(function(){return Kw})),n.d(_,"rsqrt",(function(){return Xw})),n.d(_,"sigmoid",(function(){return Zw})),n.d(_,"sign",(function(){return Yw})),n.d(_,"isNaN",(function(){return $w})),n.d(_,"isInf",(function(){return Jw})),n.d(_,"isFinite",(function(){return Qw})),n.d(_,"sin",(function(){return eC})),n.d(_,"sinh",(function(){return tC})),n.d(_,"softplus",(function(){return nC})),n.d(_,"sqrt",(function(){return rC})),n.d(_,"step",(function(){return aC})),n.d(_,"tan",(function(){return iC})),n.d(_,"tanh",(function(){return oC})),n.d(_,"all",(function(){return mw})),n.d(_,"any",(function(){return gw})),n.d(_,"argMax",(function(){return yw})),n.d(_,"argMin",(function(){return bw})),n.d(_,"logSumExp",(function(){return kw})),n.d(_,"mean",(function(){return _w})),n.d(_,"min",(function(){return ww})),n.d(_,"moments",(function(){return Cw})),n.d(_,"sum",(function(){return xw})),n.d(_,"prod",(function(){return Sw})),n.d(_,"equalStrict",(function(){return xT})),n.d(_,"greaterEqualStrict",(function(){return ST})),n.d(_,"greaterStrict",(function(){return AT})),n.d(_,"lessEqualStrict",(function(){return IT})),n.d(_,"lessStrict",(function(){return TT})),n.d(_,"notEqualStrict",(function(){return ET})),n.d(_,"addStrict",(function(){return RT})),n.d(_,"divStrict",(function(){return NT})),n.d(_,"maximumStrict",(function(){return OT})),n.d(_,"minimumStrict",(function(){return DT})),n.d(_,"modStrict",(function(){return FT})),n.d(_,"mulStrict",(function(){return MT})),n.d(_,"powStrict",(function(){return PT})),n.d(_,"squaredDifferenceStrict",(function(){return zT})),n.d(_,"subStrict",(function(){return LT})),n.d(_,"logicalAnd",(function(){return gx})),n.d(_,"logicalNot",(function(){return yx})),n.d(_,"logicalOr",(function(){return bx})),n.d(_,"logicalXor",(function(){return kx})),n.d(_,"where",(function(){return _x})),n.d(_,"whereAsync",(function(){return wx})),n.d(_,"buffer",(function(){return U_})),n.d(_,"print",(function(){return j_})),n.d(_,"cast",(function(){return H_})),n.d(_,"expandDims",(function(){return G_})),n.d(_,"reshape",(function(){return q_})),n.d(_,"squeeze",(function(){return K_})),n.d(_,"stack",(function(){return X_})),n.d(_,"unstack",(function(){return Z_})),n.d(_,"setdiff1dAsync",(function(){return Y_})),n.d(_,"linspace",(function(){return z_})),n.d(_,"ones",(function(){return M_})),n.d(_,"range",(function(){return L_})),n.d(_,"scalar",(function(){return I_})),n.d(_,"tensor",(function(){return S_})),n.d(_,"tensor1d",(function(){return T_})),n.d(_,"tensor2d",(function(){return E_})),n.d(_,"tensor3d",(function(){return R_})),n.d(_,"tensor4d",(function(){return N_})),n.d(_,"tensor5d",(function(){return O_})),n.d(_,"tensor6d",(function(){return D_})),n.d(_,"variable",(function(){return F_})),n.d(_,"zeros",(function(){return P_})),n.d(_,"onesLike",(function(){return B_})),n.d(_,"zerosLike",(function(){return V_})),n.d(_,"transpose",(function(){return BC})),n.d(_,"softmax",(function(){return BT})),n.d(_,"logSoftmax",(function(){return VT})),n.d(_,"norm",(function(){return WT})),n.d(_,"gather",(function(){return mT})),n.d(_,"unsortedSegmentSum",(function(){return gT})),n.d(_,"basicLSTMCell",(function(){return UT})),n.d(_,"multiRNNCell",(function(){return jT})),n.d(_,"movingAverage",(function(){return HT})),n.d(_,"stridedSlice",(function(){return GT})),n.d(_,"topk",(function(){return qT})),n.d(_,"scatterND",(function(){return KT})),n.d(_,"fft",(function(){return XT})),n.d(_,"ifft",(function(){return ZT})),n.d(_,"rfft",(function(){return YT})),n.d(_,"irfft",(function(){return $T})),n.d(_,"sparseToDense",(function(){return JT})),n.d(_,"gatherND",(function(){return QT})),n.d(_,"dropout",(function(){return eE})),n.d(_,"hannWindow",(function(){return rE})),n.d(_,"hammingWindow",(function(){return aE})),n.d(_,"frame",(function(){return iE})),n.d(_,"stft",(function(){return oE})),n.d(_,"inTopKAsync",(function(){return sE}));var w={};n.r(w),n.d(w,"nonMaxSuppressionV3",(function(){return CE})),n.d(w,"nonMaxSuppressionV5",(function(){return xE})),n.d(w,"upcastType",(function(){return Fb})),n.d(w,"prepareAndValidate",(function(){return yA})),n.d(w,"validateUpdateShape",(function(){return bA})),n.d(w,"validateInput",(function(){return kA})),n.d(w,"calculateShapes",(function(){return _A})),n.d(w,"segment_util",(function(){return p})),n.d(w,"castTensor",(function(){return CR})),n.d(w,"reshapeTensor",(function(){return xR})),n.d(w,"linspaceImpl",(function(){return SR})),n.d(w,"axesAreInnerMostDims",(function(){return sw})),n.d(w,"combineLocations",(function(){return uw})),n.d(w,"computeOutAndReduceShapes",(function(){return cw})),n.d(w,"expandShapeToKeepDim",(function(){return lw})),n.d(w,"assertAxesAreInnerMostDims",(function(){return hw})),n.d(w,"getAxesPermutation",(function(){return fw})),n.d(w,"getUndoAxesPermutation",(function(){return dw})),n.d(w,"getInnerMostAxes",(function(){return pw})),n.d(w,"getBroadcastDims",(function(){return c_})),n.d(w,"getReductionAxes",(function(){return l_})),n.d(w,"assertAndGetBroadcastShape",(function(){return h_})),n.d(w,"assertParamsConsistent",(function(){return k_})),n.d(w,"computeOutShape",(function(){return __})),n.d(w,"computePool2DInfo",(function(){return uC})),n.d(w,"computePool3DInfo",(function(){return cC})),n.d(w,"computeConv2DInfo",(function(){return lC})),n.d(w,"computeConv3DInfo",(function(){return hC})),n.d(w,"computeDefaultPad",(function(){return fC})),n.d(w,"tupleValuesAreOne",(function(){return gC})),n.d(w,"eitherStridesOrDilationsAreOne",(function(){return yC})),n.d(w,"convertConv2DDataFormat",(function(){return bC})),n.d(w,"PARALLELIZE_THRESHOLD",(function(){return cT})),n.d(w,"computeOptimalWindowSize",(function(){return lT})),n.d(w,"getReshaped",(function(){return nR})),n.d(w,"getPermuted",(function(){return rR})),n.d(w,"getReshapedPermuted",(function(){return aR})),n.d(w,"getSliceBeginCoords",(function(){return iR})),n.d(w,"getSliceSize",(function(){return oR})),n.d(w,"SELU_SCALEALPHA",(function(){return Tx})),n.d(w,"SELU_SCALE",(function(){return Ex})),n.d(w,"shouldFuse",(function(){return zE})),n.d(w,"ERF_P",(function(){return sR})),n.d(w,"ERF_A1",(function(){return uR})),n.d(w,"ERF_A2",(function(){return cR})),n.d(w,"ERF_A3",(function(){return lR})),n.d(w,"ERF_A4",(function(){return hR})),n.d(w,"ERF_A5",(function(){return fR})),n.d(w,"warn",(function(){return dR})),n.d(w,"log",(function(){return pR})),n.d(w,"mergeRealAndImagArrays",(function(){return vR})),n.d(w,"splitRealAndImagArrays",(function(){return mR})),n.d(w,"complexWithEvenIndex",(function(){return gR})),n.d(w,"complexWithOddIndex",(function(){return yR})),n.d(w,"getComplexWithIndex",(function(){return bR})),n.d(w,"assignToTypedArray",(function(){return kR})),n.d(w,"exponents",(function(){return _R})),n.d(w,"exponent",(function(){return wR}));var C={};n.r(C),n.d(C,"nonMaxSuppressionV3",(function(){return CE})),n.d(C,"nonMaxSuppressionV5",(function(){return xE})),n.d(C,"split",(function(){return AR})),n.d(C,"tile",(function(){return IR})),n.d(C,"topkImpl",(function(){return TR})),n.d(C,"whereImpl",(function(){return mx}));var x={};n.r(x),n.d(x,"AdadeltaOptimizer",(function(){return GE})),n.d(x,"AdagradOptimizer",(function(){return qE})),n.d(x,"AdamOptimizer",(function(){return KE})),n.d(x,"AdamaxOptimizer",(function(){return XE})),n.d(x,"MomentumOptimizer",(function(){return YE})),n.d(x,"Optimizer",(function(){return HE})),n.d(x,"RMSPropOptimizer",(function(){return $E})),n.d(x,"SGDOptimizer",(function(){return ZE})),n.d(x,"Tensor",(function(){return Ab})),n.d(x,"TensorBuffer",(function(){return Cb})),n.d(x,"Variable",(function(){return Ob})),n.d(x,"Rank",(function(){return Ib})),n.d(x,"sumOutType",(function(){return Mb})),n.d(x,"upcastType",(function(){return Fb})),n.d(x,"Reduction",(function(){return nE})),n.d(x,"customGrad",(function(){return iw})),n.d(x,"grad",(function(){return ew})),n.d(x,"grads",(function(){return tw})),n.d(x,"valueAndGrad",(function(){return nw})),n.d(x,"valueAndGrads",(function(){return rw})),n.d(x,"variableGrads",(function(){return aw})),n.d(x,"Environment",(function(){return uy})),n.d(x,"env",(function(){return cy})),n.d(x,"ENV",(function(){return hy})),n.d(x,"version_core",(function(){return MA})),n.d(x,"nextFrame",(function(){return tR})),n.d(x,"browser",(function(){return c})),n.d(x,"io",(function(){return s})),n.d(x,"math",(function(){return u})),n.d(x,"serialization",(function(){return f})),n.d(x,"test_util",(function(){return d})),n.d(x,"util",(function(){return r})),n.d(x,"backend_util",(function(){return w})),n.d(x,"tensor_util",(function(){return a})),n.d(x,"slice_util",(function(){return o})),n.d(x,"gather_util",(function(){return l})),n.d(x,"scatter_util",(function(){return h})),n.d(x,"device_util",(function(){return i})),n.d(x,"kernel_impls",(function(){return C})),n.d(x,"KernelBackend",(function(){return OR})),n.d(x,"DataStorage",(function(){return NR})),n.d(x,"add",(function(){return b_})),n.d(x,"addN",(function(){return rI})),n.d(x,"atan2",(function(){return aI})),n.d(x,"avgPool",(function(){return iI})),n.d(x,"avgPool3d",(function(){return oI})),n.d(x,"batchToSpaceND",(function(){return Nx})),n.d(x,"batchNorm",(function(){return uI})),n.d(x,"batchNorm2d",(function(){return cI})),n.d(x,"batchNorm3d",(function(){return lI})),n.d(x,"batchNorm4d",(function(){return hI})),n.d(x,"broadcastTo",(function(){return dI})),n.d(x,"clone",(function(){return fI})),n.d(x,"complex",(function(){return w_})),n.d(x,"concat",(function(){return W_})),n.d(x,"concat1d",(function(){return pI})),n.d(x,"concat2d",(function(){return vI})),n.d(x,"concat3d",(function(){return mI})),n.d(x,"concat4d",(function(){return gI})),n.d(x,"conv1d",(function(){return yI})),n.d(x,"conv2d",(function(){return FC})),n.d(x,"conv2dTranspose",(function(){return bI})),n.d(x,"conv3d",(function(){return kI})),n.d(x,"conv3dTranspose",(function(){return _I})),n.d(x,"cumsum",(function(){return VC})),n.d(x,"depthToSpace",(function(){return wI})),n.d(x,"depthwiseConv2d",(function(){return CI})),n.d(x,"diag",(function(){return xI})),n.d(x,"div",(function(){return J_})),n.d(x,"divNoNan",(function(){return SI})),n.d(x,"dot",(function(){return AI})),n.d(x,"elu",(function(){return II})),n.d(x,"equal",(function(){return TI})),n.d(x,"eye",(function(){return EI})),n.d(x,"fill",(function(){return RI})),n.d(x,"floorDiv",(function(){return $_})),n.d(x,"greater",(function(){return cx})),n.d(x,"greaterEqual",(function(){return nx})),n.d(x,"imag",(function(){return C_})),n.d(x,"leakyRelu",(function(){return OI})),n.d(x,"less",(function(){return rx})),n.d(x,"lessEqual",(function(){return lx})),n.d(x,"localResponseNormalization",(function(){return DI})),n.d(x,"matMul",(function(){return xC})),n.d(x,"max",(function(){return FI})),n.d(x,"maxPool",(function(){return MI})),n.d(x,"maxPool3d",(function(){return PI})),n.d(x,"maxPoolWithArgmax",(function(){return zI})),n.d(x,"maximum",(function(){return NI})),n.d(x,"minimum",(function(){return LI})),n.d(x,"mod",(function(){return BI})),n.d(x,"mul",(function(){return Q_})),n.d(x,"multinomial",(function(){return VI})),n.d(x,"notEqual",(function(){return WI})),n.d(x,"oneHot",(function(){return dA})),n.d(x,"outerProduct",(function(){return UI})),n.d(x,"pad",(function(){return zx})),n.d(x,"pad1d",(function(){return jI})),n.d(x,"pad2d",(function(){return HI})),n.d(x,"pad3d",(function(){return GI})),n.d(x,"pad4d",(function(){return qI})),n.d(x,"pool",(function(){return KI})),n.d(x,"pow",(function(){return Cx})),n.d(x,"prelu",(function(){return XI})),n.d(x,"rand",(function(){return ZI})),n.d(x,"randomGamma",(function(){return eT})),n.d(x,"randomNormal",(function(){return tT})),n.d(x,"randomUniform",(function(){return nT})),n.d(x,"real",(function(){return x_})),n.d(x,"relu",(function(){return rT})),n.d(x,"relu6",(function(){return aT})),n.d(x,"selu",(function(){return iT})),n.d(x,"separableConv2d",(function(){return oT})),n.d(x,"spaceToBatchND",(function(){return AC})),n.d(x,"split",(function(){return EC})),n.d(x,"square",(function(){return Aw})),n.d(x,"squaredDifference",(function(){return sT})),n.d(x,"sub",(function(){return XC})),n.d(x,"tile",(function(){return ZC})),n.d(x,"truncatedNormal",(function(){return uT})),n.d(x,"op",(function(){return y_})),n.d(x,"image",(function(){return b})),n.d(x,"linalg",(function(){return y})),n.d(x,"losses",(function(){return g})),n.d(x,"spectral",(function(){return v})),n.d(x,"fused",(function(){return k})),n.d(x,"signal",(function(){return m})),n.d(x,"train",(function(){return QE})),n.d(x,"enableProdMode",(function(){return PA})),n.d(x,"enableDebugMode",(function(){return zA})),n.d(x,"disableDeprecationWarnings",(function(){return LA})),n.d(x,"deprecationWarn",(function(){return BA})),n.d(x,"disposeVariables",(function(){return VA})),n.d(x,"engine",(function(){return WA})),n.d(x,"memory",(function(){return UA})),n.d(x,"profile",(function(){return jA})),n.d(x,"tidy",(function(){return HA})),n.d(x,"dispose",(function(){return GA})),n.d(x,"keep",(function(){return qA})),n.d(x,"time",(function(){return KA})),n.d(x,"setBackend",(function(){return XA})),n.d(x,"ready",(function(){return ZA})),n.d(x,"getBackend",(function(){return YA})),n.d(x,"removeBackend",(function(){return $A})),n.d(x,"findBackend",(function(){return JA})),n.d(x,"findBackendFactory",(function(){return QA})),n.d(x,"registerBackend",(function(){return eI})),n.d(x,"backend",(function(){return tI})),n.d(x,"setPlatform",(function(){return nI})),n.d(x,"getKernel",(function(){return my})),n.d(x,"getGradient",(function(){return gy})),n.d(x,"getKernelsForBackend",(function(){return yy})),n.d(x,"registerKernel",(function(){return by})),n.d(x,"registerGradient",(function(){return ky})),n.d(x,"unregisterKernel",(function(){return _y})),n.d(x,"unregisterGradient",(function(){return wy})),n.d(x,"Add",(function(){return qb})),n.d(x,"AddN",(function(){return Kb})),n.d(x,"Atan2",(function(){return Xb})),n.d(x,"AvgPool",(function(){return Zb})),n.d(x,"AvgPoolBackprop",(function(){return Yb})),n.d(x,"AvgPool3D",(function(){return $b})),n.d(x,"AvgPool3DBackprop",(function(){return Jb})),n.d(x,"BatchMatMul",(function(){return Qb})),n.d(x,"BatchToSpaceND",(function(){return ek})),n.d(x,"BroadcastTo",(function(){return tk})),n.d(x,"Complex",(function(){return nk})),n.d(x,"Concat",(function(){return rk})),n.d(x,"Conv2D",(function(){return ak})),n.d(x,"Conv2DBackpropFilter",(function(){return ik})),n.d(x,"Conv2DBackpropInput",(function(){return ok})),n.d(x,"Conv3D",(function(){return sk})),n.d(x,"Conv3DBackpropFilterV2",(function(){return uk})),n.d(x,"Conv3DBackpropInputV2",(function(){return ck})),n.d(x,"Cumsum",(function(){return lk})),n.d(x,"DepthToSpace",(function(){return hk})),n.d(x,"DepthwiseConv2dNative",(function(){return fk})),n.d(x,"DepthwiseConv2dNativeBackpropFilter",(function(){return dk})),n.d(x,"DepthwiseConv2dNativeBackpropInput",(function(){return pk})),n.d(x,"Diag",(function(){return vk})),n.d(x,"Div",(function(){return mk})),n.d(x,"Elu",(function(){return gk})),n.d(x,"EluGrad",(function(){return yk})),n.d(x,"Equal",(function(){return bk})),n.d(x,"FloorDiv",(function(){return kk})),n.d(x,"Fill",(function(){return _k})),n.d(x,"FusedBatchNorm",(function(){return wk})),n.d(x,"GatherNd",(function(){return Ck})),n.d(x,"Greater",(function(){return xk})),n.d(x,"GreaterEqual",(function(){return Sk})),n.d(x,"Identity",(function(){return Ak})),n.d(x,"Imag",(function(){return Ik})),n.d(x,"Less",(function(){return Tk})),n.d(x,"LessEqual",(function(){return Ek})),n.d(x,"LRN",(function(){return Rk})),n.d(x,"LRNBackprop",(function(){return Nk})),n.d(x,"Max",(function(){return Ok})),n.d(x,"Maximum",(function(){return Dk})),n.d(x,"MaxPool",(function(){return Fk})),n.d(x,"MaxPoolBackprop",(function(){return Mk})),n.d(x,"MaxPool3D",(function(){return Pk})),n.d(x,"MaxPool3DBackprop",(function(){return zk})),n.d(x,"MaxPoolWithArgmax",(function(){return Lk})),n.d(x,"Minimum",(function(){return Bk})),n.d(x,"Mod",(function(){return Vk})),n.d(x,"Multiply",(function(){return Wk})),n.d(x,"NotEqual",(function(){return Uk})),n.d(x,"NonMaxSuppressionV3",(function(){return jk})),n.d(x,"NonMaxSuppressionV5",(function(){return Hk})),n.d(x,"OneHot",(function(){return Gk})),n.d(x,"PadV2",(function(){return qk})),n.d(x,"Pool",(function(){return Kk})),n.d(x,"Pow",(function(){return Xk})),n.d(x,"Prelu",(function(){return Zk})),n.d(x,"Real",(function(){return Yk})),n.d(x,"Relu",(function(){return $k})),n.d(x,"Relu6",(function(){return Jk})),n.d(x,"SelectV2",(function(){return Qk})),n.d(x,"Selu",(function(){return e_})),n.d(x,"SpaceToBatchND",(function(){return t_})),n.d(x,"SplitV",(function(){return n_})),n.d(x,"SquaredDifference",(function(){return r_})),n.d(x,"Square",(function(){return a_})),n.d(x,"Sub",(function(){return i_})),n.d(x,"Tile",(function(){return o_})),n.d(x,"Transpose",(function(){return s_})),n.d(x,"FromPixels",(function(){return u_})),n.d(x,"booleanMaskAsync",(function(){return yT})),n.d(x,"reverse",(function(){return bT})),n.d(x,"reverse1d",(function(){return kT})),n.d(x,"reverse2d",(function(){return _T})),n.d(x,"reverse3d",(function(){return wT})),n.d(x,"reverse4d",(function(){return CT})),n.d(x,"slice",(function(){return Yx})),n.d(x,"slice1d",(function(){return $x})),n.d(x,"slice2d",(function(){return Jx})),n.d(x,"slice3d",(function(){return Qx})),n.d(x,"slice4d",(function(){return eS})),n.d(x,"abs",(function(){return Iw})),n.d(x,"acos",(function(){return Tw})),n.d(x,"acosh",(function(){return Ew})),n.d(x,"asin",(function(){return Rw})),n.d(x,"asinh",(function(){return Nw})),n.d(x,"atan",(function(){return Ow})),n.d(x,"atanh",(function(){return Dw})),n.d(x,"ceil",(function(){return Fw})),n.d(x,"clipByValue",(function(){return Mw})),n.d(x,"cos",(function(){return Pw})),n.d(x,"cosh",(function(){return zw})),n.d(x,"erf",(function(){return Lw})),n.d(x,"exp",(function(){return Bw})),n.d(x,"expm1",(function(){return Vw})),n.d(x,"floor",(function(){return Ww})),n.d(x,"log",(function(){return Uw})),n.d(x,"log1p",(function(){return jw})),n.d(x,"logSigmoid",(function(){return Hw})),n.d(x,"neg",(function(){return Gw})),n.d(x,"reciprocal",(function(){return qw})),n.d(x,"round",(function(){return Kw})),n.d(x,"rsqrt",(function(){return Xw})),n.d(x,"sigmoid",(function(){return Zw})),n.d(x,"sign",(function(){return Yw})),n.d(x,"isNaN",(function(){return $w})),n.d(x,"isInf",(function(){return Jw})),n.d(x,"isFinite",(function(){return Qw})),n.d(x,"sin",(function(){return eC})),n.d(x,"sinh",(function(){return tC})),n.d(x,"softplus",(function(){return nC})),n.d(x,"sqrt",(function(){return rC})),n.d(x,"step",(function(){return aC})),n.d(x,"tan",(function(){return iC})),n.d(x,"tanh",(function(){return oC})),n.d(x,"all",(function(){return mw})),n.d(x,"any",(function(){return gw})),n.d(x,"argMax",(function(){return yw})),n.d(x,"argMin",(function(){return bw})),n.d(x,"logSumExp",(function(){return kw})),n.d(x,"mean",(function(){return _w})),n.d(x,"min",(function(){return ww})),n.d(x,"moments",(function(){return Cw})),n.d(x,"sum",(function(){return xw})),n.d(x,"prod",(function(){return Sw})),n.d(x,"equalStrict",(function(){return xT})),n.d(x,"greaterEqualStrict",(function(){return ST})),n.d(x,"greaterStrict",(function(){return AT})),n.d(x,"lessEqualStrict",(function(){return IT})),n.d(x,"lessStrict",(function(){return TT})),n.d(x,"notEqualStrict",(function(){return ET})),n.d(x,"addStrict",(function(){return RT})),n.d(x,"divStrict",(function(){return NT})),n.d(x,"maximumStrict",(function(){return OT})),n.d(x,"minimumStrict",(function(){return DT})),n.d(x,"modStrict",(function(){return FT})),n.d(x,"mulStrict",(function(){return MT})),n.d(x,"powStrict",(function(){return PT})),n.d(x,"squaredDifferenceStrict",(function(){return zT})),n.d(x,"subStrict",(function(){return LT})),n.d(x,"logicalAnd",(function(){return gx})),n.d(x,"logicalNot",(function(){return yx})),n.d(x,"logicalOr",(function(){return bx})),n.d(x,"logicalXor",(function(){return kx})),n.d(x,"where",(function(){return _x})),n.d(x,"whereAsync",(function(){return wx})),n.d(x,"buffer",(function(){return U_})),n.d(x,"print",(function(){return j_})),n.d(x,"cast",(function(){return H_})),n.d(x,"expandDims",(function(){return G_})),n.d(x,"reshape",(function(){return q_})),n.d(x,"squeeze",(function(){return K_})),n.d(x,"stack",(function(){return X_})),n.d(x,"unstack",(function(){return Z_})),n.d(x,"setdiff1dAsync",(function(){return Y_})),n.d(x,"linspace",(function(){return z_})),n.d(x,"ones",(function(){return M_})),n.d(x,"range",(function(){return L_})),n.d(x,"scalar",(function(){return I_})),n.d(x,"tensor",(function(){return S_})),n.d(x,"tensor1d",(function(){return T_})),n.d(x,"tensor2d",(function(){return E_})),n.d(x,"tensor3d",(function(){return R_})),n.d(x,"tensor4d",(function(){return N_})),n.d(x,"tensor5d",(function(){return O_})),n.d(x,"tensor6d",(function(){return D_})),n.d(x,"variable",(function(){return F_})),n.d(x,"zeros",(function(){return P_})),n.d(x,"onesLike",(function(){return B_})),n.d(x,"zerosLike",(function(){return V_})),n.d(x,"transpose",(function(){return BC})),n.d(x,"softmax",(function(){return BT})),n.d(x,"logSoftmax",(function(){return VT})),n.d(x,"norm",(function(){return WT})),n.d(x,"gather",(function(){return mT})),n.d(x,"unsortedSegmentSum",(function(){return gT})),n.d(x,"basicLSTMCell",(function(){return UT})),n.d(x,"multiRNNCell",(function(){return jT})),n.d(x,"movingAverage",(function(){return HT})),n.d(x,"stridedSlice",(function(){return GT})),n.d(x,"topk",(function(){return qT})),n.d(x,"scatterND",(function(){return KT})),n.d(x,"fft",(function(){return XT})),n.d(x,"ifft",(function(){return ZT})),n.d(x,"rfft",(function(){return YT})),n.d(x,"irfft",(function(){return $T})),n.d(x,"sparseToDense",(function(){return JT})),n.d(x,"gatherND",(function(){return QT})),n.d(x,"dropout",(function(){return eE})),n.d(x,"hannWindow",(function(){return rE})),n.d(x,"hammingWindow",(function(){return aE})),n.d(x,"frame",(function(){return iE})),n.d(x,"stft",(function(){return oE})),n.d(x,"inTopKAsync",(function(){return sE}));var S={};n.r(S),n.d(S,"json",(function(){return UR}));var A={};n.r(A),n.d(A,"json",(function(){return jR}));var I={};n.r(I),n.d(I,"json",(function(){return HR}));var T={};n.r(T),n.d(T,"json",(function(){return GR}));var E={};n.r(E),n.d(E,"json",(function(){return qR}));var R={};n.r(R),n.d(R,"json",(function(){return KR}));var N={};n.r(N),n.d(N,"json",(function(){return XR}));var O={};n.r(O),n.d(O,"json",(function(){return ZR}));var D={};n.r(D),n.d(D,"json",(function(){return YR}));var F={};n.r(F),n.d(F,"json",(function(){return $R}));var M={};n.r(M),n.d(M,"json",(function(){return JR}));var P={};n.r(P),n.d(P,"json",(function(){return QR}));var z={};n.r(z),n.d(z,"json",(function(){return eN}));var L={};n.r(L),n.d(L,"json",(function(){return tN}));var B={};n.r(B),n.d(B,"json",(function(){return nN}));var V={};n.r(V),n.d(V,"json",(function(){return rN}));var W={};function U(e){return"function"==typeof e}n.r(W),n.d(W,"maxImpl",(function(){return vz})),n.d(W,"transposeImpl",(function(){return mz}));var j=!1,H={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else j&&console.log("RxJS: Back to a better error behavior. Thank you. <3");j=e},get useDeprecatedSynchronousErrorHandling(){return j}};function G(e){setTimeout((function(){throw e}),0)}var q={closed:!0,next:function(e){},error:function(e){if(H.useDeprecatedSynchronousErrorHandling)throw e;G(e)},complete:function(){}},K=Array.isArray||function(e){return e&&"number"==typeof e.length};function X(e){return null!==e&&"object"==typeof e}var Z,Y=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map((function(e,t){return"".concat(t+1,") ").concat(e.toString())})).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),$=((Z=function(){function e(t){_classCallCheck(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._unsubscribe=t)}return _createClass(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,r=this._unsubscribe,a=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var i=0;i<n.length;++i)n[i].remove(this);if(U(r))try{r.call(this)}catch(c){t=c instanceof Y?J(c.errors):[c]}if(K(a))for(var o=-1,s=a.length;++o<s;){var u=a[o];if(X(u))try{u.unsubscribe()}catch(c){t=t||[],c instanceof Y?t=t.concat(J(c.errors)):t.push(c)}}if(t)throw new Y(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var r=n;(n=new e)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var a=n._parentOrParents;if(null===a)n._parentOrParents=this;else if(a instanceof e){if(a===this)return n;n._parentOrParents=[a,this]}else{if(-1!==a.indexOf(this))return n;a.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[n]:i.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new Z),Z);function J(e){return e.reduce((function(e,t){return e.concat(t instanceof Y?t.errors:t)}),[])}var Q="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),ee=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;switch(_classCallCheck(this,n),(i=t.call(this)).syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=q;break;case 1:if(!e){i.destination=q;break}if("object"==typeof e){e instanceof n?(i.syncErrorThrowable=e.syncErrorThrowable,i.destination=e,e.add(_assertThisInitialized(i))):(i.syncErrorThrowable=!0,i.destination=new te(_assertThisInitialized(i),e));break}default:i.syncErrorThrowable=!0,i.destination=new te(_assertThisInitialized(i),e,r,a)}return i}return _createClass(n,[{key:Q,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,_get(_getPrototypeOf(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,r){var a=new n(e,t,r);return a.syncErrorThrowable=!1,a}}]),n}($),te=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o,s;_classCallCheck(this,n),(o=t.call(this))._parentSubscriber=e;var u=_assertThisInitialized(o);return U(r)?s=r:r&&(s=r.next,a=r.error,i=r.complete,r!==q&&(U((u=Object.create(r)).unsubscribe)&&o.add(u.unsubscribe.bind(u)),u.unsubscribe=o.unsubscribe.bind(_assertThisInitialized(o)))),o._context=u,o._next=s,o._error=a,o._complete=i,o}return _createClass(n,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;H.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=H.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):G(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;G(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};H.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),H.useDeprecatedSynchronousErrorHandling)throw n;G(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!H.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(r){return H.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=r,e.syncErrorThrown=!0,!0):(G(r),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),n}(ee),ne="function"==typeof Symbol&&Symbol.observable||"@@observable";function re(){}function ae(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ie(t)}function ie(e){return e?1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}:re}var oe,se=((oe=function(){function e(t){_classCallCheck(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return _createClass(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var r=this.operator,a=function(e,t,n){if(e){if(e instanceof ee)return e;if(e[Q])return e[Q]()}return e||t||n?new ee(e,t,n):new ee(q)}(e,t,n);if(a.add(r?r.call(a,this.source):this.source||H.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),H.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){H.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,r=t.destination,a=t.isStopped;if(n||a)return!1;e=r&&r instanceof ee?r:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=ue(t))((function(t,r){var a;a=n.subscribe((function(t){try{e(t)}catch(n){r(n),a&&a.unsubscribe()}}),r,t)}))}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:ne,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:ie(t)(this)}},{key:"toPromise",value:function(e){var t=this;return new(e=ue(e))((function(e,n){var r;t.subscribe((function(e){return r=e}),(function(e){return n(e)}),(function(){return e(r)}))}))}}]),e}()).create=function(e){return new oe(e)},oe);function ue(e){if(e||(e=H.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var ce,le=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),he=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).subject=e,a.subscriber=r,a.closed=!1,a}return _createClass(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),n}($),fe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).destination=e,r}return n}(ee),de=((ce=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return _createClass(n,[{key:Q,value:function(){return new fe(this)}},{key:"lift",value:function(e){var t=new pe(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new le;if(!this.isStopped)for(var t=this.observers,n=t.length,r=t.slice(),a=0;a<n;a++)r[a].next(e)}},{key:"error",value:function(e){if(this.closed)throw new le;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,r=t.slice(),a=0;a<n;a++)r[a].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new le;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),r=0;r<t;r++)n[r].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new le;return _get(_getPrototypeOf(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new le;return this.hasError?(e.error(this.thrownError),$.EMPTY):this.isStopped?(e.complete(),$.EMPTY):(this.observers.push(e),new he(this,e))}},{key:"asObservable",value:function(){var e=new se;return e.source=this,e}}]),n}(se)).create=function(e,t){return new pe(e,t)},ce),pe=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).destination=e,a.source=r,a}return _createClass(n,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):$.EMPTY}}]),n}(de);function ve(e){return e&&"function"==typeof e.schedule}var me=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this)).parent=e,i.outerValue=r,i.outerIndex=a,i.index=0,i}return _createClass(n,[{key:"_next",value:function(e){this.parent.notifyNext(this.outerValue,e,this.outerIndex,this.index++,this)}},{key:"_error",value:function(e){this.parent.notifyError(e,this),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(this),this.unsubscribe()}}]),n}(ee),ge=function(e){return function(t){for(var n=0,r=e.length;n<r&&!t.closed;n++)t.next(e[n]);t.complete()}};var ye="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",be=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function ke(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var _e=function(e){if(e&&"function"==typeof e[ne])return r=e,function(e){var t=r[ne]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(be(e))return ge(e);if(ke(e))return n=e,function(e){return n.then((function(t){e.closed||(e.next(t),e.complete())}),(function(t){return e.error(t)})).then(null,G),e};if(e&&"function"==typeof e[ye])return t=e,function(e){for(var n=t[ye]();;){var r=n.next();if(r.done){e.complete();break}if(e.next(r.value),e.closed)break}return"function"==typeof n.return&&e.add((function(){n.return&&n.return()})),e};var t,n,r,a=X(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(a," where a stream was expected.")+" You can provide an Observable, Promise, Array, or Iterable.")};function we(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new me(e,n,r);if(!a.closed)return t instanceof se?t.subscribe(a):_e(t)(a)}var Ce=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}},{key:"notifyError",value:function(e,t){this.destination.error(e)}},{key:"notifyComplete",value:function(e){this.destination.complete()}}]),n}(ee);function xe(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Se(e,t))}}var Se=function(){function e(t,n){_classCallCheck(this,e),this.project=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ae(e,this.project,this.thisArg))}}]),e}(),Ae=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).project=r,i.count=0,i.thisArg=a||_assertThisInitialized(i),i}return _createClass(n,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(ee);function Ie(e,t){return new se((function(n){var r=new $,a=0;return r.add(t.schedule((function(){a!==e.length?(n.next(e[a++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function Te(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[ne]}(e))return function(e,t){return new se((function(n){var r=new $;return r.add(t.schedule((function(){var a=e[ne]();r.add(a.subscribe({next:function(e){r.add(t.schedule((function(){return n.next(e)})))},error:function(e){r.add(t.schedule((function(){return n.error(e)})))},complete:function(){r.add(t.schedule((function(){return n.complete()})))}}))}))),r}))}(e,t);if(ke(e))return function(e,t){return new se((function(n){var r=new $;return r.add(t.schedule((function(){return e.then((function(e){r.add(t.schedule((function(){n.next(e),r.add(t.schedule((function(){return n.complete()})))})))}),(function(e){r.add(t.schedule((function(){return n.error(e)})))}))}))),r}))}(e,t);if(be(e))return Ie(e,t);if(function(e){return e&&"function"==typeof e[ye]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new se((function(n){var r,a=new $;return a.add((function(){r&&"function"==typeof r.return&&r.return()})),a.add(t.schedule((function(){r=e[ye](),a.add(t.schedule((function(){if(!n.closed){var e,t;try{var a=r.next();e=a.value,t=a.done}catch(i){return void n.error(i)}t?n.complete():(n.next(e),this.schedule())}})))}))),a}))}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof se?e:new se(_e(e))}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(r){return r.pipe(Ee((function(n,r){return Te(e(n,r)).pipe(xe((function(e,a){return t(n,e,r,a)})))}),n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new Re(e,n))})}var Re=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;_classCallCheck(this,e),this.project=t,this.concurrent=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Ne(e,this.project,this.concurrent))}}]),e}(),Ne=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return _classCallCheck(this,n),(a=t.call(this,e)).project=r,a.concurrent=i,a.hasCompleted=!1,a.buffer=[],a.active=0,a.index=0,a}return _createClass(n,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this.active++,this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=new me(this,t,n),a=this.destination;a.add(r);var i=we(this,e,void 0,void 0,r);i!==r&&a.add(i)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}},{key:"notifyComplete",value:function(e){var t=this.buffer;this.remove(e),this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(Ce);function Oe(e){return e}function De(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return Ee(Oe,e)}function Fe(e,t){return t?Ie(e,t):new se(ge(e))}function Me(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Number.POSITIVE_INFINITY,a=null,i=t[t.length-1];return ve(i)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(r=t.pop())):"number"==typeof i&&(r=t.pop()),null===a&&1===t.length&&t[0]instanceof se?t[0]:De(r)(Fe(t,a))}function Pe(){return function(e){return e.lift(new Le(e))}}var ze,Le=function(){function e(t){_classCallCheck(this,e),this.connectable=t}return _createClass(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var r=new Be(e,n),a=t.subscribe(r);return r.closed||(r.connection=n.connect()),a}}]),e}(),Be=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).connectable=r,a}return _createClass(n,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,r=e._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null}}]),n}(ee),Ve={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(ze=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).source=e,a.subjectFactory=r,a._refCount=0,a._isComplete=!1,a}return _createClass(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new $).add(this.source.subscribe(new We(this.getSubject(),this))),e.closed&&(this._connection=null,e=$.EMPTY)),e}},{key:"refCount",value:function(){return Pe()(this)}}]),n}(se).prototype)._subscribe},_isComplete:{value:ze._isComplete,writable:!0},getSubject:{value:ze.getSubject},connect:{value:ze.connect},refCount:{value:ze.refCount}},We=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).connectable=r,a}return _createClass(n,[{key:"_error",value:function(e){this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),n}(fe);function Ue(){return new de}function je(e){return{toString:e}.toString()}function He(e,t,n){return je((function(){var r=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof a)return r.apply(this,t),this;var i=_construct(a,t);return o.annotation=i,o;function o(e,t,n){for(var r=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;r.length<=n;)r.push(null);return(r[n]=r[n]||[]).push(i),e}}return n&&(a.prototype=Object.create(n.prototype)),a.prototype.ngMetadataName=e,a.annotationCls=a,a}))}var Ge=He("Inject",(function(e){return{token:e}})),qe=He("Optional"),Ke=He("Self"),Xe=He("SkipSelf"),Ze=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function Ye(e){for(var t in e)if(e[t]===Ye)return t;throw Error("Could not find renamed property on target object.")}function $e(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Je(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Qe(e){return{factory:e.factory,providers:e.providers||[],imports:e.imports||[]}}function et(e){return tt(e,e[rt])||tt(e,e[ot])}function tt(e,t){return t&&t.token===e?t:null}function nt(e){return e&&(e.hasOwnProperty(at)||e.hasOwnProperty(st))?e[at]:null}var rt=Ye({"\u0275prov":Ye}),at=Ye({"\u0275inj":Ye}),it=Ye({"\u0275provFallback":Ye}),ot=Ye({ngInjectableDef:Ye}),st=Ye({ngInjectorDef:Ye});function ut(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(ut).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function ct(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var lt=Ye({__forward_ref__:Ye});function ht(e){return e.__forward_ref__=ht,e.toString=function(){return ut(this())},e}function ft(e){return dt(e)?e():e}function dt(e){return"function"==typeof e&&e.hasOwnProperty(lt)&&e.__forward_ref__===ht}var pt,vt="undefined"!=typeof globalThis&&globalThis,mt="undefined"!=typeof window&&window,gt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,yt="undefined"!=typeof global&&global,bt=vt||yt||mt||gt,kt=Ye({"\u0275cmp":Ye}),_t=Ye({"\u0275dir":Ye}),wt=Ye({"\u0275pipe":Ye}),Ct=Ye({"\u0275mod":Ye}),xt=Ye({"\u0275loc":Ye}),St=Ye({"\u0275fac":Ye}),At=Ye({__NG_ELEMENT_ID__:Ye}),It=function(){function e(t,n){_classCallCheck(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Je({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return _createClass(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}(),Tt=new It("INJECTOR",-1),Et={},Rt=/\n/gm,Nt=Ye({provide:String,useValue:Ye}),Ot=void 0;function Dt(e){var t=Ot;return Ot=e,t}function Ft(e){var t=pt;return pt=e,t}function Mt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze.Default;if(void 0===Ot)throw new Error("inject() must be called from an injection context");return null===Ot?zt(e,void 0,t):Ot.get(e,t&Ze.Optional?null:void 0,t)}function Pt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze.Default;return(pt||Mt)(ft(e),t)}function zt(e,t,n){var r=et(e);if(r&&"root"==r.providedIn)return void 0===r.value?r.value=r.factory():r.value;if(n&Ze.Optional)return null;if(void 0!==t)return t;throw new Error("Injector: NOT_FOUND [".concat(ut(e),"]"))}function Lt(e){for(var t=[],n=0;n<e.length;n++){var r=ft(e[n]);if(Array.isArray(r)){if(0===r.length)throw new Error("Arguments array must have arguments.");for(var a=void 0,i=Ze.Default,o=0;o<r.length;o++){var s=r[o];s instanceof qe||"Optional"===s.ngMetadataName||s===qe?i|=Ze.Optional:s instanceof Xe||"SkipSelf"===s.ngMetadataName||s===Xe?i|=Ze.SkipSelf:s instanceof Ke||"Self"===s.ngMetadataName||s===Ke?i|=Ze.Self:a=s instanceof Ge||s===Ge?s.token:s}t.push(Pt(a,i))}else t.push(Pt(r))}return t}var Bt=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et;if(t===Et){var n=new Error("NullInjectorError: No provider for ".concat(ut(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),Vt=function e(){_classCallCheck(this,e)},Wt=function e(){_classCallCheck(this,e)};function Ut(e,t){e.forEach((function(e){return Array.isArray(e)?Ut(e,t):t(e)}))}function jt(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function Ht(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function Gt(e,t){for(var n=[],r=0;r<e;r++)n.push(t);return n}function qt(e,t,n){var r=Xt(e,t);return r>=0?e[1|r]=n:function(e,t,n,r){var a=e.length;if(a==t)e.push(n,r);else if(1===a)e.push(r,e[0]),e[0]=n;else{for(a--,e.push(e[a-1],e[a]);a>t;)e[a]=e[a-2],a--;e[t]=n,e[t+1]=r}}(e,r=~r,t,n),r}function Kt(e,t){var n=Xt(e,t);if(n>=0)return e[1|n]}function Xt(e,t){return function(e,t,n){for(var r=0,a=e.length>>1;a!==r;){var i=r+(a-r>>1),o=e[i<<1];if(t===o)return i<<1;o>t?a=i:r=i+1}return~(a<<1)}(e,t)}var Zt=function(){var e={OnPush:0,Default:1};return e[e.OnPush]="OnPush",e[e.Default]="Default",e}(),Yt=function(){var e={Emulated:0,Native:1,None:2,ShadowDom:3};return e[e.Emulated]="Emulated",e[e.Native]="Native",e[e.None]="None",e[e.ShadowDom]="ShadowDom",e}(),$t={},Jt=[],Qt=0;function en(e){return je((function(){var t=e.type,n=t.prototype,r={},a={type:t,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:e.exportAs||null,onChanges:null,onInit:n.ngOnInit||null,doCheck:n.ngDoCheck||null,afterContentInit:n.ngAfterContentInit||null,afterContentChecked:n.ngAfterContentChecked||null,afterViewInit:n.ngAfterViewInit||null,afterViewChecked:n.ngAfterViewChecked||null,onDestroy:n.ngOnDestroy||null,onPush:e.changeDetection===Zt.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||Jt,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Yt.Emulated,id:"c",styles:e.styles||Jt,_:null,setInput:null,schemas:e.schemas||null,tView:null},i=e.directives,o=e.features,s=e.pipes;return a.id+=Qt++,a.inputs=on(e.inputs,r),a.outputs=on(e.outputs),o&&o.forEach((function(e){return e(a)})),a.directiveDefs=i?function(){return("function"==typeof i?i():i).map(tn)}:null,a.pipeDefs=s?function(){return("function"==typeof s?s():s).map(nn)}:null,a}))}function tn(e){return un(e)||function(e){return e[_t]||null}(e)}function nn(e){return function(e){return e[wt]||null}(e)}var rn={};function an(e){var t={type:e.type,bootstrap:e.bootstrap||Jt,declarations:e.declarations||Jt,imports:e.imports||Jt,exports:e.exports||Jt,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&je((function(){rn[e.id]=e.type})),t}function on(e,t){if(null==e)return $t;var n={};for(var r in e)if(e.hasOwnProperty(r)){var a=e[r],i=a;Array.isArray(a)&&(i=a[1],a=a[0]),n[a]=r,t&&(t[a]=i)}return n}var sn=en;function un(e){return e[kt]||null}function cn(e,t){return e.hasOwnProperty(St)?e[St]:null}function ln(e,t){var n=e[Ct]||null;if(!n&&!0===t)throw new Error("Type ".concat(ut(e)," does not have '\u0275mod' property."));return n}function hn(e){return Array.isArray(e)&&"object"==typeof e[1]}function fn(e){return Array.isArray(e)&&!0===e[1]}function dn(e){return 0!=(8&e.flags)}function pn(e){return 2==(2&e.flags)}function vn(e){return 1==(1&e.flags)}function mn(e){return null!==e.template}function gn(e){return 0!=(512&e[2])}var yn={lFrame:Bn(null),bindingsEnabled:!0,checkNoChangesMode:!1};function bn(){return yn.bindingsEnabled}function kn(){return yn.lFrame.lView}function _n(){return yn.lFrame.tView}function wn(e){yn.lFrame.contextLView=e}function Cn(){return yn.lFrame.previousOrParentTNode}function xn(e,t){yn.lFrame.previousOrParentTNode=e,yn.lFrame.isParent=t}function Sn(){return yn.lFrame.isParent}function An(){yn.lFrame.isParent=!1}function In(){return yn.checkNoChangesMode}function Tn(e){yn.checkNoChangesMode=e}function En(){var e=yn.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function Rn(){return yn.lFrame.bindingIndex}function Nn(){return yn.lFrame.bindingIndex++}function On(e){var t=yn.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function Dn(e,t){var n=yn.lFrame;n.bindingIndex=n.bindingRootIndex=e,n.currentDirectiveIndex=t}function Fn(){return yn.lFrame.currentQueryIndex}function Mn(e){yn.lFrame.currentQueryIndex=e}function Pn(e,t){var n=Ln();yn.lFrame=n,n.previousOrParentTNode=t,n.lView=e}function zn(e,t){var n=Ln(),r=e[1];yn.lFrame=n,n.previousOrParentTNode=t,n.lView=e,n.tView=r,n.contextLView=e,n.bindingIndex=r.bindingStartIndex}function Ln(){var e=yn.lFrame,t=null===e?null:e.child;return null===t?Bn(e):t}function Bn(e){var t={previousOrParentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:0,contextLView:null,elementDepthCount:0,currentNamespace:null,currentSanitizer:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null};return null!==e&&(e.child=t),t}function Vn(){var e=yn.lFrame;return yn.lFrame=e.parent,e.previousOrParentTNode=null,e.lView=null,e}var Wn=Vn;function Un(){var e=Vn();e.isParent=!0,e.tView=null,e.selectedIndex=0,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.currentSanitizer=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function jn(){return yn.lFrame.selectedIndex}function Hn(e){yn.lFrame.selectedIndex=e}function Gn(e,t){for(var n=t.directiveStart,r=t.directiveEnd;n<r;n++){var a=e.data[n];a.afterContentInit&&(e.contentHooks||(e.contentHooks=[])).push(-n,a.afterContentInit),a.afterContentChecked&&((e.contentHooks||(e.contentHooks=[])).push(n,a.afterContentChecked),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,a.afterContentChecked)),a.afterViewInit&&(e.viewHooks||(e.viewHooks=[])).push(-n,a.afterViewInit),a.afterViewChecked&&((e.viewHooks||(e.viewHooks=[])).push(n,a.afterViewChecked),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,a.afterViewChecked)),null!=a.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(n,a.onDestroy)}}function qn(e,t,n){Zn(e,t,3,n)}function Kn(e,t,n,r){(3&e[2])===n&&Zn(e,t,n,r)}function Xn(e,t){var n=e[2];(3&n)===t&&(n&=1023,n+=1,e[2]=n)}function Zn(e,t,n,r){for(var a=null!=r?r:-1,i=0,o=void 0!==r?65535&e[18]:0;o<t.length;o++)if("number"==typeof t[o+1]){if(i=t[o],null!=r&&i>=r)break}else t[o]<0&&(e[18]+=65536),(i<a||-1==a)&&(Yn(e,n,t,o),e[18]=(4294901760&e[18])+o+2),o++}function Yn(e,t,n,r){var a=n[r]<0,i=n[r+1],o=e[a?-n[r]:n[r]];a?e[2]>>10<e[18]>>16&&(3&e[2])===t&&(e[2]+=1024,i.call(o)):i.call(o)}var $n=function e(t,n,r){_classCallCheck(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r},Jn=void 0;function Qn(e){return!!e.listen}var er={createRenderer:function(e,t){return void 0!==Jn?Jn:"undefined"!=typeof document?document:void 0}};function tr(e,t,n){for(var r=Qn(e),a=0;a<n.length;){var i=n[a];if("number"==typeof i){if(0!==i)break;a++;var o=n[a++],s=n[a++],u=n[a++];r?e.setAttribute(t,s,u,o):t.setAttributeNS(o,s,u)}else{var c=i,l=n[++a];rr(c)?r&&e.setProperty(t,c,l):r?e.setAttribute(t,c,l):t.setAttribute(c,l),a++}}return a}function nr(e){return 3===e||4===e||6===e}function rr(e){return 64===e.charCodeAt(0)}function ar(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,r=0;r<t.length;r++){var a=t[r];"number"==typeof a?n=a:0===n||ir(e,n,a,null,-1===n||2===n?t[++r]:null)}return e}function ir(e,t,n,r,a){var i=0,o=e.length;if(-1===t)o=-1;else for(;i<e.length;){var s=e[i++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=i-1;break}}}for(;i<e.length;){var u=e[i];if("number"==typeof u)break;if(u===n){if(null===r)return void(null!==a&&(e[i+1]=a));if(r===e[i+1])return void(e[i+2]=a)}i++,null!==r&&i++,null!==a&&i++}-1!==o&&(e.splice(o,0,t),i=o+1),e.splice(i++,0,n),null!==r&&e.splice(i++,0,r),null!==a&&e.splice(i++,0,a)}function or(e){return-1!==e}function sr(e){return 32767&e}function ur(e){return e>>16}function cr(e,t){for(var n=ur(e),r=t;n>0;)r=r[15],n--;return r}function lr(e){return"string"==typeof e?e:null==e?"":""+e}function hr(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():lr(e)}var fr=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(bt);function dr(e){return e instanceof Function?e():e}var pr=!0;function vr(e){var t=pr;return pr=e,t}var mr=0;function gr(e,t){var n=br(e,t);if(-1!==n)return n;var r=t[1];r.firstCreatePass&&(e.injectorIndex=t.length,yr(r.data,e),yr(t,null),yr(r.blueprint,null));var a=kr(e,t),i=e.injectorIndex;if(or(a))for(var o=sr(a),s=cr(a,t),u=s[1].data,c=0;c<8;c++)t[i+c]=s[o+c]|u[o+c];return t[i+8]=a,i}function yr(e,t){e.push(0,0,0,0,0,0,0,0,t)}function br(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null==t[e.injectorIndex+8]?-1:e.injectorIndex}function kr(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=t[6],r=1;n&&-1===n.injectorIndex;)n=(t=t[15])?t[6]:null,r++;return n?n.injectorIndex|r<<16:-1}function _r(e,t,n){!function(e,t,n){var r="string"!=typeof n?n[At]:n.charCodeAt(0)||0;null==r&&(r=n[At]=mr++);var a=255&r,i=1<<a,o=64&a,s=32&a,u=t.data;128&a?o?s?u[e+7]|=i:u[e+6]|=i:s?u[e+5]|=i:u[e+4]|=i:o?s?u[e+3]|=i:u[e+2]|=i:s?u[e+1]|=i:u[e]|=i}(e,t,n)}function wr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ze.Default,a=arguments.length>4?arguments[4]:void 0;if(null!==e){var i=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e[At];return"number"==typeof t&&t>0?255&t:t}(n);if("function"==typeof i){Pn(t,e);try{var o=i();if(null!=o||r&Ze.Optional)return o;throw new Error("No provider for ".concat(hr(n),"!"))}finally{Wn()}}else if("number"==typeof i){if(-1===i)return new Er(e,t);var s=null,u=br(e,t),c=-1,l=r&Ze.Host?t[16][6]:null;for((-1===u||r&Ze.SkipSelf)&&(c=-1===u?kr(e,t):t[u+8],Tr(r,!1)?(s=t[1],u=sr(c),t=cr(c,t)):u=-1);-1!==u;){c=t[u+8];var h=t[1];if(Ir(i,u,h.data)){var f=xr(u,t,n,s,r,l);if(f!==Cr)return f}Tr(r,t[1].data[u+8]===l)&&Ir(i,u,t)?(s=h,u=sr(c),t=cr(c,t)):u=-1}}}if(r&Ze.Optional&&void 0===a&&(a=null),0==(r&(Ze.Self|Ze.Host))){var d=t[9],p=Ft(void 0);try{return d?d.get(n,a,r&Ze.Optional):zt(n,a,r&Ze.Optional)}finally{Ft(p)}}if(r&Ze.Optional)return a;throw new Error("NodeInjector: NOT_FOUND [".concat(hr(n),"]"))}var Cr={};function xr(e,t,n,r,a,i){var o=t[1],s=o.data[e+8],u=Sr(s,o,n,null==r?pn(s)&&pr:r!=o&&3===s.type,a&Ze.Host&&i===s);return null!==u?Ar(t,o,u,s):Cr}function Sr(e,t,n,r,a){for(var i=e.providerIndexes,o=t.data,s=65535&i,u=e.directiveStart,c=i>>16,l=a?s+c:e.directiveEnd,h=r?s:s+c;h<l;h++){var f=o[h];if(h<u&&n===f||h>=u&&f.type===n)return h}if(a){var d=o[u];if(d&&mn(d)&&d.type===n)return u}return null}function Ar(e,t,n,r){var a=e[n],i=t.data;if(a instanceof $n){var o=a;if(o.resolving)throw new Error("Circular dep for ".concat(hr(i[n])));var s,u=vr(o.canSeeViewProviders);o.resolving=!0,o.injectImpl&&(s=Ft(o.injectImpl)),Pn(e,r);try{a=e[n]=o.factory(void 0,i,e,r),t.firstCreatePass&&n>=r.directiveStart&&function(e,t,n){var r=t.onChanges,a=t.onInit,i=t.doCheck;r&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,r),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,r)),a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(-e,a),i&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,i),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,i))}(n,i[n],t)}finally{o.injectImpl&&Ft(s),vr(u),o.resolving=!1,Wn()}}return a}function Ir(e,t,n){var r=64&e,a=32&e;return!!((128&e?r?a?n[t+7]:n[t+6]:a?n[t+5]:n[t+4]:r?a?n[t+3]:n[t+2]:a?n[t+1]:n[t])&1<<e)}function Tr(e,t){return!(e&Ze.Self||e&Ze.Host&&t)}var Er=function(){function e(t,n){_classCallCheck(this,e),this._tNode=t,this._lView=n}return _createClass(e,[{key:"get",value:function(e,t){return wr(this._tNode,this._lView,e,void 0,t)}}]),e}();function Rr(e){return e.ngDebugContext}function Nr(e){return e.ngOriginalError}function Or(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];e.error.apply(e,n)}var Dr=function(){function e(){_classCallCheck(this,e),this._console=console}return _createClass(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),r=function(e){return e.ngErrorLogger||Or}(e);r(this._console,"ERROR",e),t&&r(this._console,"ORIGINAL ERROR",t),n&&r(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?Rr(e)?Rr(e):this._findContext(Nr(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=Nr(e);t&&Nr(t);)t=Nr(t);return t}}]),e}();function Fr(e){return e instanceof function(){function e(t){_classCallCheck(this,e),this.changingThisBreaksApplicationSecurity=t}return _createClass(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see http://g.co/ng/security#xss)"}}]),e}()?e.changingThisBreaksApplicationSecurity:e}var Mr=!0,Pr=!1;function zr(){return Pr=!0,Mr}function Lr(e){for(;Array.isArray(e);)e=e[0];return e}function Br(e,t){return Lr(t[e+19])}function Vr(e,t){return Lr(t[e.index])}function Wr(e,t){return e.data[t+19]}function Ur(e,t){return e[t+19]}function jr(e,t){var n=t[e];return hn(n)?n:n[0]}function Hr(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Gr(e){return 4==(4&e[2])}function qr(e){return 128==(128&e[2])}function Kr(e,t){return null===e||null==t?null:e[t]}function Xr(e){e[18]=0}function Zr(e,t){e.__ngContext__=t}function Yr(e){throw new Error("Multiple components match node with tagname ".concat(e.tagName))}function $r(){throw new Error("Cannot mix multi providers and regular providers")}function Jr(e,t,n){for(var r=e.length;;){var a=e.indexOf(t,n);if(-1===a)return a;if(0===a||e.charCodeAt(a-1)<=32){var i=t.length;if(a+i===r||e.charCodeAt(a+i)<=32)return a}n=a+1}}function Qr(e,t,n){for(var r=0;r<e.length;){var a=e[r++];if(n&&"class"===a){if(-1!==Jr((a=e[r]).toLowerCase(),t,0))return!0}else if(1===a){for(;r<e.length&&"string"==typeof(a=e[r++]);)if(a.toLowerCase()===t)return!0;return!1}}return!1}function ea(e,t,n){return t===(0!==e.type||n?e.tagName:"ng-template")}function ta(e,t,n){for(var r=4,a=e.attrs||[],i=function(e){for(var t=0;t<e.length;t++)if(nr(e[t]))return t;return e.length}(a),o=!1,s=0;s<t.length;s++){var u=t[s];if("number"!=typeof u){if(!o)if(4&r){if(r=2|1&r,""!==u&&!ea(e,u,n)||""===u&&1===t.length){if(na(r))return!1;o=!0}}else{var c=8&r?u:t[++s];if(8&r&&null!==e.attrs){if(!Qr(e.attrs,c,n)){if(na(r))return!1;o=!0}continue}var l=ra(8&r?"class":u,a,0==e.type&&"ng-template"!==e.tagName,n);if(-1===l){if(na(r))return!1;o=!0;continue}if(""!==c){var h;h=l>i?"":a[l+1].toLowerCase();var f=8&r?h:null;if(f&&-1!==Jr(f,c,0)||2&r&&c!==h){if(na(r))return!1;o=!0}}}}else{if(!o&&!na(r)&&!na(u))return!1;if(o&&na(u))continue;o=!1,r=u|1&r}}return na(r)||o}function na(e){return 0==(1&e)}function ra(e,t,n,r){if(null===t)return-1;var a=0;if(r||!n){for(var i=!1;a<t.length;){var o=t[a];if(o===e)return a;if(3===o||6===o)i=!0;else{if(1===o||2===o){for(var s=t[++a];"string"==typeof s;)s=t[++a];continue}if(4===o)break;if(0===o){a+=4;continue}}a+=i?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){if(e[n]===t)return n;n++}return-1}(t,e)}function aa(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=0;r<t.length;r++)if(ta(e,t[r],n))return!0;return!1}function ia(e,t){e:for(var n=0;n<t.length;n++){var r=t[n];if(e.length===r.length){for(var a=0;a<e.length;a++)if(e[a]!==r[a])continue e;return!0}}return!1}function oa(e,t){return e?":not("+t.trim()+")":t}function sa(e){for(var t=e[0],n=1,r=2,a="",i=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&r){var s=e[++n];a+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&r?a+="."+o:4&r&&(a+=" "+o);else""===a||na(o)||(t+=oa(i,a),a=""),r=o,i=i||!na(r);n++}return""!==a&&(t+=oa(i,a)),t}var ua={};function ca(e){var t=e[3];return fn(t)?t[3]:t}function la(e){ha(_n(),kn(),jn()+e,In())}function ha(e,t,n,r){if(!r)if(3==(3&t[2])){var a=e.preOrderCheckHooks;null!==a&&qn(t,a,n)}else{var i=e.preOrderHooks;null!==i&&Kn(t,i,0,n)}Hn(n)}function fa(e,t){return e<<17|t<<2}function da(e){return e>>17&32767}function pa(e){return 2|e}function va(e){return(131068&e)>>2}function ma(e,t){return-131069&e|t<<2}function ga(e){return 1|e}function ya(e,t){var n=e.contentQueries;if(null!==n)for(var r=0;r<n.length;r+=2){var a=n[r],i=n[r+1];if(-1!==i){var o=e.data[i];Mn(a),o.contentQueries(2,t[i],i)}}}function ba(e,t,n){return Qn(t)?t.createElement(e,n):null===n?t.createElement(e):t.createElementNS(n,e)}function ka(e,t,n,r,a,i,o,s,u,c){var l=t.blueprint.slice();return l[0]=a,l[2]=140|r,Xr(l),l[3]=l[15]=e,l[8]=n,l[10]=o||e&&e[10],l[11]=s||e&&e[11],l[12]=u||e&&e[12]||null,l[9]=c||e&&e[9]||null,l[6]=i,l[16]=2==t.type?e[16]:l,l}function _a(e,t,n,r,a,i){var o=n+19,s=e.data[o]||function(e,t,n,r,a,i){var o=Cn(),s=Sn(),u=s?o:o&&o.parent,c=e.data[n]=Ra(0,u&&u!==t?u:null,r,n,a,i);return null===e.firstChild&&(e.firstChild=c),o&&(!s||null!=o.child||null===c.parent&&2!==o.type?s||(o.next=c):o.child=c),c}(e,t,o,r,a,i);return xn(s,!0),s}function wa(e,t,n){zn(t,t[6]);try{var r=e.viewQuery;null!==r&&Ja(1,r,n);var a=e.template;null!==a&&Sa(e,t,a,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&ya(e,t),e.staticViewQueries&&Ja(2,e.viewQuery,n);var i=e.components;null!==i&&function(e,t){for(var n=0;n<t.length;n++)Ka(e,t[n])}(t,i)}finally{t[2]&=-5,Un()}}function Ca(e,t,n,r){var a=t[2];if(256!=(256&a)){zn(t,t[6]);var i=In();try{Xr(t),yn.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&Sa(e,t,n,2,r);var o=3==(3&a);if(!i)if(o){var s=e.preOrderCheckHooks;null!==s&&qn(t,s,null)}else{var u=e.preOrderHooks;null!==u&&Kn(t,u,0,null),Xn(t,0)}if(function(e){for(var t=e[13];null!==t;){var n=void 0;if(fn(t)&&(n=t[2])>>1==-1){for(var r=9;r<t.length;r++){var a=t[r],i=a[1];qr(a)&&Ca(i,a,i.template,a[8])}0!=(1&n)&&Ga(t,e[16])}t=t[4]}}(t),null!==e.contentQueries&&ya(e,t),!i)if(o){var c=e.contentCheckHooks;null!==c&&qn(t,c)}else{var l=e.contentHooks;null!==l&&Kn(t,l,1),Xn(t,1)}!function(e,t){try{var n=e.expandoInstructions;if(null!==n)for(var r=e.expandoStartIndex,a=-1,i=0;i<n.length;i++){var o=n[i];"number"==typeof o?o<=0?(Hn(0-o),a=r+=9+n[++i]):r+=o:(null!==o&&(Dn(r,a),o(2,t[a])),a++)}}finally{Hn(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)qa(e,t[n])}(t,h);var f=e.viewQuery;if(null!==f&&Ja(2,f,r),!i)if(o){var d=e.viewCheckHooks;null!==d&&qn(t,d)}else{var p=e.viewHooks;null!==p&&Kn(t,p,2),Xn(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),i||(t[2]&=-73)}finally{Un()}}}function xa(e,t,n,r){var a=t[10],i=!In(),o=Gr(t);try{i&&!o&&a.begin&&a.begin(),o&&wa(e,t,r),Ca(e,t,n,r)}finally{i&&!o&&a.end&&a.end()}}function Sa(e,t,n,r,a){var i=jn();try{Hn(-1),2&r&&t.length>19&&ha(e,t,0,In()),n(r,a)}finally{Hn(i)}}function Aa(e,t,n){bn()&&(function(e,t,n,r){var a=n.directiveStart,i=n.directiveEnd;e.firstCreatePass||gr(n,t),Zr(r,t);for(var o=n.initialInputs,s=a;s<i;s++){var u=e.data[s],c=mn(u);c&&Wa(t,n,u);var l=Ar(t,e,s,n);Zr(l,t),null!==o&&Ua(0,s-a,l,u,0,o),c&&(jr(n.index,t)[8]=l)}}(e,t,n,Vr(n,t)),128==(128&n.flags)&&function(e,t,n){var r=n.directiveStart,a=n.directiveEnd,i=e.expandoInstructions,o=e.firstCreatePass,s=n.index-19;try{Hn(s);for(var u=r;u<a;u++){var c=e.data[u],l=t[u];null!==c.hostBindings||0!==c.hostVars||null!==c.hostAttrs?Ma(c,l):o&&i.push(null)}}finally{Hn(-1)}}(e,t,n))}function Ia(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vr,r=t.localNames;if(null!==r)for(var a=t.index+1,i=0;i<r.length;i+=2){var o=r[i+1],s=-1===o?n(t,e):e[o];e[a++]=s}}function Ta(e){return e.tView||(e.tView=Ea(1,-1,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts))}function Ea(e,t,n,r,a,i,o,s,u,c){var l=19+r,h=l+a,f=function(e,t){for(var n=[],r=0;r<t;r++)n.push(r<e?null:ua);return n}(l,h);return f[1]={type:e,id:t,blueprint:f,template:n,queries:null,viewQuery:s,node:null,data:f.slice().fill(null,l),bindingStartIndex:l,expandoStartIndex:h,expandoInstructions:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof i?i():i,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:u,consts:c}}function Ra(e,t,n,r,a,i){return{type:n,index:r,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,tagName:a,attrs:i,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,residualStyles:void 0,classes:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Na(e,t,n){for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];(n=null===n?{}:n).hasOwnProperty(r)?n[r].push(t,a):n[r]=[t,a]}return n}function Oa(e,t,n,r){var a=!1;if(bn()){var i=function(e,t,n){var r=e.directiveRegistry,a=null;if(r)for(var i=0;i<r.length;i++){var o=r[i];aa(n,o.selectors,!1)&&(a||(a=[]),_r(gr(n,t),e,o.type),mn(o)?(2&n.flags&&Yr(n),za(e,n),a.unshift(o)):a.push(o))}return a}(e,t,n),o=null===r?null:{"":-1};if(null!==i){var s=0;a=!0,Ba(n,e.data.length,i.length);for(var u=0;u<i.length;u++){var c=i[u];c.providersResolver&&c.providersResolver(c)}Pa(e,n,i.length);for(var l=!1,h=!1,f=0;f<i.length;f++){var d=i[f];n.mergedAttrs=ar(n.mergedAttrs,d.hostAttrs),Va(e,t,d),La(e.data.length-1,d,o),null!==d.contentQueries&&(n.flags|=8),null===d.hostBindings&&null===d.hostAttrs&&0===d.hostVars||(n.flags|=128),!l&&(d.onChanges||d.onInit||d.doCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index-19),l=!0),h||!d.onChanges&&!d.doCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index-19),h=!0),Da(e,d),s+=d.hostVars}!function(e,t){for(var n=t.directiveEnd,r=e.data,a=t.attrs,i=[],o=null,s=null,u=t.directiveStart;u<n;u++){var c=r[u],l=c.inputs;i.push(null!==a?ja(l,a):null),o=Na(l,u,o),s=Na(c.outputs,u,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=i,t.inputs=o,t.outputs=s}(e,n),Fa(e,t,s)}o&&function(e,t,n){if(t)for(var r=e.localNames=[],a=0;a<t.length;a+=2){var i=n[t[a+1]];if(null==i)throw new Error("Export of name '".concat(t[a+1],"' not found!"));r.push(t[a],i)}}(n,r,o)}return n.mergedAttrs=ar(n.mergedAttrs,n.attrs),a}function Da(e,t){var n=e.expandoInstructions;n.push(t.hostBindings),0!==t.hostVars&&n.push(t.hostVars)}function Fa(e,t,n){for(var r=0;r<n;r++)t.push(ua),e.blueprint.push(ua),e.data.push(null)}function Ma(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Pa(e,t,n){var r=19-t.index,a=e.data.length-(65535&t.providerIndexes);(e.expandoInstructions||(e.expandoInstructions=[])).push(r,a,n)}function za(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function La(e,t,n){if(n){if(t.exportAs)for(var r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;mn(t)&&(n[""]=e)}}function Ba(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function Va(e,t,n){e.data.push(n);var r=n.factory||(n.factory=cn(n.type)),a=new $n(r,mn(n),null);e.blueprint.push(a),t.push(a)}function Wa(e,t,n){var r=Vr(t,e),a=Ta(n),i=e[10],o=Xa(e,ka(e,a,null,n.onPush?64:16,r,t,i,i.createRenderer(r,n)));e[t.index]=o}function Ua(e,t,n,r,a,i){var o=i[t];if(null!==o)for(var s=r.setInput,u=0;u<o.length;){var c=o[u++],l=o[u++],h=o[u++];null!==s?r.setInput(n,h,c,l):n[l]=h}}function ja(e,t){for(var n=null,r=0;r<t.length;){var a=t[r];if(0!==a)if(5!==a){if("number"==typeof a)break;e.hasOwnProperty(a)&&(null===n&&(n=[]),n.push(a,e[a],t[r+1])),r+=2}else r+=2;else r+=4}return n}function Ha(e,t,n,r){return new Array(e,!0,-2,t,null,null,r,n,null)}function Ga(e,t){for(var n=e[5],r=0;r<n.length;r++){var a=n[r],i=a[3][3][16];if(i!==t&&0==(16&i[2])){var o=a[1];Ca(o,a,o.template,a[8])}}}function qa(e,t){var n=jr(t,e);if(qr(n)&&80&n[2]){var r=n[1];Ca(r,n,r.template,n[8])}}function Ka(e,t){var n=jr(t,e),r=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n),wa(r,n,n[8])}function Xa(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Za(e){for(;e;){e[2]|=64;var t=ca(e);if(gn(e)&&!t)return e;e=t}return null}function Ya(e,t,n){var r=t[10];r.begin&&r.begin();try{Ca(e,t,e.template,n)}catch(a){throw ni(t,a),a}finally{r.end&&r.end()}}function $a(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],r=Hr(n),a=r[1];xa(a,r,a.template,n)}}(e[8])}function Ja(e,t,n){Mn(0),t(e,n)}var Qa=Promise.resolve(null);function ei(e){return e[7]||(e[7]=[])}function ti(e){return e.cleanup||(e.cleanup=[])}function ni(e,t){var n=e[9],r=n?n.get(Dr,null):null;r&&r.handleError(t)}function ri(e,t,n,r,a){for(var i=0;i<n.length;){var o=n[i++],s=n[i++],u=t[o],c=e.data[o];null!==c.setInput?c.setInput(u,a,r,s):u[s]=a}}function ai(e,t,n){var r=Br(t,e),a=e[11];Qn(a)?a.setValue(r,n):r.textContent=n}function ii(e,t){var n=t[3];return-1===e.index?fn(n)?n:null:n}function oi(e,t){var n=ii(e,t);return n?yi(t[11],n[7]):null}function si(e,t,n,r,a){if(null!=r){var i,o=!1;fn(r)?i=r:hn(r)&&(o=!0,r=r[0]);var s=Lr(r);0===e&&null!==n?null==a?mi(t,n,s):vi(t,n,s,a||null):1===e&&null!==n?vi(t,n,s,a||null):2===e?function(e,t,n){var r=yi(e,t);r&&function(e,t,n,r){Qn(e)?e.removeChild(t,n,r):t.removeChild(n)}(e,r,t,n)}(t,s,o):3===e&&t.destroyNode(s),null!=i&&function(e,t,n,r,a){var i=n[7];i!==Lr(n)&&si(t,e,r,i,a);for(var o=9;o<n.length;o++){var s=n[o];Ci(s[1],s,e,t,r,i)}}(t,e,i,n,a)}}function ui(e,t,n,r){var a=oi(e.node,t);a&&Ci(e,t,t[11],n?1:2,a,r)}function ci(e,t){var n=e[5],r=n.indexOf(t);n.splice(r,1)}function li(e,t){if(!(e.length<=9)){var n=9+t,r=e[n];if(r){var a=r[17];null!==a&&a!==e&&ci(a,r),t>0&&(e[n-1][4]=r[4]);var i=Ht(e,9+t);ui(r[1],r,!1,null);var o=i[5];null!==o&&o.detachView(i[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function hi(e,t){if(!(256&t[2])){var n=t[11];Qn(n)&&n.destroyNode&&Ci(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return di(e[1],e);for(;t;){var n=null;if(hn(t))n=t[13];else{var r=t[9];r&&(n=r)}if(!n){for(;t&&!t[4]&&t!==e;)hn(t)&&di(t[1],t),t=fi(t,e);null===t&&(t=e),hn(t)&&di(t[1],t),n=t&&t[4]}t=n}}(t)}}function fi(e,t){var n;return hn(e)&&(n=e[6])&&2===n.type?ii(n,e):e[3]===t?null:e[3]}function di(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var r=0;r<n.length;r+=2){var a=t[n[r]];a instanceof $n||n[r+1].call(a)}}(e,t),function(e,t){var n=e.cleanup;if(null!==n){for(var r=t[7],a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var i=n[a+1],o="function"==typeof i?i(t):Lr(t[i]),s=r[n[a+2]],u=n[a+3];"boolean"==typeof u?o.removeEventListener(n[a],s,u):u>=0?r[u]():r[-u].unsubscribe(),a+=2}else n[a].call(r[n[a+1]]);t[7]=null}}(e,t);var n=t[6];n&&3===n.type&&Qn(t[11])&&t[11].destroy();var r=t[17];if(null!==r&&fn(t[3])){r!==t[3]&&ci(r,t);var a=t[5];null!==a&&a.detachView(e)}}}function pi(e,t,n){for(var r=t.parent;null!=r&&(4===r.type||5===r.type);)r=(t=r).parent;if(null==r){var a=n[6];return 2===a.type?oi(a,n):n[0]}if(t&&5===t.type&&4&t.flags)return Vr(t,n).parentNode;if(2&r.flags){var i=e.data,o=i[i[r.index].directiveStart].encapsulation;if(o!==Yt.ShadowDom&&o!==Yt.Native)return null}return Vr(r,n)}function vi(e,t,n,r){Qn(e)?e.insertBefore(t,n,r):t.insertBefore(n,r,!0)}function mi(e,t,n){Qn(e)?e.appendChild(t,n):t.appendChild(n)}function gi(e,t,n,r){null!==r?vi(e,t,n,r):mi(e,t,n)}function yi(e,t){return Qn(e)?e.parentNode(t):t.parentNode}function bi(e,t){if(2===e.type){var n=ii(e,t);return null===n?null:_i(n.indexOf(t,9)-9,n)}return 4===e.type||5===e.type?Vr(e,t):null}function ki(e,t,n,r){var a=pi(e,r,t);if(null!=a){var i=t[11],o=bi(r.parent||t[6],t);if(Array.isArray(n))for(var s=0;s<n.length;s++)gi(i,a,n[s],o);else gi(i,a,n,o)}}function _i(e,t){var n=9+e+1;if(n<t.length){var r=t[n],a=r[1].firstChild;if(null!==a)return function e(t,n){if(null!==n){var r=n.type;if(3===r)return Vr(n,t);if(0===r)return _i(-1,t[n.index]);if(4===r||5===r){var a=n.child;if(null!==a)return e(t,a);var i=t[n.index];return fn(i)?_i(-1,i):Lr(i)}var o=t[16],s=o[6],u=ca(o),c=s.projection[n.projection];return null!=c?e(u,c):e(t,n.next)}return null}(r,a)}return t[7]}function wi(e,t,n,r,a,i,o){for(;null!=n;){var s=r[n.index],u=n.type;o&&0===t&&(s&&Zr(Lr(s),r),n.flags|=4),64!=(64&n.flags)&&(4===u||5===u?(wi(e,t,n.child,r,a,i,!1),si(t,e,a,s,i)):1===u?xi(e,t,r,n,a,i):si(t,e,a,s,i)),n=o?n.projectionNext:n.next}}function Ci(e,t,n,r,a,i){wi(n,r,e.node.child,t,a,i,!1)}function xi(e,t,n,r,a,i){var o=n[16],s=o[6].projection[r.projection];if(Array.isArray(s))for(var u=0;u<s.length;u++)si(t,e,a,s[u],i);else wi(e,t,s,o[3],a,i,!0)}function Si(e,t,n){Qn(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function Ai(e,t,n){Qn(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}var Ii,Ti,Ei,Ri=function(){function e(t,n){_classCallCheck(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._viewContainerRef=null,this._tViewNode=null}return _createClass(e,[{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._viewContainerRef){var e=this._viewContainerRef.indexOf(this);e>-1&&this._viewContainerRef.detach(e),this._viewContainerRef=null}hi(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){var t,n,r;t=this._lView[1],r=e,ei(n=this._lView).push(r),t.firstCreatePass&&ti(t).push(n[7].length-1,null)}},{key:"markForCheck",value:function(){Za(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){Ya(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){Tn(!0);try{Ya(e,t,n)}finally{Tn(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(e){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._viewContainerRef=e}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,Ci(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._viewContainerRef)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}},{key:"rootNodes",get:function(){var e=this._lView;return null==e[0]?function e(t,n,r,a){for(var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==r;){var o=n[r.index];if(null!==o&&a.push(Lr(o)),fn(o))for(var s=9;s<o.length;s++){var u=o[s],c=u[1].firstChild;null!==c&&e(u[1],u,c,a)}var l=r.type;if(4===l||5===l)e(t,n,r.child,a);else if(1===l){var h=n[16],f=h[6],d=ca(h),p=f.projection[r.projection];null!==p&&null!==d&&e(d[1],d,p,a,!0)}r=i?r.projectionNext:r.next}return a}(e[1],e,e[6].child,[]):[]}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}}]),e}(),Ni=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e))._view=e,r}return _createClass(n,[{key:"detectChanges",value:function(){$a(this._view)}},{key:"checkNoChanges",value:function(){!function(e){Tn(!0);try{$a(e)}finally{Tn(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(Ri);function Oi(e,t,n){return Ii||(Ii=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(e)),new Ii(Vr(t,n))}function Di(e,t,n,r){return Ti||(Ti=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this))._declarationView=e,i._declarationTContainer=r,i.elementRef=a,i}return _createClass(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=ka(this._declarationView,t,e,16,null,t.node);n[17]=this._declarationView[this._declarationTContainer.index];var r=this._declarationView[5];null!==r&&(n[5]=r.createEmbeddedView(t)),wa(t,n,e);var a=new Ri(n);return a._tViewNode=n[6],a}}]),n}(e)),0===n.type?new Ti(r,n,Oi(t,n,r)):null}function Fi(e,t,n,r){var a;Ei||(Ei=function(e){_inherits(r,e);var n=_createSuper(r);function r(e,t,a){var i;return _classCallCheck(this,r),(i=n.call(this))._lContainer=e,i._hostTNode=t,i._hostView=a,i}return _createClass(r,[{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){return null!==this._lContainer[8]&&this._lContainer[8][e]||null}},{key:"createEmbeddedView",value:function(e,t,n){var r=e.createEmbeddedView(t||{});return this.insert(r,n),r}},{key:"createComponent",value:function(e,t,n,r,a){var i=n||this.parentInjector;if(!a&&null==e.ngModule&&i){var o=i.get(Vt,null);o&&(a=o)}var s=e.create(i,r,void 0,a);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var n=e._lView,r=n[1];if(e.destroyed)throw new Error("Cannot insert a destroyed View in a ViewContainer!");if(this.allocateContainerIfNeeded(),fn(n[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var i=n[3],o=new Ei(i,i[6],i[3]);o.detach(o.indexOf(e))}}var s=this._adjustIndex(t);return function(e,t,n,r){var a=9+r,i=n.length;r>0&&(n[a-1][4]=t),r<i-9?(t[4]=n[a],jt(n,9+r,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[5],r=t[3][3][16];16!=(16&r[2])&&t[16]!==r&&(e[2]|=1),null===n?e[5]=[t]:n.push(t)}(o,t);var s=t[5];null!==s&&s.insertView(e),t[2]|=128}(r,n,this._lContainer,s),ui(r,n,!0,_i(s,this._lContainer)),e.attachToViewContainerRef(this),jt(this._lContainer[8],s,e),e}},{key:"move",value:function(e,t){if(e.destroyed)throw new Error("Cannot move a destroyed View in a ViewContainer!");return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=this._lContainer[8];return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1);(function(e,t){var n=li(e,t);n&&hi(n[1],n)})(this._lContainer,t),Ht(this._lContainer[8],t)}},{key:"detach",value:function(e){this.allocateContainerIfNeeded();var t=this._adjustIndex(e,-1),n=li(this._lContainer,t);return n&&null!=Ht(this._lContainer[8],t)?new Ri(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}},{key:"allocateContainerIfNeeded",value:function(){null===this._lContainer[8]&&(this._lContainer[8]=[])}},{key:"element",get:function(){return Oi(t,this._hostTNode,this._hostView)}},{key:"injector",get:function(){return new Er(this._hostTNode,this._hostView)}},{key:"parentInjector",get:function(){var e=kr(this._hostTNode,this._hostView),t=cr(e,this._hostView),n=function(e,t,n){if(n.parent&&-1!==n.parent.injectorIndex){for(var r=n.parent.injectorIndex,a=n.parent;null!=a.parent&&r==a.parent.injectorIndex;)a=a.parent;return a}for(var i=ur(e),o=t,s=t[6];i>1;)s=(o=o[15])[6],i--;return s}(e,this._hostView,this._hostTNode);return or(e)&&null!=n?new Er(n,t):new Er(null,this._hostView)}},{key:"length",get:function(){return this._lContainer.length-9}}]),r}(e));var i=r[n.index];if(fn(i))(function(e,t){e[2]=-2})(a=i);else{var o;if(4===n.type)o=Lr(i);else if(o=r[11].createComment(""),gn(r)){var s=r[11],u=Vr(n,r);vi(s,yi(s,u),o,function(e,t){return Qn(e)?e.nextSibling(t):t.nextSibling}(s,u))}else ki(r[1],r,o,n);r[n.index]=a=Ha(i,r,o,n),Xa(r,a)}return new Ei(a,n,r)}var Mi=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Pi()},e}(),Pi=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n){if(!n&&pn(e)){var r=jr(e.index,t);return new Ri(r,r)}return 3===e.type||0===e.type||4===e.type||5===e.type?new Ri(t[16],t):null}(Cn(),kn(),e)},zi=new It("Set Injector scope."),Li={},Bi={},Vi=[],Wi=void 0;function Ui(){return void 0===Wi&&(Wi=new Bt),Wi}function ji(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return new Hi(e,n,t||Ui(),r)}var Hi=function(){function e(t,n,r){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&Ut(n,(function(e){return a.processProvider(e,t,n)})),Ut([t],(function(e){return a.processInjectorType(e,[],o)})),this.records.set(Tt,Ki(void 0,this));var s=this.records.get(zi);this.scope=null!=s?s.value:null,this.source=i||("object"==typeof t?null:ut(t))}return _createClass(e,[{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach((function(e){return e.ngOnDestroy()}))}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Et,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ze.Default;this.assertNotDestroyed();var r,a=Dt(this);try{if(!(n&Ze.SkipSelf)){var i=this.records.get(e);if(void 0===i){var o=("function"==typeof(r=e)||"object"==typeof r&&r instanceof It)&&et(e);i=o&&this.injectableDefInScope(o)?Ki(Gi(e),Li):null,this.records.set(e,i)}if(null!=i)return this.hydrate(e,i)}return(n&Ze.Self?Ui():this.parent).get(e,t=n&Ze.Optional&&t===Et?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(ut(e)),a)throw s;return function(e,t,n,r){var a=e.ngTempTokenPath;throw t.__source&&a.unshift(t.__source),e.message=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var a=ut(t);if(Array.isArray(t))a=t.map(ut).join(" -> ");else if("object"==typeof t){var i=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];i.push(o+":"+("string"==typeof s?JSON.stringify(s):ut(s)))}a="{".concat(i.join(", "),"}")}return"".concat(n).concat(r?"("+r+")":"","[").concat(a,"]: ").concat(e.replace(Rt,"\n  "))}("\n"+e.message,a,"R3InjectorError",r),e.ngTokenPath=a,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{Dt(a)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach((function(t){return e.get(t)}))}},{key:"toString",value:function(){var e=[];return this.records.forEach((function(t,n){return e.push(ut(n))})),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var r=this;if(!(e=ft(e)))return!1;var a=nt(e),i=null==a&&e.ngModule||void 0,o=void 0===i?e:i,s=-1!==n.indexOf(o);if(void 0!==i&&(a=nt(i)),null==a)return!1;if(null!=a.imports&&!s){var u;n.push(o);try{Ut(a.imports,(function(e){r.processInjectorType(e,t,n)&&(void 0===u&&(u=[]),u.push(e))}))}finally{}if(void 0!==u)for(var c=function(e){var t=u[e],n=t.ngModule,a=t.providers;Ut(a,(function(e){return r.processProvider(e,n,a||Vi)}))},l=0;l<u.length;l++)c(l)}this.injectorDefTypes.add(o),this.records.set(o,Ki(a.factory,Li));var h=a.providers;if(null!=h&&!s){var f=e;Ut(h,(function(e){return r.processProvider(e,f,h)}))}return void 0!==i&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var r=Zi(e=ft(e))?e:ft(e&&e.provide),a=function(e,t,n){return Xi(e)?Ki(void 0,e.useValue):Ki(qi(e,t,n),Li)}(e,t,n);if(Zi(e)||!0!==e.multi){var i=this.records.get(r);i&&void 0!==i.multi&&$r()}else{var o=this.records.get(r);o?void 0===o.multi&&$r():((o=Ki(void 0,Li,!0)).factory=function(){return Lt(o.multi)},this.records.set(r,o)),r=e,o.multi.push(e)}this.records.set(r,a)}},{key:"hydrate",value:function(e,t){var n;return t.value===Bi?function(e){throw new Error("Cannot instantiate cyclic dependency! ".concat(e))}(ut(e)):t.value===Li&&(t.value=Bi,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();function Gi(e){var t=et(e),n=null!==t?t.factory:cn(e);if(null!==n)return n;var r=nt(e);if(null!==r)return r.factory;if(e instanceof It)throw new Error("Token ".concat(ut(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=Gt(t,"?");throw new Error("Can't resolve all parameters for ".concat(ut(e),": (").concat(n.join(", "),")."))}var r=function(e){var t=e&&(e[rt]||e[ot]||e[it]&&e[it]());if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in v10. Please add @Injectable() to the "'.concat(n,'" class.')),t}return null}(e);return null!==r?function(){return r.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function qi(e,t,n){var r,a=void 0;if(Zi(e)){var i=ft(e);return cn(i)||Gi(i)}if(Xi(e))a=function(){return ft(e.useValue)};else if((r=e)&&r.useFactory)a=function(){return e.useFactory.apply(e,_toConsumableArray(Lt(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))a=function(){return Pt(ft(e.useExisting))};else{var o=ft(e&&(e.useClass||e.provide));if(o||function(e,t,n){var r="";throw e&&t&&(r=" - only instances of Provider and Type are allowed, got: [".concat(t.map((function(e){return e==n?"?"+n+"?":"..."})).join(", "),"]")),new Error("Invalid provider for the NgModule '".concat(ut(e),"'")+r)}(t,n,e),!function(e){return!!e.deps}(e))return cn(o)||Gi(o);a=function(){return _construct(o,_toConsumableArray(Lt(e.deps)))}}return a}function Ki(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function Xi(e){return null!==e&&"object"==typeof e&&Nt in e}function Zi(e){return"function"==typeof e}var Yi=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0,a=ji(e,t,n,r);return a._resolveInjectorDefTypes(),a}({name:n},t,e,n)},$i=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?Yi(e,t,""):Yi(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=Et,e.NULL=new Bt,e.\u0275prov=Je({token:e,providedIn:"any",factory:function(){return Pt(Tt)}}),e.__NG_ELEMENT_ID__=-1,e}(),Ji=new It("AnalyzeForEntryComponents"),Qi=new Map,eo=new Set;function to(e){return"string"==typeof e?e:e.text()}function no(e,t){for(var n=e.styles,r=e.classes,a=0,i=0;i<t.length;i++){var o=t[i];"number"==typeof o?a=o:1==a?r=ct(r,o):2==a&&(n=ct(n,o+": "+t[++i]+";"))}null!==n&&(e.styles=n),null!==r&&(e.classes=r)}var ro=null;function ao(){if(!ro){var e=bt.Symbol;if(e&&e.iterator)ro=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var r=t[n];"entries"!==r&&"size"!==r&&Map.prototype[r]===Map.prototype.entries&&(ro=r)}}return ro}function io(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)}var oo=function(){function e(t){_classCallCheck(this,e),this.wrapped=t}return _createClass(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function so(e){return!!uo(e)&&(Array.isArray(e)||!(e instanceof Map)&&ao()in e)}function uo(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function co(e,t,n){return e[t]=n}function lo(e,t){return e[t]}function ho(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function fo(e,t,n,r){var a=ho(e,t,n);return ho(e,t+1,r)||a}function po(e,t,n,r){var a=kn();return ho(a,Nn(),t)&&function(e,t,n,r,a,i,o){var s=Br(e,a),u=a[11];if(null==n)Qn(u)?u.removeAttribute(s,t,o):s.removeAttribute(t);else{var c=Wr(r,e),l=null==i?lr(n):i(n,c.tagName||"",t);Qn(u)?u.setAttribute(s,t,l,o):o?s.setAttributeNS(o,t,l):s.setAttribute(t,l)}}(jn(),e,t,_n(),a,n,r),po}function vo(e,t,n,r,a,i,o,s){var u=kn(),c=_n(),l=e+19,h=c.firstCreatePass?function(e,t,n,r,a,i,o,s,u){var c=t.consts,l=_a(t,n[6],e,0,o||null,Kr(c,s));Oa(t,n,l,Kr(c,u)),Gn(t,l);var h=l.tViews=Ea(2,-1,r,a,i,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c),f=Ra(0,null,2,-1,null,null);return f.injectorIndex=l.injectorIndex,h.node=f,null!==t.queries&&(t.queries.template(t,l),h.queries=t.queries.embeddedTView(l)),l}(e,c,u,t,n,r,a,i,o):c.data[l];xn(h,!1);var f=u[11].createComment("");ki(c,u,f,h),Zr(f,u),Xa(u,u[l]=Ha(f,u,f,h)),vn(h)&&Aa(c,u,h),null!=o&&Ia(u,h,s)}function mo(e){return Ur(yn.lFrame.contextLView,e)}function go(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze.Default,n=kn();return null==n?Pt(e,t):wr(Cn(),n,ft(e),t)}function yo(){throw new Error("invalid")}function bo(e,t,n){var r=kn();if(ho(r,Nn(),t)){var a=jn();!function(e,t,n,r,a,i,o,s){var u,c,l=Br(n,t),h=Wr(e,n),f=h.inputs;if(null!=f&&(u=f[r]))ri(e,t,u,r,a),pn(h)&&function(e,t){var n=jr(t,e);16&n[2]||(n[2]|=64)}(t,n+19);else if(3===h.type){r="class"===(c=r)?"className":"for"===c?"htmlFor":"formaction"===c?"formAction":"innerHtml"===c?"innerHTML":"readonly"===c?"readOnly":"tabindex"===c?"tabIndex":c;var d=t[11];a=null!=i?i(a,h.tagName||"",r):a,Qn(d)?d.setProperty(l,r,a):rr(r)||(l.setProperty?l.setProperty(r,a):l[r]=a)}}(_n(),r,a,e,t,n)}return bo}function ko(e,t,n,r,a){var i=a?"class":"style";ri(e,n,t.inputs[i],i,r)}function _o(e,t,n,r){var a=kn(),i=_n(),o=19+e,s=a[11],u=a[o]=ba(t,s,yn.lFrame.currentNamespace),c=i.firstCreatePass?function(e,t,n,r,a,i,o){var s=t.consts,u=Kr(s,i),c=_a(t,n[6],e,3,a,u);return Oa(t,n,c,Kr(s,o)),null!==c.mergedAttrs&&no(c,c.mergedAttrs),null!==t.queries&&t.queries.elementStart(t,c),c}(e,i,a,0,t,n,r):i.data[o];xn(c,!0);var l=c.mergedAttrs;null!==l&&tr(s,u,l);var h=c.classes;null!==h&&Ai(s,u,h);var f=c.styles;null!==f&&Si(s,u,f),ki(i,a,u,c),0===yn.lFrame.elementDepthCount&&Zr(u,a),yn.lFrame.elementDepthCount++,vn(c)&&(Aa(i,a,c),function(e,t,n){if(dn(t))for(var r=t.directiveEnd,a=t.directiveStart;a<r;a++){var i=e.data[a];i.contentQueries&&i.contentQueries(1,n[a],a)}}(i,c,a)),null!==r&&Ia(a,c)}function wo(){var e=Cn();Sn()?An():xn(e=e.parent,!1);var t=e;yn.lFrame.elementDepthCount--;var n=_n();n.firstCreatePass&&(Gn(n,e),dn(e)&&n.queries.elementEnd(e)),null!==t.classes&&function(e){return 0!=(16&e.flags)}(t)&&ko(n,t,kn(),t.classes,!0),null!==t.styles&&function(e){return 0!=(32&e.flags)}(t)&&ko(n,t,kn(),t.styles,!1)}function Co(e,t,n,r){_o(e,t,n,r),wo()}function xo(e){return!!e&&"function"==typeof e.then}function So(e){return!!e&&"function"==typeof e.subscribe}function Ao(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0,a=kn(),i=_n(),o=Cn();return function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,u=vn(r),c=e.firstCreatePass&&(e.cleanup||(e.cleanup=[])),l=ei(t),h=!0;if(3===r.type){var f=Vr(r,t),d=s?s(f):$t,p=d.target||f,v=l.length,m=s?function(e){return s(Lr(e[r.index])).target}:r.index;if(Qn(n)){var g=null;if(!s&&u&&(g=function(e,t,n,r){var a=e.cleanup;if(null!=a)for(var i=0;i<a.length-1;i+=2){var o=a[i];if(o===n&&a[i+1]===r){var s=t[7],u=a[i+2];return s.length>u?s[u]:null}"string"==typeof o&&(i+=2)}return null}(e,t,a,r.index)),null!==g)(g.__ngLastListenerFn__||g).__ngNextListenerFn__=i,g.__ngLastListenerFn__=i,h=!1;else{i=To(r,t,i,!1);var y=n.listen(d.name||p,a,i);l.push(i,y),c&&c.push(a,m,v,v+1)}}else i=To(r,t,i,!0),p.addEventListener(a,i,o),l.push(i),c&&c.push(a,m,v,o)}var b,k=r.outputs;if(h&&null!==k&&(b=k[a])){var _=b.length;if(_)for(var w=0;w<_;w+=2){var C=t[b[w]][b[w+1]].subscribe(i),x=l.length;l.push(i,C),c&&c.push(a,r.index,x,-(x+1))}}}(i,a,a[11],o,e,t,n,r),Ao}function Io(e,t,n){try{return!1!==t(n)}catch(r){return ni(e,r),!1}}function To(e,t,n,r){return function a(i){if(i===Function)return n;var o=2&e.flags?jr(e.index,t):t;0==(32&t[2])&&Za(o);for(var s=Io(t,n,i),u=a.__ngNextListenerFn__;u;)s=Io(t,u,i)&&s,u=u.__ngNextListenerFn__;return r&&!1===s&&(i.preventDefault(),i.returnValue=!1),s}}function Eo(e,t){for(var n=null,r=function(e){var t=e.attrs;if(null!=t){var n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e),a=0;a<t.length;a++){var i=t[a];if("*"!==i){if(null===r?aa(e,i,!0):ia(r,i))return a}else n=a}return n}function Ro(e){var t=kn()[16][6];if(!t.projection)for(var n=t.projection=Gt(e?e.length:1,null),r=n.slice(),a=t.child;null!==a;){var i=e?Eo(a,e):0;null!==i&&(r[i]?r[i].projectionNext=a:n[i]=a,r[i]=a),a=a.next}}function No(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=kn(),a=_n(),i=_a(a,r[6],e,1,null,n||null);null===i.projection&&(i.projection=t),An(),function(e,t,n){xi(t[11],0,t,n,pi(e,n,t),bi(n.parent||t[6],t))}(a,r,i)}var Oo=[];function Do(e,t,n,r,a){for(var i=e[n+1],o=null===t,s=r?da(i):va(i),u=!1;0!==s&&(!1===u||o);){var c=e[s+1];Fo(e[s],t)&&(u=!0,e[s+1]=r?ga(c):pa(c)),s=r?da(c):va(c)}u&&(e[n+1]=r?pa(i):ga(i))}function Fo(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&Xt(e,t)>=0}var Mo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Po(e){return e.substring(Mo.key,Mo.keyEnd)}function zo(e,t){var n=Mo.textEnd;return n===t?-1:(t=Mo.keyEnd=function(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Mo.key=t,n),Lo(e,t,n))}function Lo(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function Bo(e,t){return function(e,t,n,r){var a,i,o=kn(),s=_n(),u=On(2);(s.firstUpdatePass&&jo(s,e,u,!0),t!==ua&&ho(o,u,t))&&(null==n&&(a=null===(i=yn.lFrame)?null:i.currentSanitizer)&&(n=a),qo(s,s.data[jn()+19],o,o[11],e,o[u+1]=function(e,t){return null==e||("function"==typeof t?e=t(e):"string"==typeof t?e+=t:"object"==typeof e&&(e=ut(Fr(e)))),e}(t,n),!0,u))}(e,t,null),Bo}function Vo(e){!function(e,t,n,r){var a=_n(),i=On(2);a.firstUpdatePass&&jo(a,null,i,!0);var o=kn();if(n!==ua&&ho(o,i,n)){var s=a.data[jn()+19];if(Zo(s,!0)&&!Uo(a,i)){var u=s.classes;null!==u&&(n=ct(u,n||"")),ko(a,s,o,n,!0)}else!function(e,t,n,r,a,i,o,s){a===ua&&(a=Oo);for(var u=0,c=0,l=0<a.length?a[0]:null,h=0<i.length?i[0]:null;null!==l||null!==h;){var f=u<a.length?a[u+1]:void 0,d=c<i.length?i[c+1]:void 0,p=null,v=void 0;l===h?(u+=2,c+=2,f!==d&&(p=h,v=d)):null===h||null!==l&&l<h?(u+=2,p=l):(c+=2,p=h,v=d),null!==p&&qo(e,t,n,r,p,v,!0,s),l=u<a.length?a[u]:null,h=c<i.length?i[c]:null}}(a,s,o,o[11],o[i+1],o[i+1]=function(e,t,n){if(null==n||""===n)return Oo;var r=[],a=Fr(n);if(Array.isArray(a))for(var i=0;i<a.length;i++)e(r,a[i],!0);else if("object"==typeof a)for(var o in a)a.hasOwnProperty(o)&&e(r,o,a[o]);else"string"==typeof a&&t(r,a);return r}(e,t,n),0,i)}}(qt,Wo,e)}function Wo(e,t){for(var n=function(e){return function(e){Mo.key=0,Mo.keyEnd=0,Mo.value=0,Mo.valueEnd=0,Mo.textEnd=e.length}(e),zo(e,Lo(e,0,Mo.textEnd))}(t);n>=0;n=zo(t,n))qt(e,Po(t),!0)}function Uo(e,t){return t>=e.expandoStartIndex}function jo(e,t,n,r){var a=e.data;if(null===a[n+1]){var i=a[jn()+19],o=Uo(e,n);Zo(i,r)&&null===t&&!o&&(t=!1),t=function(e,t,n,r){var a=function(e){var t=yn.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),i=r?t.residualClasses:t.residualStyles;if(null===a)0===(r?t.classBindings:t.styleBindings)&&(n=Go(n=Ho(null,e,t,n,r),t.attrs,r),i=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==a)if(n=Ho(a,e,t,n,r),null===i){var s=function(e,t,n){var r=n?t.classBindings:t.styleBindings;if(0!==va(r))return e[da(r)]}(e,t,r);void 0!==s&&Array.isArray(s)&&function(e,t,n,r){e[da(n?t.classBindings:t.styleBindings)]=r}(e,t,r,s=Go(s=Ho(null,e,t,s[1],r),t.attrs,r))}else i=function(e,t,n){for(var r=void 0,a=t.directiveEnd,i=1+t.directiveStylingLast;i<a;i++)r=Go(r,e[i].hostAttrs,n);return Go(r,t.attrs,n)}(e,t,r)}return void 0!==i&&(r?t.residualClasses=i:t.residualStyles=i),n}(a,i,t,r),function(e,t,n,r,a,i){var o=i?t.classBindings:t.styleBindings,s=da(o),u=va(o);e[r]=n;var c,l=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||Xt(h,c)>0)&&(l=!0)}else c=n;if(a)if(0!==u){var f=da(e[s+1]);e[r+1]=fa(f,s),0!==f&&(e[f+1]=ma(e[f+1],r)),e[s+1]=131071&e[s+1]|r<<17}else e[r+1]=fa(s,0),0!==s&&(e[s+1]=ma(e[s+1],r)),s=r;else e[r+1]=fa(u,0),0===s?s=r:e[u+1]=ma(e[u+1],r),u=r;l&&(e[r+1]=pa(e[r+1])),Do(e,c,r,!0),Do(e,c,r,!1),function(e,t,n,r,a){var i=a?e.residualClasses:e.residualStyles;null!=i&&"string"==typeof t&&Xt(i,t)>=0&&(n[r+1]=ga(n[r+1]))}(t,c,e,r,i),o=fa(s,u),i?t.classBindings=o:t.styleBindings=o}(a,i,t,n,o,r)}}function Ho(e,t,n,r,a){var i=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(r=Go(r,(i=t[s]).hostAttrs,a),i!==e);)s++;return null!==e&&(n.directiveStylingLast=s),r}function Go(e,t,n){var r=n?1:2,a=-1;if(null!==t)for(var i=0;i<t.length;i++){var o=t[i];"number"==typeof o?a=o:a===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),qt(e,o,!!n||t[++i]))}return void 0===e?null:e}function qo(e,t,n,r,a,i,o,s){if(3===t.type){var u=e.data,c=u[s+1];Xo(1==(1&c)?Ko(u,t,n,a,va(c),o):void 0)||(Xo(i)||2==(2&c)&&(i=Ko(u,null,n,a,s,o)),function(e,t,n,r,a){var i=Qn(e);if(t)a?i?e.addClass(n,r):n.classList.add(r):i?e.removeClass(n,r):n.classList.remove(r);else{var o=-1==r.indexOf("-")?void 0:2;null==a?i?e.removeStyle(n,r,o):n.style.removeProperty(r):i?e.setStyle(n,r,a,o):n.style.setProperty(r,a)}}(r,o,Br(jn(),n),a,i))}}function Ko(e,t,n,r,a,i){for(var o=null===t,s=void 0;a>0;){var u=e[a],c=Array.isArray(u),l=c?u[1]:u,h=null===l,f=n[a+1];f===ua&&(f=h?Oo:void 0);var d=h?Kt(f,r):l===r?f:void 0;if(c&&!Xo(d)&&(d=Kt(u,r)),Xo(d)&&(s=d,o))return s;var p=e[a+1];a=o?da(p):va(p)}if(null!==t){var v=i?t.residualClasses:t.residualStyles;null!=v&&(s=Kt(v,r))}return s}function Xo(e){return void 0!==e}function Zo(e,t){return 0!=(e.flags&(t?16:32))}function Yo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=kn(),r=_n(),a=e+19,i=r.firstCreatePass?_a(r,n[6],e,3,null,null):r.data[a],o=n[a]=function(e,t){return Qn(t)?t.createText(e):t.createTextNode(e)}(t,n[11]);ki(r,n,o,i),xn(i,!1)}function $o(e){return Jo("",e,""),$o}function Jo(e,t,n){var r=kn(),a=function(e,t,n,r){return ho(e,Nn(),n)?t+lr(n)+r:ua}(r,e,t,n);return a!==ua&&ai(r,jn(),a),Jo}function Qo(e,t,n,r,a){var i=kn(),o=function(e,t,n,r,a,i){var o=fo(e,Rn(),n,a);return On(2),o?t+lr(n)+r+lr(a)+i:ua}(i,e,t,n,r,a);return o!==ua&&ai(i,jn(),o),Qo}function es(e,t){var n=Hr(e)[1],r=n.data.length-1;Gn(n,{directiveStart:r,directiveEnd:r+1})}function ts(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0,r=[e];t;){var a=void 0;if(mn(e))a=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");a=t.\u0275dir}if(a){if(n){r.push(a);var i=e;i.inputs=ns(e.inputs),i.declaredInputs=ns(e.declaredInputs),i.outputs=ns(e.outputs);var o=a.hostBindings;o&&is(e,o);var s=a.viewQuery,u=a.contentQueries;if(s&&rs(e,s),u&&as(e,u),$e(e.inputs,a.inputs),$e(e.declaredInputs,a.declaredInputs),$e(e.outputs,a.outputs),mn(a)&&a.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(a.data.animation)}i.afterContentChecked=i.afterContentChecked||a.afterContentChecked,i.afterContentInit=e.afterContentInit||a.afterContentInit,i.afterViewChecked=e.afterViewChecked||a.afterViewChecked,i.afterViewInit=e.afterViewInit||a.afterViewInit,i.doCheck=e.doCheck||a.doCheck,i.onDestroy=e.onDestroy||a.onDestroy,i.onInit=e.onInit||a.onInit}var l=a.features;if(l)for(var h=0;h<l.length;h++){var f=l[h];f&&f.ngInherit&&f(e),f===ts&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,r=e.length-1;r>=0;r--){var a=e[r];a.hostVars=t+=a.hostVars,a.hostAttrs=ar(a.hostAttrs,n=ar(n,a.hostAttrs))}}(r)}function ns(e){return e===$t?{}:e===Jt?[]:e}function rs(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,r){t(e,r),n(e,r)}:t}function as(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,r,a){t(e,r,a),n(e,r,a)}:t}function is(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,r){t(e,r),n(e,r)}:t}var os=function(){function e(t,n,r){_classCallCheck(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=r}return _createClass(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function ss(e){e.type.prototype.ngOnChanges&&(e.setInput=us,e.onChanges=function(){var e=cs(this),t=e&&e.current;if(t){var n=e.previous;if(n===$t)e.previous=t;else for(var r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}})}function us(e,t,n,r){var a=cs(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:$t,current:null}),i=a.current||(a.current={}),o=a.previous,s=this.declaredInputs[n],u=o[s];i[s]=new os(u&&u.currentValue,t,o===$t),e[r]=t}function cs(e){return e.__ngSimpleChanges__||null}function ls(e,t,n,r,a){if(e=ft(e),Array.isArray(e))for(var i=0;i<e.length;i++)ls(e[i],t,n,r,a);else{var o=_n(),s=kn(),u=Zi(e)?e:ft(e.provide),c=qi(e),l=Cn(),h=65535&l.providerIndexes,f=l.directiveStart,d=l.providerIndexes>>16;if(Zi(e)||!e.multi){var p=new $n(c,a,go),v=ds(u,t,a?h:h+d,f);-1===v?(_r(gr(l,s),o,u),hs(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,a&&(l.providerIndexes+=65536),n.push(p),s.push(p)):(n[v]=p,s[v]=p)}else{var m=ds(u,t,h+d,f),g=ds(u,t,h,h+d),y=m>=0&&n[m],b=g>=0&&n[g];if(a&&!b||!a&&!y){_r(gr(l,s),o,u);var k=function(e,t,n,r,a){var i=new $n(e,n,go);return i.multi=[],i.index=t,i.componentProviders=0,fs(i,a,r&&!n),i}(a?vs:ps,n.length,a,r,c);!a&&b&&(n[g].providerFactory=k),hs(o,e,t.length),t.push(u),l.directiveStart++,l.directiveEnd++,a&&(l.providerIndexes+=65536),n.push(k),s.push(k)}else hs(o,e,m>-1?m:g),fs(n[a?g:m],c,!a&&r);!a&&r&&b&&n[g].componentProviders++}}}function hs(e,t,n){if(Zi(t)||t.useClass){var r=(t.useClass||t).prototype.ngOnDestroy;r&&(e.destroyHooks||(e.destroyHooks=[])).push(n,r)}}function fs(e,t,n){e.multi.push(t),n&&e.componentProviders++}function ds(e,t,n,r){for(var a=n;a<r;a++)if(t[a]===e)return a;return-1}function ps(e,t,n,r){return ms(this.multi,[])}function vs(e,t,n,r){var a,i=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=Ar(n,n[1],this.providerFactory.index,r);ms(i,a=s.slice(0,o));for(var u=o;u<s.length;u++)a.push(s[u])}else ms(i,a=[]);return a}function ms(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function gs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,r){return function(e,t,n){var r=_n();if(r.firstCreatePass){var a=mn(e);ls(n,r.data,r.blueprint,a,!0),ls(t,r.data,r.blueprint,a,!1)}}(n,r?r(e):e,t)}}}ss.ngInherit=!0;var ys=function e(){_classCallCheck(this,e)},bs=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(ut(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),ks=function(){var e=function e(){_classCallCheck(this,e)};return e.NULL=new bs,e}(),_s=function(){var e=function e(t){_classCallCheck(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=function(){return ws(e)},e}(),ws=function(e){return Oi(e,Cn(),kn())},Cs=function e(){_classCallCheck(this,e)},xs=function(){var e={Important:1,DashCase:2};return e[e.Important]="Important",e[e.DashCase]="DashCase",e}(),Ss=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return As()},e}(),As=function(){var e=kn(),t=jr(Cn().index,e);return function(e){var t=e[11];if(Qn(t))return t;throw new Error("Cannot inject Renderer2 when the application uses Renderer3!")}(hn(t)?t:e)},Is=function(){var e=function e(){_classCallCheck(this,e)};return e.\u0275prov=Je({token:e,providedIn:"root",factory:function(){return null}}),e}(),Ts=new function e(t){_classCallCheck(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("9.0.6"),Es=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return so(e)}},{key:"create",value:function(e){return new Ns(e)}}]),e}(),Rs=function(e,t){return t},Ns=function(){function e(t){_classCallCheck(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||Rs}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,r=0,a=null;t||n;){var i=!n||t&&t.currentIndex<Ms(n,r,a)?t:n,o=Ms(i,r,a),s=i.currentIndex;if(i===n)r--,n=n._nextRemoved;else if(t=t._next,null==i.previousIndex)r++;else{a||(a=[]);var u=o-r,c=s-r;if(u!=c){for(var l=0;l<u;l++){var h=l<a.length?a[l]:a[l]=0,f=h+l;c<=f&&f<u&&(a[l]=h+1)}a[i.previousIndex]=c-u}}o!==s&&e(i,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!so(e))throw new Error("Error trying to diff '".concat(ut(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,r,a,i=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)r=e[s],a=this._trackByFn(s,r),null!==i&&io(i.trackById,a)?(o&&(i=this._verifyReinsertion(i,r,a,s)),io(i.item,r)||this._addIdentityChange(i,r)):(i=this._mismatch(i,r,a,s),o=!0),i=i._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var r,a=e[ao()]();!(r=a.next()).done;)t(r.value)}(e,(function(e){a=t._trackByFn(n,e),null!==i&&io(i.trackById,a)?(o&&(i=t._verifyReinsertion(i,e,a,n)),io(i.item,e)||t._addIdentityChange(i,e)):(i=t._mismatch(i,e,a,n),o=!0),i=i._next,n++})),this.length=n;return this._truncate(i),this.collection=e,this.isDirty}},{key:"_reset",value:function(){if(this.isDirty){var e,t;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=t)e.previousIndex=e.currentIndex,t=e._nextMoved;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,r){var a;return null===e?a=this._itTail:(a=e._prev,this._remove(e)),null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,r))?(io(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,a,r)):null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(io(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,a,r)):e=this._addAfter(new Os(t,n),a,r),e}},{key:"_verifyReinsertion",value:function(e,t,n,r){var a=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==a?e=this._reinsertAfter(a,e._prev,r):e.currentIndex!=r&&(e.currentIndex=r,this._addToMoves(e,r)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var r=e._prevRemoved,a=e._nextRemoved;return null===r?this._removalsHead=a:r._nextRemoved=a,null===a?this._removalsTail=r:a._prevRemoved=r,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var r=null===t?this._itHead:t._next;return e._next=r,e._prev=t,null===r?this._itTail=e:r._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new Fs),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t?e:(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e,e)}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Fs),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}}]),e}(),Os=function e(t,n){_classCallCheck(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},Ds=function(){function e(){_classCallCheck(this,e),this._head=null,this._tail=null}return _createClass(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&io(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),Fs=function(){function e(){_classCallCheck(this,e),this.map=new Map}return _createClass(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new Ds,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"clear",value:function(){this.map.clear()}},{key:"isEmpty",get:function(){return 0===this.map.size}}]),e}();function Ms(e,t,n){var r=e.previousIndex;if(null===r)return r;var a=0;return n&&r<n.length&&(a=n[r]),r+t+a}var Ps=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"supports",value:function(e){return e instanceof Map||uo(e)}},{key:"create",value:function(){return new zs}}]),e}(),zs=function(){function e(){_classCallCheck(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return _createClass(e,[{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||uo(e)))throw new Error("Error trying to diff '".concat(ut(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,(function(e,r){if(n&&n.key===r)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var a=t._getOrCreateRecordForKey(r,e);n=t._insertBeforeOrAppend(n,a)}})),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var r=n._prev,a=n._next;return r&&(r._next=a),a&&(a._prev=r),n._next=null,n._prev=null,n}var i=new Ls(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){io(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach((function(n){return t(e[n],n)}))}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}}]),e}(),Ls=function e(t){_classCallCheck(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null},Bs=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t,n=this.factories.find((function(t){return t.supports(e)}));if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend IterableDiffers without a parent injector");return e.create(t,n)},deps:[[e,new Xe,new qe]]}}}]),e}();return e.\u0275prov=Je({token:e,providedIn:"root",factory:function(){return new e([new Es])}}),e}(),Vs=function(){var e=function(){function e(t){_classCallCheck(this,e),this.factories=t}return _createClass(e,[{key:"find",value:function(e){var t=this.factories.find((function(t){return t.supports(e)}));if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var r=n.factories.slice();t=t.concat(r)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){if(!n)throw new Error("Cannot extend KeyValueDiffers without a parent injector");return e.create(t,n)},deps:[[e,new Xe,new qe]]}}}]),e}();return e.\u0275prov=Je({token:e,providedIn:"root",factory:function(){return new e([new Ps])}}),e}(),Ws=[new Ps],Us=new Bs([new Es]),js=new Vs(Ws),Hs=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Gs(e,_s)},e}(),Gs=function(e,t){return Di(e,t,Cn(),kn())},qs=function(){var e=function e(){_classCallCheck(this,e)};return e.__NG_ELEMENT_ID__=function(){return Ks(e,_s)},e}(),Ks=function(e,t){return Fi(e,t,Cn(),kn())},Xs={},Zs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).ngModule=e,r}return _createClass(n,[{key:"resolveComponentFactory",value:function(e){var t=un(e);return new Js(t,this.ngModule)}}]),n}(ks);function Ys(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var $s=new It("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return fr}}),Js=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).componentDef=e,a.ngModule=r,a.componentType=e.type,a.selector=e.selectors.map(sa).join(","),a.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],a.isBoundToModule=!!r,a}return _createClass(n,[{key:"create",value:function(e,t,n,r){var a,i,o=(r=r||this.ngModule)?function(e,t){return{get:function(n,r,a){var i=e.get(n,Xs,a);return i!==Xs||r===Xs?i:t.get(n,r,a)}}}(e,r.injector):e,s=o.get(Cs,er),u=o.get(Is,null),c=s.createRenderer(null,this.componentDef),l=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(Qn(e))return e.selectRootElement(t,n===Yt.ShadowDom);var r="string"==typeof t?e.querySelector(t):t;return r.textContent="",r}(c,n,this.componentDef.encapsulation):ba(l,s.createRenderer(null,this.componentDef),function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(l)),f=this.componentDef.onPush?576:528,d="string"==typeof n&&/^#root-ng-internal-isolated-\d+/.test(n),p={components:[],scheduler:fr,clean:Qa,playerHandler:null,flags:0},v=Ea(0,-1,null,1,0,null,null,null,null,null),m=ka(null,v,p,f,null,null,s,c,u,o);zn(m,null);try{var g=function(e,t,n,r,a,i){var o=n[1];n[19]=e;var s=_a(o,null,0,3,null,null),u=s.mergedAttrs=t.hostAttrs;null!==u&&(no(s,u),null!==e&&(tr(a,e,u),null!==s.classes&&Ai(a,e,s.classes),null!==s.styles&&Si(a,e,s.styles)));var c=r.createRenderer(e,t),l=ka(n,Ta(t),null,t.onPush?64:16,n[19],s,r,c,void 0);return o.firstCreatePass&&(_r(gr(s,n),o,t.type),za(o,s),Ba(s,n.length,1)),Xa(n,l),n[19]=l}(h,this.componentDef,m,s,c);if(h)if(n)tr(c,h,["ng-version",Ts.full]);else{var y=function(e){for(var t=[],n=[],r=1,a=2;r<e.length;){var i=e[r];if("string"==typeof i)2===a?""!==i&&t.push(i,e[++r]):8===a&&n.push(i);else{if(!na(a))break;a=i}r++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),b=y.attrs,k=y.classes;b&&tr(c,h,b),k&&k.length>0&&Ai(c,h,k.join(" "))}i=Wr(m[1],0),t&&(i.projection=t.map((function(e){return Array.from(e)}))),a=function(e,t,n,r,a){var i=n[1],o=function(e,t,n){var r=Cn();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),Pa(e,r,1),Va(e,t,n));var a=Ar(t,e,t.length-1,r);Zr(a,t);var i=Vr(r,t);return i&&Zr(i,t),a}(i,n,t);r.components.push(o),e[8]=o,a&&a.forEach((function(e){return e(o,t)})),t.contentQueries&&t.contentQueries(1,o,n.length-1);var s=Cn();if(i.firstCreatePass&&(null!==t.hostBindings||null!==t.hostAttrs)){Hn(s.index-19);var u=n[1];Da(u,t),Fa(u,n,t.hostVars),Ma(t,o)}return o}(g,this.componentDef,m,p,[es]),wa(v,m,null)}finally{Un()}var _=new Qs(this.componentType,a,Oi(_s,i,m),m,i);return n&&!d||(_.hostView._tViewNode.child=i),_}},{key:"inputs",get:function(){return Ys(this.componentDef.inputs)}},{key:"outputs",get:function(){return Ys(this.componentDef.outputs)}}]),n}(ys),Qs=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o){var s,u,c,l;return _classCallCheck(this,n),(s=t.call(this)).location=a,s._rootLView=i,s._tNode=o,s.destroyCbs=[],s.instance=r,s.hostView=s.changeDetectorRef=new Ni(i),s.hostView._tViewNode=(u=i[1],c=i,null==(l=u.node)&&(u.node=l=Ra(0,null,2,-1,null,null)),c[6]=l),s.componentType=e,s}return _createClass(n,[{key:"destroy",value:function(){this.destroyCbs&&(this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null,!this.hostView.destroyed&&this.hostView.destroy())}},{key:"onDestroy",value:function(e){this.destroyCbs&&this.destroyCbs.push(e)}},{key:"injector",get:function(){return new Er(this._tNode,this._rootLView)}}]),n}(function(){return function e(){_classCallCheck(this,e)}}()),eu=void 0,tu=["en",[["a","p"],["AM","PM"],eu],[["AM","PM"],eu,eu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],eu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],eu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",eu,"{1} 'at' {0}",eu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],nu={};function ru(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=au(t);if(n)return n;var r=t.split("-")[0];if(n=au(r))return n;if("en"===r)return tu;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function au(e){return e in nu||(nu[e]=bt.ng&&bt.ng.common&&bt.ng.common.locales&&bt.ng.common.locales[e]),nu[e]}var iu=function(){var e={LocaleId:0,DayPeriodsFormat:1,DayPeriodsStandalone:2,DaysFormat:3,DaysStandalone:4,MonthsFormat:5,MonthsStandalone:6,Eras:7,FirstDayOfWeek:8,WeekendRange:9,DateFormat:10,TimeFormat:11,DateTimeFormat:12,NumberSymbols:13,NumberFormats:14,CurrencyCode:15,CurrencySymbol:16,CurrencyName:17,Currencies:18,PluralCase:19,ExtraData:20};return e[e.LocaleId]="LocaleId",e[e.DayPeriodsFormat]="DayPeriodsFormat",e[e.DayPeriodsStandalone]="DayPeriodsStandalone",e[e.DaysFormat]="DaysFormat",e[e.DaysStandalone]="DaysStandalone",e[e.MonthsFormat]="MonthsFormat",e[e.MonthsStandalone]="MonthsStandalone",e[e.Eras]="Eras",e[e.FirstDayOfWeek]="FirstDayOfWeek",e[e.WeekendRange]="WeekendRange",e[e.DateFormat]="DateFormat",e[e.TimeFormat]="TimeFormat",e[e.DateTimeFormat]="DateTimeFormat",e[e.NumberSymbols]="NumberSymbols",e[e.NumberFormats]="NumberFormats",e[e.CurrencyCode]="CurrencyCode",e[e.CurrencySymbol]="CurrencySymbol",e[e.CurrencyName]="CurrencyName",e[e.Currencies]="Currencies",e[e.PluralCase]="PluralCase",e[e.ExtraData]="ExtraData",e}();function ou(e){var t;null==(t=e)&&function(e,t,n,r){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined")+" [Expected=> null != ".concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}var su=new Map,uu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;_classCallCheck(this,n),(a=t.call(this))._parent=r,a._bootstrapComponents=[],a.injector=_assertThisInitialized(a),a.destroyCbs=[],a.componentFactoryResolver=new Zs(_assertThisInitialized(a));var i=ln(e),o=e[xt]||null;return o&&ou(o),a._bootstrapComponents=dr(i.bootstrap),a._r3Injector=ji(e,r,[{provide:Vt,useValue:_assertThisInitialized(a)},{provide:ks,useValue:a.componentFactoryResolver}],ut(e)),a._r3Injector._resolveInjectorDefTypes(),a.instance=a.get(e),a}return _createClass(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:$i.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ze.Default;return e===$i||e===Vt||e===Tt?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach((function(e){return e()})),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(Vt),cu=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).moduleType=e,null!==ln(e)&&function e(t){if(null!==t.\u0275mod.id){var n=t.\u0275mod.id;(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(ut(t)," vs ").concat(ut(t.name)))})(n,su.get(n),t),su.set(n,t)}var r=t.\u0275mod.imports;r instanceof Function&&(r=r()),r&&r.forEach((function(t){return e(t)}))}(e),r}return _createClass(n,[{key:"create",value:function(e){return new uu(this.moduleType,e)}}]),n}(Wt);function lu(e,t,n,r){return function(e,t,n,r,a,i){var o=t+n;return ho(e,o,a)?co(e,o+1,i?r.call(i,a):r(a)):lo(e,o+1)}(kn(),En(),e,t,n,r)}function hu(e,t){var n,r=_n(),a=e+19;r.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var r=t[n];if(e===r.name)return r}throw new Error("The pipe '".concat(e,"' could not be found!"))}(t,r.pipeRegistry),r.data[a]=n,n.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(a,n.onDestroy)):n=r.data[a];var i=n.factory||(n.factory=cn(n.type)),o=Ft(go),s=i();return Ft(o),function(e,t,n,r){var a=n+19;a>=e.data.length&&(e.data[a]=null,e.blueprint[a]=null),t[a]=r}(r,kn(),e,s),s}function fu(e,t,n,r){var a=kn(),i=Ur(a,e);return function(e,t){return oo.isWrapped(t)&&(t=oo.unwrap(t),e[Rn()]=ua),t}(a,function(e,t){return e[1].data[t+19].pure}(a,e)?function(e,t,n,r,a,i,o){var s=t+n;return fo(e,s,a,i)?co(e,s+2,o?r.call(o,a,i):r(a,i)):lo(e,s+2)}(a,En(),t,i.transform,n,r,i):i.transform(n,r))}var du=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _classCallCheck(this,n),(e=t.call(this)).__isAsync=r,e}return _createClass(n,[{key:"emit",value:function(e){_get(_getPrototypeOf(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,r){var a,i=function(e){return null},o=function(){return null};e&&"object"==typeof e?(a=this.__isAsync?function(t){setTimeout((function(){return e.next(t)}))}:function(t){e.next(t)},e.error&&(i=this.__isAsync?function(t){setTimeout((function(){return e.error(t)}))}:function(t){e.error(t)}),e.complete&&(o=this.__isAsync?function(){setTimeout((function(){return e.complete()}))}:function(){e.complete()})):(a=this.__isAsync?function(t){setTimeout((function(){return e(t)}))}:function(t){e(t)},t&&(i=this.__isAsync?function(e){setTimeout((function(){return t(e)}))}:function(e){t(e)}),r&&(o=this.__isAsync?function(){setTimeout((function(){return r()}))}:function(){r()}));var s=_get(_getPrototypeOf(n.prototype),"subscribe",this).call(this,a,i,o);return e instanceof $&&e.add(s),s}}]),n}(de);function pu(){return this._results[ao()]()}var vu=function(){function e(){_classCallCheck(this,e),this.dirty=!0,this._results=[],this.changes=new du,this.length=0;var t=ao(),n=e.prototype;n[t]||(n[t]=pu)}return _createClass(e,[{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e){this._results=function e(t,n){void 0===n&&(n=t);for(var r=0;r<t.length;r++){var a=t[r];Array.isArray(a)?(n===t&&(n=t.slice(0,r)),e(a,n)):n!==t&&n.push(a)}return n}(e),this.dirty=!1,this.length=this._results.length,this.last=this._results[this.length-1],this.first=this._results[0]}},{key:"notifyOnChanges",value:function(){this.changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),mu=function(){function e(t){_classCallCheck(this,e),this.queryList=t,this.matches=null}return _createClass(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),gu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var r=null!==t.contentQueries?t.contentQueries[0]:n.length,a=[],i=0;i<r;i++){var o=n.getByIndex(i);a.push(this.queries[o.indexInDeclarationView].clone())}return new e(a)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==Nu(e,t).matches&&this.queries[t].setDirty()}}]),e}(),yu=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_classCallCheck(this,e),this.predicate=t,this.descendants=n,this.isStatic=r,this.read=a},bu=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_classCallCheck(this,e),this.queries=t}return _createClass(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,r=0;r<this.length;r++){var a=null!==n?n.length:0,i=this.getByIndex(r).embeddedTView(t,a);i&&(i.indexInDeclarationView=r,null!==n?n.push(i):n=[i])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"track",value:function(e){this.queries.push(e)}},{key:"length",get:function(){return this.queries.length}}]),e}(),ku=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_classCallCheck(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return _createClass(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&!1===this.metadata.descendants){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&4===n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){if(Array.isArray(this.metadata.predicate))for(var n=this.metadata.predicate,r=0;r<n.length;r++)this.matchTNodeWithReadOption(e,t,_u(t,n[r]));else{var a=this.metadata.predicate;a===Hs?0===t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,Sr(t,e,a,!1,!1))}}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var r=this.metadata.read;if(null!==r)if(r===_s||r===qs||r===Hs&&0===t.type)this.addMatch(t.index,-2);else{var a=Sr(t,e,r,!1,!1);null!==a&&this.addMatch(t.index,a)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function _u(e,t){var n=e.localNames;if(null!==n)for(var r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function wu(e,t,n,r){return-1===n?function(e,t){return 3===e.type||4===e.type?Oi(_s,e,t):0===e.type?Di(Hs,_s,e,t):null}(t,e):-2===n?function(e,t,n){return n===_s?Oi(_s,t,e):n===Hs?Di(Hs,_s,t,e):n===qs?Fi(qs,_s,t,e):void 0}(e,t,r):Ar(e,e[1],n,t)}function Cu(e,t,n,r){var a=t[5].queries[r];if(null===a.matches){for(var i=e.data,o=n.matches,s=[],u=0;u<o.length;u+=2){var c=o[u];s.push(c<0?null:wu(t,i[c],o[u+1],n.metadata.read))}a.matches=s}return a.matches}function xu(e){var t=kn(),n=_n(),r=Fn();Mn(r+1);var a=Nu(n,r);if(e.dirty&&Gr(t)===a.metadata.isStatic){if(null===a.matches)e.reset([]);else{var i=a.crossesNgTemplate?function e(t,n,r,a){var i=t.queries.getByIndex(r),o=i.matches;if(null!==o)for(var s=Cu(t,n,i,r),u=0;u<o.length;u+=2){var c=o[u];if(c>0)a.push(s[u/2]);else{for(var l=o[u+1],h=n[-c],f=9;f<h.length;f++){var d=h[f];d[17]===d[3]&&e(d[1],d,l,a)}if(null!==h[5])for(var p=h[5],v=0;v<p.length;v++){var m=p[v];e(m[1],m,l,a)}}}return a}(n,t,r,[]):Cu(n,t,a,r);e.reset(i),e.notifyOnChanges()}return!0}return!1}function Su(e,t,n){Au(_n(),kn(),e,t,n,!1)}function Au(e,t,n,r,a,i){e.firstCreatePass&&(Ru(e,new yu(n,r,i,a),-1),i&&(e.staticViewQueries=!0)),Eu(e,t)}function Iu(e,t,n,r){!function(e,t,n,r,a,i,o,s){e.firstCreatePass&&(Ru(e,new yu(n,r,!1,a),o.index),function(e,t){var n=e.contentQueries||(e.contentQueries=[]);t!==(e.contentQueries.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(e,s)),Eu(e,t)}(_n(),kn(),t,n,r,0,Cn(),e)}function Tu(){return e=kn(),t=Fn(),e[5].queries[t].queryList;var e,t}function Eu(e,t){var n=new vu;!function(e,t,n,r){var a=ei(t);a.push(n),e.firstCreatePass&&ti(e).push(r,a.length-1)}(e,t,n,n.destroy),null===t[5]&&(t[5]=new gu),t[5].queries.push(new mu(n))}function Ru(e,t,n){null===e.queries&&(e.queries=new bu),e.queries.track(new ku(t,n))}function Nu(e,t){return e.queries.getByIndex(t)}var Ou=new It("Application Initializer"),Du=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this.appInits=t,this.initialized=!1,this.done=!1,this.donePromise=new Promise((function(e,t){n.resolve=e,n.reject=t}))}return _createClass(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var r=0;r<this.appInits.length;r++){var a=this.appInits[r]();xo(a)&&t.push(a)}Promise.all(t).then((function(){n()})).catch((function(t){e.reject(t)})),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pt(Ou,8))},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}(),Fu=new It("AppId"),Mu={provide:Fu,useFactory:function(){return"".concat(Pu()).concat(Pu()).concat(Pu())},deps:[]};function Pu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var zu=new It("Platform Initializer"),Lu=new It("Platform ID"),Bu=new It("appBootstrapListener"),Vu=function(){var e=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}(),Wu=new It("LocaleId"),Uu=new It("DefaultCurrencyCode"),ju=function e(t,n){_classCallCheck(this,e),this.ngModuleFactory=t,this.componentFactories=n},Hu=function(e){return new cu(e)},Gu=Hu,qu=function(e){return Promise.resolve(Hu(e))},Ku=function(e){var t=Hu(e),n=dr(ln(e).declarations).reduce((function(e,t){var n=un(t);return n&&e.push(new Js(n)),e}),[]);return new ju(t,n)},Xu=Ku,Zu=function(e){return Promise.resolve(Ku(e))},Yu=function(){var e=function(){function e(){_classCallCheck(this,e),this.compileModuleSync=Gu,this.compileModuleAsync=qu,this.compileModuleAndAllComponentsSync=Xu,this.compileModuleAndAllComponentsAsync=Zu}return _createClass(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}(),$u=new It("compilerOptions"),Ju=Promise.resolve(0);function Qu(e){"undefined"==typeof Zone?Ju.then((function(){e&&e.apply(null,null)})):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var ec=function(){function e(t){var n,r,a=t.enableLongStackTrace,i=void 0!==a&&a,o=t.shouldCoalesceEventChangeDetection,s=void 0!==o&&o;if(_classCallCheck(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new du(!1),this.onMicrotaskEmpty=new du(!1),this.onStable=new du(!1),this.onError=new du(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.wtfZoneSpec&&(this._inner=this._inner.fork(Zone.wtfZoneSpec)),Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=s,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=bt.requestAnimationFrame,t=bt.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,r=!!(n=this).shouldCoalesceEventChangeDetection&&n.nativeRequestAnimationFrame&&function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(bt,(function(){e.lastRequestAnimationFrameId=-1,ac(e),rc(e)})),ac(e))}(n)},n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0,maybeDelayChangeDetection:r},onInvokeTask:function(e,t,a,i,o,s){try{return ic(n),e.invokeTask(a,i,o,s)}finally{r&&"eventTask"===i.type&&r(),oc(n)}},onInvoke:function(e,t,r,a,i,o,s){try{return ic(n),e.invoke(r,a,i,o,s)}finally{oc(n)}},onHasTask:function(e,t,r,a){e.hasTask(r,a),t===r&&("microTask"==a.change?(n._hasPendingMicrotasks=a.microTask,ac(n),rc(n)):"macroTask"==a.change&&(n.hasPendingMacrotasks=a.macroTask))},onHandleError:function(e,t,r,a){return e.handleError(r,a),n.runOutsideAngular((function(){return n.onError.emit(a)})),!1}})}return _createClass(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,r){var a=this._inner,i=a.scheduleEventTask("NgZoneEvent: "+r,e,nc,tc,tc);try{return a.runTask(i,t,n)}finally{a.cancelTask(i)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}();function tc(){}var nc={};function rc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular((function(){return e.onStable.emit(null)}))}finally{e.isStable=!0}}}function ac(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||e.shouldCoalesceEventChangeDetection&&-1!==e.lastRequestAnimationFrameId)}function ic(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function oc(e){e._nesting--,rc(e)}var sc,uc=function(){function e(){_classCallCheck(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new du,this.onMicrotaskEmpty=new du,this.onStable=new du,this.onError=new du}return _createClass(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,r){return e.apply(t,n)}}]),e}(),cc=function(){var e=function(){function e(t){var n=this;_classCallCheck(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run((function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")}))}return _createClass(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular((function(){e._ngZone.onStable.subscribe({next:function(){ec.assertNotInAngularZone(),Qu((function(){e._isZoneStable=!0,e._runCallbacksIfReady()}))}})}))}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())Qu((function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1}));else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter((function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)})),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map((function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}})):[]}},{key:"addCallback",value:function(e,t,n){var r=this,a=-1;t&&t>0&&(a=setTimeout((function(){r._callbacks=r._callbacks.filter((function(e){return e.timeoutId!==a})),e(r._didWork,r.getPendingTasks())}),t)),this._callbacks.push({doneCb:e,timeoutId:a,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pt(ec))},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}(),lc=function(){var e=function(){function e(){_classCallCheck(this,e),this._applications=new Map,hc.addToWindow(this)}return _createClass(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return hc.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}(),hc=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),fc=function(e,t,n){var r=new cu(n);if(0===Qi.size)return Promise.resolve(r);var a,i,o=(a=e.get($u,[]).concat(t).map((function(e){return e.providers})),i=[],a.forEach((function(e){return e&&i.push.apply(i,_toConsumableArray(e))})),i);if(0===o.length)return Promise.resolve(r);var s=function(){var e=bt.ng;if(!e||!e.\u0275compilerFacade)throw new Error("Angular JIT compilation failed: '@angular/compiler' not loaded!\n  - JIT compilation is discouraged for production use-cases! Consider AOT mode instead.\n  - Did you bootstrap using '@angular/platform-browser-dynamic' or '@angular/platform-server'?\n  - Alternatively provide the compiler with 'import \"@angular/compiler\";' before bootstrapping.");return e.\u0275compilerFacade}(),u=$i.create({providers:o}).get(s.ResourceLoader);return function(e){var t=[],n=new Map;function r(e){var t=n.get(e);if(!t){var r=function(e){return Promise.resolve(u.get(e))}(e);n.set(e,t=r.then(to))}return t}return Qi.forEach((function(e,n){var a=[];e.templateUrl&&a.push(r(e.templateUrl).then((function(t){e.template=t})));var i=e.styleUrls,o=e.styles||(e.styles=[]),s=e.styles.length;i&&i.forEach((function(t,n){o.push(""),a.push(r(t).then((function(r){o[s+n]=r,i.splice(i.indexOf(t),1),0==i.length&&(e.styleUrls=void 0)})))}));var u=Promise.all(a).then((function(){return function(e){eo.delete(e)}(n)}));t.push(u)})),Qi=new Map,Promise.all(t).then((function(){}))}().then((function(){return r}))},dc=new It("AllowMultipleToken"),pc=function e(t,n){_classCallCheck(this,e),this.name=t,this.token=n};function vc(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r="Platform: ".concat(t),a=new It(r);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=mc();if(!i||i.injector.get(dc,!1))if(e)e(n.concat(t).concat({provide:a,useValue:!0}));else{var o=n.concat(t).concat({provide:a,useValue:!0},{provide:zi,useValue:"platform"});!function(e){if(sc&&!sc.destroyed&&!sc.injector.get(dc,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");sc=e.get(gc);var t=e.get(zu,null);t&&t.forEach((function(e){return e()}))}($i.create({providers:o,name:r}))}return function(e){var t=mc();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(a)}}function mc(){return sc&&!sc.destroyed?sc:null}var gc=function(){var e=function(){function e(t){_classCallCheck(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return _createClass(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,r,a=this,i=(n=t?t.ngZone:void 0,r=t&&t.ngZoneEventCoalescing||!1,"noop"===n?new uc:("zone.js"===n?void 0:n)||new ec({enableLongStackTrace:zr(),shouldCoalesceEventChangeDetection:r})),o=[{provide:ec,useValue:i}];return i.run((function(){var t=$i.create({providers:o,parent:a.injector,name:e.moduleType.name}),n=e.create(t),r=n.injector.get(Dr,null);if(!r)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return n.onDestroy((function(){return _c(a._modules,n)})),i.runOutsideAngular((function(){return i.onError.subscribe({next:function(e){r.handleError(e)}})})),function(e,t,r){try{var i=((o=n.injector.get(Du)).runInitializers(),o.donePromise.then((function(){return ou(n.injector.get(Wu,"en-US")||"en-US"),a._moduleDoBootstrap(n),n})));return xo(i)?i.catch((function(n){throw t.runOutsideAngular((function(){return e.handleError(n)})),n})):i}catch(s){throw t.runOutsideAngular((function(){return e.handleError(s)})),s}var o}(r,i)}))}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=yc({},n);return fc(this.injector,r,e).then((function(e){return t.bootstrapModuleFactory(e,r)}))}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(kc);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach((function(e){return t.bootstrap(e)}));else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(ut(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. ')+"Please define one of these.");e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach((function(e){return e.destroy()})),this._destroyListeners.forEach((function(e){return e()})),this._destroyed=!0}},{key:"injector",get:function(){return this._injector}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pt($i))},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}();function yc(e,t){return Array.isArray(t)?t.reduce(yc,e):Object.assign(Object.assign({},e),t)}var bc,kc=((bc=function(){function e(t,n,r,a,i,o){var s=this;_classCallCheck(this,e),this._zone=t,this._console=n,this._injector=r,this._exceptionHandler=a,this._componentFactoryResolver=i,this._initStatus=o,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._enforceNoNewChanges=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._enforceNoNewChanges=zr(),this._zone.onMicrotaskEmpty.subscribe({next:function(){s._zone.run((function(){s.tick()}))}});var u=new se((function(e){s._stable=s._zone.isStable&&!s._zone.hasPendingMacrotasks&&!s._zone.hasPendingMicrotasks,s._zone.runOutsideAngular((function(){e.next(s._stable),e.complete()}))})),c=new se((function(e){var t;s._zone.runOutsideAngular((function(){t=s._zone.onStable.subscribe((function(){ec.assertNotInAngularZone(),Qu((function(){s._stable||s._zone.hasPendingMacrotasks||s._zone.hasPendingMicrotasks||(s._stable=!0,e.next(!0))}))}))}));var n=s._zone.onUnstable.subscribe((function(){ec.assertInAngularZone(),s._stable&&(s._stable=!1,s._zone.runOutsideAngular((function(){e.next(!1)})))}));return function(){t.unsubscribe(),n.unsubscribe()}}));this.isStable=Me(u,c.pipe((function(e){return Pe()((t=Ue,function(e){var n;n="function"==typeof t?t:function(){return t};var r=Object.create(e,Ve);return r.source=e,r.subjectFactory=n,r})(e));var t})))}return _createClass(e,[{key:"bootstrap",value:function(e,t){var n,r=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof ys?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var a=n.isBoundToModule?void 0:this._injector.get(Vt),i=n.create($i.NULL,[],t||n.selector,a);i.onDestroy((function(){r._unloadComponent(i)}));var o=i.injector.get(cc,null);return o&&i.injector.get(lc).registerApplication(i.location.nativeElement,o),this._loadComponent(i),zr()&&this._console.log("Angular is running in the development mode. Call enableProdMode() to enable the production mode."),i}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=_createForOfIteratorHelper(this._views);try{for(n.s();!(t=n.n()).done;)t.value.detectChanges()}catch(i){n.e(i)}finally{n.f()}if(this._enforceNoNewChanges){var r,a=_createForOfIteratorHelper(this._views);try{for(a.s();!(r=a.n()).done;)r.value.checkNoChanges()}catch(i){a.e(i)}finally{a.f()}}}catch(o){this._zone.runOutsideAngular((function(){return e._exceptionHandler.handleError(o)}))}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;_c(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(Bu,[]).concat(this._bootstrapListeners).forEach((function(t){return t(e)}))}},{key:"_unloadComponent",value:function(e){this.detachView(e.hostView),_c(this.components,e)}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach((function(e){return e.destroy()}))}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||bc)(Pt(ec),Pt(Vu),Pt($i),Pt(Dr),Pt(ks),Pt(Du))},bc.\u0275prov=Je({token:bc,factory:bc.\u0275fac}),bc);function _c(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var wc=function e(){_classCallCheck(this,e)},Cc=function e(){_classCallCheck(this,e)},xc={factoryPathPrefix:"",factoryPathSuffix:".ngfactory"},Sc=function(){var e=function(){function e(t,n){_classCallCheck(this,e),this._compiler=t,this._config=n||xc}return _createClass(e,[{key:"load",value:function(e){return this.loadAndCompile(e)}},{key:"loadAndCompile",value:function(e){var t=this,r=_slicedToArray(e.split("#"),2),a=r[0],i=r[1];return void 0===i&&(i="default"),n("crnd")(a).then((function(e){return e[i]})).then((function(e){return Ac(e,a,i)})).then((function(e){return t._compiler.compileModuleAsync(e)}))}},{key:"loadFactory",value:function(e){var t=_slicedToArray(e.split("#"),2),r=t[0],a=t[1],i="NgFactory";return void 0===a&&(a="default",i=""),n("crnd")(this._config.factoryPathPrefix+r+this._config.factoryPathSuffix).then((function(e){return e[a+i]})).then((function(e){return Ac(e,r,a)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(Pt(Yu),Pt(Cc,8))},e.\u0275prov=Je({token:e,factory:e.\u0275fac}),e}();function Ac(e,t,n){if(!e)throw new Error("Cannot find '".concat(n,"' in '").concat(t,"'"));return e}var Ic=vc(null,"core",[{provide:Lu,useValue:"unknown"},{provide:gc,deps:[$i]},{provide:lc,deps:[]},{provide:Vu,deps:[]}]),Tc=[{provide:kc,useClass:kc,deps:[ec,Vu,$i,Dr,ks,Du]},{provide:$s,deps:[ec],useFactory:function(e){var t=[];return e.onStable.subscribe((function(){for(;t.length;)t.pop()()})),function(e){t.push(e)}}},{provide:Du,useClass:Du,deps:[[new qe,Ou]]},{provide:Yu,useClass:Yu,deps:[]},Mu,{provide:Bs,useFactory:function(){return Us},deps:[]},{provide:Vs,useFactory:function(){return js},deps:[]},{provide:Wu,useFactory:function(e){return ou(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new Ge(Wu),new qe,new Xe]]},{provide:Uu,useValue:"USD"}],Ec=function(){var e=function e(t){_classCallCheck(this,e)};return e.\u0275mod=an({type:e}),e.\u0275inj=Qe({factory:function(t){return new(t||e)(Pt(kc))},providers:Tc}),e}(),Rc=null;function Nc(){return Rc}var Oc,Dc=new It("DocumentToken"),Fc=((Oc=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Oc)},Oc.\u0275prov=Je({factory:Mc,token:Oc,providedIn:"platform"}),Oc);function Mc(){return Pt(Lc)}var Pc,zc=new It("Location Initialized"),Lc=((Pc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r._init(),r}return _createClass(n,[{key:"_init",value:function(){this.location=Nc().getLocation(),this._history=Nc().getHistory()}},{key:"getBaseHrefFromDOM",value:function(){return Nc().getBaseHref(this._doc)}},{key:"onPopState",value:function(e){Nc().getGlobalEventTarget(this._doc,"window").addEventListener("popstate",e,!1)}},{key:"onHashChange",value:function(e){Nc().getGlobalEventTarget(this._doc,"window").addEventListener("hashchange",e,!1)}},{key:"pushState",value:function(e,t,n){Bc()?this._history.pushState(e,t,n):this.location.hash=n}},{key:"replaceState",value:function(e,t,n){Bc()?this._history.replaceState(e,t,n):this.location.hash=n}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"getState",value:function(){return this._history.state}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(e){this.location.pathname=e}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}}]),n}(Fc)).\u0275fac=function(e){return new(e||Pc)(Pt(Dc))},Pc.\u0275prov=Je({factory:Vc,token:Pc,providedIn:"platform"}),Pc);function Bc(){return!!window.history.pushState}function Vc(){return new Lc(Pt(Dc))}function Wc(e,t){if(0==e.length)return t;if(0==t.length)return e;var n=0;return e.endsWith("/")&&n++,t.startsWith("/")&&n++,2==n?e+t.substring(1):1==n?e+t:e+"/"+t}function Uc(e){var t=e.match(/#|\?|$/),n=t&&t.index||e.length;return e.slice(0,n-("/"===e[n-1]?1:0))+e.slice(n)}function jc(e){return e&&"?"!==e[0]?"?"+e:e}var Hc,Gc=((Hc=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Hc)},Hc.\u0275prov=Je({factory:qc,token:Hc,providedIn:"root"}),Hc);function qc(e){var t=Pt(Dc).location;return new $c(Pt(Fc),t&&t.origin||"")}var Kc,Xc,Zc,Yc=new It("appBaseHref"),$c=((Zc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this))._platformLocation=e,null==r&&(r=a._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return a._baseHref=r,_possibleConstructorReturn(a)}return _createClass(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(e){return Wc(this._baseHref,e)}},{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this._platformLocation.pathname+jc(this._platformLocation.search),n=this._platformLocation.hash;return n&&e?"".concat(t).concat(n):t}},{key:"pushState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+jc(r));this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+jc(r));this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(Gc)).\u0275fac=function(e){return new(e||Zc)(Pt(Fc),Pt(Yc,8))},Zc.\u0275prov=Je({token:Zc,factory:Zc.\u0275fac}),Zc),Jc=((Xc=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this))._platformLocation=e,a._baseHref="",null!=r&&(a._baseHref=r),a}return _createClass(n,[{key:"onPopState",value:function(e){this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e)}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this._platformLocation.hash;return null==e&&(e="#"),e.length>0?e.substring(1):e}},{key:"prepareExternalUrl",value:function(e){var t=Wc(this._baseHref,e);return t.length>0?"#"+t:t}},{key:"pushState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+jc(r));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.pushState(e,t,a)}},{key:"replaceState",value:function(e,t,n,r){var a=this.prepareExternalUrl(n+jc(r));0==a.length&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(e,t,a)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}}]),n}(Gc)).\u0275fac=function(e){return new(e||Xc)(Pt(Fc),Pt(Yc,8))},Xc.\u0275prov=Je({token:Xc,factory:Xc.\u0275fac}),Xc),Qc=((Kc=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._subject=new du,this._urlChangeListeners=[],this._platformStrategy=t;var a=this._platformStrategy.getBaseHref();this._platformLocation=n,this._baseHref=Uc(tl(a)),this._platformStrategy.onPopState((function(e){r._subject.emit({url:r.path(!0),pop:!0,state:e.state,type:e.type})}))}return _createClass(e,[{key:"path",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(e))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(e+jc(t))}},{key:"normalize",value:function(t){return e.stripTrailingSlash(function(e,t){return e&&t.startsWith(e)?t.substring(e.length):t}(this._baseHref,tl(t)))}},{key:"prepareExternalUrl",value:function(e){return e&&"/"!==e[0]&&(e="/"+e),this._platformStrategy.prepareExternalUrl(e)}},{key:"go",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+jc(t)),n)}},{key:"replaceState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(n,"",e,t),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+jc(t)),n)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"onUrlChange",value:function(e){var t=this;this._urlChangeListeners.push(e),this.subscribe((function(e){t._notifyUrlChangeListeners(e.url,e.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach((function(n){return n(e,t)}))}},{key:"subscribe",value:function(e,t,n){return this._subject.subscribe({next:e,error:t,complete:n})}}]),e}()).\u0275fac=function(e){return new(e||Kc)(Pt(Gc),Pt(Fc))},Kc.normalizeQueryParams=jc,Kc.joinWithSlash=Wc,Kc.stripTrailingSlash=Uc,Kc.\u0275prov=Je({factory:el,token:Kc,providedIn:"root"}),Kc);function el(){return new Qc(Pt(Gc),Pt(Fc))}function tl(e){return e.replace(/\/index.html$/,"")}var nl=function(){var e={Zero:0,One:1,Two:2,Few:3,Many:4,Other:5};return e[e.Zero]="Zero",e[e.One]="One",e[e.Two]="Two",e[e.Few]="Few",e[e.Many]="Many",e[e.Other]="Other",e}(),rl=function(){var e={Format:0,Standalone:1};return e[e.Format]="Format",e[e.Standalone]="Standalone",e}(),al=function(){var e={Narrow:0,Abbreviated:1,Wide:2,Short:3};return e[e.Narrow]="Narrow",e[e.Abbreviated]="Abbreviated",e[e.Wide]="Wide",e[e.Short]="Short",e}(),il=function(){var e={Short:0,Medium:1,Long:2,Full:3};return e[e.Short]="Short",e[e.Medium]="Medium",e[e.Long]="Long",e[e.Full]="Full",e}(),ol=function(){var e={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};return e[e.Decimal]="Decimal",e[e.Group]="Group",e[e.List]="List",e[e.PercentSign]="PercentSign",e[e.PlusSign]="PlusSign",e[e.MinusSign]="MinusSign",e[e.Exponential]="Exponential",e[e.SuperscriptingExponent]="SuperscriptingExponent",e[e.PerMille]="PerMille",e[e.Infinity]="Infinity",e[e.NaN]="NaN",e[e.TimeSeparator]="TimeSeparator",e[e.CurrencyDecimal]="CurrencyDecimal",e[e.CurrencyGroup]="CurrencyGroup",e}();function sl(e,t){return fl(ru(e)[iu.DateFormat],t)}function ul(e,t){return fl(ru(e)[iu.TimeFormat],t)}function cl(e,t){return fl(ru(e)[iu.DateTimeFormat],t)}function ll(e,t){var n=ru(e),r=n[iu.NumberSymbols][t];if(void 0===r){if(t===ol.CurrencyDecimal)return n[iu.NumberSymbols][ol.Decimal];if(t===ol.CurrencyGroup)return n[iu.NumberSymbols][ol.Group]}return r}function hl(e){if(!e[iu.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[iu.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function fl(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function dl(e){var t=_slicedToArray(e.split(":"),2);return{hours:+t[0],minutes:+t[1]}}var pl=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,vl={},ml=/((?:[^GyMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,gl=function(){var e={Short:0,ShortGMT:1,Long:2,Extended:3};return e[e.Short]="Short",e[e.ShortGMT]="ShortGMT",e[e.Long]="Long",e[e.Extended]="Extended",e}(),yl=function(){var e={FullYear:0,Month:1,Date:2,Hours:3,Minutes:4,Seconds:5,FractionalSeconds:6,Day:7};return e[e.FullYear]="FullYear",e[e.Month]="Month",e[e.Date]="Date",e[e.Hours]="Hours",e[e.Minutes]="Minutes",e[e.Seconds]="Seconds",e[e.FractionalSeconds]="FractionalSeconds",e[e.Day]="Day",e}(),bl=function(){var e={DayPeriods:0,Days:1,Months:2,Eras:3};return e[e.DayPeriods]="DayPeriods",e[e.Days]="Days",e[e.Months]="Months",e[e.Eras]="Eras",e}();function kl(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,(function(e,n){return null!=t&&n in t?t[n]:e}))),e}function _l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i="";(e<0||a&&e<=0)&&(a?e=1-e:(e=-e,i=n));for(var o=String(e);o.length<t;)o="0"+o;return r&&(o=o.substr(o.length-t)),i+o}function wl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(i,o){var s,u=function(e,t){switch(e){case yl.FullYear:return t.getFullYear();case yl.Month:return t.getMonth();case yl.Date:return t.getDate();case yl.Hours:return t.getHours();case yl.Minutes:return t.getMinutes();case yl.Seconds:return t.getSeconds();case yl.FractionalSeconds:return t.getMilliseconds();case yl.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,i);if((n>0||u>-n)&&(u+=n),e===yl.Hours)0===u&&-12===n&&(u=12);else if(e===yl.FractionalSeconds)return s=t,_l(u,3).substr(0,s);var c=ll(o,ol.MinusSign);return _l(u,t,c,r,a)}}function Cl(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rl.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(a,i){return function(e,t,n,r,a,i){switch(n){case bl.Months:return function(e,t,n){var r=ru(e),a=fl([r[iu.MonthsFormat],r[iu.MonthsStandalone]],t);return fl(a,n)}(t,a,r)[e.getMonth()];case bl.Days:return function(e,t,n){var r=ru(e),a=fl([r[iu.DaysFormat],r[iu.DaysStandalone]],t);return fl(a,n)}(t,a,r)[e.getDay()];case bl.DayPeriods:var o=e.getHours(),s=e.getMinutes();if(i){var u,c=function(e){var t=ru(e);return hl(t),(t[iu.ExtraData][2]||[]).map((function(e){return"string"==typeof e?dl(e):[dl(e[0]),dl(e[1])]}))}(t),l=function(e,t,n){var r=ru(e);hl(r);var a=fl([r[iu.ExtraData][0],r[iu.ExtraData][1]],t)||[];return fl(a,n)||[]}(t,a,r);if(c.forEach((function(e,t){if(Array.isArray(e)){var n=e[0],r=n.hours,a=n.minutes,i=e[1],c=i.hours,h=i.minutes;o>=r&&s>=a&&(o<c||o===c&&s<h)&&(u=l[t])}else{var f=e.hours,d=e.minutes;f===o&&d===s&&(u=l[t])}})),u)return u}return function(e,t,n){var r=ru(e),a=fl([r[iu.DayPeriodsFormat],r[iu.DayPeriodsStandalone]],t);return fl(a,n)}(t,a,r)[o<12?0:1];case bl.Eras:return function(e,t){return fl(ru(e)[iu.Eras],t)}(t,r)[e.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(n))}}(a,i,e,t,n,r)}}function xl(e){return function(t,n,r){var a=-1*r,i=ll(n,ol.MinusSign),o=a>0?Math.floor(a/60):Math.ceil(a/60);switch(e){case gl.Short:return(a>=0?"+":"")+_l(o,2,i)+_l(Math.abs(a%60),2,i);case gl.ShortGMT:return"GMT"+(a>=0?"+":"")+_l(o,1,i);case gl.Long:return"GMT"+(a>=0?"+":"")+_l(o,2,i)+":"+_l(Math.abs(a%60),2,i);case gl.Extended:return 0===r?"Z":(a>=0?"+":"")+_l(o,2,i)+":"+_l(Math.abs(a%60),2,i);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function Sl(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,r){var a,i,o,s;if(t){var u=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,c=n.getDate();a=1+Math.floor((c+u)/7)}else{var l=(i=n.getFullYear(),o=new Date(i,0,1).getDay(),new Date(i,0,1+(o<=4?4:11)-o)),h=(s=n,new Date(s.getFullYear(),s.getMonth(),s.getDate()+(4-s.getDay()))).getTime()-l.getTime();a=1+Math.round(h/6048e5)}return _l(a,e,ll(r,ol.MinusSign))}}var Al={};function Il(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function Tl(e){return e instanceof Date&&!isNaN(e.valueOf())}var El,Rl,Nl,Ol,Dl=function e(){_classCallCheck(this,e)},Fl=((Rl=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).locale=e,r}return _createClass(n,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return ru(e)[iu.PluralCase]}(t||this.locale)(e)){case nl.Zero:return"zero";case nl.One:return"one";case nl.Two:return"two";case nl.Few:return"few";case nl.Many:return"many";default:return"other"}}}]),n}(Dl)).\u0275fac=function(e){return new(e||Rl)(Pt(Wu))},Rl.\u0275prov=Je({token:Rl,factory:Rl.\u0275fac}),Rl),Ml=((El=function(){function e(t,n,r,a){_classCallCheck(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=r,this._renderer=a,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachChangedItem((function(e){return t._toggleClass(e.key,e.currentValue)})),e.forEachRemovedItem((function(e){e.previousValue&&t._toggleClass(e.key,!1)}))}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem((function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(ut(e.item)));t._toggleClass(e.item,!0)})),e.forEachRemovedItem((function(e){return t._toggleClass(e.item,!1)}))}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!0)})):Object.keys(e).forEach((function(n){return t._toggleClass(n,!!e[n])})))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach((function(e){return t._toggleClass(e,!1)})):Object.keys(e).forEach((function(e){return t._toggleClass(e,!1)})))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach((function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)}))}},{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(so(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}}]),e}()).\u0275fac=function(e){return new(e||El)(go(Bs),go(Vs),go(_s),go(Ss))},El.\u0275dir=sn({type:El,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),El),Pl=function(){function e(t,n,r,a){_classCallCheck(this,e),this.$implicit=t,this.ngForOf=n,this.index=r,this.count=a}return _createClass(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),zl=((Nl=function(){function e(t,n,r){_classCallCheck(this,e),this._viewContainer=t,this._template=n,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return _createClass(e,[{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(r){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation((function(e,r,a){if(null==e.previousIndex){var i=t._viewContainer.createEmbeddedView(t._template,new Pl(null,t._ngForOf,-1,-1),null===a?void 0:a),o=new Ll(e,i);n.push(o)}else if(null==a)t._viewContainer.remove(null===r?void 0:r);else if(null!==r){var s=t._viewContainer.get(r);t._viewContainer.move(s,a);var u=new Ll(e,s);n.push(u)}}));for(var r=0;r<n.length;r++)this._perViewChange(n[r].view,n[r].record);for(var a=0,i=this._viewContainer.length;a<i;a++){var o=this._viewContainer.get(a);o.context.index=a,o.context.count=i,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange((function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item}))}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}},{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",set:function(e){zr()&&null!=e&&"function"!=typeof e&&console&&console.warn&&console.warn("trackBy must be a function, but received ".concat(JSON.stringify(e),". ")+"See https://angular.io/api/common/NgForOf#change-propagation for more information."),this._trackByFn=e},get:function(){return this._trackByFn}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||Nl)(go(qs),go(Hs),go(Bs))},Nl.\u0275dir=sn({type:Nl,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),Nl),Ll=function e(t,n){_classCallCheck(this,e),this.record=t,this.view=n},Bl=((Ol=function(){function e(t,n){_classCallCheck(this,e),this._viewContainer=t,this._context=new Vl,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return _createClass(e,[{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}},{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){Wl("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){Wl("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||Ol)(go(qs),go(Hs))},Ol.\u0275dir=sn({type:Ol,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),Ol),Vl=function e(){_classCallCheck(this,e),this.$implicit=null,this.ngIf=null};function Wl(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(ut(t),"'."))}var Ul,jl,Hl,Gl,ql,Kl,Xl,Zl,Yl=((Gl=function(){function e(t){_classCallCheck(this,e),this.locale=t}return _createClass(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return function(e,t,n,r){var a=function(e){if(Tl(e))return e;if("number"==typeof e&&!isNaN(e))return new Date(e);if("string"==typeof e){e=e.trim();var t,n=parseFloat(e);if(!isNaN(e-n))return new Date(n);if(/^(\d{4}-\d{1,2}-\d{1,2})$/.test(e)){var r=_slicedToArray(e.split("-").map((function(e){return+e})),3),a=r[0],i=r[1],o=r[2];return new Date(a,i-1,o)}if(t=e.match(pl))return function(e){var t=new Date(0),n=0,r=0,a=e[8]?t.setUTCFullYear:t.setFullYear,i=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),r=Number(e[9]+e[11])),a.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-r,u=Number(e[6]||0),c=Math.round(1e3*parseFloat("0."+(e[7]||0)));return i.call(t,o,s,u,c),t}(t)}var s=new Date(e);if(!Tl(s))throw new Error('Unable to convert "'.concat(e,'" into a date'));return s}(e);t=function e(t,n){var r=function(e){return ru(e)[iu.LocaleId]}(t);if(vl[r]=vl[r]||{},vl[r][n])return vl[r][n];var a="";switch(n){case"shortDate":a=sl(t,il.Short);break;case"mediumDate":a=sl(t,il.Medium);break;case"longDate":a=sl(t,il.Long);break;case"fullDate":a=sl(t,il.Full);break;case"shortTime":a=ul(t,il.Short);break;case"mediumTime":a=ul(t,il.Medium);break;case"longTime":a=ul(t,il.Long);break;case"fullTime":a=ul(t,il.Full);break;case"short":var i=e(t,"shortTime"),o=e(t,"shortDate");a=kl(cl(t,il.Short),[i,o]);break;case"medium":var s=e(t,"mediumTime"),u=e(t,"mediumDate");a=kl(cl(t,il.Medium),[s,u]);break;case"long":var c=e(t,"longTime"),l=e(t,"longDate");a=kl(cl(t,il.Long),[c,l]);break;case"full":var h=e(t,"fullTime"),f=e(t,"fullDate");a=kl(cl(t,il.Full),[h,f])}return a&&(vl[r][n]=a),a}(n,t)||t;for(var i,o=[];t;){if(!(i=ml.exec(t))){o.push(t);break}var s=(o=o.concat(i.slice(1))).pop();if(!s)break;t=s}var u=a.getTimezoneOffset();r&&(u=Il(r,u),a=function(e,t,n){var r=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(Il(t,r)-r))}(a,r));var c="";return o.forEach((function(e){var t=function(e){if(Al[e])return Al[e];var t;switch(e){case"G":case"GG":case"GGG":t=Cl(bl.Eras,al.Abbreviated);break;case"GGGG":t=Cl(bl.Eras,al.Wide);break;case"GGGGG":t=Cl(bl.Eras,al.Narrow);break;case"y":t=wl(yl.FullYear,1,0,!1,!0);break;case"yy":t=wl(yl.FullYear,2,0,!0,!0);break;case"yyy":t=wl(yl.FullYear,3,0,!1,!0);break;case"yyyy":t=wl(yl.FullYear,4,0,!1,!0);break;case"M":case"L":t=wl(yl.Month,1,1);break;case"MM":case"LL":t=wl(yl.Month,2,1);break;case"MMM":t=Cl(bl.Months,al.Abbreviated);break;case"MMMM":t=Cl(bl.Months,al.Wide);break;case"MMMMM":t=Cl(bl.Months,al.Narrow);break;case"LLL":t=Cl(bl.Months,al.Abbreviated,rl.Standalone);break;case"LLLL":t=Cl(bl.Months,al.Wide,rl.Standalone);break;case"LLLLL":t=Cl(bl.Months,al.Narrow,rl.Standalone);break;case"w":t=Sl(1);break;case"ww":t=Sl(2);break;case"W":t=Sl(1,!0);break;case"d":t=wl(yl.Date,1);break;case"dd":t=wl(yl.Date,2);break;case"E":case"EE":case"EEE":t=Cl(bl.Days,al.Abbreviated);break;case"EEEE":t=Cl(bl.Days,al.Wide);break;case"EEEEE":t=Cl(bl.Days,al.Narrow);break;case"EEEEEE":t=Cl(bl.Days,al.Short);break;case"a":case"aa":case"aaa":t=Cl(bl.DayPeriods,al.Abbreviated);break;case"aaaa":t=Cl(bl.DayPeriods,al.Wide);break;case"aaaaa":t=Cl(bl.DayPeriods,al.Narrow);break;case"b":case"bb":case"bbb":t=Cl(bl.DayPeriods,al.Abbreviated,rl.Standalone,!0);break;case"bbbb":t=Cl(bl.DayPeriods,al.Wide,rl.Standalone,!0);break;case"bbbbb":t=Cl(bl.DayPeriods,al.Narrow,rl.Standalone,!0);break;case"B":case"BB":case"BBB":t=Cl(bl.DayPeriods,al.Abbreviated,rl.Format,!0);break;case"BBBB":t=Cl(bl.DayPeriods,al.Wide,rl.Format,!0);break;case"BBBBB":t=Cl(bl.DayPeriods,al.Narrow,rl.Format,!0);break;case"h":t=wl(yl.Hours,1,-12);break;case"hh":t=wl(yl.Hours,2,-12);break;case"H":t=wl(yl.Hours,1);break;case"HH":t=wl(yl.Hours,2);break;case"m":t=wl(yl.Minutes,1);break;case"mm":t=wl(yl.Minutes,2);break;case"s":t=wl(yl.Seconds,1);break;case"ss":t=wl(yl.Seconds,2);break;case"S":t=wl(yl.FractionalSeconds,1);break;case"SS":t=wl(yl.FractionalSeconds,2);break;case"SSS":t=wl(yl.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=xl(gl.Short);break;case"ZZZZZ":t=xl(gl.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=xl(gl.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=xl(gl.Long);break;default:return null}return Al[e]=t,t}(e);c+=t?t(a,n,u):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")})),c}(t,n,a||this.locale,r)}catch(i){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(ut(e),"'"))}(e,i.message)}}}]),e}()).\u0275fac=function(e){return new(e||Gl)(go(Wu))},Gl.\u0275pipe={type:(Hl={name:"date",type:Gl,pure:!0}).type,name:Hl.name,factory:null,pure:!1!==Hl.pure,onDestroy:Hl.type.prototype.ngOnDestroy||null},Gl),$l=((jl=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:jl}),jl.\u0275inj=Qe({factory:function(e){return new(e||jl)},providers:[{provide:Dl,useClass:Fl}]}),jl),Jl=((Ul=function e(){_classCallCheck(this,e)}).\u0275prov=Je({token:Ul,providedIn:"root",factory:function(){return new Ql(Pt(Dc),window,Pt(Dr))}}),Ul),Ql=function(){function e(t,n,r){_classCallCheck(this,e),this.document=t,this.window=n,this.errorHandler=r,this.offset=function(){return[0,0]}}return _createClass(e,[{key:"setOffset",value:function(e){this.offset=Array.isArray(e)?function(){return e}:e}},{key:"getScrollPosition",value:function(){return this.supportScrollRestoration()?[this.window.scrollX,this.window.scrollY]:[0,0]}},{key:"scrollToPosition",value:function(e){this.supportScrollRestoration()&&this.window.scrollTo(e[0],e[1])}},{key:"scrollToAnchor",value:function(e){if(this.supportScrollRestoration()){e=this.window.CSS&&this.window.CSS.escape?this.window.CSS.escape(e):e.replace(/(\"|\'\ |:|\.|\[|\]|,|=)/g,"\\$1");try{var t=this.document.querySelector("#".concat(e));if(t)return void this.scrollToElement(t);var n=this.document.querySelector("[name='".concat(e,"']"));if(n)return void this.scrollToElement(n)}catch(r){this.errorHandler.handleError(r)}}}},{key:"setHistoryScrollRestoration",value:function(e){if(this.supportScrollRestoration()){var t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}},{key:"scrollToElement",value:function(e){var t=e.getBoundingClientRect(),n=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(n-a[0],r-a[1])}},{key:"supportScrollRestoration",value:function(){try{return!!this.window&&!!this.window.scrollTo}catch(e){return!1}}}]),e}(),eh=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=th||(th=document.querySelector("base"))?th.getAttribute("href"):null;return null==n?null:(t=n,ql||(ql=document.createElement("a")),ql.setAttribute("href",t),"/"===ql.pathname.charAt(0)?ql.pathname:"/"+ql.pathname)}},{key:"resetBaseElement",value:function(){th=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(e){return function(e,t){t=encodeURIComponent(t);var n,r=_createForOfIteratorHelper(e.split(";"));try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.indexOf("="),o=_slicedToArray(-1==i?[a,""]:[a.slice(0,i),a.slice(i+1)],2),s=o[0],u=o[1];if(s.trim()===t)return decodeURIComponent(u)}}catch(c){r.e(c)}finally{r.f()}return null}(document.cookie,e)}}],[{key:"makeCurrent",value:function(){var e;e=new n,Rc||(Rc=e)}}]),n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.call(this)}return _createClass(n,[{key:"supportsDOMEvents",value:function(){return!0}}]),n}(function(){return function e(){_classCallCheck(this,e)}}())),th=null,nh=new It("TRANSITION_ID"),rh=[{provide:Ou,useFactory:function(e,t,n){return function(){n.get(Du).donePromise.then((function(){var n=Nc();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter((function(t){return t.getAttribute("ng-transition")===e})).forEach((function(e){return n.remove(e)}))}))}},deps:[nh,Dc,$i],multi:!0}],ah=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"addToWindow",value:function(e){bt.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.findTestabilityInTree(t,n);if(null==r)throw new Error("Could not find testability for element.");return r},bt.getAllAngularTestabilities=function(){return e.getAllTestabilities()},bt.getAllAngularRootElements=function(){return e.getAllRootElements()},bt.frameworkStabilizers||(bt.frameworkStabilizers=[]),bt.frameworkStabilizers.push((function(e){var t=bt.getAllAngularTestabilities(),n=t.length,r=!1,a=function(t){r=r||t,0==--n&&e(r)};t.forEach((function(e){e.whenStable(a)}))}))}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var r=e.getTestability(t);return null!=r?r:n?Nc().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,hc=t}}]),e}(),ih=new It("EventManagerPlugins"),oh=((Kl=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach((function(e){return e.manager=r})),this._plugins=t.slice().reverse()}return _createClass(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,r=0;r<n.length;r++){var a=n[r];if(a.supports(e))return this._eventNameToPlugin.set(e,a),a}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||Kl)(Pt(ih),Pt(ec))},Kl.\u0275prov=Je({token:Kl,factory:Kl.\u0275fac}),Kl),sh=function(){function e(t){_classCallCheck(this,e),this._doc=t}return _createClass(e,[{key:"addGlobalEventListener",value:function(e,t,n){var r=Nc().getGlobalEventTarget(this._doc,e);if(!r)throw new Error("Unsupported event target ".concat(r," for event ").concat(t));return this.addEventListener(r,t,n)}}]),e}(),uh=((Zl=function(){function e(){_classCallCheck(this,e),this._stylesSet=new Set}return _createClass(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach((function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))})),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||Zl)},Zl.\u0275prov=Je({token:Zl,factory:Zl.\u0275fac}),Zl),ch=((Xl=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._doc=e,r._hostNodes=new Set,r._styleNodes=new Set,r._hostNodes.add(e.head),r}return _createClass(n,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach((function(e){var r=n._doc.createElement("style");r.textContent=e,n._styleNodes.add(t.appendChild(r))}))}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach((function(n){return t._addStylesToHost(e,n)}))}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach((function(e){return Nc().remove(e)}))}}]),n}(uh)).\u0275fac=function(e){return new(e||Xl)(Pt(Dc))},Xl.\u0275prov=Je({token:Xl,factory:Xl.\u0275fac}),Xl),lh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},hh=/%COMP%/g;function fh(e,t,n){for(var r=0;r<t.length;r++){var a=t[r];Array.isArray(a)?fh(e,a,n):(a=a.replace(hh,e),n.push(a))}return n}function dh(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var ph,vh,mh,gh,yh=((ph=function(){function e(t,n,r){_classCallCheck(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new bh(t)}return _createClass(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Yt.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new kh(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case Yt.Native:case Yt.ShadowDom:return new _h(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var r=fh(t.id,t.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ph)(Pt(oh),Pt(ch),Pt(Fu))},ph.\u0275prov=Je({token:ph,factory:ph.\u0275fac}),ph),bh=function(){function e(t){_classCallCheck(this,e),this.eventManager=t,this.data=Object.create(null)}return _createClass(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(lh[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,r){if(r){t=r+":"+t;var a=lh[r];a?e.setAttributeNS(a,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var r=lh[n];r?e.removeAttributeNS(r,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,r){r&xs.DashCase?e.style.setProperty(t,n,r&xs.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&xs.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,dh(n)):this.eventManager.addEventListener(e,t,dh(n))}}]),e}(),kh=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this,e)).component=a;var s,u=fh(i+"-"+a.id,a.styles,[]);return r.addStyles(u),o.contentAttr="_ngcontent-%COMP%".replace(hh,i+"-"+a.id),o.hostAttr=(s=i+"-"+a.id,"_nghost-%COMP%".replace(hh,s)),o}return _createClass(n,[{key:"applyToHost",value:function(e){_get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var r=_get(_getPrototypeOf(n.prototype),"createElement",this).call(this,e,t);return _get(_getPrototypeOf(n.prototype),"setAttribute",this).call(this,r,this.contentAttr,""),r}}]),n}(bh),_h=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;_classCallCheck(this,n),(o=t.call(this,e)).sharedStylesHost=r,o.hostEl=a,o.component=i,o.shadowRoot=i.encapsulation===Yt.ShadowDom?a.attachShadow({mode:"open"}):a.createShadowRoot(),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=fh(i.id,i.styles,[]),u=0;u<s.length;u++){var c=document.createElement("style");c.textContent=s[u],o.shadowRoot.appendChild(c)}return o}return _createClass(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,r){return _get(_getPrototypeOf(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,r)}},{key:"removeChild",value:function(e,t){return _get(_getPrototypeOf(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(_get(_getPrototypeOf(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(bh),wh=((vh=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var r=this;return e.addEventListener(t,n,!1),function(){return r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(sh)).\u0275fac=function(e){return new(e||vh)(Pt(Dc))},vh.\u0275prov=Je({token:vh,factory:vh.\u0275fac}),vh),Ch=["alt","control","meta","shift"],xh={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sh={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Ah={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},Ih=((mh=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,r){var a=n.parseEventName(t),i=n.eventCallback(a.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular((function(){return Nc().onAndCancel(e,a.domEventName,i)}))}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),r=t.shift();if(0===t.length||"keydown"!==r&&"keyup"!==r)return null;var a=n._normalizeKey(t.pop()),i="";if(Ch.forEach((function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),i+=e+".")})),i+=a,0!=t.length||0===a.length)return null;var o={};return o.domEventName=r,o.fullKey=i,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&Sh.hasOwnProperty(t)&&(t=Sh[t]))}return xh[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),Ch.forEach((function(r){r!=n&&(0,Ah[r])(e)&&(t+=r+".")})),t+=n}},{key:"eventCallback",value:function(e,t,r){return function(a){n.getEventFullKey(a)===e&&r.runGuarded((function(){return t(a)}))}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(sh)).\u0275fac=function(e){return new(e||mh)(Pt(Dc))},mh.\u0275prov=Je({token:mh,factory:mh.\u0275fac}),mh),Th=vc(Ic,"browser",[{provide:Lu,useValue:"browser"},{provide:zu,useValue:function(){eh.makeCurrent(),ah.init()},multi:!0},{provide:Dc,useFactory:function(){return function(e){Jn=e}(document),document},deps:[]}]),Eh=[[],{provide:zi,useValue:"root"},{provide:Dr,useFactory:function(){return new Dr},deps:[]},{provide:ih,useClass:wh,multi:!0,deps:[Dc,ec,Lu]},{provide:ih,useClass:Ih,multi:!0,deps:[Dc]},[],{provide:yh,useClass:yh,deps:[oh,ch,Fu]},{provide:Cs,useExisting:yh},{provide:uh,useExisting:ch},{provide:ch,useClass:ch,deps:[Dc]},{provide:cc,useClass:cc,deps:[ec]},{provide:oh,useClass:oh,deps:[ih,ec]},[]],Rh=((gh=function(){function e(t){if(_classCallCheck(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return _createClass(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Fu,useValue:t.appId},{provide:nh,useExisting:Fu},rh]}}}]),e}()).\u0275mod=an({type:gh}),gh.\u0275inj=Qe({factory:function(e){return new(e||gh)(Pt(gh,12))},providers:Eh,imports:[$l,Ec]}),gh);function Nh(e,t){return new se((function(n){var r=e.length;if(0!==r)for(var a=new Array(r),i=0,o=0,s=function(s){var u=Te(e[s]),c=!1;n.add(u.subscribe({next:function(e){c||(c=!0,o++),a[s]=e},error:function(e){return n.error(e)},complete:function(){++i!==r&&c||(o===r&&n.next(t?t.reduce((function(e,t,n){return e[t]=a[n],e}),{}):a),n.complete())}}))},u=0;u<r;u++)s(u);else n.complete()}))}"undefined"!=typeof window&&window;var Oh,Dh,Fh,Mh,Ph=((Dh=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}},{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}}]),e}()).\u0275fac=function(e){return new(e||Dh)},Dh.\u0275dir=sn({type:Dh}),Dh),zh=((Oh=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(Ph)).\u0275fac=function(e){return Lh(e||Oh)},Oh.\u0275dir=sn({type:Oh,features:[ts]}),Oh),Lh=(Fh=zh,je((function(){var e=Object.getPrototypeOf(Fh.prototype).constructor,t=e[St]||function e(t){var n=t;if(dt(t))return function(){var t=e(ft(n));return t?t():null};var r=cn(n);if(null===r){var a=nt(n);r=a&&a.factory}return r||null}(e);return null!==t?t:function(e){return new e}}))),Bh=((Mh=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return n}(function(){function e(t){_classCallCheck(this,e),this._cd=t}return _createClass(e,[{key:"ngClassUntouched",get:function(){return!!this._cd.control&&this._cd.control.untouched}},{key:"ngClassTouched",get:function(){return!!this._cd.control&&this._cd.control.touched}},{key:"ngClassPristine",get:function(){return!!this._cd.control&&this._cd.control.pristine}},{key:"ngClassDirty",get:function(){return!!this._cd.control&&this._cd.control.dirty}},{key:"ngClassValid",get:function(){return!!this._cd.control&&this._cd.control.valid}},{key:"ngClassInvalid",get:function(){return!!this._cd.control&&this._cd.control.invalid}},{key:"ngClassPending",get:function(){return!!this._cd.control&&this._cd.control.pending}}]),e}())).\u0275fac=function(e){return new(e||Mh)(go(zh,2))},Mh.\u0275dir=sn({type:Mh,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&Bo("ng-untouched",t.ngClassUntouched)("ng-touched",t.ngClassTouched)("ng-pristine",t.ngClassPristine)("ng-dirty",t.ngClassDirty)("ng-valid",t.ngClassValid)("ng-invalid",t.ngClassInvalid)("ng-pending",t.ngClassPending)},features:[ts]}),Mh);function Vh(e){return null==e||0===e.length}var Wh=new It("NgValidators"),Uh=new It("NgAsyncValidators"),jh=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Hh=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"min",value:function(e){return function(t){if(Vh(t.value)||Vh(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n<e?{min:{min:e,actual:t.value}}:null}}},{key:"max",value:function(e){return function(t){if(Vh(t.value)||Vh(e))return null;var n=parseFloat(t.value);return!isNaN(n)&&n>e?{max:{max:e,actual:t.value}}:null}}},{key:"required",value:function(e){return Vh(e.value)?{required:!0}:null}},{key:"requiredTrue",value:function(e){return!0===e.value?null:{required:!0}}},{key:"email",value:function(e){return Vh(e.value)?null:jh.test(e.value)?null:{email:!0}}},{key:"minLength",value:function(e){return function(t){if(Vh(t.value))return null;var n=t.value?t.value.length:0;return n<e?{minlength:{requiredLength:e,actualLength:n}}:null}}},{key:"maxLength",value:function(e){return function(t){var n=t.value?t.value.length:0;return n>e?{maxlength:{requiredLength:e,actualLength:n}}:null}}},{key:"pattern",value:function(t){return t?("string"==typeof t?(r="","^"!==t.charAt(0)&&(r+="^"),r+=t,"$"!==t.charAt(t.length-1)&&(r+="$"),n=new RegExp(r)):(r=t.toString(),n=t),function(e){if(Vh(e.value))return null;var t=e.value;return n.test(t)?null:{pattern:{requiredPattern:r,actualValue:t}}}):e.nullValidator;var n,r}},{key:"nullValidator",value:function(e){return null}},{key:"compose",value:function(e){if(!e)return null;var t=e.filter(Gh);return 0==t.length?null:function(e){return Kh(function(e,t){return t.map((function(t){return t(e)}))}(e,t))}}},{key:"composeAsync",value:function(e){if(!e)return null;var t=e.filter(Gh);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var r=t[0];if(K(r))return Nh(r,null);if(X(r)&&Object.getPrototypeOf(r)===Object.prototype){var a=Object.keys(r);return Nh(a.map((function(e){return r[e]})),a)}}if("function"==typeof t[t.length-1]){var i=t.pop();return Nh(t=1===t.length&&K(t[0])?t[0]:t,null).pipe(xe((function(e){return i.apply(void 0,_toConsumableArray(e))})))}return Nh(t,null)}(function(e,t){return t.map((function(t){return t(e)}))}(e,t).map(qh)).pipe(xe(Kh))}}}]),e}();function Gh(e){return null!=e}function qh(e){var t=xo(e)?Te(e):e;if(!So(t))throw new Error("Expected validator to return Promise or Observable.");return t}function Kh(e){var t={};return e.forEach((function(e){t=null!=e?Object.assign(Object.assign({},t),e):t})),0===Object.keys(t).length?null:t}function Xh(e){return e.validate?function(t){return e.validate(t)}:e}function Zh(e){return e.validate?function(t){return e.validate(t)}:e}var Yh,$h=((Yh=function(){function e(){_classCallCheck(this,e),this._accessors=[]}return _createClass(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach((function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)}))}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}()).\u0275fac=function(e){return new(e||Yh)},Yh.\u0275prov=Je({token:Yh,factory:Yh.\u0275fac}),Yh);function Jh(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function Qh(e,t){var n;throw n=e.path.length>1?"path: '".concat(e.path.join(" -> "),"'"):e.path[0]?"name: '".concat(e.path,"'"):"unspecified name attribute",new Error("".concat(t," ").concat(n))}function ef(e){return null!=e?Hh.compose(e.map(Xh)):null}function tf(e){return null!=e?Hh.composeAsync(e.map(Zh)):null}function nf(e){var t=af(e)?e.validators:e;return Array.isArray(t)?ef(t):t||null}function rf(e,t){var n=af(t)?t.asyncValidators:e;return Array.isArray(n)?tf(n):n||null}function af(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var of,sf,uf,cf,lf=function(){function e(t,n){_classCallCheck(this,e),this.validator=t,this.asyncValidator=n,this._onCollectionChange=function(){},this.pristine=!0,this.touched=!1,this._onDisabledChange=[]}return _createClass(e,[{key:"setValidators",value:function(e){this.validator=nf(e)}},{key:"setAsyncValidators",value:function(e){this.asyncValidator=rf(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild((function(e){return e.markAllAsTouched()}))}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild((function(e){e.markAsUntouched({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild((function(e){e.markAsPristine({onlySelf:!0})})),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild((function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!0)}))}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild((function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach((function(e){return e(!1)}))}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild((function(t){return t._updateTreeValidity(e)})),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING";var n=qh(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe((function(n){return t.setErrors(n,{emitEvent:e})}))}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&this._asyncValidationSubscription.unsubscribe()}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;var r=e;return t.forEach((function(e){r=r instanceof ff?r.controls.hasOwnProperty(e)?r.controls[e]:null:r instanceof df&&r.at(e)||null})),r}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new du,this.statusChanges=new du}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls((function(t){return t.status===e}))}},{key:"_anyControlsDirty",value:function(){return this._anyControls((function(e){return e.dirty}))}},{key:"_anyControlsTouched",value:function(){return this._anyControls((function(e){return e.touched}))}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){af(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&this._parent&&this._parent.dirty&&!this._parent._anyControlsDirty()}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}}]),e}(),hf=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,n),(e=t.call(this,nf(a),rf(i,a)))._onChange=[],e._applyFormState(r),e._setUpdateStrategy(a),e.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),e._initObservables(),e}return _createClass(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach((function(e){return e(t.value,!1!==n.emitViewToModelChange)})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_clearChangeFns",value:function(){this._onChange=[],this._onDisabledChange=[],this._onCollectionChange=function(){}}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(lf),ff=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,nf(r),rf(a,r))).controls=e,i._initObservables(),i._setUpdateStrategy(r),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _createClass(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach((function(r){t._throwIfControlMissing(r),t.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.keys(e).forEach((function(r){t.controls[r]&&t.controls[r].patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},(function(e,t,n){return e[n]=t instanceof hf?t.value:t.getRawValue(),e}))}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,(function(e,t){return!!t._syncPendingControls()||e}));return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach((function(n){return e(t.controls[n],n)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)}))}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){var t=this,n=!1;return this._forEachChild((function(r,a){n=n||t.contains(a)&&e(r)})),n}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},(function(t,n,r){return(n.enabled||e.disabled)&&(t[r]=n.value),t}))}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild((function(e,r){n=t(n,e,r)})),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))}))}}]),n}(lf),df=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,nf(r),rf(a,r))).controls=e,i._initObservables(),i._setUpdateStrategy(r),i._setUpControls(),i.updateValueAndValidity({onlySelf:!0,emitEvent:!1}),i}return _createClass(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange((function(){})),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach((function(e,r){t._throwIfControlMissing(r),t.at(r).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((function(e,r){t.at(r)&&t.at(r).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})})),this.updateValueAndValidity(n)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild((function(n,r){n.reset(e[r],{onlySelf:!0,emitEvent:t.emitEvent})})),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map((function(e){return e instanceof hf?e.value:e.getRawValue()}))}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild((function(e){return e._registerOnCollectionChange((function(){}))})),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce((function(e,t){return!!t._syncPendingControls()||e}),!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet.  If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach((function(t,n){e(t,n)}))}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter((function(t){return t.enabled||e.disabled})).map((function(e){return e.value}))}},{key:"_anyControls",value:function(e){return this.controls.some((function(t){return t.enabled&&e(t)}))}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild((function(t){return e._registerControl(t)}))}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild((function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))}))}},{key:"_allControlsDisabled",value:function(){var e,t=_createForOfIteratorHelper(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}},{key:"length",get:function(){return this.controls.length}}]),n}(lf),pf={provide:zh,useExisting:ht((function(){return mf}))},vf=Promise.resolve(null),mf=((cf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).submitted=!1,a._directives=[],a.ngSubmit=new du,a.form=new ff({},ef(e),tf(r)),a}return _createClass(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"addControl",value:function(e){var t=this;vf.then((function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),function(e,t){e||Qh(t,"Cannot find control with"),t.valueAccessor||Qh(t,"No value accessor for form control with"),e.validator=Hh.compose([e.validator,t.validator]),e.asyncValidator=Hh.composeAsync([e.asyncValidator,t.asyncValidator]),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange((function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&Jh(e,t)}))}(e,t),function(e,t){e.registerOnChange((function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)}))}(e,t),function(e,t){t.valueAccessor.registerOnTouched((function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&Jh(e,t),"submit"!==e.updateOn&&e.markAsTouched()}))}(e,t),t.valueAccessor.setDisabledState&&e.registerOnDisabledChange((function(e){t.valueAccessor.setDisabledState(e)})),t._rawValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))})),t._rawAsyncValidators.forEach((function(t){t.registerOnValidatorChange&&t.registerOnValidatorChange((function(){return e.updateValueAndValidity()}))}))}(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)}))}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;vf.then((function(){var n,r,a,i=t._findContainer(e.path);i&&i.removeControl(e.name),n=t._directives,r=e,(a=n.indexOf(r))>-1&&n.splice(a,1)}))}},{key:"addFormGroup",value:function(e){var t=this;vf.then((function(){var n=t._findContainer(e.path),r=new ff({});(function(e,t){null==e&&Qh(t,"Cannot find control with"),e.validator=Hh.compose([e.validator,t.validator]),e.asyncValidator=Hh.composeAsync([e.asyncValidator,t.asyncValidator])})(r,e),n.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})}))}},{key:"removeFormGroup",value:function(e){var t=this;vf.then((function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)}))}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;vf.then((function(){n.form.get(e.path).setValue(t)}))}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach((function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)})),this.ngSubmit.emit(e),!1;var t}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}}]),n}(zh)).\u0275fac=function(e){return new(e||cf)(go(Wh,10),go(Uh,10))},cf.\u0275dir=sn({type:cf,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&Ao("submit",(function(e){return t.onSubmit(e)}))("reset",(function(){return t.onReset()}))},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[gs([pf]),ts]}),cf),gf=((uf=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||uf)},uf.\u0275dir=sn({type:uf,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),uf),yf=((sf=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:sf}),sf.\u0275inj=Qe({factory:function(e){return new(e||sf)}}),sf),bf=((of=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:of}),of.\u0275inj=Qe({factory:function(e){return new(e||of)},providers:[$h],imports:[yf]}),of),kf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this))._value=e,r}return _createClass(n,[{key:"_subscribe",value:function(e){var t=_get(_getPrototypeOf(n.prototype),"_subscribe",this).call(this,e);return t&&!t.closed&&e.next(this._value),t}},{key:"getValue",value:function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new le;return this._value}},{key:"next",value:function(e){_get(_getPrototypeOf(n.prototype),"next",this).call(this,this._value=e)}},{key:"value",get:function(){return this.getValue()}}]),n}(de),_f={},wf=function(){function e(t){_classCallCheck(this,e),this.resultSelector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Cf(e,this.resultSelector))}}]),e}(),Cf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).resultSelector=r,a.active=0,a.values=[],a.observables=[],a}return _createClass(n,[{key:"_next",value:function(e){this.values.push(_f),this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{this.active=t,this.toRespond=t;for(var n=0;n<t;n++){var r=e[n];this.add(we(this,r,r,n))}}}},{key:"notifyComplete",value:function(e){0==(this.active-=1)&&this.destination.complete()}},{key:"notifyNext",value:function(e,t,n,r,a){var i=this.values,o=this.toRespond?i[n]===_f?--this.toRespond:this.toRespond:0;i[n]=t,0===o&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))}},{key:"_tryResultSelector",value:function(e){var t;try{t=this.resultSelector.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(Ce),xf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e,r)).scheduler=e,a.work=r,a.pending=!1,a}return _createClass(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n=!1,r=void 0;try{this.work(e)}catch(a){n=!0,r=!!a&&a||new Error(a)}if(n)return this.unsubscribe(),r}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),n}(function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){return _classCallCheck(this,n),t.call(this)}return _createClass(n,[{key:"schedule",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this}}]),n}($)),Sf=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;_classCallCheck(this,e),this.SchedulerAction=t,this.now=n}return _createClass(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Af=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Sf.now;return _classCallCheck(this,n),(r=t.call(this,e,(function(){return n.delegate&&n.delegate!==_assertThisInitialized(r)?n.delegate.now():a()}))).actions=[],r.active=!1,r.scheduled=void 0,r}return _createClass(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,r):_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,e,t,r)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(Sf),If=new Af(xf);function Tf(e){return!K(e)&&e-parseFloat(e)+1>=0}function Ef(e){var t=e.index,n=e.period,r=e.subscriber;if(r.next(t),!r.closed){if(-1===n)return r.complete();e.index=t+1,this.schedule(e,n)}}function Rf(e,t,n,r){return U(n)&&(r=n,n=void 0),r?Rf(e,t,n).pipe(xe((function(e){return K(e)?r.apply(void 0,_toConsumableArray(e)):r(e)}))):new se((function(r){!function e(t,n,r,a,i){var o;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(t)){var s=t;t.addEventListener(n,r,i),o=function(){return s.removeEventListener(n,r,i)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(t)){var u=t;t.on(n,r),o=function(){return u.off(n,r)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(t)){var c=t;t.addListener(n,r),o=function(){return c.removeListener(n,r)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var l=0,h=t.length;l<h;l++)e(t[l],n,r,a,i)}a.add(o)}(e,t,(function(e){r.next(arguments.length>1?Array.prototype.slice.call(arguments):e)}),r,n)}))}var Nf=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Of(e))}}]),e}(),Of=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).hasFirst=!1,r.observables=[],r.subscriptions=[],r}return _createClass(n,[{key:"_next",value:function(e){this.observables.push(e)}},{key:"_complete",value:function(){var e=this.observables,t=e.length;if(0===t)this.destination.complete();else{for(var n=0;n<t&&!this.hasFirst;n++){var r=e[n],a=we(this,r,r,n);this.subscriptions&&this.subscriptions.push(a),this.add(a)}this.observables=null}}},{key:"notifyNext",value:function(e,t,n,r,a){if(!this.hasFirst){this.hasFirst=!0;for(var i=0;i<this.subscriptions.length;i++)if(i!==n){var o=this.subscriptions[i];o.unsubscribe(),this.remove(o)}this.subscriptions=null}this.destination.next(t)}}]),n}(Ce);function Df(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];return ve(r)?(t.pop(),Ie(t,r)):Fe(t)}function Ff(){return De(1)}function Mf(){return Ff()(Df.apply(void 0,arguments))}function Pf(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[t.length-1];return ve(r)?(t.pop(),function(e){return Mf(t,e,r)}):function(e){return Mf(t,e)}}function zf(e,t){return"function"==typeof t?function(n){return n.pipe(zf((function(n,r){return Te(e(n,r)).pipe(xe((function(e,a){return t(n,e,r,a)})))})))}:function(t){return t.lift(new Lf(e))}}var Lf=function(){function e(t){_classCallCheck(this,e),this.project=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Bf(e,this.project))}}]),e}(),Bf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).project=r,a.index=0,a}return _createClass(n,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(r){return void this.destination.error(r)}this._innerSub(t,e,n)}},{key:"_innerSub",value:function(e,t,n){var r=this.innerSubscription;r&&r.unsubscribe();var a=new me(this,t,n),i=this.destination;i.add(a),this.innerSubscription=we(this,e,void 0,void 0,a),this.innerSubscription!==a&&i.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||_get(_getPrototypeOf(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=null}},{key:"notifyComplete",value:function(e){this.destination.remove(e),this.innerSubscription=null,this.isStopped&&_get(_getPrototypeOf(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e,t,n,r,a){this.destination.next(t)}}]),n}(Ce);function Vf(e){return function(t){return t.lift(new Wf(e))}}var Wf=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){var n=new Uf(e),r=we(n,this.notifier);return r&&!n.seenValue?(n.add(r),t.subscribe(n)):n}}]),e}(),Uf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).seenValue=!1,r}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,a){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),n}(Ce);function jf(e,t){return function(n){return n.lift(new Hf(e,t))}}var Hf=function(){function e(t,n){_classCallCheck(this,e),this.predicate=t,this.thisArg=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Gf(e,this.predicate,this.thisArg))}}]),e}(),Gf=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).predicate=r,i.thisArg=a,i.count=0,i}return _createClass(n,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),n}(ee),qf=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}(),Kf=new se((function(e){return e.complete()}));function Xf(e){return e?function(e){return new se((function(t){return e.schedule((function(){return t.complete()}))}))}(e):Kf}function Zf(e){return function(t){return 0===e?Xf():t.lift(new Yf(e))}}var Yf=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new qf}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new $f(e,this.total))}}]),e}(),$f=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),n}(ee);function Jf(e,t,n){return function(r){return r.lift(new Qf(e,t,n))}}var Qf=function(){function e(t,n,r){_classCallCheck(this,e),this.nextOrObserver=t,this.error=n,this.complete=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ed(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),ed=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e))._tapNext=re,o._tapError=re,o._tapComplete=re,o._tapError=a||re,o._tapComplete=i||re,U(r)?(o._context=_assertThisInitialized(o),o._tapNext=r):r&&(o._context=r,o._tapNext=r.next||re,o._tapError=r.error||re,o._tapComplete=r.complete||re),o}return _createClass(n,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),n}(ee);function td(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n;return"function"==typeof t[t.length-1]&&(n=t.pop()),e.lift(new rd(t,n))}}var nd,rd=function(){function e(t,n){_classCallCheck(this,e),this.observables=t,this.project=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ad(e,this.observables,this.project))}}]),e}(),ad=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;_classCallCheck(this,n),(i=t.call(this,e)).observables=r,i.project=a,i.toRespond=[];var o=r.length;i.values=new Array(o);for(var s=0;s<o;s++)i.toRespond.push(s);for(var u=0;u<o;u++){var c=r[u];i.add(we(_assertThisInitialized(i),c,c,u))}return i}return _createClass(n,[{key:"notifyNext",value:function(e,t,n,r,a){this.values[n]=t;var i=this.toRespond;if(i.length>0){var o=i.indexOf(n);-1!==o&&i.splice(o,1)}}},{key:"notifyComplete",value:function(){}},{key:"_next",value:function(e){if(0===this.toRespond.length){var t=[e].concat(_toConsumableArray(this.values));this.project?this._tryProject(t):this.destination.next(t)}}},{key:"_tryProject",value:function(e){var t;try{t=this.project.apply(this,e)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(Ce),id=((nd=function(){function e(t,n,r){_classCallCheck(this,e),this.kind=t,this.value=n,this.error=r,this.hasValue="N"===t}return _createClass(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return Df(this.value);case"E":return e=this.error,new se((function(t){return t.error(e)}));case"C":return Xf()}var e;throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new nd("C"),nd.undefinedValueNotification=new nd("N",void 0),nd);function od(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:If,r=(t=e)instanceof Date&&!isNaN(+t)?+e-n.now():Math.abs(e);return function(e){return e.lift(new sd(r,n))}}var sd=function(){function e(t,n){_classCallCheck(this,e),this.delay=t,this.scheduler=n}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new ud(e,this.delay,this.scheduler))}}]),e}(),ud=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).delay=r,i.scheduler=a,i.queue=[],i.active=!1,i.errored=!1,i}return _createClass(n,[{key:"_schedule",value:function(e){this.active=!0,this.destination.add(e.schedule(n.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}},{key:"scheduleNotification",value:function(e){if(!0!==this.errored){var t=this.scheduler,n=new cd(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}}},{key:"_next",value:function(e){this.scheduleNotification(id.createNext(e))}},{key:"_error",value:function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleNotification(id.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){for(var t=e.source,n=t.queue,r=e.scheduler,a=e.destination;n.length>0&&n[0].time-r.now()<=0;)n.shift().notification.observe(a);if(n.length>0){var i=Math.max(0,n[0].time-r.now());this.schedule(e,i)}else this.unsubscribe(),t.active=!1}}]),n}(ee),cd=function e(t,n){_classCallCheck(this,e),this.time=t,this.notification=n};$localize(_templateObject());var ld=["*"];$localize(_templateObject2()),$localize(_templateObject3()),$localize(_templateObject4()),$localize(_templateObject5()),$localize(_templateObject6()),$localize(_templateObject7()),$localize(_templateObject8()),$localize(_templateObject9()),$localize(_templateObject10()),$localize(_templateObject11());var hd=["dialog"];function fd(e){return null!=e}$localize(_templateObject12()),$localize(_templateObject13()),$localize(_templateObject14()),$localize(_templateObject15()),$localize(_templateObject16()),$localize(_templateObject17()),$localize(_templateObject18()),$localize(_templateObject19()),$localize(_templateObject20(),"\ufffd0\ufffd"),$localize(_templateObject21()),$localize(_templateObject22()),$localize(_templateObject23()),$localize(_templateObject24()),$localize(_templateObject25()),$localize(_templateObject26()),$localize(_templateObject27()),$localize(_templateObject28()),$localize(_templateObject29()),$localize(_templateObject30()),$localize(_templateObject31()),$localize(_templateObject32()),$localize(_templateObject33(),"\ufffd0\ufffd"),$localize(_templateObject34(),"\ufffd0\ufffd"),$localize(_templateObject35()),"undefined"==typeof Element||Element.prototype.closest||(Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector),Element.prototype.closest=function(e){var t=this;if(!document.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null});var dd,pd,vd,md,gd,yd=((gd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:gd}),gd.\u0275inj=Qe({factory:function(e){return new(e||gd)},imports:[[$l]]}),gd),bd=((md=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:md}),md.\u0275inj=Qe({factory:function(e){return new(e||md)},imports:[[$l]]}),md),kd=((vd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:vd}),vd.\u0275inj=Qe({factory:function(e){return new(e||vd)}}),vd),_d=((pd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:pd}),pd.\u0275inj=Qe({factory:function(e){return new(e||pd)},imports:[[$l]]}),pd),wd=((dd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:dd}),dd.\u0275inj=Qe({factory:function(e){return new(e||dd)}}),dd),Cd=function(e){return e[e.Tab=9]="Tab",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.Space=32]="Space",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.End=35]="End",e[e.Home=36]="Home",e[e.ArrowLeft=37]="ArrowLeft",e[e.ArrowUp=38]="ArrowUp",e[e.ArrowRight=39]="ArrowRight",e[e.ArrowDown=40]="ArrowDown",e}({}),xd=function(e,t){return!!t&&t.some((function(t){return t.contains(e)}))},Sd=function(e,t){return!t||null!=function(e,t){return t?e.closest(t):null}(e,t)},Ad="undefined"!=typeof navigator&&!!navigator.userAgent&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||/Macintosh/.test(navigator.userAgent)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>2||/Android/.test(navigator.userAgent)),Id=["a[href]","button:not([disabled])",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])","[contenteditable]",'[tabindex]:not([tabindex="-1"])'].join(", ");function Td(e){var t=Array.from(e.querySelectorAll(Id)).filter((function(e){return-1!==e.tabIndex}));return[t[0],t[t.length-1]]}var Ed,Rd,Nd,Od,Dd,Fd,Md,Pd,zd,Ld,Bd,Vd,Wd,Ud,jd,Hd,Gd,qd,Kd,Xd,Zd,Yd,$d,Jd,Qd,ep,tp,np,rp=/\s+/,ap=new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getAllStyles",value:function(e){return window.getComputedStyle(e)}},{key:"getStyle",value:function(e,t){return this.getAllStyles(e)[t]}},{key:"isStaticPositioned",value:function(e){return"static"===(this.getStyle(e,"position")||"static")}},{key:"offsetParent",value:function(e){for(var t=e.offsetParent||document.documentElement;t&&t!==document.documentElement&&this.isStaticPositioned(t);)t=t.offsetParent;return t||document.documentElement}},{key:"position",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={width:0,height:0,top:0,bottom:0,left:0,right:0};if("fixed"===this.getStyle(e,"position"))t={top:(t=e.getBoundingClientRect()).top,bottom:t.bottom,left:t.left,right:t.right,height:t.height,width:t.width};else{var a=this.offsetParent(e);t=this.offset(e,!1),a!==document.documentElement&&(r=this.offset(a,!1)),r.top+=a.clientTop,r.left+=a.clientLeft}return t.top-=r.top,t.bottom-=r.top,t.left-=r.left,t.right-=r.left,n&&(t.top=Math.round(t.top),t.bottom=Math.round(t.bottom),t.left=Math.round(t.left),t.right=Math.round(t.right)),t}},{key:"offset",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e.getBoundingClientRect(),r=window.pageYOffset-document.documentElement.clientTop,a=window.pageXOffset-document.documentElement.clientLeft,i={height:n.height||e.offsetHeight,width:n.width||e.offsetWidth,top:n.top+r,bottom:n.bottom+r,left:n.left+a,right:n.right+a};return t&&(i.height=Math.round(i.height),i.width=Math.round(i.width),i.top=Math.round(i.top),i.bottom=Math.round(i.bottom),i.left=Math.round(i.left),i.right=Math.round(i.right)),i}},{key:"positionElements",value:function(e,t,n,r){var a=_slicedToArray(n.split("-"),2),i=a[0],o=void 0===i?"top":i,s=a[1],u=void 0===s?"center":s,c=r?this.offset(e,!1):this.position(e,!1),l=this.getAllStyles(t),h=parseFloat(l.marginTop),f=parseFloat(l.marginBottom),d=parseFloat(l.marginLeft),p=parseFloat(l.marginRight),v=0,m=0;switch(o){case"top":v=c.top-(t.offsetHeight+h+f);break;case"bottom":v=c.top+c.height;break;case"left":m=c.left-(t.offsetWidth+d+p);break;case"right":m=c.left+c.width}switch(u){case"top":v=c.top;break;case"bottom":v=c.top+c.height-t.offsetHeight;break;case"left":m=c.left;break;case"right":m=c.left+c.width-t.offsetWidth;break;case"center":"top"===o||"bottom"===o?m=c.left+c.width/2-t.offsetWidth/2:v=c.top+c.height/2-t.offsetHeight/2}t.style.transform="translate(".concat(Math.round(m),"px, ").concat(Math.round(v),"px)");var g=t.getBoundingClientRect(),y=document.documentElement,b=window.innerHeight||y.clientHeight,k=window.innerWidth||y.clientWidth;return g.left>=0&&g.top>=0&&g.right<=k&&g.bottom<=b}}]),e}()),ip=((Rd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Rd}),Rd.\u0275inj=Qe({factory:function(e){return new(e||Rd)},imports:[[$l,bf]]}),Rd),op=((Ed=function e(){_classCallCheck(this,e),this.autoClose=!0,this.placement=["bottom-left","bottom-right","top-left","top-right"]}).\u0275fac=function(e){return new(e||Ed)},Ed.\u0275prov=Je({factory:function(){return new Ed},token:Ed,providedIn:"root"}),Ed),sp=((Bd=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Bd)},Bd.\u0275dir=sn({type:Bd,selectors:[["",8,"navbar"]]}),Bd),up=((Ld=function(){function e(t){_classCallCheck(this,e),this.elementRef=t,this._disabled=!1}return _createClass(e,[{key:"disabled",set:function(e){this._disabled=""===e||!0===e},get:function(){return this._disabled}}]),e}()).\u0275fac=function(e){return new(e||Ld)(go(_s))},Ld.\u0275dir=sn({type:Ld,selectors:[["","ngbDropdownItem",""]],hostAttrs:[1,"dropdown-item"],hostVars:2,hostBindings:function(e,t){2&e&&Bo("disabled",t.disabled)},inputs:{disabled:"disabled"}}),Ld),cp=((zd=function e(t){_classCallCheck(this,e),this.dropdown=t,this.placement="bottom",this.isOpen=!1}).\u0275fac=function(e){return new(e||zd)(go(ht((function(){return fp}))))},zd.\u0275dir=sn({type:zd,selectors:[["","ngbDropdownMenu",""]],contentQueries:function(e,t,n){var r;1&e&&Iu(n,up,!1),2&e&&xu(r=Tu())&&(t.menuItems=r)},hostVars:5,hostBindings:function(e,t){1&e&&Ao("keydown.ArrowUp",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.ArrowDown",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.Home",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.End",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.Enter",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.Space",(function(e){return t.dropdown.onKeyDown(e)})),2&e&&(po("x-placement",t.placement),Bo("dropdown-menu",!0)("show",t.dropdown.isOpen()))}}),zd),lp=((Pd=function(){function e(t,n){_classCallCheck(this,e),this.dropdown=t,this._elementRef=n,this.anchorEl=n.nativeElement}return _createClass(e,[{key:"getNativeElement",value:function(){return this._elementRef.nativeElement}}]),e}()).\u0275fac=function(e){return new(e||Pd)(go(ht((function(){return fp}))),go(_s))},Pd.\u0275dir=sn({type:Pd,selectors:[["","ngbDropdownAnchor",""]],hostAttrs:["aria-haspopup","true",1,"dropdown-toggle"],hostVars:1,hostBindings:function(e,t){2&e&&po("aria-expanded",t.dropdown.isOpen())}}),Pd),hp=((Md=Nd=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){return _classCallCheck(this,n),t.call(this,e,r)}return n}(lp)).\u0275fac=function(e){return new(e||Md)(go(ht((function(){return fp}))),go(_s))},Md.\u0275dir=sn({type:Md,selectors:[["","ngbDropdownToggle",""]],hostAttrs:["aria-haspopup","true",1,"dropdown-toggle"],hostVars:1,hostBindings:function(e,t){1&e&&Ao("click",(function(){return t.dropdown.toggle()}))("keydown.ArrowUp",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.ArrowDown",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.Home",(function(e){return t.dropdown.onKeyDown(e)}))("keydown.End",(function(e){return t.dropdown.onKeyDown(e)})),2&e&&po("aria-expanded",t.dropdown.isOpen())},features:[gs([{provide:lp,useExisting:ht((function(){return Nd}))}]),ts]}),Md),fp=((Fd=function(){function e(t,n,r,a,i,o,s){var u=this;_classCallCheck(this,e),this._changeDetector=t,this._document=r,this._ngZone=a,this._elementRef=i,this._renderer=o,this._closed$=new de,this._open=!1,this.openChange=new du,this.placement=n.placement,this.container=n.container,this.autoClose=n.autoClose,this.display=s?"static":"dynamic",this._zoneSubscription=a.onStable.subscribe((function(){u._positionMenu()}))}return _createClass(e,[{key:"ngAfterContentInit",value:function(){var e=this;this._ngZone.onStable.pipe(Zf(1)).subscribe((function(){e._applyPlacementClasses(),e._open&&e._setCloseHandlers()}))}},{key:"ngOnChanges",value:function(e){e.container&&this._open&&this._applyContainer(this.container),e.placement&&!e.placement.isFirstChange&&this._applyPlacementClasses()}},{key:"isOpen",value:function(){return this._open}},{key:"open",value:function(){this._open||(this._open=!0,this._applyContainer(this.container),this.openChange.emit(!0),this._setCloseHandlers())}},{key:"_setCloseHandlers",value:function(){var e=this,t=this._anchor;!function(e,t,n,r,a,i,o,s){var u;n&&e.runOutsideAngular((u=function(){var s=Rf(t,"keydown").pipe(Vf(a),jf((function(e){return e.which===Cd.Escape})),Jf((function(e){return e.preventDefault()}))),u=Rf(t,"mousedown").pipe(xe((function(e){var t=e.target;return 2!==e.button&&!xd(t,o)&&("inside"===n?xd(t,i)&&Sd(t,".dropdown-item,.dropdown-divider"):"outside"===n?!xd(t,i):Sd(t,".dropdown-item,.dropdown-divider")||!xd(t,i))})),Vf(a));(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){if(!K(t[0]))return t[0];t=t[0]}return Fe(t,void 0).lift(new Nf)})([s,Rf(t,"mouseup").pipe(td(u),jf((function(e){var t=_slicedToArray(e,2);return t[0],t[1]})),od(0),Vf(a))]).subscribe((function(){return e.run(r)}))},Ad?function(){return setTimeout((function(){return u()}),100)}:u))}(this._ngZone,this._document,this.autoClose,(function(){return e.close()}),this._closed$,this._menu?[this._menuElement.nativeElement]:[],t?[t.getNativeElement()]:[])}},{key:"close",value:function(){this._open&&(this._open=!1,this._resetContainer(),this._closed$.next(),this.openChange.emit(!1),this._changeDetector.markForCheck())}},{key:"toggle",value:function(){this.isOpen()?this.close():this.open()}},{key:"ngOnDestroy",value:function(){this._resetContainer(),this._closed$.next(),this._zoneSubscription.unsubscribe()}},{key:"onKeyDown",value:function(e){var t=this,n=e.which,r=this._getMenuElements(),a=-1,i=!1,o=null,s=this._isEventFromToggle(e);if(!s&&r.length&&r.forEach((function(n,r){n.contains(e.target)&&(i=!0,o=n),n===t._document.activeElement&&(a=r)})),n!==Cd.Space&&n!==Cd.Enter){if(s||i){if(this.open(),r.length){switch(n){case Cd.ArrowDown:a=Math.min(a+1,r.length-1);break;case Cd.ArrowUp:if(this._isDropup()&&-1===a){a=r.length-1;break}a=Math.max(a-1,0);break;case Cd.Home:a=0;break;case Cd.End:a=r.length-1}r[a].focus()}e.preventDefault()}}else!i||!0!==this.autoClose&&"inside"!==this.autoClose||Rf(o,"click").pipe(Zf(1)).subscribe((function(){return t.close()}))}},{key:"_isDropup",value:function(){return this._elementRef.nativeElement.classList.contains("dropup")}},{key:"_isEventFromToggle",value:function(e){return this._anchor.getNativeElement().contains(e.target)}},{key:"_getMenuElements",value:function(){var e=this._menu;return null==e?[]:e.menuItems.filter((function(e){return!e.disabled})).map((function(e){return e.elementRef.nativeElement}))}},{key:"_positionMenu",value:function(){var e=this._menu;this.isOpen()&&e&&this._applyPlacementClasses("dynamic"===this.display?function(e,t,n,r,a){var i=Array.isArray(n)?n:n.split(rp),o=function(e){var t=_slicedToArray(e.split("-"),2);return t[0],t[1],[]},s=i.findIndex((function(e){return"auto"===e}));s>=0&&["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right","left-top","left-bottom","right-top","right-bottom"].forEach((function(e){null==i.find((function(t){return-1!==t.search("^"+e)}))&&i.splice(s++,1,e)}));var u,c=t.style;c.position="absolute",c.top="0",c.left="0",c["will-change"]="transform";var l,h=!1,f=_createForOfIteratorHelper(i);try{for(f.s();!(l=f.n()).done;)if(o(u=l.value),ap.positionElements(e,t,u,r)){h=!0;break}}catch(d){f.e(d)}finally{f.f()}return h||(o(u=i[0]),ap.positionElements(e,t,u,r)),u}(this._anchor.anchorEl,this._bodyContainer||this._menuElement.nativeElement,this.placement,"body"===this.container):this._getFirstPlacement(this.placement))}},{key:"_getFirstPlacement",value:function(e){return Array.isArray(e)?e[0]:e.split(" ")[0]}},{key:"_resetContainer",value:function(){var e=this._renderer,t=this._menuElement;if(t){var n=t.nativeElement;e.appendChild(this._elementRef.nativeElement,n),e.removeStyle(n,"position"),e.removeStyle(n,"transform")}this._bodyContainer&&(e.removeChild(this._document.body,this._bodyContainer),this._bodyContainer=null)}},{key:"_applyContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this._resetContainer(),"body"===e){var t=this._renderer,n=this._menuElement.nativeElement,r=this._bodyContainer=this._bodyContainer||t.createElement("div");t.setStyle(r,"position","absolute"),t.setStyle(n,"position","static"),t.setStyle(r,"z-index","1050"),t.appendChild(r,n),t.appendChild(this._document.body,r)}}},{key:"_applyPlacementClasses",value:function(e){var t=this._menu;if(t){e||(e=this._getFirstPlacement(this.placement));var n=this._renderer,r=this._elementRef.nativeElement;n.removeClass(r,"dropup"),n.removeClass(r,"dropdown"),t.placement="static"===this.display?null:e;var a=-1!==e.search("^top")?"dropup":"dropdown";n.addClass(r,a);var i=this._bodyContainer;i&&(n.removeClass(i,"dropup"),n.removeClass(i,"dropdown"),n.addClass(i,a))}}}]),e}()).\u0275fac=function(e){return new(e||Fd)(go(Mi),go(op),go(Dc),go(ec),go(_s),go(Ss),go(sp,8))},Fd.\u0275dir=sn({type:Fd,selectors:[["","ngbDropdown",""]],contentQueries:function(e,t,n){var r;1&e&&(Iu(n,cp,!0),Iu(n,cp,!0,_s),Iu(n,lp,!0)),2&e&&(xu(r=Tu())&&(t._menu=r.first),xu(r=Tu())&&(t._menuElement=r.first),xu(r=Tu())&&(t._anchor=r.first))},hostVars:2,hostBindings:function(e,t){2&e&&Bo("show",t.isOpen())},inputs:{_open:["open","_open"],placement:"placement",container:"container",autoClose:"autoClose",display:"display"},outputs:{openChange:"openChange"},exportAs:["ngbDropdown"],features:[ss]}),Fd),dp=((Dd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Dd}),Dd.\u0275inj=Qe({factory:function(e){return new(e||Dd)}}),Dd),pp=((Od=function e(){_classCallCheck(this,e),this.backdrop=!0,this.keyboard=!0}).\u0275fac=function(e){return new(e||Od)},Od.\u0275prov=Je({factory:function(){return new Od},token:Od,providedIn:"root"}),Od),vp=function e(t,n,r){_classCallCheck(this,e),this.nodes=t,this.viewRef=n,this.componentRef=r},mp=function(){},gp=((Wd=function(){function e(t){_classCallCheck(this,e),this._document=t}return _createClass(e,[{key:"compensate",value:function(){var e=this._getWidth();return this._isPresent(e)?this._adjustBody(e):mp}},{key:"_adjustBody",value:function(e){var t=this._document.body,n=t.style.paddingRight,r=parseFloat(window.getComputedStyle(t)["padding-right"]);return t.style["padding-right"]="".concat(r+e,"px"),function(){return t.style["padding-right"]=n}}},{key:"_isPresent",value:function(e){var t=this._document.body.getBoundingClientRect();return window.innerWidth-(t.left+t.right)>=e-.1*e}},{key:"_getWidth",value:function(){var e=this._document.createElement("div");e.className="modal-scrollbar-measure";var t=this._document.body;t.appendChild(e);var n=e.getBoundingClientRect().width-e.clientWidth;return t.removeChild(e),n}}]),e}()).\u0275fac=function(e){return new(e||Wd)(Pt(Dc))},Wd.\u0275prov=Je({factory:function(){return new Wd(Pt(Dc))},token:Wd,providedIn:"root"}),Wd),yp=((Vd=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||Vd)},Vd.\u0275cmp=en({type:Vd,selectors:[["ngb-modal-backdrop"]],hostAttrs:[2,"z-index","1050"],hostVars:2,hostBindings:function(e,t){2&e&&Vo("modal-backdrop fade show"+(t.backdropClass?" "+t.backdropClass:""))},inputs:{backdropClass:"backdropClass"},decls:0,vars:0,template:function(e,t){},encapsulation:2}),Vd),bp=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"close",value:function(e){}},{key:"dismiss",value:function(e){}}]),e}(),kp=function(){function e(t,n,r,a){var i=this;_classCallCheck(this,e),this._windowCmptRef=t,this._contentRef=n,this._backdropCmptRef=r,this._beforeDismiss=a,t.instance.dismissEvent.subscribe((function(e){i.dismiss(e)})),this.result=new Promise((function(e,t){i._resolve=e,i._reject=t})),this.result.then(null,(function(){}))}return _createClass(e,[{key:"close",value:function(e){this._windowCmptRef&&(this._resolve(e),this._removeModalElements())}},{key:"_dismiss",value:function(e){this._reject(e),this._removeModalElements()}},{key:"dismiss",value:function(e){var t=this;if(this._windowCmptRef)if(this._beforeDismiss){var n=this._beforeDismiss();n&&n.then?n.then((function(n){!1!==n&&t._dismiss(e)}),(function(){})):!1!==n&&this._dismiss(e)}else this._dismiss(e)}},{key:"_removeModalElements",value:function(){var e=this._windowCmptRef.location.nativeElement;if(e.parentNode.removeChild(e),this._windowCmptRef.destroy(),this._backdropCmptRef){var t=this._backdropCmptRef.location.nativeElement;t.parentNode.removeChild(t),this._backdropCmptRef.destroy()}this._contentRef&&this._contentRef.viewRef&&this._contentRef.viewRef.destroy(),this._windowCmptRef=null,this._backdropCmptRef=null,this._contentRef=null}},{key:"componentInstance",get:function(){if(this._contentRef&&this._contentRef.componentRef)return this._contentRef.componentRef.instance}}]),e}(),_p=function(e){return e[e.BACKDROP_CLICK=0]="BACKDROP_CLICK",e[e.ESC=1]="ESC",e}({}),wp=((tp=function(){function e(t,n,r){_classCallCheck(this,e),this._document=t,this._elRef=n,this._zone=r,this._closed$=new de,this.backdrop=!0,this.keyboard=!0,this.dismissEvent=new du}return _createClass(e,[{key:"dismiss",value:function(e){this.dismissEvent.emit(e)}},{key:"ngOnInit",value:function(){this._elWithFocus=this._document.activeElement}},{key:"ngAfterViewInit",value:function(){var e=this,t=this._elRef.nativeElement;if(this._zone.runOutsideAngular((function(){Rf(t,"keydown").pipe(Vf(e._closed$),jf((function(t){return t.which===Cd.Escape&&e.keyboard}))).subscribe((function(t){return requestAnimationFrame((function(){t.defaultPrevented||e._zone.run((function(){return e.dismiss(_p.ESC)}))}))}));var n=!1;Rf(e._dialogEl.nativeElement,"mousedown").pipe(Vf(e._closed$),Jf((function(){return n=!1})),zf((function(){return Rf(t,"mouseup").pipe(Vf(e._closed$),Zf(1))})),jf((function(e){var n=e.target;return t===n}))).subscribe((function(){n=!0})),Rf(t,"click").pipe(Vf(e._closed$)).subscribe((function(r){var a=r.target;!0!==e.backdrop||t!==a||n||e._zone.run((function(){return e.dismiss(_p.BACKDROP_CLICK)})),n=!1}))})),!t.contains(document.activeElement)){var n=t.querySelector("[ngbAutofocus]"),r=Td(t)[0];(n||r||t).focus()}}},{key:"ngOnDestroy",value:function(){var e,t=this,n=this._document.body,r=this._elWithFocus;e=r&&r.focus&&n.contains(r)?r:n,this._zone.runOutsideAngular((function(){setTimeout((function(){return e.focus()})),t._elWithFocus=null})),this._closed$.next()}}]),e}()).\u0275fac=function(e){return new(e||tp)(go(Dc),go(_s),go(ec))},tp.\u0275cmp=en({type:tp,selectors:[["ngb-modal-window"]],viewQuery:function(e,t){var n,r;1&e&&(r=hd,Au(_n(),kn(),r,!0,void 0,!0)),2&e&&xu(n=Tu())&&(t._dialogEl=n.first)},hostAttrs:["role","dialog","tabindex","-1"],hostVars:4,hostBindings:function(e,t){2&e&&(po("aria-modal",!0)("aria-labelledby",t.ariaLabelledBy),Vo("modal fade show d-block"+(t.windowClass?" "+t.windowClass:"")))},inputs:{backdrop:"backdrop",keyboard:"keyboard",ariaLabelledBy:"ariaLabelledBy",centered:"centered",scrollable:"scrollable",size:"size",windowClass:"windowClass"},outputs:{dismissEvent:"dismiss"},ngContentSelectors:ld,decls:4,vars:2,consts:[["role","document"],["dialog",""],[1,"modal-content"]],template:function(e,t){1&e&&(Ro(),_o(0,"div",0,1),_o(2,"div",2),No(3),wo(),wo()),2&e&&Vo("modal-dialog"+(t.size?" modal-"+t.size:"")+(t.centered?" modal-dialog-centered":"")+(t.scrollable?" modal-dialog-scrollable":""))},styles:["ngb-modal-window .component-host-scrollable{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:hidden}"],encapsulation:2}),tp),Cp=((ep=function(){function e(t,n,r,a,i,o){var s=this;_classCallCheck(this,e),this._applicationRef=t,this._injector=n,this._document=r,this._scrollBar=a,this._rendererFactory=i,this._ngZone=o,this._activeWindowCmptHasChanged=new de,this._ariaHiddenValues=new Map,this._backdropAttributes=["backdropClass"],this._modalRefs=[],this._windowAttributes=["ariaLabelledBy","backdrop","centered","keyboard","scrollable","size","windowClass"],this._windowCmpts=[],this._activeWindowCmptHasChanged.subscribe((function(){if(s._windowCmpts.length){var e=s._windowCmpts[s._windowCmpts.length-1];(function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];s._ngZone.runOutsideAngular((function(){var e=Rf(t,"focusin").pipe(Vf(n),xe((function(e){return e.target})));Rf(t,"keydown").pipe(Vf(n),jf((function(e){return e.which===Cd.Tab})),td(e)).subscribe((function(e){var n=_slicedToArray(e,2),r=n[0],a=n[1],i=_slicedToArray(Td(t),2),o=i[0],s=i[1];a!==o&&a!==t||!r.shiftKey||(s.focus(),r.preventDefault()),a!==s||r.shiftKey||(o.focus(),r.preventDefault())})),r&&Rf(t,"click").pipe(Vf(n),td(e),xe((function(e){return e[1]}))).subscribe((function(e){return e.focus()}))}))})(0,e.location.nativeElement,s._activeWindowCmptHasChanged),s._revertAriaHidden(),s._setAriaHidden(e.location.nativeElement)}}))}return _createClass(e,[{key:"open",value:function(e,t,n,r){var a=this,i=r.container instanceof HTMLElement?r.container:fd(r.container)?this._document.querySelector(r.container):this._document.body,o=this._rendererFactory.createRenderer(null,null),s=this._scrollBar.compensate(),u=function(){a._modalRefs.length||(o.removeClass(a._document.body,"modal-open"),a._revertAriaHidden())};if(!i)throw new Error('The specified modal container "'.concat(r.container||"body",'" was not found in the DOM.'));var c=new bp,l=this._getContentRef(e,r.injector||t,n,c,r),h=!1!==r.backdrop?this._attachBackdrop(e,i):null,f=this._attachWindowComponent(e,i,l),d=new kp(f,l,h,r.beforeDismiss);return this._registerModalRef(d),this._registerWindowCmpt(f),d.result.then(s,s),d.result.then(u,u),c.close=function(e){d.close(e)},c.dismiss=function(e){d.dismiss(e)},this._applyWindowOptions(f.instance,r),1===this._modalRefs.length&&o.addClass(this._document.body,"modal-open"),h&&h.instance&&this._applyBackdropOptions(h.instance,r),d}},{key:"dismissAll",value:function(e){this._modalRefs.forEach((function(t){return t.dismiss(e)}))}},{key:"hasOpenModals",value:function(){return this._modalRefs.length>0}},{key:"_attachBackdrop",value:function(e,t){var n=e.resolveComponentFactory(yp).create(this._injector);return this._applicationRef.attachView(n.hostView),t.appendChild(n.location.nativeElement),n}},{key:"_attachWindowComponent",value:function(e,t,n){var r=e.resolveComponentFactory(wp).create(this._injector,n.nodes);return this._applicationRef.attachView(r.hostView),t.appendChild(r.location.nativeElement),r}},{key:"_applyWindowOptions",value:function(e,t){this._windowAttributes.forEach((function(n){fd(t[n])&&(e[n]=t[n])}))}},{key:"_applyBackdropOptions",value:function(e,t){this._backdropAttributes.forEach((function(n){fd(t[n])&&(e[n]=t[n])}))}},{key:"_getContentRef",value:function(e,t,n,r,a){return n?n instanceof Hs?this._createFromTemplateRef(n,r):"string"==typeof n?this._createFromString(n):this._createFromComponent(e,t,n,r,a):new vp([])}},{key:"_createFromTemplateRef",value:function(e,t){var n=e.createEmbeddedView({$implicit:t,close:function(e){t.close(e)},dismiss:function(e){t.dismiss(e)}});return this._applicationRef.attachView(n),new vp([n.rootNodes],n)}},{key:"_createFromString",value:function(e){var t=this._document.createTextNode("".concat(e));return new vp([[t]])}},{key:"_createFromComponent",value:function(e,t,n,r,a){var i=e.resolveComponentFactory(n),o=$i.create({providers:[{provide:bp,useValue:r}],parent:t}),s=i.create(o),u=s.location.nativeElement;return a.scrollable&&u.classList.add("component-host-scrollable"),this._applicationRef.attachView(s.hostView),new vp([[u]],s.hostView,s)}},{key:"_setAriaHidden",value:function(e){var t=this,n=e.parentElement;n&&e!==this._document.body&&(Array.from(n.children).forEach((function(n){n!==e&&"SCRIPT"!==n.nodeName&&(t._ariaHiddenValues.set(n,n.getAttribute("aria-hidden")),n.setAttribute("aria-hidden","true"))})),this._setAriaHidden(n))}},{key:"_revertAriaHidden",value:function(){this._ariaHiddenValues.forEach((function(e,t){e?t.setAttribute("aria-hidden",e):t.removeAttribute("aria-hidden")})),this._ariaHiddenValues.clear()}},{key:"_registerModalRef",value:function(e){var t=this,n=function(){var n=t._modalRefs.indexOf(e);n>-1&&t._modalRefs.splice(n,1)};this._modalRefs.push(e),e.result.then(n,n)}},{key:"_registerWindowCmpt",value:function(e){var t=this;this._windowCmpts.push(e),this._activeWindowCmptHasChanged.next(),e.onDestroy((function(){var n=t._windowCmpts.indexOf(e);n>-1&&(t._windowCmpts.splice(n,1),t._activeWindowCmptHasChanged.next())}))}}]),e}()).\u0275fac=function(e){return new(e||ep)(Pt(kc),Pt($i),Pt(Dc),Pt(gp),Pt(Cs),Pt(ec))},ep.\u0275prov=Je({factory:function(){return new ep(Pt(kc),Pt(Tt),Pt(Dc),Pt(gp),Pt(Cs),Pt(ec))},token:ep,providedIn:"root"}),ep),xp=((Qd=function(){function e(t,n,r,a){_classCallCheck(this,e),this._moduleCFR=t,this._injector=n,this._modalStack=r,this._config=a}return _createClass(e,[{key:"open",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Object.assign({},this._config,t);return this._modalStack.open(this._moduleCFR,this._injector,e,n)}},{key:"dismissAll",value:function(e){this._modalStack.dismissAll(e)}},{key:"hasOpenModals",value:function(){return this._modalStack.hasOpenModals()}}]),e}()).\u0275fac=function(e){return new(e||Qd)(Pt(ks),Pt($i),Pt(Cp),Pt(pp))},Qd.\u0275prov=Je({factory:function(){return new Qd(Pt(ks),Pt(Tt),Pt(Cp),Pt(pp))},token:Qd,providedIn:"root"}),Qd),Sp=((Jd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Jd}),Jd.\u0275inj=Qe({factory:function(e){return new(e||Jd)},providers:[xp]}),Jd),Ap=(($d=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:$d}),$d.\u0275inj=Qe({factory:function(e){return new(e||$d)},imports:[[$l]]}),$d),Ip=((Yd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Yd}),Yd.\u0275inj=Qe({factory:function(e){return new(e||Yd)},imports:[[$l]]}),Yd),Tp=((Zd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Zd}),Zd.\u0275inj=Qe({factory:function(e){return new(e||Zd)},imports:[[$l]]}),Zd),Ep=((Xd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Xd}),Xd.\u0275inj=Qe({factory:function(e){return new(e||Xd)},imports:[[$l]]}),Xd),Rp=((Kd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Kd}),Kd.\u0275inj=Qe({factory:function(e){return new(e||Kd)},imports:[[$l]]}),Kd),Np=((qd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:qd}),qd.\u0275inj=Qe({factory:function(e){return new(e||qd)},imports:[[$l]]}),qd),Op=((Gd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Gd}),Gd.\u0275inj=Qe({factory:function(e){return new(e||Gd)},imports:[[$l]]}),Gd),Dp=((Hd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Hd}),Hd.\u0275inj=Qe({factory:function(e){return new(e||Hd)},imports:[[$l]]}),Hd),Fp=((jd=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:jd}),jd.\u0275inj=Qe({factory:function(e){return new(e||jd)}}),jd),Mp=((Ud=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:Ud}),Ud.\u0275inj=Qe({factory:function(e){return new(e||Ud)},imports:[[$l]]}),Ud),Pp=[yd,bd,kd,_d,wd,ip,dp,Sp,Ap,Ip,Tp,Ep,Rp,Op,Dp,Fp,Mp,Np],zp=((np=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:np}),np.\u0275inj=Qe({factory:function(e){return new(e||np)},imports:[Pp,yd,bd,kd,_d,wd,ip,dp,Sp,Ap,Ip,Tp,Ep,Rp,Op,Dp,Fp,Mp,Np]}),np),Lp=function(){function e(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return e.prototype=Object.create(Error.prototype),e}();function Bp(e){return new se((function(t){var n;try{n=e()}catch(r){return void t.error(r)}return(n?Te(n):Xf()).subscribe(t)}))}function Vp(e){return function(t){return 0===e?Xf():t.lift(new Wp(e))}}var Wp=function(){function e(t){if(_classCallCheck(this,e),this.total=t,this.total<0)throw new qf}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Up(e,this.total))}}]),e}(),Up=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.ring=new Array,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){var t=this.ring,n=this.total,r=this.count++;t.length<n?t.push(e):t[r%n]=e}},{key:"_complete",value:function(){var e=this.destination,t=this.count;if(t>0)for(var n=this.count>=this.total?this.total:this.count,r=this.ring,a=0;a<n;a++){var i=t++%n;e.next(r[i])}e.complete()}}]),n}(ee);function jp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qp;return function(t){return t.lift(new Hp(e))}}var Hp=function(){function e(t){_classCallCheck(this,e),this.errorFactory=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Gp(e,this.errorFactory))}}]),e}(),Gp=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).errorFactory=r,a.hasValue=!1,a}return _createClass(n,[{key:"_next",value:function(e){this.hasValue=!0,this.destination.next(e)}},{key:"_complete",value:function(){if(this.hasValue)return this.destination.complete();var e;try{e=this.errorFactory()}catch(t){e=t}this.destination.error(e)}}]),n}(ee);function qp(){return new Lp}function Kp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(t){return t.lift(new Xp(e))}}var Xp=function(){function e(t){_classCallCheck(this,e),this.defaultValue=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Zp(e,this.defaultValue))}}]),e}(),Zp=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).defaultValue=r,a.isEmpty=!0,a}return _createClass(n,[{key:"_next",value:function(e){this.isEmpty=!1,this.destination.next(e)}},{key:"_complete",value:function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}]),n}(ee);function Yp(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?jf((function(t,n){return e(t,n,r)})):Oe,Vp(1),n?Kp(t):jp((function(){return new Lp})))}}function $p(e){return function(t){var n=new Jp(e),r=t.lift(n);return n.caught=r}}var Jp=function(){function e(t){_classCallCheck(this,e),this.selector=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new Qp(e,this.selector,this.caught))}}]),e}(),Qp=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e)).selector=r,i.caught=a,i}return _createClass(n,[{key:"error",value:function(e){if(!this.isStopped){var t;try{t=this.selector(e,this.caught)}catch(i){return void _get(_getPrototypeOf(n.prototype),"error",this).call(this,i)}this._unsubscribeAndRecycle();var r=new me(this,void 0,void 0);this.add(r);var a=we(this,t,void 0,void 0,r);a!==r&&this.add(a)}}}]),n}(Ce);function ev(e,t){var n=arguments.length>=2;return function(r){return r.pipe(e?jf((function(t,n){return e(t,n,r)})):Oe,Zf(1),n?Kp(t):jp((function(){return new Lp})))}}var tv=function(){function e(t,n,r){_classCallCheck(this,e),this.predicate=t,this.thisArg=n,this.source=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new nv(e,this.predicate,this.thisArg,this.source))}}]),e}(),nv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e)).predicate=r,o.thisArg=a,o.source=i,o.index=0,o.thisArg=a||_assertThisInitialized(o),o}return _createClass(n,[{key:"notifyComplete",value:function(e){this.destination.next(e),this.destination.complete()}},{key:"_next",value:function(e){var t=!1;try{t=this.predicate.call(this.thisArg,e,this.index++,this.source)}catch(n){return void this.destination.error(n)}t||this.notifyComplete(!1)}},{key:"_complete",value:function(){this.notifyComplete(!0)}}]),n}(ee);function rv(e,t){var n=!1;return arguments.length>=2&&(n=!0),function(r){return r.lift(new av(e,t,n))}}var av=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.accumulator=t,this.seed=n,this.hasSeed=r}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new iv(e,this.accumulator,this.seed,this.hasSeed))}}]),e}(),iv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e)).accumulator=r,o._seed=a,o.hasSeed=i,o.index=0,o}return _createClass(n,[{key:"_next",value:function(e){if(this.hasSeed)return this._tryNext(e);this.seed=e,this.destination.next(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.accumulator(this.seed,e,n)}catch(r){this.destination.error(r)}this.seed=t,this.destination.next(t)}},{key:"seed",get:function(){return this._seed},set:function(e){this.hasSeed=!0,this._seed=e}}]),n}(ee);function ov(e,t){return Ee(e,t,1)}var sv,uv=function(){function e(t){_classCallCheck(this,e),this.callback=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new cv(e,this.callback))}}]),e}(),cv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).add(new $(r)),a}return n}(ee),lv=function e(t,n){_classCallCheck(this,e),this.id=t,this.url=n},hv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,n),(a=t.call(this,e,r)).navigationTrigger=i,a.restoredState=o,a}return _createClass(n,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(lv),fv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).urlAfterRedirects=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),n}(lv),dv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).reason=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),n}(lv),pv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a){var i;return _classCallCheck(this,n),(i=t.call(this,e,r)).error=a,i}return _createClass(n,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),n}(lv),vv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(lv),mv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(lv),gv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i,o){var s;return _classCallCheck(this,n),(s=t.call(this,e,r)).urlAfterRedirects=a,s.state=i,s.shouldActivate=o,s}return _createClass(n,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),n}(lv),yv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(lv),bv=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e,r)).urlAfterRedirects=a,o.state=i,o}return _createClass(n,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),n}(lv),kv=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),e}(),_v=function(){function e(t){_classCallCheck(this,e),this.route=t}return _createClass(e,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),e}(),wv=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Cv=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),xv=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Sv=function(){function e(t){_classCallCheck(this,e),this.snapshot=t}return _createClass(e,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),e}(),Av=function(){function e(t,n,r){_classCallCheck(this,e),this.routerEvent=t,this.position=n,this.anchor=r}return _createClass(e,[{key:"toString",value:function(){return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(this.position?"".concat(this.position[0],", ").concat(this.position[1]):null,"')")}}]),e}(),Iv=((sv=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||sv)},sv.\u0275cmp=en({type:sv,selectors:[["ng-component"]],decls:1,vars:0,template:function(e,t){1&e&&Co(0,"router-outlet")},directives:function(){return[Ng]},encapsulation:2}),sv),Tv=function(){function e(t){_classCallCheck(this,e),this.params=t||{}}return _createClass(e,[{key:"has",value:function(e){return this.params.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t[0]:t}return null}},{key:"getAll",value:function(e){if(this.has(e)){var t=this.params[e];return Array.isArray(t)?t:[t]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),e}();function Ev(e){return new Tv(e)}function Rv(e){var t=Error("NavigationCancelingError: "+e);return t.ngNavigationCancelingError=!0,t}function Nv(e,t,n){var r=n.path.split("/");if(r.length>e.length)return null;if("full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;for(var a={},i=0;i<r.length;i++){var o=r[i],s=e[i];if(o.startsWith(":"))a[o.substring(1)]=s;else if(o!==s.path)return null}return{consumed:e.slice(0,r.length),posParams:a}}var Ov=function e(t,n){_classCallCheck(this,e),this.routes=t,this.module=n};function Dv(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=0;n<e.length;n++){var r=e[n];Fv(r,Mv(t,r))}}function Fv(e,t){if(!e)throw new Error("\n      Invalid configuration of route '".concat(t,"': Encountered undefined route.\n      The reason might be an extra comma.\n\n      Example:\n      const routes: Routes = [\n        { path: '', redirectTo: '/dashboard', pathMatch: 'full' },\n        { path: 'dashboard',  component: DashboardComponent },, << two commas\n        { path: 'detail/:id', component: HeroDetailComponent }\n      ];\n    "));if(Array.isArray(e))throw new Error("Invalid configuration of route '".concat(t,"': Array cannot be specified"));if(!e.component&&!e.children&&!e.loadChildren&&e.outlet&&"primary"!==e.outlet)throw new Error("Invalid configuration of route '".concat(t,"': a componentless route without children or loadChildren cannot have a named outlet set"));if(e.redirectTo&&e.children)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and children cannot be used together"));if(e.redirectTo&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and loadChildren cannot be used together"));if(e.children&&e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"': children and loadChildren cannot be used together"));if(e.redirectTo&&e.component)throw new Error("Invalid configuration of route '".concat(t,"': redirectTo and component cannot be used together"));if(e.path&&e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': path and matcher cannot be used together"));if(void 0===e.redirectTo&&!e.component&&!e.children&&!e.loadChildren)throw new Error("Invalid configuration of route '".concat(t,"'. One of the following must be provided: component, redirectTo, children or loadChildren"));if(void 0===e.path&&void 0===e.matcher)throw new Error("Invalid configuration of route '".concat(t,"': routes must have either a path or a matcher specified"));if("string"==typeof e.path&&"/"===e.path.charAt(0))throw new Error("Invalid configuration of route '".concat(t,"': path cannot start with a slash"));if(""===e.path&&void 0!==e.redirectTo&&void 0===e.pathMatch)throw new Error("Invalid configuration of route '{path: \"".concat(t,'", redirectTo: "').concat(e.redirectTo,"\"}': please provide 'pathMatch'. The default value of 'pathMatch' is 'prefix', but often the intent is to use 'full'."));if(void 0!==e.pathMatch&&"full"!==e.pathMatch&&"prefix"!==e.pathMatch)throw new Error("Invalid configuration of route '".concat(t,"': pathMatch can only be set to 'prefix' or 'full'"));e.children&&Dv(e.children,t)}function Mv(e,t){return t?e||t.path?e&&!t.path?"".concat(e,"/"):!e&&t.path?t.path:"".concat(e,"/").concat(t.path):"":e}function Pv(e){var t=e.children&&e.children.map(Pv),n=t?Object.assign(Object.assign({},e),{children:t}):Object.assign({},e);return!n.component&&(t||n.loadChildren)&&n.outlet&&"primary"!==n.outlet&&(n.component=Iv),n}function zv(e,t){var n,r=Object.keys(e),a=Object.keys(t);if(!r||!a||r.length!=a.length)return!1;for(var i=0;i<r.length;i++)if(!Lv(e[n=r[i]],t[n]))return!1;return!0}function Lv(e,t){return Array.isArray(e)&&Array.isArray(t)?e.length==t.length&&e.every((function(e){return t.indexOf(e)>-1})):e===t}function Bv(e){return Array.prototype.concat.apply([],e)}function Vv(e){return e.length>0?e[e.length-1]:null}function Wv(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}function Uv(e){return So(e)?e:xo(e)?Te(Promise.resolve(e)):Df(e)}function jv(e,t,n){return n?function(e,t){return zv(e,t)}(e.queryParams,t.queryParams)&&function e(t,n){if(!Kv(t.segments,n.segments))return!1;if(t.numberOfChildren!==n.numberOfChildren)return!1;for(var r in n.children){if(!t.children[r])return!1;if(!e(t.children[r],n.children[r]))return!1}return!0}(e.root,t.root):function(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every((function(n){return Lv(e[n],t[n])}))}(e.queryParams,t.queryParams)&&function e(t,n){return function t(n,r,a){if(n.segments.length>a.length)return!!Kv(n.segments.slice(0,a.length),a)&&!r.hasChildren();if(n.segments.length===a.length){if(!Kv(n.segments,a))return!1;for(var i in r.children){if(!n.children[i])return!1;if(!e(n.children[i],r.children[i]))return!1}return!0}var o=a.slice(0,n.segments.length),s=a.slice(n.segments.length);return!!Kv(n.segments,o)&&!!n.children.primary&&t(n.children.primary,r,s)}(t,n,n.segments)}(e.root,t.root)}var Hv=function(){function e(t,n,r){_classCallCheck(this,e),this.root=t,this.queryParams=n,this.fragment=r}return _createClass(e,[{key:"toString",value:function(){return $v.serialize(this)}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Ev(this.queryParams)),this._queryParamMap}}]),e}(),Gv=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.segments=t,this.children=n,this.parent=null,Wv(n,(function(e,t){return e.parent=r}))}return _createClass(e,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"toString",value:function(){return Jv(this)}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}}]),e}(),qv=function(){function e(t,n){_classCallCheck(this,e),this.path=t,this.parameters=n}return _createClass(e,[{key:"toString",value:function(){return am(this)}},{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=Ev(this.parameters)),this._parameterMap}}]),e}();function Kv(e,t){return e.length===t.length&&e.every((function(e,n){return e.path===t[n].path}))}function Xv(e,t){var n=[];return Wv(e.children,(function(e,r){"primary"===r&&(n=n.concat(t(e,r)))})),Wv(e.children,(function(e,r){"primary"!==r&&(n=n.concat(t(e,r)))})),n}var Zv=function e(){_classCallCheck(this,e)},Yv=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"parse",value:function(e){var t=new cm(e);return new Hv(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}},{key:"serialize",value:function(e){var t,n,r;return"".concat("/".concat(function e(t,n){if(!t.hasChildren())return Jv(t);if(n){var r=t.children.primary?e(t.children.primary,!1):"",a=[];return Wv(t.children,(function(t,n){"primary"!==n&&a.push("".concat(n,":").concat(e(t,!1)))})),a.length>0?"".concat(r,"(").concat(a.join("//"),")"):r}var i=Xv(t,(function(n,r){return"primary"===r?[e(t.children.primary,!1)]:["".concat(r,":").concat(e(n,!1))]}));return"".concat(Jv(t),"/(").concat(i.join("//"),")")}(e.root,!0)),(n=e.queryParams,r=Object.keys(n).map((function(e){var t=n[e];return Array.isArray(t)?t.map((function(t){return"".concat(em(e),"=").concat(em(t))})).join("&"):"".concat(em(e),"=").concat(em(t))})),r.length?"?".concat(r.join("&")):"")).concat("string"==typeof e.fragment?"#".concat((t=e.fragment,encodeURI(t))):"")}}]),e}(),$v=new Yv;function Jv(e){return e.segments.map((function(e){return am(e)})).join("/")}function Qv(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function em(e){return Qv(e).replace(/%3B/gi,";")}function tm(e){return Qv(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function nm(e){return decodeURIComponent(e)}function rm(e){return nm(e.replace(/\+/g,"%20"))}function am(e){return"".concat(tm(e.path)).concat((t=e.parameters,Object.keys(t).map((function(e){return";".concat(tm(e),"=").concat(tm(t[e]))})).join("")));var t}var im=/^[^\/()?;=#]+/;function om(e){var t=e.match(im);return t?t[0]:""}var sm=/^[^=?&#]+/,um=/^[^?&#]+/,cm=function(){function e(t){_classCallCheck(this,e),this.url=t,this.remaining=t}return _createClass(e,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Gv([],{}):new Gv([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());var t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));var n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n.primary=new Gv(e,t)),n}},{key:"parseSegment",value:function(){var e=om(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(e),new qv(nm(e),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var e={};this.consumeOptional(";");)this.parseParam(e);return e}},{key:"parseParam",value:function(e){var t=om(this.remaining);if(t){this.capture(t);var n="";if(this.consumeOptional("=")){var r=om(this.remaining);r&&(n=r,this.capture(n))}e[nm(t)]=nm(n)}}},{key:"parseQueryParam",value:function(e){var t,n,r=(t=this.remaining,(n=t.match(sm))?n[0]:"");if(r){this.capture(r);var a="";if(this.consumeOptional("=")){var i=function(e){var t=e.match(um);return t?t[0]:""}(this.remaining);i&&(a=i,this.capture(a))}var o=rm(r),s=rm(a);if(e.hasOwnProperty(o)){var u=e[o];Array.isArray(u)||(u=[u],e[o]=u),u.push(s)}else e[o]=s}}},{key:"parseParens",value:function(e){var t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var n=om(this.remaining),r=this.remaining[n.length];if("/"!==r&&")"!==r&&";"!==r)throw new Error("Cannot parse url '".concat(this.url,"'"));var a=void 0;n.indexOf(":")>-1?(a=n.substr(0,n.indexOf(":")),this.capture(a),this.capture(":")):e&&(a="primary");var i=this.parseChildren();t[a]=1===Object.keys(i).length?i.primary:new Gv([],i),this.consumeOptional("//")}return t}},{key:"peekStartsWith",value:function(e){return this.remaining.startsWith(e)}},{key:"consumeOptional",value:function(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}},{key:"capture",value:function(e){if(!this.consumeOptional(e))throw new Error('Expected "'.concat(e,'".'))}}]),e}(),lm=function(){function e(t){_classCallCheck(this,e),this._root=t}return _createClass(e,[{key:"parent",value:function(e){var t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}},{key:"children",value:function(e){var t=hm(e,this._root);return t?t.children.map((function(e){return e.value})):[]}},{key:"firstChild",value:function(e){var t=hm(e,this._root);return t&&t.children.length>0?t.children[0].value:null}},{key:"siblings",value:function(e){var t=fm(e,this._root);return t.length<2?[]:t[t.length-2].children.map((function(e){return e.value})).filter((function(t){return t!==e}))}},{key:"pathFromRoot",value:function(e){return fm(e,this._root).map((function(e){return e.value}))}},{key:"root",get:function(){return this._root.value}}]),e}();function hm(e,t){if(e===t.value)return t;var n,r=_createForOfIteratorHelper(t.children);try{for(r.s();!(n=r.n()).done;){var a=hm(e,n.value);if(a)return a}}catch(i){r.e(i)}finally{r.f()}return null}function fm(e,t){if(e===t.value)return[t];var n,r=_createForOfIteratorHelper(t.children);try{for(r.s();!(n=r.n()).done;){var a=fm(e,n.value);if(a.length)return a.unshift(t),a}}catch(i){r.e(i)}finally{r.f()}return[]}var dm=function(){function e(t,n){_classCallCheck(this,e),this.value=t,this.children=n}return _createClass(e,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),e}();function pm(e){var t={};return e&&e.children.forEach((function(e){return t[e.value.outlet]=e})),t}var vm=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).snapshot=r,_m(_assertThisInitialized(a),e),a}return _createClass(n,[{key:"toString",value:function(){return this.snapshot.toString()}}]),n}(lm);function mm(e,t){var n=function(e,t){var n=new bm([],{},{},"",{},"primary",t,null,e.root,-1,{});return new km("",new dm(n,[]))}(e,t),r=new kf([new qv("",{})]),a=new kf({}),i=new kf({}),o=new kf({}),s=new kf(""),u=new gm(r,a,o,s,i,"primary",t,n.root);return u.snapshot=n.root,new vm(new dm(u,[]),n)}var gm=function(){function e(t,n,r,a,i,o,s,u){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=a,this.data=i,this.outlet=o,this.component=s,this._futureSnapshot=u}return _createClass(e,[{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}},{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(xe((function(e){return Ev(e)})))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(xe((function(e){return Ev(e)})))),this._queryParamMap}}]),e}();function ym(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",n=e.pathFromRoot,r=0;if("always"!==t)for(r=n.length-1;r>=1;){var a=n[r],i=n[r-1];if(a.routeConfig&&""===a.routeConfig.path)r--;else{if(i.component)break;r--}}return function(e){return e.reduce((function(e,t){return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign({},e.resolve),t._resolvedData)}}),{params:{},data:{},resolve:{}})}(n.slice(r))}var bm=function(){function e(t,n,r,a,i,o,s,u,c,l,h){_classCallCheck(this,e),this.url=t,this.params=n,this.queryParams=r,this.fragment=a,this.data=i,this.outlet=o,this.component=s,this.routeConfig=u,this._urlSegment=c,this._lastPathIndex=l,this._resolve=h}return _createClass(e,[{key:"toString",value:function(){return"Route(url:'".concat(this.url.map((function(e){return e.toString()})).join("/"),"', path:'").concat(this.routeConfig?this.routeConfig.path:"","')")}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=Ev(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=Ev(this.queryParams)),this._queryParamMap}}]),e}(),km=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,r)).url=e,_m(_assertThisInitialized(a),r),a}return _createClass(n,[{key:"toString",value:function(){return wm(this._root)}}]),n}(lm);function _m(e,t){t.value._routerState=e,t.children.forEach((function(t){return _m(e,t)}))}function wm(e){var t=e.children.length>0?" { ".concat(e.children.map(wm).join(", ")," } "):"";return"".concat(e.value).concat(t)}function Cm(e){if(e.snapshot){var t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,zv(t.queryParams,n.queryParams)||e.queryParams.next(n.queryParams),t.fragment!==n.fragment&&e.fragment.next(n.fragment),zv(t.params,n.params)||e.params.next(n.params),function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!zv(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.url.next(n.url),zv(t.data,n.data)||e.data.next(n.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function xm(e,t){var n,r;return zv(e.params,t.params)&&Kv(n=e.url,r=t.url)&&n.every((function(e,t){return zv(e.parameters,r[t].parameters)}))&&!(!e.parent!=!t.parent)&&(!e.parent||xm(e.parent,t.parent))}function Sm(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function Am(e,t,n,r,a){var i={};return r&&Wv(r,(function(e,t){i[t]=Array.isArray(e)?e.map((function(e){return"".concat(e)})):"".concat(e)})),new Hv(n.root===e?t:function e(t,n,r){var a={};return Wv(t.children,(function(t,i){a[i]=t===n?r:e(t,n,r)})),new Gv(t.segments,a)}(n.root,e,t),i,a)}var Im=function(){function e(t,n,r){if(_classCallCheck(this,e),this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Sm(r[0]))throw new Error("Root segment cannot have matrix parameters");var a=r.find((function(e){return"object"==typeof e&&null!=e&&e.outlets}));if(a&&a!==Vv(r))throw new Error("{outlets:{}} has to be the last command")}return _createClass(e,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),e}(),Tm=function e(t,n,r){_classCallCheck(this,e),this.segmentGroup=t,this.processChildren=n,this.index=r};function Em(e){return"object"==typeof e&&null!=e&&e.outlets?e.outlets.primary:"".concat(e)}function Rm(e,t,n){if(e||(e=new Gv([],{})),0===e.segments.length&&e.hasChildren())return Nm(e,t,n);var r=function(e,t,n){for(var r=0,a=t,i={match:!1,pathIndex:0,commandIndex:0};a<e.segments.length;){if(r>=n.length)return i;var o=e.segments[a],s=Em(n[r]),u=r<n.length-1?n[r+1]:null;if(a>0&&void 0===s)break;if(s&&u&&"object"==typeof u&&void 0===u.outlets){if(!Mm(s,u,o))return i;r+=2}else{if(!Mm(s,{},o))return i;r++}a++}return{match:!0,pathIndex:a,commandIndex:r}}(e,t,n),a=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){var i=new Gv(e.segments.slice(0,r.pathIndex),{});return i.children.primary=new Gv(e.segments.slice(r.pathIndex),e.children),Nm(i,0,a)}return r.match&&0===a.length?new Gv(e.segments,{}):r.match&&!e.hasChildren()?Om(e,t,n):r.match?Nm(e,0,a):Om(e,t,n)}function Nm(e,t,n){if(0===n.length)return new Gv(e.segments,{});var r=function(e){return"object"!=typeof e[0]?{primary:e}:void 0===e[0].outlets?{primary:e}:e[0].outlets}(n),a={};return Wv(r,(function(n,r){null!==n&&(a[r]=Rm(e.children[r],t,n))})),Wv(e.children,(function(e,t){void 0===r[t]&&(a[t]=e)})),new Gv(e.segments,a)}function Om(e,t,n){for(var r=e.segments.slice(0,t),a=0;a<n.length;){if("object"==typeof n[a]&&void 0!==n[a].outlets){var i=Dm(n[a].outlets);return new Gv(r,i)}if(0===a&&Sm(n[0]))r.push(new qv(e.segments[t].path,n[0])),a++;else{var o=Em(n[a]),s=a<n.length-1?n[a+1]:null;o&&s&&Sm(s)?(r.push(new qv(o,Fm(s))),a+=2):(r.push(new qv(o,{})),a++)}}return new Gv(r,{})}function Dm(e){var t={};return Wv(e,(function(e,n){null!==e&&(t[n]=Om(new Gv([],{}),0,e))})),t}function Fm(e){var t={};return Wv(e,(function(e,n){return t[n]="".concat(e)})),t}function Mm(e,t,n){return e==n.path&&zv(t,n.parameters)}var Pm=function(){function e(t,n,r,a){_classCallCheck(this,e),this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=a}return _createClass(e,[{key:"activate",value:function(e){var t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),Cm(this.futureState.root),this.activateChildRoutes(t,n,e)}},{key:"deactivateChildRoutes",value:function(e,t,n){var r=this,a=pm(t);e.children.forEach((function(e){var t=e.value.outlet;r.deactivateRoutes(e,a[t],n),delete a[t]})),Wv(a,(function(e,t){r.deactivateRouteAndItsChildren(e,n)}))}},{key:"deactivateRoutes",value:function(e,t,n){var r=e.value,a=t?t.value:null;if(r===a)if(r.component){var i=n.getContext(r.outlet);i&&this.deactivateChildRoutes(e,t,i.children)}else this.deactivateChildRoutes(e,t,n);else a&&this.deactivateRouteAndItsChildren(t,n)}},{key:"deactivateRouteAndItsChildren",value:function(e,t){this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}},{key:"detachAndStoreRouteSubtree",value:function(e,t){var n=t.getContext(e.value.outlet);if(n&&n.outlet){var r=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:r,route:e,contexts:a})}}},{key:"deactivateRouteAndOutlet",value:function(e,t){var n=this,r=t.getContext(e.value.outlet);if(r){var a=pm(e),i=e.value.component?r.children:t;Wv(a,(function(e,t){return n.deactivateRouteAndItsChildren(e,i)})),r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated())}}},{key:"activateChildRoutes",value:function(e,t,n){var r=this,a=pm(t);e.children.forEach((function(e){r.activateRoutes(e,a[e.value.outlet],n),r.forwardEvent(new Sv(e.value.snapshot))})),e.children.length&&this.forwardEvent(new Cv(e.value.snapshot))}},{key:"activateRoutes",value:function(e,t,n){var r=e.value,a=t?t.value:null;if(Cm(r),r===a)if(r.component){var i=n.getOrCreateContext(r.outlet);this.activateChildRoutes(e,t,i.children)}else this.activateChildRoutes(e,t,n);else if(r.component){var o=n.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){var s=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),o.children.onOutletReAttached(s.contexts),o.attachRef=s.componentRef,o.route=s.route.value,o.outlet&&o.outlet.attach(s.componentRef,s.route.value),zm(s.route)}else{var u=function(e){for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig;if(n&&n.component)return null}return null}(r.snapshot),c=u?u.module.componentFactoryResolver:null;o.attachRef=null,o.route=r,o.resolver=c,o.outlet&&o.outlet.activateWith(r,c),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,n)}}]),e}();function zm(e){Cm(e.value),e.children.forEach(zm)}function Lm(e){return"function"==typeof e}function Bm(e){return e instanceof Hv}var Vm=function e(t){_classCallCheck(this,e),this.segmentGroup=t||null},Wm=function e(t){_classCallCheck(this,e),this.urlTree=t};function Um(e){return new se((function(t){return t.error(new Vm(e))}))}function jm(e){return new se((function(t){return t.error(new Wm(e))}))}function Hm(e){return new se((function(t){return t.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(e,"'")))}))}var Gm=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.configLoader=n,this.urlSerializer=r,this.urlTree=a,this.config=i,this.allowRedirects=!0,this.ngModule=t.get(Vt)}return _createClass(e,[{key:"apply",value:function(){var e=this;return this.expandSegmentGroup(this.ngModule,this.config,this.urlTree.root,"primary").pipe(xe((function(t){return e.createUrlTree(t,e.urlTree.queryParams,e.urlTree.fragment)}))).pipe($p((function(t){if(t instanceof Wm)return e.allowRedirects=!1,e.match(t.urlTree);if(t instanceof Vm)throw e.noMatchError(t);throw t})))}},{key:"match",value:function(e){var t=this;return this.expandSegmentGroup(this.ngModule,this.config,e.root,"primary").pipe(xe((function(n){return t.createUrlTree(n,e.queryParams,e.fragment)}))).pipe($p((function(e){if(e instanceof Vm)throw t.noMatchError(e);throw e})))}},{key:"noMatchError",value:function(e){return new Error("Cannot match any routes. URL Segment: '".concat(e.segmentGroup,"'"))}},{key:"createUrlTree",value:function(e,t,n){var r=e.segments.length>0?new Gv([],{primary:e}):e;return new Hv(r,t,n)}},{key:"expandSegmentGroup",value:function(e,t,n,r){return 0===n.segments.length&&n.hasChildren()?this.expandChildren(e,t,n).pipe(xe((function(e){return new Gv([],e)}))):this.expandSegment(e,n,t,n.segments,r,!0)}},{key:"expandChildren",value:function(e,t,n){var r=this;return function(n,a){if(0===Object.keys(n).length)return Df({});var i=[],o=[],s={};return Wv(n,(function(n,a){var u,c,l=(u=a,c=n,r.expandSegmentGroup(e,t,c,u)).pipe(xe((function(e){return s[a]=e})));"primary"===a?i.push(l):o.push(l)})),Df.apply(null,i.concat(o)).pipe(Ff(),Yp(),xe((function(){return s})))}(n.children)}},{key:"expandSegment",value:function(e,t,n,r,a,i){var o=this;return Df.apply(void 0,_toConsumableArray(n)).pipe(xe((function(s){return o.expandSegmentAgainstRoute(e,t,n,s,r,a,i).pipe($p((function(e){if(e instanceof Vm)return Df(null);throw e})))})),Ff(),ev((function(e){return!!e})),$p((function(e,n){if(e instanceof Lp||"EmptyError"===e.name){if(o.noLeftoversInUrl(t,r,a))return Df(new Gv([],{}));throw new Vm(t)}throw e})))}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"expandSegmentAgainstRoute",value:function(e,t,n,r,a,i,o){return Zm(r)!==i?Um(t):void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,a):o&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,n,r,a,i):Um(t)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,a,i){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,n,r,i):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,n,r,a,i)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(e,t,n,r){var a=this,i=this.applyRedirectCommands([],n.redirectTo,{});return n.redirectTo.startsWith("/")?jm(i):this.lineralizeSegments(n,i).pipe(Ee((function(n){var i=new Gv(n,{});return a.expandSegment(e,i,t,n,r,!1)})))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(e,t,n,r,a,i){var o=this,s=qm(t,r,a),u=s.matched,c=s.consumedSegments,l=s.lastChild,h=s.positionalParamSegments;if(!u)return Um(t);var f=this.applyRedirectCommands(c,r.redirectTo,h);return r.redirectTo.startsWith("/")?jm(f):this.lineralizeSegments(r,f).pipe(Ee((function(r){return o.expandSegment(e,t,n,r.concat(a.slice(l)),i,!1)})))}},{key:"matchSegmentAgainstRoute",value:function(e,t,n,r){var a=this;if("**"===n.path)return n.loadChildren?this.configLoader.load(e.injector,n).pipe(xe((function(e){return n._loadedConfig=e,new Gv(r,{})}))):Df(new Gv(r,{}));var i=qm(t,n,r),o=i.matched,s=i.consumedSegments,u=i.lastChild;if(!o)return Um(t);var c=r.slice(u);return this.getChildConfig(e,n,r).pipe(Ee((function(e){var n=e.module,r=e.routes,i=function(e,t,n,r){return n.length>0&&function(e,t,n){return n.some((function(n){return Xm(e,t,n)&&"primary"!==Zm(n)}))}(e,n,r)?{segmentGroup:Km(new Gv(t,function(e,t){var n={};n.primary=t;var r,a=_createForOfIteratorHelper(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;""===i.path&&"primary"!==Zm(i)&&(n[Zm(i)]=new Gv([],{}))}}catch(o){a.e(o)}finally{a.f()}return n}(r,new Gv(n,e.children)))),slicedSegments:[]}:0===n.length&&function(e,t,n){return n.some((function(n){return Xm(e,t,n)}))}(e,n,r)?{segmentGroup:Km(new Gv(e.segments,function(e,t,n,r){var a,i={},o=_createForOfIteratorHelper(n);try{for(o.s();!(a=o.n()).done;){var s=a.value;Xm(e,t,s)&&!r[Zm(s)]&&(i[Zm(s)]=new Gv([],{}))}}catch(u){o.e(u)}finally{o.f()}return Object.assign(Object.assign({},r),i)}(e,n,r,e.children))),slicedSegments:n}:{segmentGroup:e,slicedSegments:n}}(t,s,c,r),o=i.segmentGroup,u=i.slicedSegments;return 0===u.length&&o.hasChildren()?a.expandChildren(n,r,o).pipe(xe((function(e){return new Gv(s,e)}))):0===r.length&&0===u.length?Df(new Gv(s,{})):a.expandSegment(n,o,r,u,"primary",!0).pipe(xe((function(e){return new Gv(s.concat(e.segments),e.children)})))})))}},{key:"getChildConfig",value:function(e,t,n){var r=this;return t.children?Df(new Ov(t.children,e)):t.loadChildren?void 0!==t._loadedConfig?Df(t._loadedConfig):function(e,t,n){var r,a=t.canLoad;return a&&0!==a.length?Te(a).pipe(xe((function(r){var a,i=e.get(r);if(function(e){return e&&Lm(e.canLoad)}(i))a=i.canLoad(t,n);else{if(!Lm(i))throw new Error("Invalid CanLoad guard");a=i(t,n)}return Uv(a)}))).pipe(Ff(),(r=function(e){return!0===e},function(e){return e.lift(new tv(r,void 0,e))})):Df(!0)}(e.injector,t,n).pipe(Ee((function(n){return n?r.configLoader.load(e.injector,t).pipe(xe((function(e){return t._loadedConfig=e,e}))):function(e){return new se((function(t){return t.error(Rv("Cannot load children because the guard of the route \"path: '".concat(e.path,"'\" returned false")))}))}(t)}))):Df(new Ov([],e))}},{key:"lineralizeSegments",value:function(e,t){for(var n=[],r=t.root;;){if(n=n.concat(r.segments),0===r.numberOfChildren)return Df(n);if(r.numberOfChildren>1||!r.children.primary)return Hm(e.redirectTo);r=r.children.primary}}},{key:"applyRedirectCommands",value:function(e,t,n){return this.applyRedirectCreatreUrlTree(t,this.urlSerializer.parse(t),e,n)}},{key:"applyRedirectCreatreUrlTree",value:function(e,t,n,r){var a=this.createSegmentGroup(e,t.root,n,r);return new Hv(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}},{key:"createQueryParams",value:function(e,t){var n={};return Wv(e,(function(e,r){if("string"==typeof e&&e.startsWith(":")){var a=e.substring(1);n[r]=t[a]}else n[r]=e})),n}},{key:"createSegmentGroup",value:function(e,t,n,r){var a=this,i=this.createSegments(e,t.segments,n,r),o={};return Wv(t.children,(function(t,i){o[i]=a.createSegmentGroup(e,t,n,r)})),new Gv(i,o)}},{key:"createSegments",value:function(e,t,n,r){var a=this;return t.map((function(t){return t.path.startsWith(":")?a.findPosParam(e,t,r):a.findOrReturn(t,n)}))}},{key:"findPosParam",value:function(e,t,n){var r=n[t.path.substring(1)];if(!r)throw new Error("Cannot redirect to '".concat(e,"'. Cannot find '").concat(t.path,"'."));return r}},{key:"findOrReturn",value:function(e,t){var n,r=0,a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.path===e.path)return t.splice(r),i;r++}}catch(o){a.e(o)}finally{a.f()}return e}}]),e}();function qm(e,t,n){if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}:{matched:!0,consumedSegments:[],lastChild:0,positionalParamSegments:{}};var r=(t.matcher||Nv)(n,e,t);return r?{matched:!0,consumedSegments:r.consumed,lastChild:r.consumed.length,positionalParamSegments:r.posParams}:{matched:!1,consumedSegments:[],lastChild:0,positionalParamSegments:{}}}function Km(e){if(1===e.numberOfChildren&&e.children.primary){var t=e.children.primary;return new Gv(e.segments.concat(t.segments),t.children)}return e}function Xm(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0!==n.redirectTo}function Zm(e){return e.outlet||"primary"}var Ym=function e(t){_classCallCheck(this,e),this.path=t,this.route=this.path[this.path.length-1]},$m=function e(t,n){_classCallCheck(this,e),this.component=t,this.route=n};function Jm(e,t,n){var r=function(e){if(!e)return null;for(var t=e.parent;t;t=t.parent){var n=t.routeConfig;if(n&&n._loadedConfig)return n._loadedConfig}return null}(t);return(r?r.module.injector:n).get(e)}function Qm(e,t,n){var r=pm(e),a=e.value;Wv(r,(function(e,r){Qm(e,a.component?t?t.children.getContext(r):null:t,n)})),n.canDeactivateChecks.push(new $m(a.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,a))}var eg=Symbol("INITIAL_VALUE");function tg(){return zf((function(e){return(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=null,a=null;return ve(t[t.length-1])&&(a=t.pop()),"function"==typeof t[t.length-1]&&(r=t.pop()),1===t.length&&K(t[0])&&(t=t[0]),Fe(t,a).lift(new wf(r))}).apply(void 0,_toConsumableArray(e.map((function(e){return e.pipe(Zf(1),Pf(eg))})))).pipe(rv((function(e,t){var n=!1;return t.reduce((function(e,r,a){if(e!==eg)return e;if(r===eg&&(n=!0),!n){if(!1===r)return r;if(a===t.length-1||Bm(r))return r}return e}),e)}),eg),jf((function(e){return e!==eg})),xe((function(e){return Bm(e)?e:!0===e})),Zf(1))}))}function ng(e,t){return null!==e&&t&&t(new xv(e)),Df(!0)}function rg(e,t){return null!==e&&t&&t(new wv(e)),Df(!0)}function ag(e,t,n){var r=t.routeConfig?t.routeConfig.canActivate:null;return r&&0!==r.length?Df(r.map((function(r){return Bp((function(){var a,i=Jm(r,t,n);if(function(e){return e&&Lm(e.canActivate)}(i))a=Uv(i.canActivate(t,e));else{if(!Lm(i))throw new Error("Invalid CanActivate guard");a=Uv(i(t,e))}return a.pipe(ev())}))}))).pipe(tg()):Df(!0)}function ig(e,t,n){var r=t[t.length-1],a=t.slice(0,t.length-1).reverse().map((function(e){return function(e){var t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(e)})).filter((function(e){return null!==e})).map((function(t){return Bp((function(){return Df(t.guards.map((function(a){var i,o=Jm(a,t.node,n);if(function(e){return e&&Lm(e.canActivateChild)}(o))i=Uv(o.canActivateChild(r,e));else{if(!Lm(o))throw new Error("Invalid CanActivateChild guard");i=Uv(o(r,e))}return i.pipe(ev())}))).pipe(tg())}))}));return Df(a).pipe(tg())}var og=function e(){_classCallCheck(this,e)},sg=function(){function e(t,n,r,a,i,o){_classCallCheck(this,e),this.rootComponentType=t,this.config=n,this.urlTree=r,this.url=a,this.paramsInheritanceStrategy=i,this.relativeLinkResolution=o}return _createClass(e,[{key:"recognize",value:function(){try{var e=lg(this.urlTree.root,[],[],this.config,this.relativeLinkResolution).segmentGroup,t=this.processSegmentGroup(this.config,e,"primary"),n=new bm([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},"primary",this.rootComponentType,null,this.urlTree.root,-1,{}),r=new dm(n,t),a=new km(this.url,r);return this.inheritParamsAndData(a._root),Df(a)}catch(i){return new se((function(e){return e.error(i)}))}}},{key:"inheritParamsAndData",value:function(e){var t=this,n=e.value,r=ym(n,this.paramsInheritanceStrategy);n.params=Object.freeze(r.params),n.data=Object.freeze(r.data),e.children.forEach((function(e){return t.inheritParamsAndData(e)}))}},{key:"processSegmentGroup",value:function(e,t,n){return 0===t.segments.length&&t.hasChildren()?this.processChildren(e,t):this.processSegment(e,t,t.segments,n)}},{key:"processChildren",value:function(e,t){var n,r=this,a=Xv(t,(function(t,n){return r.processSegmentGroup(e,t,n)}));return n={},a.forEach((function(e){var t=n[e.value.outlet];if(t){var r=t.url.map((function(e){return e.toString()})).join("/"),a=e.value.url.map((function(e){return e.toString()})).join("/");throw new Error("Two segments cannot have the same outlet name: '".concat(r,"' and '").concat(a,"'."))}n[e.value.outlet]=e.value})),a.sort((function(e,t){return"primary"===e.value.outlet?-1:"primary"===t.value.outlet?1:e.value.outlet.localeCompare(t.value.outlet)})),a}},{key:"processSegment",value:function(e,t,n,r){var a,i=_createForOfIteratorHelper(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;try{return this.processSegmentAgainstRoute(o,t,n,r)}catch(s){if(!(s instanceof og))throw s}}}catch(u){i.e(u)}finally{i.f()}if(this.noLeftoversInUrl(t,n,r))return[];throw new og}},{key:"noLeftoversInUrl",value:function(e,t,n){return 0===t.length&&!e.children[n]}},{key:"processSegmentAgainstRoute",value:function(e,t,n,r){if(e.redirectTo)throw new og;if((e.outlet||"primary")!==r)throw new og;var a,i=[],o=[];if("**"===e.path){var s=n.length>0?Vv(n).parameters:{};a=new bm(n,s,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,dg(e),r,e.component,e,ug(t),cg(t)+n.length,pg(e))}else{var u=function(e,t,n){if(""===t.path){if("full"===t.pathMatch&&(e.hasChildren()||n.length>0))throw new og;return{consumedSegments:[],lastChild:0,parameters:{}}}var r=(t.matcher||Nv)(n,e,t);if(!r)throw new og;var a={};Wv(r.posParams,(function(e,t){a[t]=e.path}));var i=r.consumed.length>0?Object.assign(Object.assign({},a),r.consumed[r.consumed.length-1].parameters):a;return{consumedSegments:r.consumed,lastChild:r.consumed.length,parameters:i}}(t,e,n);i=u.consumedSegments,o=n.slice(u.lastChild),a=new bm(i,u.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,dg(e),r,e.component,e,ug(t),cg(t)+i.length,pg(e))}var c=function(e){return e.children?e.children:e.loadChildren?e._loadedConfig.routes:[]}(e),l=lg(t,i,o,c,this.relativeLinkResolution),h=l.segmentGroup,f=l.slicedSegments;if(0===f.length&&h.hasChildren()){var d=this.processChildren(c,h);return[new dm(a,d)]}if(0===c.length&&0===f.length)return[new dm(a,[])];var p=this.processSegment(c,h,f,"primary");return[new dm(a,p)]}}]),e}();function ug(e){for(var t=e;t._sourceSegment;)t=t._sourceSegment;return t}function cg(e){for(var t=e,n=t._segmentIndexShift?t._segmentIndexShift:0;t._sourceSegment;)n+=(t=t._sourceSegment)._segmentIndexShift?t._segmentIndexShift:0;return n-1}function lg(e,t,n,r,a){if(n.length>0&&function(e,t,n){return n.some((function(n){return hg(e,t,n)&&"primary"!==fg(n)}))}(e,n,r)){var i=new Gv(t,function(e,t,n,r){var a={};a.primary=r,r._sourceSegment=e,r._segmentIndexShift=t.length;var i,o=_createForOfIteratorHelper(n);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(""===s.path&&"primary"!==fg(s)){var u=new Gv([],{});u._sourceSegment=e,u._segmentIndexShift=t.length,a[fg(s)]=u}}}catch(c){o.e(c)}finally{o.f()}return a}(e,t,r,new Gv(n,e.children)));return i._sourceSegment=e,i._segmentIndexShift=t.length,{segmentGroup:i,slicedSegments:[]}}if(0===n.length&&function(e,t,n){return n.some((function(n){return hg(e,t,n)}))}(e,n,r)){var o=new Gv(e.segments,function(e,t,n,r,a,i){var o,s={},u=_createForOfIteratorHelper(r);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(hg(e,n,c)&&!a[fg(c)]){var l=new Gv([],{});l._sourceSegment=e,l._segmentIndexShift="legacy"===i?e.segments.length:t.length,s[fg(c)]=l}}}catch(h){u.e(h)}finally{u.f()}return Object.assign(Object.assign({},a),s)}(e,t,n,r,e.children,a));return o._sourceSegment=e,o._segmentIndexShift=t.length,{segmentGroup:o,slicedSegments:n}}var s=new Gv(e.segments,e.children);return s._sourceSegment=e,s._segmentIndexShift=t.length,{segmentGroup:s,slicedSegments:n}}function hg(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path&&void 0===n.redirectTo}function fg(e){return e.outlet||"primary"}function dg(e){return e.data||{}}function pg(e){return e.resolve||{}}function vg(e,t,n,r){var a=Jm(e,t,r);return Uv(a.resolve?a.resolve(t,n):a(t,n))}function mg(e){return function(t){return t.pipe(zf((function(t){var n=e(t);return n?Te(n).pipe(xe((function(){return t}))):Te([t])})))}}var gg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldDetach",value:function(e){return!1}},{key:"store",value:function(e,t){}},{key:"shouldAttach",value:function(e){return!1}},{key:"retrieve",value:function(e){return null}},{key:"shouldReuseRoute",value:function(e,t){return e.routeConfig===t.routeConfig}}]),e}(),yg=new It("ROUTES"),bg=function(){function e(t,n,r,a){_classCallCheck(this,e),this.loader=t,this.compiler=n,this.onLoadStartListener=r,this.onLoadEndListener=a}return _createClass(e,[{key:"load",value:function(e,t){var n=this;return this.onLoadStartListener&&this.onLoadStartListener(t),this.loadModuleFactory(t.loadChildren).pipe(xe((function(r){n.onLoadEndListener&&n.onLoadEndListener(t);var a=r.create(e);return new Ov(Bv(a.injector.get(yg)).map(Pv),a)})))}},{key:"loadModuleFactory",value:function(e){var t=this;return"string"==typeof e?Te(this.loader.load(e)):Uv(e()).pipe(Ee((function(e){return e instanceof Wt?Df(e):Te(t.compiler.compileModuleAsync(e))})))}}]),e}(),kg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"shouldProcessUrl",value:function(e){return!0}},{key:"extract",value:function(e){return e}},{key:"merge",value:function(e,t){return e}}]),e}();function _g(e){throw e}function wg(e,t,n){return t.parse("/")}function Cg(e,t){return Df(null)}var xg,Sg,Ag,Ig,Tg=((xg=function(){function e(t,n,r,a,i,o,s,u){var c=this;_classCallCheck(this,e),this.rootComponentType=t,this.urlSerializer=n,this.rootContexts=r,this.location=a,this.config=u,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.navigationId=0,this.isNgZoneEnabled=!1,this.events=new de,this.errorHandler=_g,this.malformedUriErrorHandler=wg,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Cg,afterPreactivation:Cg},this.urlHandlingStrategy=new kg,this.routeReuseStrategy=new gg,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="legacy",this.ngModule=i.get(Vt),this.console=i.get(Vu);var l=i.get(ec);this.isNgZoneEnabled=l instanceof ec,this.resetConfig(u),this.currentUrlTree=new Hv(new Gv([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new bg(o,s,(function(e){return c.triggerEvent(new kv(e))}),(function(e){return c.triggerEvent(new _v(e))})),this.routerState=mm(this.currentUrlTree,this.rootComponentType),this.transitions=new kf({id:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return _createClass(e,[{key:"setupNavigations",value:function(e){var t=this,n=this.events;return e.pipe(jf((function(e){return 0!==e.id})),xe((function(e){return Object.assign(Object.assign({},e),{extractedUrl:t.urlHandlingStrategy.extract(e.rawUrl)})})),zf((function(e){var r,a,i,o,s=!1,u=!1;return Df(e).pipe(Jf((function(e){t.currentNavigation={id:e.id,initialUrl:e.currentRawUrl,extractedUrl:e.extractedUrl,trigger:e.source,extras:e.extras,previousNavigation:t.lastSuccessfulNavigation?Object.assign(Object.assign({},t.lastSuccessfulNavigation),{previousNavigation:null}):null}})),zf((function(e){var r,a,i,o,s=!t.navigated||e.extractedUrl.toString()!==t.browserUrlTree.toString();if(("reload"===t.onSameUrlNavigation||s)&&t.urlHandlingStrategy.shouldProcessUrl(e.rawUrl))return Df(e).pipe(zf((function(e){var r=t.transitions.getValue();return n.next(new hv(e.id,t.serializeUrl(e.extractedUrl),e.source,e.restoredState)),r!==t.transitions.getValue()?Kf:[e]})),zf((function(e){return Promise.resolve(e)})),(r=t.ngModule.injector,a=t.configLoader,i=t.urlSerializer,o=t.config,function(e){return e.pipe(zf((function(e){return function(e,t,n,r,a){return new Gm(e,t,n,r,a).apply()}(r,a,i,e.extractedUrl,o).pipe(xe((function(t){return Object.assign(Object.assign({},e),{urlAfterRedirects:t})})))})))}),Jf((function(e){t.currentNavigation=Object.assign(Object.assign({},t.currentNavigation),{finalUrl:e.urlAfterRedirects})})),function(e,n,r,a,i){return function(r){return r.pipe(Ee((function(r){return function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";return new sg(e,t,n,r,a,i).recognize()}(e,n,r.urlAfterRedirects,(o=r.urlAfterRedirects,t.serializeUrl(o)),a,i).pipe(xe((function(e){return Object.assign(Object.assign({},r),{targetSnapshot:e})})));var o})))}}(t.rootComponentType,t.config,0,t.paramsInheritanceStrategy,t.relativeLinkResolution),Jf((function(e){"eager"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(e.urlAfterRedirects,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),Jf((function(e){var r=new vv(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);n.next(r)})));if(s&&t.rawUrlTree&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){var u=e.id,c=e.extractedUrl,l=e.source,h=e.restoredState,f=e.extras,d=new hv(u,t.serializeUrl(c),l,h);n.next(d);var p=mm(c,t.rootComponentType).snapshot;return Df(Object.assign(Object.assign({},e),{targetSnapshot:p,urlAfterRedirects:c,extras:Object.assign(Object.assign({},f),{skipLocationChange:!1,replaceUrl:!1})}))}return t.rawUrlTree=e.rawUrl,t.browserUrlTree=e.urlAfterRedirects,e.resolve(null),Kf})),mg((function(e){var n=e.targetSnapshot,r=e.id,a=e.extractedUrl,i=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.beforePreactivation(n,{navigationId:r,appliedUrlTree:a,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!u})})),Jf((function(e){var n=new mv(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),xe((function(e){return Object.assign(Object.assign({},e),{guards:(n=e.targetSnapshot,r=e.currentSnapshot,a=t.rootContexts,i=n._root,function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=pm(n);return t.children.forEach((function(t){!function(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},o=t.value,s=n?n.value:null,u=r?r.getContext(t.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){var c=function(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!Kv(e.url,t.url);case"pathParamsOrQueryParamsChange":return!Kv(e.url,t.url)||!zv(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!xm(e,t)||!zv(e.queryParams,t.queryParams);case"paramsChange":default:return!xm(e,t)}}(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Ym(a)):(o.data=s.data,o._resolvedData=s._resolvedData),e(t,n,o.component?u?u.children:null:r,a,i),c&&i.canDeactivateChecks.push(new $m(u&&u.outlet&&u.outlet.component||null,s))}else s&&Qm(n,u,i),i.canActivateChecks.push(new Ym(a)),e(t,null,o.component?u?u.children:null:r,a,i)}(t,o[t.value.outlet],r,a.concat([t.value]),i),delete o[t.value.outlet]})),Wv(o,(function(e,t){return Qm(e,r.getContext(t),i)})),i}(i,r?r._root:null,a,[i.value]))});var n,r,a,i})),function(e,t){return function(n){return n.pipe(Ee((function(n){var r=n.targetSnapshot,a=n.currentSnapshot,i=n.guards,o=i.canActivateChecks,s=i.canDeactivateChecks;return 0===s.length&&0===o.length?Df(Object.assign(Object.assign({},n),{guardsResult:!0})):function(e,t,n,r){return Te(e).pipe(Ee((function(e){return function(e,t,n,r,a){var i=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return i&&0!==i.length?Df(i.map((function(i){var o,s=Jm(i,t,a);if(function(e){return e&&Lm(e.canDeactivate)}(s))o=Uv(s.canDeactivate(e,t,n,r));else{if(!Lm(s))throw new Error("Invalid CanDeactivate guard");o=Uv(s(e,t,n,r))}return o.pipe(ev())}))).pipe(tg()):Df(!0)}(e.component,e.route,n,t,r)})),ev((function(e){return!0!==e}),!0))}(s,r,a,e).pipe(Ee((function(n){return n&&"boolean"==typeof n?function(e,t,n,r){return Te(t).pipe(ov((function(t){return Te([rg(t.route.parent,r),ng(t.route,r),ig(e,t.path,n),ag(e,t.route,n)]).pipe(Ff(),ev((function(e){return!0!==e}),!0))})),ev((function(e){return!0!==e}),!0))}(r,o,e,t):Df(n)})),xe((function(e){return Object.assign(Object.assign({},n),{guardsResult:e})})))})))}}(t.ngModule.injector,(function(e){return t.triggerEvent(e)})),Jf((function(e){if(Bm(e.guardsResult)){var n=Rv('Redirecting to "'.concat(t.serializeUrl(e.guardsResult),'"'));throw n.url=e.guardsResult,n}})),Jf((function(e){var n=new gv(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot,!!e.guardsResult);t.triggerEvent(n)})),jf((function(e){if(!e.guardsResult){t.resetUrlToCurrentUrlTree();var r=new dv(e.id,t.serializeUrl(e.extractedUrl),"");return n.next(r),e.resolve(!1),!1}return!0})),mg((function(e){if(e.guards.canActivateChecks.length)return Df(e).pipe(Jf((function(e){var n=new yv(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})),(n=t.paramsInheritanceStrategy,r=t.ngModule.injector,function(e){return e.pipe(Ee((function(e){var t=e.targetSnapshot,a=e.guards.canActivateChecks;return a.length?Te(a).pipe(ov((function(e){return function(e,t,n,r){return function(e,t,n,r){var a=Object.keys(e);if(0===a.length)return Df({});if(1===a.length){var i=a[0];return vg(e[i],t,n,r).pipe(xe((function(e){return _defineProperty({},i,e)})))}var o={};return Te(a).pipe(Ee((function(a){return vg(e[a],t,n,r).pipe(xe((function(e){return o[a]=e,e})))}))).pipe(Yp(),xe((function(){return o})))}(e._resolve,e,t,r).pipe(xe((function(t){return e._resolvedData=t,e.data=Object.assign(Object.assign({},e.data),ym(e,n).resolve),null})))}(e.route,t,n,r)})),function(e,t){return arguments.length>=2?function(n){return ae(rv(e,t),Vp(1),Kp(t))(n)}:function(t){return ae(rv((function(t,n,r){return e(t,n,r+1)})),Vp(1))(t)}}((function(e,t){return e})),xe((function(t){return e}))):Df(e)})))}),Jf((function(e){var n=new bv(e.id,t.serializeUrl(e.extractedUrl),t.serializeUrl(e.urlAfterRedirects),e.targetSnapshot);t.triggerEvent(n)})));var n,r})),mg((function(e){var n=e.targetSnapshot,r=e.id,a=e.extractedUrl,i=e.rawUrl,o=e.extras,s=o.skipLocationChange,u=o.replaceUrl;return t.hooks.afterPreactivation(n,{navigationId:r,appliedUrlTree:a,rawUrlTree:i,skipLocationChange:!!s,replaceUrl:!!u})})),xe((function(e){var n=function(e,t,n){var r=function e(t,n,r){if(r&&t.shouldReuseRoute(n.value,r.value.snapshot)){var a=r.value;a._futureSnapshot=n.value;var i=function(t,n,r){return n.children.map((function(n){var a,i=_createForOfIteratorHelper(r.children);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(t.shouldReuseRoute(o.value.snapshot,n.value))return e(t,n,o)}}catch(s){i.e(s)}finally{i.f()}return e(t,n)}))}(t,n,r);return new dm(a,i)}var o=t.retrieve(n.value);if(o){var s=o.route;return function e(t,n){if(t.value.routeConfig!==n.value.routeConfig)throw new Error("Cannot reattach ActivatedRouteSnapshot created from a different route");if(t.children.length!==n.children.length)throw new Error("Cannot reattach ActivatedRouteSnapshot with a different number of children");n.value._futureSnapshot=t.value;for(var r=0;r<t.children.length;++r)e(t.children[r],n.children[r])}(n,s),s}var u,c=new gm(new kf((u=n.value).url),new kf(u.params),new kf(u.queryParams),new kf(u.fragment),new kf(u.data),u.outlet,u.component,u),l=n.children.map((function(n){return e(t,n)}));return new dm(c,l)}(e,t._root,n?n._root:void 0);return new vm(r,t)}(t.routeReuseStrategy,e.targetSnapshot,e.currentRouterState);return Object.assign(Object.assign({},e),{targetRouterState:n})})),Jf((function(e){t.currentUrlTree=e.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(t.currentUrlTree,e.rawUrl),t.routerState=e.targetRouterState,"deferred"===t.urlUpdateStrategy&&(e.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,!!e.extras.replaceUrl,e.id,e.extras.state),t.browserUrlTree=e.urlAfterRedirects)})),(a=t.rootContexts,i=t.routeReuseStrategy,o=function(e){return t.triggerEvent(e)},xe((function(e){return new Pm(i,e.targetRouterState,e.currentRouterState,o).activate(a),e}))),Jf({next:function(){s=!0},complete:function(){s=!0}}),(r=function(){if(!s&&!u){t.resetUrlToCurrentUrlTree();var r=new dv(e.id,t.serializeUrl(e.extractedUrl),"Navigation ID ".concat(e.id," is not equal to the current navigation id ").concat(t.navigationId));n.next(r),e.resolve(!1)}t.currentNavigation=null},function(e){return e.lift(new uv(r))}),$p((function(r){if(u=!0,(s=r)&&s.ngNavigationCancelingError){var a=Bm(r.url);a||(t.navigated=!0,t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl));var i=new dv(e.id,t.serializeUrl(e.extractedUrl),r.message);n.next(i),a?setTimeout((function(){var n=t.urlHandlingStrategy.merge(r.url,t.rawUrlTree);return t.scheduleNavigation(n,"imperative",null,{skipLocationChange:e.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy},{resolve:e.resolve,reject:e.reject,promise:e.promise})}),0):e.resolve(!1)}else{t.resetStateAndUrl(e.currentRouterState,e.currentUrlTree,e.rawUrl);var o=new pv(e.id,t.serializeUrl(e.extractedUrl),r);n.next(o);try{e.resolve(t.errorHandler(r))}catch(c){e.reject(c)}}var s;return Kf})))})))}},{key:"resetRootComponentType",value:function(e){this.rootComponentType=e,this.routerState.root.component=this.rootComponentType}},{key:"getTransition",value:function(){var e=this.transitions.value;return e.urlAfterRedirects=this.browserUrlTree,e}},{key:"setTransition",value:function(e){this.transitions.next(Object.assign(Object.assign({},this.getTransition()),e))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var e=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe((function(t){var n=e.parseUrl(t.url),r="popstate"===t.type?"popstate":"hashchange",a=t.state&&t.state.navigationId?t.state:null;setTimeout((function(){e.scheduleNavigation(n,r,a,{replaceUrl:!0})}),0)})))}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(e){this.events.next(e)}},{key:"resetConfig",value:function(e){Dv(e),this.config=e.map(Pv),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=null)}},{key:"createUrlTree",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.relativeTo,r=t.queryParams,a=t.fragment,i=t.preserveQueryParams,o=t.queryParamsHandling,s=t.preserveFragment;zr()&&i&&console&&console.warn&&console.warn("preserveQueryParams is deprecated, use queryParamsHandling instead.");var u=n||this.routerState.root,c=s?this.currentUrlTree.fragment:a,l=null;if(o)switch(o){case"merge":l=Object.assign(Object.assign({},this.currentUrlTree.queryParams),r);break;case"preserve":l=this.currentUrlTree.queryParams;break;default:l=r||null}else l=i?this.currentUrlTree.queryParams:r||null;return null!==l&&(l=this.removeEmptyProps(l)),function(e,t,n,r,a){if(0===n.length)return Am(t.root,t.root,t,r,a);var i=function(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new Im(!0,0,e);var t=0,n=!1,r=e.reduce((function(e,r,a){if("object"==typeof r&&null!=r){if(r.outlets){var i={};return Wv(r.outlets,(function(e,t){i[t]="string"==typeof e?e.split("/"):e})),[].concat(_toConsumableArray(e),[{outlets:i}])}if(r.segmentPath)return[].concat(_toConsumableArray(e),[r.segmentPath])}return"string"!=typeof r?[].concat(_toConsumableArray(e),[r]):0===a?(r.split("/").forEach((function(r,a){0==a&&"."===r||(0==a&&""===r?n=!0:".."===r?t++:""!=r&&e.push(r))})),e):[].concat(_toConsumableArray(e),[r])}),[]);return new Im(n,t,r)}(n);if(i.toRoot())return Am(t.root,new Gv([],{}),t,r,a);var o=function(e,t,n){if(e.isAbsolute)return new Tm(t.root,!0,0);if(-1===n.snapshot._lastPathIndex)return new Tm(n.snapshot._urlSegment,!0,0);var r=Sm(e.commands[0])?0:1;return function(e,t,n){for(var r=e,a=t,i=n;i>a;){if(i-=a,!(r=r.parent))throw new Error("Invalid number of '../'");a=r.segments.length}return new Tm(r,!1,a-i)}(n.snapshot._urlSegment,n.snapshot._lastPathIndex+r,e.numberOfDoubleDots)}(i,t,e),s=o.processChildren?Nm(o.segmentGroup,o.index,i.commands):Rm(o.segmentGroup,o.index,i.commands);return Am(o.segmentGroup,s,t,r,a)}(u,this.currentUrlTree,e,l,c)}},{key:"navigateByUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};zr()&&this.isNgZoneEnabled&&!ec.isInAngularZone()&&this.console.warn("Navigation triggered outside Angular zone, did you forget to call 'ngZone.run()'?");var n=Bm(e)?e:this.parseUrl(e),r=this.urlHandlingStrategy.merge(n,this.rawUrlTree);return this.scheduleNavigation(r,"imperative",null,t)}},{key:"navigate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return function(e){for(var t=0;t<e.length;t++){var n=e[t];if(null==n)throw new Error("The requested path contains ".concat(n," segment at index ").concat(t))}}(e),this.navigateByUrl(this.createUrlTree(e,t),t)}},{key:"serializeUrl",value:function(e){return this.urlSerializer.serialize(e)}},{key:"parseUrl",value:function(e){var t;try{t=this.urlSerializer.parse(e)}catch(n){t=this.malformedUriErrorHandler(n,this.urlSerializer,e)}return t}},{key:"isActive",value:function(e,t){if(Bm(e))return jv(this.currentUrlTree,e,t);var n=this.parseUrl(e);return jv(this.currentUrlTree,n,t)}},{key:"removeEmptyProps",value:function(e){return Object.keys(e).reduce((function(t,n){var r=e[n];return null!=r&&(t[n]=r),t}),{})}},{key:"processNavigations",value:function(){var e=this;this.navigations.subscribe((function(t){e.navigated=!0,e.lastSuccessfulId=t.id,e.events.next(new fv(t.id,e.serializeUrl(t.extractedUrl),e.serializeUrl(e.currentUrlTree))),e.lastSuccessfulNavigation=e.currentNavigation,e.currentNavigation=null,t.resolve(!0)}),(function(t){e.console.warn("Unhandled Navigation Error: ")}))}},{key:"scheduleNavigation",value:function(e,t,n,r,a){var i,o,s,u=this.getTransition();if(u&&"imperative"!==t&&"imperative"===u.source&&u.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(u&&"hashchange"==t&&"popstate"===u.source&&u.rawUrl.toString()===e.toString())return Promise.resolve(!0);if(u&&"popstate"==t&&"hashchange"===u.source&&u.rawUrl.toString()===e.toString())return Promise.resolve(!0);a?(i=a.resolve,o=a.reject,s=a.promise):s=new Promise((function(e,t){i=e,o=t}));var c=++this.navigationId;return this.setTransition({id:c,source:t,restoredState:n,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:e,extras:r,resolve:i,reject:o,promise:s,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),s.catch((function(e){return Promise.reject(e)}))}},{key:"setBrowserUrl",value:function(e,t,n,r){var a=this.urlSerializer.serialize(e);r=r||{},this.location.isCurrentPathEqualTo(a)||t?this.location.replaceState(a,"",Object.assign(Object.assign({},r),{navigationId:n})):this.location.go(a,"",Object.assign(Object.assign({},r),{navigationId:n}))}},{key:"resetStateAndUrl",value:function(e,t,n){this.routerState=e,this.currentUrlTree=t,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n),this.resetUrlToCurrentUrlTree()}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",{navigationId:this.lastSuccessfulId})}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}}]),e}()).\u0275fac=function(e){yo()},xg.\u0275dir=sn({type:xg}),xg),Eg=function e(){_classCallCheck(this,e),this.outlet=null,this.route=null,this.resolver=null,this.children=new Rg,this.attachRef=null},Rg=function(){function e(){_classCallCheck(this,e),this.contexts=new Map}return _createClass(e,[{key:"onChildOutletCreated",value:function(e,t){var n=this.getOrCreateContext(e);n.outlet=t,this.contexts.set(e,n)}},{key:"onChildOutletDestroyed",value:function(e){var t=this.getContext(e);t&&(t.outlet=null)}},{key:"onOutletDeactivated",value:function(){var e=this.contexts;return this.contexts=new Map,e}},{key:"onOutletReAttached",value:function(e){this.contexts=e}},{key:"getOrCreateContext",value:function(e){var t=this.getContext(e);return t||(t=new Eg,this.contexts.set(e,t)),t}},{key:"getContext",value:function(e){return this.contexts.get(e)||null}}]),e}(),Ng=((Sg=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.parentContexts=t,this.location=n,this.resolver=r,this.changeDetector=i,this.activated=null,this._activatedRoute=null,this.activateEvents=new du,this.deactivateEvents=new du,this.name=a||"primary",t.onChildOutletCreated(this.name,this)}return _createClass(e,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var e=this.parentContexts.getContext(this.name);e&&e.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.resolver||null))}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var e=this.activated;return this.activated=null,this._activatedRoute=null,e}},{key:"attach",value:function(e,t){this.activated=e,this._activatedRoute=t,this.location.insert(e.hostView)}},{key:"deactivate",value:function(){if(this.activated){var e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}},{key:"activateWith",value:function(e,t){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=e;var n=(t=t||this.resolver).resolveComponentFactory(e._futureSnapshot.routeConfig.component),r=this.parentContexts.getOrCreateContext(this.name).children,a=new Og(e,r,this.location.injector);this.activated=this.location.createComponent(n,this.location.length,a),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}}]),e}()).\u0275fac=function(e){return new(e||Sg)(go(Rg),go(qs),go(ks),function(e,t){var n=e.attrs;if(n)for(var r=n.length,a=0;a<r;){var i=n[a];if(nr(i))break;if(0===i)a+=2;else if("number"==typeof i)for(a++;a<r&&"string"==typeof n[a];)a++;else{if("name"===i)return n[a+1];a+=2}}return null}(Cn()),go(Mi))},Sg.\u0275dir=sn({type:Sg,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),Sg),Og=function(){function e(t,n,r){_classCallCheck(this,e),this.route=t,this.childContexts=n,this.parent=r}return _createClass(e,[{key:"get",value:function(e,t){return e===gm?this.route:e===Rg?this.childContexts:this.parent.get(e,t)}}]),e}(),Dg=function e(){_classCallCheck(this,e)},Fg=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return Df(null)}}]),e}(),Mg=((Ig=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.router=t,this.injector=a,this.preloadingStrategy=i,this.loader=new bg(n,r,(function(e){return t.triggerEvent(new kv(e))}),(function(e){return t.triggerEvent(new _v(e))}))}return _createClass(e,[{key:"setUpPreloading",value:function(){var e=this;this.subscription=this.router.events.pipe(jf((function(e){return e instanceof fv})),ov((function(){return e.preload()}))).subscribe((function(){}))}},{key:"preload",value:function(){var e=this.injector.get(Vt);return this.processRoutes(e,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"processRoutes",value:function(e,t){var n,r=[],a=_createForOfIteratorHelper(t);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.loadChildren&&!i.canLoad&&i._loadedConfig){var o=i._loadedConfig;r.push(this.processRoutes(o.module,o.routes))}else i.loadChildren&&!i.canLoad?r.push(this.preloadConfig(e,i)):i.children&&r.push(this.processRoutes(e,i.children))}}catch(s){a.e(s)}finally{a.f()}return Te(r).pipe(De(),xe((function(e){})))}},{key:"preloadConfig",value:function(e,t){var n=this;return this.preloadingStrategy.preload(t,(function(){return n.loader.load(e.injector,t).pipe(Ee((function(e){return t._loadedConfig=e,n.processRoutes(e.module,e.routes)})))}))}}]),e}()).\u0275fac=function(e){return new(e||Ig)(Pt(Tg),Pt(wc),Pt(Yu),Pt($i),Pt(Dg))},Ig.\u0275prov=Je({token:Ig,factory:Ig.\u0275fac}),Ig),Pg=((Ag=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.router=t,this.viewportScroller=n,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}return _createClass(e,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof hv?(e.store[e.lastId]=e.viewportScroller.getScrollPosition(),e.lastSource=t.navigationTrigger,e.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof fv&&(e.lastId=t.id,e.scheduleScrollEvent(t,e.router.parseUrl(t.urlAfterRedirects).fragment))}))}},{key:"consumeScrollEvents",value:function(){var e=this;return this.router.events.subscribe((function(t){t instanceof Av&&(t.position?"top"===e.options.scrollPositionRestoration?e.viewportScroller.scrollToPosition([0,0]):"enabled"===e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===e.options.anchorScrolling?e.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==e.options.scrollPositionRestoration&&e.viewportScroller.scrollToPosition([0,0]))}))}},{key:"scheduleScrollEvent",value:function(e,t){this.router.triggerEvent(new Av(e,"popstate"===this.lastSource?this.store[this.restoredId]:null,t))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),e}()).\u0275fac=function(e){yo()},Ag.\u0275dir=sn({type:Ag}),Ag),zg=new It("ROUTER_CONFIGURATION"),Lg=new It("ROUTER_FORROOT_GUARD"),Bg=[Qc,{provide:Zv,useClass:Yv},{provide:Tg,useFactory:function(e,t,n,r,a,i,o){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{},u=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,l=new Tg(null,e,t,n,r,a,i,Bv(o));if(u&&(l.urlHandlingStrategy=u),c&&(l.routeReuseStrategy=c),s.errorHandler&&(l.errorHandler=s.errorHandler),s.malformedUriErrorHandler&&(l.malformedUriErrorHandler=s.malformedUriErrorHandler),s.enableTracing){var h=Nc();l.events.subscribe((function(e){h.logGroup("Router Event: ".concat(e.constructor.name)),h.log(e.toString()),h.log(e),h.logGroupEnd()}))}return s.onSameUrlNavigation&&(l.onSameUrlNavigation=s.onSameUrlNavigation),s.paramsInheritanceStrategy&&(l.paramsInheritanceStrategy=s.paramsInheritanceStrategy),s.urlUpdateStrategy&&(l.urlUpdateStrategy=s.urlUpdateStrategy),s.relativeLinkResolution&&(l.relativeLinkResolution=s.relativeLinkResolution),l},deps:[Zv,Rg,Qc,$i,wc,Yu,yg,zg,[function(){return function e(){_classCallCheck(this,e)}}(),new qe],[function(){return function e(){_classCallCheck(this,e)}}(),new qe]]},Rg,{provide:gm,useFactory:function(e){return e.routerState.root},deps:[Tg]},{provide:wc,useClass:Sc},Mg,Fg,function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"preload",value:function(e,t){return t().pipe($p((function(){return Df(null)})))}}]),e}(),{provide:zg,useValue:{enableTracing:!1}}];function Vg(){return new pc("Router",Tg)}var Wg,Ug=((Wg=function(){function e(t,n){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t,n){return{ngModule:e,providers:[Bg,qg(t),{provide:Lg,useFactory:Gg,deps:[[Tg,new qe,new Xe]]},{provide:zg,useValue:n||{}},{provide:Gc,useFactory:Hg,deps:[Fc,[new Ge(Yc),new qe],zg]},{provide:Pg,useFactory:jg,deps:[Tg,Jl,zg]},{provide:Dg,useExisting:n&&n.preloadingStrategy?n.preloadingStrategy:Fg},{provide:pc,multi:!0,useFactory:Vg},[Xg,{provide:Ou,multi:!0,useFactory:Zg,deps:[Xg]},{provide:ty,useFactory:Yg,deps:[Xg]},{provide:Bu,multi:!0,useExisting:ty}]]}}},{key:"forChild",value:function(t){return{ngModule:e,providers:[qg(t)]}}}]),e}()).\u0275mod=an({type:Wg}),Wg.\u0275inj=Qe({factory:function(e){return new(e||Wg)(Pt(Lg,8),Pt(Tg,8))}}),Wg);function jg(e,t,n){return n.scrollOffset&&t.setOffset(n.scrollOffset),new Pg(e,t,n)}function Hg(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.useHash?new Jc(e,t):new $c(e,t)}function Gg(e){if(e)throw new Error("RouterModule.forRoot() called twice. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function qg(e){return[{provide:Ji,multi:!0,useValue:e},{provide:yg,multi:!0,useValue:e}]}var Kg,Xg=((Kg=function(){function e(t){_classCallCheck(this,e),this.injector=t,this.initNavigation=!1,this.resultOfPreactivationDone=new de}return _createClass(e,[{key:"appInitializer",value:function(){var e=this;return this.injector.get(zc,Promise.resolve(null)).then((function(){var t=null,n=new Promise((function(e){return t=e})),r=e.injector.get(Tg),a=e.injector.get(zg);if(e.isLegacyDisabled(a)||e.isLegacyEnabled(a))t(!0);else if("disabled"===a.initialNavigation)r.setUpLocationChangeListener(),t(!0);else{if("enabled"!==a.initialNavigation)throw new Error("Invalid initialNavigation options: '".concat(a.initialNavigation,"'"));r.hooks.afterPreactivation=function(){return e.initNavigation?Df(null):(e.initNavigation=!0,t(!0),e.resultOfPreactivationDone)},r.initialNavigation()}return n}))}},{key:"bootstrapListener",value:function(e){var t=this.injector.get(zg),n=this.injector.get(Mg),r=this.injector.get(Pg),a=this.injector.get(Tg),i=this.injector.get(kc);e===i.components[0]&&(this.isLegacyEnabled(t)?a.initialNavigation():this.isLegacyDisabled(t)&&a.setUpLocationChangeListener(),n.setUpPreloading(),r.init(),a.resetRootComponentType(i.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"isLegacyEnabled",value:function(e){return"legacy_enabled"===e.initialNavigation||!0===e.initialNavigation||void 0===e.initialNavigation}},{key:"isLegacyDisabled",value:function(e){return"legacy_disabled"===e.initialNavigation||!1===e.initialNavigation}}]),e}()).\u0275fac=function(e){return new(e||Kg)(Pt($i))},Kg.\u0275prov=Je({token:Kg,factory:Kg.\u0275fac}),Kg);function Zg(e){return e.appInitializer.bind(e)}function Yg(e){return e.bootstrapListener.bind(e)}var $g,Jg,Qg,ey,ty=new It("Router Initializer"),ny=(($g=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||$g)},$g.\u0275cmp=en({type:$g,selectors:[["app-profile"]],decls:81,vars:0,consts:[[1,"wrapper"],["data-parallax","true",1,"page-header","page-header-xs",2,"background-image","url('./assets/img/fabio-mangione.jpg')"],[1,"filter"],[1,"section","profile-content"],[1,"container"],[1,"owner"],[1,"avatar"],["src","./assets/img/faces/joe-gardner-2.jpg","alt","Circle Image",1,"img-circle","img-no-padding","img-responsive"],[1,"name"],[1,"title"],[1,"description"],[1,"card","card-user"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],[1,"col-md-5","pr-1"],[1,"form-group"],["type","text","disabled","","placeholder","Company","value","Creative Code Inc.",1,"form-control"],[1,"col-md-3","px-1"],["type","text","placeholder","Username","value","michael23",1,"form-control"],[1,"col-md-4","pl-1"],["for","exampleInputEmail1"],["type","email","placeholder","Email",1,"form-control"],[1,"col-md-6","pr-1"],["type","text","placeholder","Company","value","Chet",1,"form-control"],[1,"col-md-6","pl-1"],["type","text","placeholder","Last Name","value","Faker",1,"form-control"],[1,"col-md-12"],["type","text","placeholder","Home Address","value","Melbourne, Australia",1,"form-control"],[1,"col-md-4","pr-1"],["type","text","placeholder","City","value","Melbourne",1,"form-control"],[1,"col-md-4","px-1"],["type","text","placeholder","Country","value","Australia",1,"form-control"],["type","number","placeholder","ZIP Code",1,"form-control"],[1,"form-control","textarea"],[1,"update","ml-auto","mr-auto"],["type","submit",1,"btn","btn-primary","btn-round"]],template:function(e,t){1&e&&(_o(0,"div",0),_o(1,"div",1),Co(2,"div",2),wo(),_o(3,"div",3),_o(4,"div",4),_o(5,"div",5),_o(6,"div",6),Co(7,"img",7),wo(),_o(8,"div",8),_o(9,"h4",9),Yo(10,"Jane Faker"),Co(11,"br"),wo(),_o(12,"h6",10),Yo(13,"Music Producer"),wo(),wo(),wo(),Co(14,"br"),_o(15,"div",11),_o(16,"div",12),_o(17,"h5",13),Yo(18,"Edit Profile"),wo(),wo(),_o(19,"div",14),_o(20,"form"),_o(21,"div",15),_o(22,"div",16),_o(23,"div",17),_o(24,"label"),Yo(25,"Company (disabled)"),wo(),Co(26,"input",18),wo(),wo(),_o(27,"div",19),_o(28,"div",17),_o(29,"label"),Yo(30,"Username"),wo(),Co(31,"input",20),wo(),wo(),_o(32,"div",21),_o(33,"div",17),_o(34,"label",22),Yo(35,"Email address"),wo(),Co(36,"input",23),wo(),wo(),wo(),_o(37,"div",15),_o(38,"div",24),_o(39,"div",17),_o(40,"label"),Yo(41,"First Name"),wo(),Co(42,"input",25),wo(),wo(),_o(43,"div",26),_o(44,"div",17),_o(45,"label"),Yo(46,"Last Name"),wo(),Co(47,"input",27),wo(),wo(),wo(),_o(48,"div",15),_o(49,"div",28),_o(50,"div",17),_o(51,"label"),Yo(52,"Address"),wo(),Co(53,"input",29),wo(),wo(),wo(),_o(54,"div",15),_o(55,"div",30),_o(56,"div",17),_o(57,"label"),Yo(58,"City"),wo(),Co(59,"input",31),wo(),wo(),_o(60,"div",32),_o(61,"div",17),_o(62,"label"),Yo(63,"Country"),wo(),Co(64,"input",33),wo(),wo(),_o(65,"div",21),_o(66,"div",17),_o(67,"label"),Yo(68,"Postal Code"),wo(),Co(69,"input",34),wo(),wo(),wo(),_o(70,"div",15),_o(71,"div",28),_o(72,"div",17),_o(73,"label"),Yo(74,"About Me"),wo(),_o(75,"textarea",35),Yo(76,"Oh so, your weak rhyme You doubt I'll bother, reading into it"),wo(),wo(),wo(),wo(),_o(77,"div",15),_o(78,"div",36),_o(79,"button",37),Yo(80,"Update Profile"),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo())},directives:[gf,Bh,mf],styles:[""]}),$g),ry=function(e){return{"input-group-focus":e}},ay=((Qg=function(){function e(){_classCallCheck(this,e),this.test=new Date}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Qg)},Qg.\u0275cmp=en({type:Qg,selectors:[["app-signup"]],decls:40,vars:10,consts:[[1,"wrapper"],[1,"page-header",2,"background-color","rgb(51, 45, 56)"],[1,"container"],[1,"row"],[1,"col-lg-4","col-sm-6","mr-auto","ml-auto"],[1,"card","card-register",2,"background-color","rgb(180, 147, 223)"],[1,"title",2,"color","rgb(48, 23, 82)"],[1,"social-line","text-center"],["href","#pablo",1,"btn","btn-neutral","btn-facebook","btn-just-icon"],[1,"fa","fa-facebook-square"],["href","#pablo",1,"btn","btn-neutral","btn-google","btn-just-icon"],[1,"fa","fa-google-plus"],["href","#pablo",1,"btn","btn-neutral","btn-twitter","btn-just-icon"],[1,"fa","fa-twitter"],[1,"register-form"],[1,"input-group","form-group-no-border",3,"ngClass"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"nc-icon","nc-email-85"],["type","text","placeholder","Email",1,"form-control",3,"focus","blur"],[1,"nc-icon","nc-key-25"],["type","text","placeholder","Password",1,"form-control",3,"focus","blur"],["href","#/dashboard",1,"btn","btn-danger","btn-block","btn-round"],[1,"forgot"],["href","#/login",1,"btn","btn-link","btn-danger"],[1,"footer","register-footer","text-center"]],template:function(e,t){1&e&&(_o(0,"div",0),_o(1,"div",1),Yo(2,';"> '),_o(3,"div",2),_o(4,"div",3),_o(5,"div",4),_o(6,"div",5),_o(7,"h3",6),Yo(8,"Welcome"),wo(),_o(9,"div",7),_o(10,"a",8),Co(11,"i",9),wo(),_o(12,"a",10),Co(13,"i",11),wo(),_o(14,"a",12),Co(15,"i",13),wo(),wo(),_o(16,"form",14),_o(17,"label"),Yo(18,"Email"),wo(),_o(19,"div",15),_o(20,"div",16),_o(21,"span",17),Co(22,"i",18),wo(),wo(),_o(23,"input",19),Ao("focus",(function(){return t.focus=!0}))("blur",(function(){return t.focus=!1})),wo(),wo(),_o(24,"label"),Yo(25,"Password"),wo(),_o(26,"div",15),_o(27,"div",16),_o(28,"span",17),Co(29,"i",20),wo(),wo(),_o(30,"input",21),Ao("focus",(function(){return t.focus1=!0}))("blur",(function(){return t.focus1=!1})),wo(),wo(),_o(31,"a",22),Yo(32,"Register"),wo(),wo(),_o(33,"div",23),_o(34,"a",24),Yo(35,"Already have an account?"),wo(),wo(),wo(),wo(),wo(),_o(36,"div",25),_o(37,"h6"),Yo(38),hu(39,"date"),wo(),wo(),wo(),wo(),wo()),2&e&&(la(19),bo("ngClass",lu(6,ry,!0===t.focus)),la(7),bo("ngClass",lu(8,ry,!0===t.focus1)),la(12),Jo("\xa9",fu(39,3,t.test,"yyyy"),", SPQR"))},directives:[gf,Bh,mf,Ml],pipes:[Yl],styles:[""]}),Qg),iy=((Jg=function(){function e(t){_classCallCheck(this,e),this.viewportScroller=t}return _createClass(e,[{key:"onClick",value:function(e){this.viewportScroller.scrollToAnchor(e)}},{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Jg)(go(Jl))},Jg.\u0275cmp=en({type:Jg,selectors:[["app-landing"]],decls:67,vars:0,consts:[["data-parallax","true",1,"page-header",2,"background-image","url('./assets/img/theo-leconte-y3_-hzTcxm4-unsplash.jpg')"],[1,"filter"],[1,"container"],[1,"motto","text-center"],[1,"presentation-title"],["type","button",1,"btn","btn-outline-neutral","btn-round",3,"click"],["href","#/signup"],["type","button",1,"btn","btn-outline-neutral","btn-round"],["id","main",1,"main"],[1,"section","text-center"],[1,"row"],[1,"col-md-8","mr-auto","ml-auto"],[1,"title"],[1,"description"],["href","https://youtu.be/YHNyeX1We70",1,"btn","btn-danger","btn-round"],[1,"col-md-3"],[1,"info"],[1,"icon","icon-danger"],[1,"nc-icon","nc-pin-3"],[1,"info-title"],[1,"nc-icon","nc-camera-compact"],[1,"nc-icon","nc-chat-33"],[1,"nc-icon","nc-app"]],template:function(e,t){1&e&&(_o(0,"div",0),Co(1,"div",1),_o(2,"div",2),_o(3,"div",3),_o(4,"h1",4),Yo(5,"S\u0113pi\u014d "),wo(),_o(6,"h3"),Yo(7,"Preserve The Empire."),wo(),Co(8,"br"),Co(9,"br"),Co(10,"br"),_o(11,"button",5),Ao("click",(function(){return t.onClick("main")})),Yo(12,"Learn More"),wo(),_o(13,"a",6),_o(14,"button",7),Yo(15,"Get Started"),wo(),wo(),wo(),wo(),wo(),_o(16,"div",8),_o(17,"div",9),_o(18,"div",2),_o(19,"div",10),_o(20,"div",11),_o(21,"h2",12),Yo(22,"A unified security system for all of Rome"),wo(),_o(23,"h5",13),Yo(24,"What has brought Rome to such a level of power is its unified front. As the Empire continues to grow, however, the need for us to constantly be updated is integral to our safety and preservation of resources."),wo(),Co(25,"br"),_o(26,"a",14),Yo(27,"See Details"),wo(),wo(),wo(),Co(28,"br"),Co(29,"br"),_o(30,"div",10),_o(31,"div",15),_o(32,"div",16),_o(33,"div",17),Co(34,"i",18),wo(),_o(35,"div",13),_o(36,"h4",19),Yo(37,"Map Data"),wo(),_o(38,"p",13),Yo(39,"Find where the most recent invasions have occured and coordinate defenses."),wo(),wo(),wo(),wo(),_o(40,"div",15),_o(41,"div",16),_o(42,"div",17),Co(43,"i",20),wo(),_o(44,"div",13),_o(45,"h4",19),Yo(46,"AI surveillance"),wo(),_o(47,"p"),Yo(48,"Live surveillance feed that can recognize banners of invading armies and suspicous activity."),wo(),wo(),wo(),wo(),_o(49,"div",15),_o(50,"div",16),_o(51,"div",17),Co(52,"i",21),wo(),_o(53,"div",13),_o(54,"h4",19),Yo(55,"User Updates"),wo(),_o(56,"p"),Yo(57,"Find out what is happening around the Empire."),wo(),wo(),wo(),wo(),_o(58,"div",15),_o(59,"div",16),_o(60,"div",17),Co(61,"i",22),wo(),_o(62,"div",13),_o(63,"h4",19),Yo(64,"AR Weapons View"),wo(),_o(65,"p"),Yo(66,"View potential weapons invading armies could be carrying in your own hands"),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo())},styles:[""]}),Jg),oy=function(e){return{"input-group-focus":e}},sy=((ey=function(){function e(){_classCallCheck(this,e),this.test=new Date}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||ey)},ey.\u0275cmp=en({type:ey,selectors:[["app-login"]],decls:39,vars:10,consts:[[1,"wrapper"],[1,"page-header",2,"background-color","rgb(180, 147, 223)"],[1,"container"],[1,"row"],[1,"col-lg-4","col-sm-6","mr-auto","ml-auto"],[1,"card","card-register",2,"background-color","rgb(51, 45, 56)"],[1,"title",2,"color","white"],[1,"social-line","text-center"],["href","#pablo",1,"btn","btn-neutral","btn-facebook","btn-just-icon"],[1,"fa","fa-facebook-square"],["href","#pablo",1,"btn","btn-neutral","btn-google","btn-just-icon"],[1,"fa","fa-google-plus"],["href","#pablo",1,"btn","btn-neutral","btn-twitter","btn-just-icon"],[1,"fa","fa-twitter"],[1,"register-form"],[1,"input-group","form-group-no-border",3,"ngClass"],[1,"input-group-prepend"],[1,"input-group-text"],[1,"nc-icon","nc-email-85"],["type","text","placeholder","Email",1,"form-control",3,"focus","blur"],[1,"nc-icon","nc-key-25"],["type","text","placeholder","Password",1,"form-control",3,"focus","blur"],["href","#/dashboard",1,"btn","btn-danger","btn-block","btn-round"],[1,"forgot"],["href","#/signup",1,"btn","btn-link","btn-default",2,"color","white"],[1,"footer","register-footer","text-center"]],template:function(e,t){1&e&&(_o(0,"div",0),_o(1,"div",1),_o(2,"div",2),_o(3,"div",3),_o(4,"div",4),_o(5,"div",5),_o(6,"h3",6),Yo(7,"Welcome Back"),wo(),_o(8,"div",7),_o(9,"a",8),Co(10,"i",9),wo(),_o(11,"a",10),Co(12,"i",11),wo(),_o(13,"a",12),Co(14,"i",13),wo(),wo(),_o(15,"form",14),_o(16,"label"),Yo(17,"Email"),wo(),_o(18,"div",15),_o(19,"div",16),_o(20,"span",17),Co(21,"i",18),wo(),wo(),_o(22,"input",19),Ao("focus",(function(){return t.focus=!0}))("blur",(function(){return t.focus=!1})),wo(),wo(),_o(23,"label"),Yo(24,"Password"),wo(),_o(25,"div",15),_o(26,"div",16),_o(27,"span",17),Co(28,"i",20),wo(),wo(),_o(29,"input",21),Ao("focus",(function(){return t.focus1=!0}))("blur",(function(){return t.focus1=!1})),wo(),wo(),_o(30,"a",22),Yo(31,"Login"),wo(),wo(),_o(32,"div",23),_o(33,"a",24),Yo(34,"Don't have an account?"),wo(),wo(),wo(),wo(),wo(),_o(35,"div",25),_o(36,"h6"),Yo(37),hu(38,"date"),wo(),wo(),wo(),wo(),wo()),2&e&&(la(18),bo("ngClass",lu(6,oy,!0===t.focus)),la(7),bo("ngClass",lu(8,oy,!0===t.focus1)),la(12),Jo("\xa9",fu(38,3,t.test,"yyyy"),", SPQR"))},directives:[gf,Bh,mf,Ml],pipes:[Yl],styles:[""]}),ey),uy=function(){function e(t){_classCallCheck(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}var t;return _createClass(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=4;break}e.t0=this.flags[t],e.next=8;break;case 4:return e.next=6,this.evaluateFlag(t);case 6:this.flags[t]=e.sent,e.t0=this.flags[t];case 8:return e.abrupt("return",e.t0);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(t instanceof Promise)throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,r[0],r[1]),r.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=_slicedToArray(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}},{key:"features",get:function(){return this.flags}}]),e}();function cy(){return hy}var ly,hy=null;function fy(){if(null==ly){var e;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof global)e=global;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}ly=e}return ly}function dy(e,t){var n,r=(null==(n=fy())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(e))return r.get(e);var a=t();return r.set(e,a),r.get(e)}var py=dy("kernelRegistry",(function(){return new Map})),vy=dy("gradRegistry",(function(){return new Map}));function my(e,t){var n=Cy(e,t);return py.get(n)}function gy(e){return vy.get(e)}function yy(e){for(var t=py.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=_slicedToArray(i,2),s=o[0],u=o[1];_slicedToArray(s.split("_"),1)[0]===e&&n.push(u)}return n}function by(e){var t=e.kernelName,n=e.backendName,r=Cy(t,n);py.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),py.set(r,e)}function ky(e){var t=e.kernelName;vy.has(t)&&console.warn("Overriding the gradient for '".concat(t,"'")),vy.set(t,e)}function _y(e,t){var n=Cy(e,t);if(!py.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));py.delete(n)}function wy(e){if(!vy.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));vy.delete(e)}function Cy(e,t){return"".concat(t,"_").concat(e)}function xy(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function Sy(e,t,n){return Math.max(e,Math.min(t,n))}function Ay(e){return e%2==0?e:e+1}function Iy(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function Ty(e,t){var n=Math.random();return t*n+(1-n)*e}function Ey(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function Ry(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Ny(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Ry(Py(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function Oy(e){Ry(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Dy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||$y(e)&&!n)for(var r=0;r<e.length;++r)Dy(e[r],t,n);else t.push(e);return t}function Fy(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function My(e){return 0===e.length}function Py(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function zy(e){return e%1==0}function Ly(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function By(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function Vy(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return xy(t),t}function Wy(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Uy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function jy(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function Hy(e,t){var n=t.length;return Ry((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),Ry(e.every((function(e){return zy(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function Gy(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:Hy(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function qy(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function Ky(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function Xy(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function Zy(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function Yy(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function $y(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function Jy(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function Qy(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function eb(e){return"string"==typeof e||e instanceof String}function tb(e){return"boolean"==typeof e}function nb(e){return"number"==typeof e}function rb(e){return Array.isArray(e)?rb(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":nb(e)?"float32":eb(e)?"string":tb(e)?"bool":"float32"}function ab(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ib(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function ob(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function sb(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Dy(e)),n&&Xy(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)0!==Math.round(e[a])&&(r[a]=1);return r}throw new Error("Unknown data type ".concat(t))}function ub(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size."));return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else for(var s=n[0],u=n.slice(1),c=u.reduce((function(e,t){return e*t})),l=0;l<s;l++)a[l]=e(t+l*c,u,r);return a}(0,e,t)}function cb(e,t){for(var n=lb(e,t),r=0;r<n.length;r++)n[r]=1;return n}function lb(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function hb(){return cy().platform.now()}function fb(e){e.forEach((function(t){Ry(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function db(e,t){return cy().platform.fetch(e,t)}function pb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",cy().platform.encode(e,t)}function vb(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",cy().platform.decode(e,t)}function mb(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function gb(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}var yb=function(){function e(t,n){_classCallCheck(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new bb)}return _createClass(e,[{key:"profileKernel",value:function(e,t,n){var r,a=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(r,n.dtype,e),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(e,n,r,i.kernelMs,t,o)}))}))})),r}}]),e}(),bb=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"==typeof r?Wy("".concat(r,"ms"),9):r.error,s=Wy(e,25),u=t.rank,c=t.size,l=Wy(t.shape.toString(),14),h="";for(var f in a){var d=a[f].shape||t.shape,p=d.length;h+="".concat(f,": ").concat(p,"D ").concat(p>0?d:""," ")}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(u,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(h,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function kb(e,t,n){return Wy(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):eb(e)?"'".concat(e,"'"):"bool"===n?_b(e):parseFloat(e.toFixed(7)).toString(),t)}function _b(e){return 0===e?"false":"true"}function wb(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Cb=function(){function e(t,n,r){var a=this;if(_classCallCheck(this,e),this.dtype=n,this.shape=t.slice(),this.size=Fy(t),null!=r){var i=r.length;Ry(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||Ky(n,this.size),this.strides=ob(t)}return _createClass(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),Ry(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r])throw new Error("Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape));r++}for(var s=t[t.length-1],u=0;u<t.length-1;++u)s+=this.strides[u]*t[u];return this.values[s]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"toTensor",value:function(){return xb().makeTensor(this.values,this.shape,this.dtype)}},{key:"rank",get:function(){return this.shape.length}}]),e}(),xb=null,Sb=null,Ab=function(){function e(t,n,r,a){_classCallCheck(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Fy(t),this.strides=ob(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}var t,n,r,a;return _createClass(e,[{key:"flatten",value:function(){return this.throwIfDisposed(),this.as1D()}},{key:"asScalar",value:function(){return this.throwIfDisposed(),Ry(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])}},{key:"as1D",value:function(){return this.throwIfDisposed(),this.reshape([this.size])}},{key:"as2D",value:function(e,t){return this.throwIfDisposed(),this.reshape([e,t])}},{key:"as3D",value:function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])}},{key:"as4D",value:function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])}},{key:"as5D",value:function(e,t,n,r,a){return this.throwIfDisposed(),this.reshape([e,t,n,r,a])}},{key:"asType",value:function(e){return this.throwIfDisposed(),Sb.cast(this,e)}},{key:"buffer",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Sb.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"bufferSync",value:function(){return Sb.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",ub(this.shape,t));case 4:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"arraySync",value:function(){return ub(this.shape,this.dataSync())}},{key:"data",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=xb().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return vb(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])}))),function(){return n.apply(this,arguments)})},{key:"dataSync",value:function(){this.throwIfDisposed();var e=xb().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return vb(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,xb().read(this.dataId);case 3:return t=e.sent,e.abrupt("return","string"===this.dtype?t:new Uint8Array(t.buffer));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"dispose",value:function(){this.isDisposed||(xb().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"toFloat",value:function(){return this.asType("float32")}},{key:"toInt",value:function(){return this.asType("int32")}},{key:"toBool",value:function(){return this.asType("bool")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Sb.print(this,e)}},{key:"reshape",value:function(e){return this.throwIfDisposed(),Sb.reshape(this,e)}},{key:"reshapeAs",value:function(e){return this.throwIfDisposed(),this.reshape(e.shape)}},{key:"expandDims",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Sb.expandDims(this,e)}},{key:"squeeze",value:function(e){return this.throwIfDisposed(),Sb.squeeze(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),Sb.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n,r){var a=ob(t),i=function(e,t,n,r){var a=Fy(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?wb(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,h=0;h<i;h++)o[h]=Math.max(o[h],kb(u[l+h],0,n).length);return o}(e,t,n,a),o=t.length,s=function e(t,n,r,a,i){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[kb(wb(t)[0],0,r)]:"bool"===r?[_b(t[0])]:[t[0].toString()];if(1===c){if(u>20){var l=Array.from(t.slice(0,3*s)),h=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(l=wb(l),h=wb(h)),["["+l.map((function(e,t){return kb(e,i[t],r)})).join(", ")+", ..., "+h.map((function(e,t){return kb(e,i[u-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?wb(t):Array.from(t)).map((function(e,t){return kb(e,i[t],r)})).join(", ")+"]"]}var f=n.slice(1),d=a.slice(1),p=a[0]*s,v=[];if(u>20){for(var m=0;m<3;m++){var g=m*p;v.push.apply(v,_toConsumableArray(e(t.slice(g,g+p),f,r,d,i,!1)))}v.push("...");for(var y=u-3;y<u;y++){var b=y*p;v.push.apply(v,_toConsumableArray(e(t.slice(b,b+p),f,r,d,i,y===u-1)))}}else for(var k=0;k<u;k++){var _=k*p;v.push.apply(v,_toConsumableArray(e(t.slice(_,_+p),f,r,d,i,k===u-1)))}var w=2===c?",":"";v[0]="["+v[0]+w;for(var C=1;C<v.length-1;C++)v[C]=" "+v[C]+w;for(var x=",\n",S=2;S<c;S++)x+="\n";return v[v.length-1]=" "+v[v.length-1]+"]"+(o?"":x),v}(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: ".concat(n)),u.push("  rank: ".concat(o)),u.push("  shape: [".concat(t,"]")),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)}},{key:"gather",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.throwIfDisposed(),Sb.gather(this,e,t)}},{key:"norm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"euclidean",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.throwIfDisposed(),Sb.norm(this,e,t,n)}},{key:"slice",value:function(e,t){return this.throwIfDisposed(),Sb.slice(this,e,t)}},{key:"reverse",value:function(e){return this.throwIfDisposed(),Sb.reverse(this,e)}},{key:"stack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Sb.stack([this,e],t)}},{key:"unstack",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Sb.unstack(this,e)}},{key:"all",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.all(this,e,t)}},{key:"any",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.any(this,e,t)}},{key:"logSumExp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.logSumExp(this,e,t)}},{key:"sum",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.sum(this,e,t)}},{key:"prod",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.prod(this,e,t)}},{key:"mean",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.mean(this,e,t)}},{key:"min",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.min(this,e,t)}},{key:"argMin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.throwIfDisposed(),Sb.argMin(this,e)}},{key:"argMax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.throwIfDisposed(),Sb.argMax(this,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),Sb.cast(this,e)}},{key:"addStrict",value:function(e){return this.throwIfDisposed(),Sb.addStrict(this,e)}},{key:"subStrict",value:function(e){return this.throwIfDisposed(),Sb.subStrict(this,e)}},{key:"powStrict",value:function(e){return this.throwIfDisposed(),Sb.powStrict(this,e)}},{key:"mulStrict",value:function(e){return this.throwIfDisposed(),Sb.mulStrict(this,e)}},{key:"divStrict",value:function(e){return this.throwIfDisposed(),Sb.divStrict(this,e)}},{key:"minimumStrict",value:function(e){return this.throwIfDisposed(),Sb.minimumStrict(this,e)}},{key:"maximumStrict",value:function(e){return this.throwIfDisposed(),Sb.maximumStrict(this,e)}},{key:"modStrict",value:function(e){return this.throwIfDisposed(),Sb.modStrict(this,e)}},{key:"squaredDifferenceStrict",value:function(e){return this.throwIfDisposed(),Sb.squaredDifferenceStrict(this,e)}},{key:"notEqualStrict",value:function(e){return this.throwIfDisposed(),Sb.notEqualStrict(this,e)}},{key:"lessStrict",value:function(e){return this.throwIfDisposed(),Sb.lessStrict(this,e)}},{key:"equalStrict",value:function(e){return this.throwIfDisposed(),Sb.equalStrict(this,e)}},{key:"lessEqualStrict",value:function(e){return this.throwIfDisposed(),Sb.lessEqualStrict(this,e)}},{key:"greaterStrict",value:function(e){return this.throwIfDisposed(),Sb.greaterStrict(this,e)}},{key:"greaterEqualStrict",value:function(e){return this.throwIfDisposed(),Sb.greaterEqualStrict(this,e)}},{key:"logicalAnd",value:function(e){return this.throwIfDisposed(),Sb.logicalAnd(this,e)}},{key:"logicalOr",value:function(e){return this.throwIfDisposed(),Sb.logicalOr(this,e)}},{key:"logicalNot",value:function(){return this.throwIfDisposed(),Sb.logicalNot(this)}},{key:"logicalXor",value:function(e){return this.throwIfDisposed(),Sb.logicalXor(this,e)}},{key:"where",value:function(e,t){return this.throwIfDisposed(),Sb.where(e,this,t)}},{key:"neg",value:function(){return this.throwIfDisposed(),Sb.neg(this)}},{key:"ceil",value:function(){return this.throwIfDisposed(),Sb.ceil(this)}},{key:"floor",value:function(){return this.throwIfDisposed(),Sb.floor(this)}},{key:"sign",value:function(){return this.throwIfDisposed(),Sb.sign(this)}},{key:"isNaN",value:function(){return this.throwIfDisposed(),Sb.isNaN(this)}},{key:"isInf",value:function(){return this.throwIfDisposed(),Sb.isInf(this)}},{key:"isFinite",value:function(){return this.throwIfDisposed(),Sb.isFinite(this)}},{key:"exp",value:function(){return this.throwIfDisposed(),Sb.exp(this)}},{key:"expm1",value:function(){return this.throwIfDisposed(),Sb.expm1(this)}},{key:"log",value:function(){return this.throwIfDisposed(),Sb.log(this)}},{key:"log1p",value:function(){return this.throwIfDisposed(),Sb.log1p(this)}},{key:"sqrt",value:function(){return this.throwIfDisposed(),Sb.sqrt(this)}},{key:"rsqrt",value:function(){return this.throwIfDisposed(),Sb.rsqrt(this)}},{key:"square",value:function(){return this.throwIfDisposed(),Sb.square(this)}},{key:"reciprocal",value:function(){return this.throwIfDisposed(),Sb.reciprocal(this)}},{key:"abs",value:function(){return this.throwIfDisposed(),Sb.abs(this)}},{key:"clipByValue",value:function(e,t){return this.throwIfDisposed(),Sb.clipByValue(this,e,t)}},{key:"sigmoid",value:function(){return this.throwIfDisposed(),Sb.sigmoid(this)}},{key:"logSigmoid",value:function(){return this.throwIfDisposed(),Sb.logSigmoid(this)}},{key:"softplus",value:function(){return this.throwIfDisposed(),Sb.softplus(this)}},{key:"zerosLike",value:function(){return this.throwIfDisposed(),Sb.zerosLike(this)}},{key:"onesLike",value:function(){return this.throwIfDisposed(),Sb.onesLike(this)}},{key:"sin",value:function(){return this.throwIfDisposed(),Sb.sin(this)}},{key:"cos",value:function(){return this.throwIfDisposed(),Sb.cos(this)}},{key:"tan",value:function(){return this.throwIfDisposed(),Sb.tan(this)}},{key:"asin",value:function(){return this.throwIfDisposed(),Sb.asin(this)}},{key:"acos",value:function(){return this.throwIfDisposed(),Sb.acos(this)}},{key:"atan",value:function(){return this.throwIfDisposed(),Sb.atan(this)}},{key:"sinh",value:function(){return this.throwIfDisposed(),Sb.sinh(this)}},{key:"cosh",value:function(){return this.throwIfDisposed(),Sb.cosh(this)}},{key:"tanh",value:function(){return this.throwIfDisposed(),Sb.tanh(this)}},{key:"asinh",value:function(){return this.throwIfDisposed(),Sb.asinh(this)}},{key:"acosh",value:function(){return this.throwIfDisposed(),Sb.acosh(this)}},{key:"atanh",value:function(){return this.throwIfDisposed(),Sb.atanh(this)}},{key:"erf",value:function(){return this.throwIfDisposed(),Sb.erf(this)}},{key:"round",value:function(){return this.throwIfDisposed(),Sb.round(this)}},{key:"step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.throwIfDisposed(),Sb.step(this,e)}},{key:"softmax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.throwIfDisposed(),Sb.softmax(this,e)}},{key:"logSoftmax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;return this.throwIfDisposed(),Sb.logSoftmax(this,e)}},{key:"resizeBilinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.image.resizeBilinear(this,e,t)}},{key:"resizeNearestNeighbor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.throwIfDisposed(),Sb.image.resizeNearestNeighbor(this,e,t)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),xb().makeVariable(this,e,t,n)}},{key:"unsortedSegmentSum",value:function(e,t){return this.throwIfDisposed(),Sb.unsortedSegmentSum(this,e,t)}},{key:"topk",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.throwIfDisposed(),Sb.topk(this,e,t)}},{key:"stridedSlice",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return this.throwIfDisposed(),Sb.stridedSlice(this,e,t,n,r,a,i,o,s)}},{key:"fft",value:function(){return this.throwIfDisposed(),Sb.spectral.fft(this)}},{key:"ifft",value:function(){return this.throwIfDisposed(),Sb.spectral.ifft(this)}},{key:"rfft",value:function(){return this.throwIfDisposed(),Sb.spectral.rfft(this)}},{key:"irfft",value:function(){return this.throwIfDisposed(),Sb.spectral.irfft(this)}},{key:"rank",get:function(){return this.shape.length}},{key:"isDisposed",get:function(){return this.isDisposedInternal}}]),e}();Object.defineProperty(Ab,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var Ib,Tb,Eb,Rb,Nb,Ob=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r,a,i){var o;return _classCallCheck(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return _createClass(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!Py(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));xb().disposeTensor(this),this.dataId=e.dataId,xb().incRef(this,null)}},{key:"dispose",value:function(){xb().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(Ab);Object.defineProperty(Ob,Symbol.hasInstance,{value:function(e){return e instanceof Ab&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Ib||(Ib={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Tb||(Tb={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Eb||(Eb={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Rb||(Rb={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Nb||(Nb={}));var Db={float32:Rb,int32:Tb,bool:Eb,complex64:Nb};function Fb(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return Db[e][t]}function Mb(e){return Fb(e,"int32")}function Pb(e,t){if(e.dtype===t.dtype)return[e,t];var n=Fb(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function zb(e,t){Ry(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function Lb(e,t){return t.some((function(t){return t.id===e.id}))}function Bb(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof Ab)n.push(t);else if(a=t,Array.isArray(a)||"object"==typeof a){var a,i=t;for(var o in i){var s=i[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}var Vb=function(){function e(){_classCallCheck(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return _createClass(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),Wb=function(){function e(t){_classCallCheck(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new Vb}var t,n,r,a;return _createClass(e,[{key:"ready",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=17;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=14;break}return e.next=13,this.setBackend(r);case 13:return e.abrupt("return",void e.sent);case 14:n++,e.next=6;break;case 17:throw new Error("Could not initialize any backends, all backend initializations failed.");case 18:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=14;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=11;break}return e.next=8,r;case 8:e.t0=e.sent,e.next=12;break;case 11:e.t0=r;case 12:if(e.t0){e.next=14;break}return e.abrupt("return",!1);case 14:return e.abrupt("return",(this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new yb(this.backendInstance),!0));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"setupRegisteredKernels",value:function(){var e=this;yy(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;yy(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId||(t.registry[e]=n,t.pendingBackendInit=null,0))})).catch((function(n){return!(a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message),1))}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype);return this.addTapeNode(this.state.activeScope.name,{x:e},[t],(function(e){return{x:function(){return e.toFloat()}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=r-t-a-this.state.numDataMovesStack[this.state.numDataMovesStack.length-1];if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e,t,n,r,a,i,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var h,f=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var p,v=my(r,this.backendName);if(null!=v)h=function(){var e=u.backend.numDataIds();p=v.kernelFunc({inputs:t,attrs:a,backend:u.backend});var n=Array.isArray(p)?p:[p];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)}));if(l){var h=u.getTensorsForGradient(r,t,s);if(null==h){null==o&&(o=[]);var f=s.filter((function(e,t){return o[t]}));h=(i||[]).slice().concat(f)}c=u.saveTensorsForBackwardMode(h)}return s};else{var m=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))};h=function(){var t=u.backend.numDataIds();p=u.tidy((function(){return e(u.backend,m)}));var n=Array.isArray(p)?p:[p];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return h()})):h()})),l&&this.addTapeNode(r,t,s,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-f,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(p)?s:s[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=gy(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(Ry(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return null}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");r=r||this.backend;var a=e;"string"===(n=n||"float32")&&eb(e[0])&&(a=e.map((function(e){return pb(e)})));var i=r.write(a,t,n),o=new Ab(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=Qy(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a=new Ab(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var a=new Ob(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"incRef",value:function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*Jy(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Ob||this.track(e)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables)this.disposeVariable(this.state.registeredVariables[e])}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,e.abrupt("return",(this.state.activeProfile.kernels=[],this.state.activeProfile.result=t(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,_toConsumableArray(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,this.state.activeProfile));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=gy(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=lb(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Bb(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Ry(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));Ry(i instanceof Ab,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],u=s.inputs;for(var c in u){for(var l=u[c],h=!1,f=0;f<t.length;f++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),h=!0,a[s.id]=!0;break}if(h)break}}var d={};d[n.id]=!0;for(var p={},v=e.length-1;v>=0;v--)for(var m=e[v],g=m.inputs,y=0;y<m.outputs.length;y++)if(d[m.outputs[y].id]){for(var b in g)d[g[b].id]=!0,p[m.id]=!0;break}for(var k=[],_=0;_<e.length;_++){var w=e[_];if(a[w.id]&&p[w.id]){var C={};for(var x in w.inputs){var S=w.inputs[x];r[S.id]&&(C[x]=S)}var A=Object.assign({},w);A.inputs=C,A.outputs=w.outputs,k.push(A)}}return k}(this.state.activeTape,t,i);if(!a&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,a,s={};s[i.id]=null==n?(e=i.shape,a=cb(Fy(e),"float32"),Ub.makeTensor(a,e,"float32")):n,function(e,t,n){for(var a=function(n){var a=t[n],i=[];if(a.outputs.forEach((function(t){var n=e[t.id];i.push(null!=n?n:null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(a.kernelName,"."));var o=a.gradient(i),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(o),"."));var n=function(e){return r.tidy(e)}((function(){return o[t]()}));if("float32"!==n.dtype)throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(n.dtype,"'"));var i=a.inputs[t];if(!Py(n.shape,i.shape))throw new Error("Error in gradient for op ".concat(a.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(n.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==e[i.id])e[i.id]=n;else{var s=e[i.id];e[i.id]=s.add(n),s.dispose()}};for(var u in a.inputs)s(u)},i=t.length-1;i>=0;i--)a(i)}(s,o);var u=t.map((function(e){return s[e.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=_createForOfIteratorHelper(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:i,grads:u}}))}},{key:"customGrad",value:function(e){var t=this;return Ry(ab(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;Ry(r.every((function(e){return e instanceof Ab})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(e,t){o[t]=e})),t.runKernelFunc((function(t,n){return Ry((i=e.apply(void 0,r.concat([n]))).value instanceof Ab,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),Ry(ab(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value}),o,(function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];Ry(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),Ry(a.every((function(e){return e instanceof Ab})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o}))}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=hb(),e.next=3,this.backend.time(t);case 3:return r=e.sent,e.abrupt("return",(r.wallMs=hb()-n,r));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new Vb,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}}]),e}();Wb.nextTensorId=0,Wb.nextVariableId=0;var Ub=function(){var e=fy();if(null==e._tfengine){var t=new uy(e);e._tfengine=new Wb(t)}return hy=e._tfengine.ENV,xb=function(){return e._tfengine},e._tfengine}();function jb(){if("undefined"!=typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Hb(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var Gb=cy();Gb.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),Gb.registerFlag("IS_BROWSER",(function(){return Hb()})),Gb.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),Gb.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),Gb.registerFlag("PROD",(function(){return!1})),Gb.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return Gb.getBool("DEBUG")})),Gb.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),Gb.registerFlag("IS_TEST",(function(){return!1}));var qb="Add",Kb="AddN",Xb="Atan2",Zb="AvgPool",Yb="AvgPoolBackprop",$b="AvgPool3D",Jb="AvgPool3DBackprop",Qb="BatchMatMul",ek="BatchToSpaceND",tk="BroadcastTo",nk="Complex",rk="Concat",ak="Conv2D",ik="Conv2DBackpropFilter",ok="Conv2DBackpropInput",sk="Conv3D",uk="Conv3DBackpropFilterV2",ck="Conv3DBackpropInputV2",lk="Cumsum",hk="DepthToSpace",fk="DepthwiseConv2dNative",dk="DepthwiseConv2dNativeBackpropFilter",pk="DepthwiseConv2dNativeBackpropInput",vk="Diag",mk="Div",gk="Elu",yk="EluGrad",bk="Equal",kk="FloorDiv",_k="Fill",wk="FusedBatchNorm",Ck="GatherNd",xk="Greater",Sk="GreaterEqual",Ak="Identity",Ik="Imag",Tk="Less",Ek="LessEqual",Rk="LRN",Nk="LRNBackprop",Ok="Max",Dk="Maximum",Fk="MaxPool",Mk="MaxPoolBackprop",Pk="MaxPool3D",zk="MaxPool3DBackprop",Lk="MaxPoolWithArgmax",Bk="Minimum",Vk="Mod",Wk="Multiply",Uk="NotEqual",jk="NonMaxSuppressionV3",Hk="NonMaxSuppressionV5",Gk="OneHot",qk="PadV2",Kk="Pool",Xk="Pow",Zk="Prelu",Yk="Real",$k="Relu",Jk="Relu6",Qk="SelectV2",e_="Selu",t_="SpaceToBatchND",n_="SplitV",r_="SquaredDifference",a_="Square",i_="Sub",o_="Tile",s_="Transpose",u_="FromPixels";function c_(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function l_(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function h_(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,"."));n.unshift(i)}}return n}var f_={kernelName:qb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=e,n=l_(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=l_(a.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(a.shape)}}}},d_={kernelName:Kb,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}};function p_(e,t){var n=e;if($y(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||$y(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&cy().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||$y(t)){Ry(n.length>0,(function(){return"Element arr[".concat(r.join("]["),"] should be a primitive, ")+"but is an array of ".concat(t.length," elements")})),Ry(t.length===n[0],(function(){return"Element arr[".concat(r.join("]["),"] should have ").concat(n[0]," ")+"elements, but has ".concat(t.length," elements")}));for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else Ry(0===n.length,(function(){return"Element arr[".concat(r.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(n[0]," elements")}))}(e,r,[]),r}function v_(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}function m_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Ab)return v_(r,e.dtype,t,n),e;var a=rb(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),v_(r,a,t,n),null==e||!$y(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(null==e?"null":e.constructor.name,"'"));var i=p_(e,a);$y(e)||Array.isArray(e)||(e=[e]);var o="string"!==a?sb(e,a,cy().getBool("DEBUG")):Dy(e,[],!0);return Ub.makeTensor(o,i,a)}function g_(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return m_(e,"".concat(t,"[").concat(r,"]"),n)}),r)}function y_(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){Ub.startScope(n);try{var e=r.apply(void 0,arguments);return e instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),Ub.endScope(e),e}catch(t){throw Ub.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var b_=y_({add_:function(e,t){var n,r=m_(e,"a","add"),a=m_(t,"b","add");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.add(r,a);return t([r,a]),n}),{a:r,b:a},null,qb)}});function k_(e,t){var n=e[0].length;e.forEach((function(e,t){Ry(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),Ry(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)Ry(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function __(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var w_=y_({complex_:function(e,t){var n=m_(e,"real","complex"),r=m_(t,"imag","complex");return Ny(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex()."),Ub.runKernelFunc((function(e){return e.complex(n,r)}),{real:n,imag:r},null,nk)}}),C_=y_({imag_:function(e){var t=m_(e,"input","imag");return Ub.runKernelFunc((function(e){return e.imag(t)}),{input:t},null,Ik)}}),x_=y_({real_:function(e){var t=m_(e,"input","real");return Ub.runKernelFunc((function(e){return e.real(t)}),{input:t},null,Yk)}});function S_(e,t,n){return A_(e,t,p_(e,n),n)}function A_(e,t,n,r){if(null==r&&(r=rb(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!$y(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){fb(t);var a=Fy(t),i=Fy(n);Ry(a===i,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(i)}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==Fy(t.slice(o));Ry(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return $y(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?sb(e,r,cy().getBool("DEBUG")):Dy(e,[],!0),Ub.makeTensor(e,t,r)}function I_(e,t){if(($y(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&$y(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return A_(e,[],[],t)}function T_(e,t){Oy(e);var n=p_(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return A_(e,null,n,t)}function E_(e,t,n){if(Oy(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=p_(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return A_(e,t,r,n)}function R_(e,t,n){if(Oy(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=p_(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return A_(e,t,r,n)}function N_(e,t,n){if(Oy(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=p_(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return A_(e,t,r,n)}function O_(e,t,n){if(Oy(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=p_(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return A_(e,t,r,n)}function D_(e,t,n){if(Oy(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=p_(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return A_(e,t=t||r,r,n)}function F_(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;return Ub.makeVariable(e,t,n,r)}function M_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=M_(e,"float32"),r=P_(e,"float32");return w_(n,r)}var a=cb(Fy(e),t);return Ub.makeTensor(a,e,t)}function P_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=P_(e,"float32"),r=P_(e,"float32");return w_(n,r)}var a=lb(Fy(e),t);return Ub.makeTensor(a,e,t)}function z_(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return Ub.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})}function L_(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return P_([0],r);var a=lb(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return T_(a,r)}var B_=y_({onesLike_:function(e){var t=m_(e,"x","onesLike");if("complex64"===t.dtype){var n=B_(x_(t)),r=V_(C_(t));return w_(n,r)}return Ub.runKernelFunc((function(e){return e.onesLike(t)}),{x:t},(function(e,t){return{x:function(){return V_(e)}}}),"OnesLike")}}),V_=y_({zerosLike_:function(e){var t=m_(e,"x","zerosLike");return Ub.runKernelFunc((function(e){return e.zerosLike(t)}),{x:t},(function(e,t){return{x:function(){return V_(e)}}}),"ZerosLike")}}),W_=y_({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Ry(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=g_(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}));var r=Hy(t,n[0].shape)[0],a=__(n.map((function(e){return e.shape})),r);return 0===Fy(a)?S_([],a):1===(n=n.filter((function(e){return e.size>0}))).length?n[0]:(k_(n.map((function(e){return e.shape})),r),Ub.runKernelFunc((function(e,t){var a=e.concat(n,r);return t(n),a}),n,null,rk,{axis:t}))}});function U_(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",fb(e),new Cb(e,t,n)}function j_(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}var H_=y_({cast_:function(e,t){var n=m_(e,"x","cast");if(!Zy(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");return Ub.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",{dtype:t})}}),G_=y_({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=m_(e,"x","expandDims",null);Ry(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(Ry(-(n.rank+1)<=t,(function(){return"Axis must be in the interval [".concat(-(n.rank+1),", ").concat(n.rank,"]")})),t=n.rank+t+1),r.splice(t,0,1),q_(n,r)}}),q_=y_({reshape_:function(e,t){var n=m_(e,"x","reshape",null);return t=jy(t,n.size),Ry(n.size===Fy(t),(function(){return"new shape and old shape must have the same number of elements."})),Ub.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",{shape:t})}}),K_=y_({squeeze_:function(e,t){var n=m_(e,"x","squeeze");return q_(n,Gy(n.shape,t).newShape)}}),X_=y_({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=g_(e,"tensors","stack");if(Ry(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].shape,a=n[0].dtype;Ry(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){Ny(r,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){Ry(a===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var i=n.map((function(e){return e.expandDims(t)}));return W_(i,t)}}),Z_=y_({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=t||0;var n=m_(e,"x","unstack");return Ry(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")})),t<0&&(t+=n.shape.length),Ub.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return X_(e,t)}}}),"Unpack",{axis:t})}}),Y_=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m_(t,"x","setdiff1d"),a=m_(n,"y","setdiff1d"),Ry(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),Ry(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),Ry(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=4,r.data();case 4:return i=e.sent,e.next=7,a.data();case 7:for(o=e.sent,s=new Set(o),u=0,c=0;c<i.length;c++)s.has(i[c])||u++;for(l=new Cb([u],r.dtype),h=new Cb([u],"int32"),f=0,d=0;f<i.length;f++)s.has(i[f])||(l.values[d]=i[f],h.values[d]=f,d++);return e.abrupt("return",[l.toTensor(),h.toTensor()]);case 14:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),$_=y_({floorDiv_:function(e,t){var n,r=m_(e,"a","floorDiv"),a=m_(t,"b","floorDiv");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.floorDiv(r,a);return t([r,a]),n}),{a:r,b:a},null,kk)}}),J_=y_({div_:function(e,t){var n,r=m_(e,"a","div"),a=m_(t,"b","div");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype?$_(r,a):Ub.runKernelFunc((function(e,t){var n=e.realDivide(r,a);return t([r,a]),n}),{a:r,b:a},null,mk,{})}}),Q_=y_({mul_:function(e,t){var n,r=m_(e,"a","mul"),a=m_(t,"b","mul");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.multiply(r,a);return t([r,a]),n}),{a:r,b:a},null,Wk)}});function ew(e){return Ry(ab(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=m_(t,"x","tf.grad",null),a=null!=n?m_(n,"dy","tf.grad"):null;return Ub.tidy((function(){var t=Ub.gradients((function(){return e(r)}),[r],a),n=t.value,i=t.grads;return null!=a&&Ny(n.shape,a.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),ow(i),i[0]}))}}function tw(e){return Ry(ab(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){Ry(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var r=g_(t,"args","tf.grads",null),a=null!=n?m_(n,"dy","tf.grads"):null;return Ub.tidy((function(){var t=Ub.gradients((function(){return e.apply(void 0,_toConsumableArray(r))}),r,a),n=t.value,i=t.grads;return null!=a&&Ny(n.shape,a.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ow(i),i}))}}function nw(e){return Ry(ab(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){Ry(t instanceof Ab,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),Ry(null==n||n instanceof Ab,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=Ub.gradients((function(){return e(t)}),[t],n),a=r.grads,i=r.value;return ow(a),{grad:a[0],value:i}}}function rw(e){return Ry(ab(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){Ry(Array.isArray(t)&&t.every((function(e){return e instanceof Ab})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),Ry(null==n||n instanceof Ab,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var r=Ub.gradients((function(){return e.apply(void 0,_toConsumableArray(t))}),t,n);return null!=n&&Ny(r.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),ow(r.grads),r}}function aw(e,t){Ry(ab(e),(function(){return"The f passed in variableGrads(f) must be a function"})),Ry(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof Ob})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],Ub.registeredVariables)t.push(Ub.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;Ry((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(i," variables is ")+"trainable."}));var o=Ub.gradients(e,t,null,!0),s=o.value,u=o.grads;Ry(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),Ry(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(s.rank," tensor")}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}function iw(e){return Ub.customGrad(e)}function ow(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}function sw(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function uw(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function cw(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function lw(e,t){return uw(e,t.map((function(e){return 1})),t)}function hw(e,t,n){Ry(sw(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function fw(e,t){if(sw(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function dw(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function pw(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function vw(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(lw(t.shape,r))),e.rank<n.rank&&(e=e.reshape(lw(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==a?r:r.transpose(a)}}}var mw=y_({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","all","bool"),a=Hy(t,r.shape),i=a,o=fw(i,r.rank);null!=o&&(r=r.transpose(o),i=pw(i.length,r.rank));var s=Ub.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=lw(s.shape,a);return s.reshape(u)}return s}}),gw=y_({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","any","bool"),a=Hy(t,r.shape),i=a,o=fw(i,r.rank);null!=o&&(r=r.transpose(o),i=pw(i.length,r.rank));var s=Ub.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=lw(s.shape,a);return s.reshape(u)}return s}}),yw=y_({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=m_(e,"x","argMax");null==t&&(t=0);var r=Hy(t,n.shape),a=fw(r,n.rank);return null!=a&&(n=n.transpose(a),r=pw(r.length,n.rank)),Ub.runKernelFunc((function(e,t){var a=e.argMax(n,r[0]);return t([n]),a}),{x:n},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return V_(n)}}}),"ArgMax",{axis:r[0]},[n])}}),bw=y_({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=m_(e,"x","argMin");null==t&&(t=0);var r=Hy(t,n.shape),a=fw(r,n.rank);return null!=a&&(n=n.transpose(a),r=pw(r.length,n.rank)),Ub.runKernelFunc((function(e,t){var a=e.argMin(n,r[0]);return t([n]),a}),{$x:n},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return V_(n)}}}))}}),kw=y_({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","logSumExp"),a=Hy(t,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var u=lw(s.shape,a);return s.reshape(u)}return s}}),_w=y_({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","mean"),a=Hy(t,r.shape),i=Fy(cw(r.shape,a)[1]);return iw((function(e){var r=I_(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(M_(e.shape,"float32")).div(i)}}}))(r)}}),ww=y_({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","min"),a=r,i=Hy(t,r.shape),o=i,s=fw(o,r.rank);null!=s&&(r=r.transpose(s),o=pw(o.length,r.rank));var u=Ub.runKernelFunc((function(e,t){var n=e.min(r,o);return t([a,n]),n}),{x:r},(function(e,t){return vw(e,t[1],t[0],i,s)}),"Min",{axes:o},[r],[!0]);if(n){var c=lw(u.shape,i);u=u.reshape(c)}return u}}),Cw=y_({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Hy(t,(e=m_(e,"x","moments")).shape),a=e.mean(r,n),i=a.shape;n||(i=lw(a.shape,r));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),xw=y_({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=Hy(t,r.shape);return iw((function(e){var t=fw(a,e.rank),r=a,i=e;null!=t&&(i=e.transpose(t),r=pw(r.length,e.rank));var o=function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(M_(e.shape,"float32"))},s=Ub.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return o(e)}}}),"Sum",{axes:r});if(n){var u=lw(s.shape,a);s=s.reshape(u)}return{value:s,gradFunc:o}}))(r)}}),Sw=y_({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=Hy(t,r.shape),i=fw(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=pw(o.length,r.rank));var u=Ub.runKernelFunc((function(e){return e.prod(s,o)}),{permutedX:s});if(n){var c=lw(u.shape,a);u=u.reshape(c)}return u}}),Aw=y_({square_:function(e){var t=m_(e,"x","square");return Ub.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},[t],[])}}),Iw=y_({abs_:function(e){var t=m_(e,"x","abs");return"complex64"===t.dtype?Ub.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):Ub.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),Tw=y_({acos_:function(e){var t=m_(e,"x","acos");return Ub.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){var t=n.toFloat().square(),r=I_(1).sub(t).sqrt();return e.div(r).neg()}}}))}}),Ew=y_({acosh_:function(e){var t=m_(e,"x","acosh");return Ub.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){var t=n.toFloat().square().sub(1).sqrt();return e.div(t)}}}))}}),Rw=y_({asin_:function(e){var t=m_(e,"x","asin");return Ub.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(I_(1).sub(n.toFloat().square()).sqrt())}}}))}}),Nw=y_({asinh_:function(e){var t=m_(e,"x","asinh");return Ub.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){var t=I_(1).add(n.toFloat().square()).sqrt();return e.div(t)}}}))}}),Ow=y_({atan_:function(e){var t=m_(e,"x","atan");return Ub.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),Dw=y_({atanh_:function(e){var t=m_(e,"x","atanh");return Ub.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(I_(1).sub(n.toFloat().square()))}}}))}}),Fw=y_({ceil_:function(e){var t=m_(e,"x","ceil");return Ub.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),Mw=y_({clipByValue_:function(e,t,n){var r=m_(e,"x","clipByValue");return Ry(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")})),Ub.runKernelFunc((function(e,a){var i=e.clip(r,t,n);return a([r]),i}),{x:r},(function(e,r){var a=_slicedToArray(r,1)[0];return{x:function(){return e.where(a.greaterEqual(t).logicalAnd(a.lessEqual(n)),V_(e))}}}),"ClipByValue",{min:t,max:n},[r])}}),Pw=y_({cos_:function(e){var t=m_(e,"x","cos");return Ub.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},[t])}}),zw=y_({cosh_:function(e){var t=m_(e,"x","cosh");return Ub.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return n.toFloat().sinh().mul(e)}}}))}}),Lw=y_({erf_:function(e){var t=m_(e,"x","erf");return Ry("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),Ub.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Bw=y_({exp_:function(e){var t=m_(e,"x","exp");return Ub.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mul(t[0])}}}),"Exp",{},[],[!0])}}),Vw=y_({expm1_:function(e){var t=m_(e,"x","expm1");return Ub.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.mul(n.exp())}}}))}}),Ww=y_({floor_:function(e){var t=m_(e,"x","floor");return Ub.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),Uw=y_({log_:function(e){var t=m_(e,"x","log");return Ub.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},[t])}}),jw=y_({log1p_:function(e){var t=m_(e,"x","log1p");return Ub.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(n.add(1))}}}))}}),Hw=y_({logSigmoid_:function(e){var t=m_(e,"x","logSigmoid");return Ub.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),Gw=y_({neg_:function(e){var t=m_(e,"x","neg");return Ub.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},[t])}}),qw=y_({reciprocal_:function(e){var t=m_(e,"x","reciprocal");return Ub.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),Kw=y_({round_:function(e){var t=m_(e,"x","round");return Ub.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),Xw=y_({rsqrt_:function(e){var t=m_(e,"x","rsqrt");return Ub.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},[t])}}),Zw=y_({sigmoid_:function(e){var t=m_(e,"x","sigmoid");return Ub.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return e.mul(n.mul(I_(1).sub(n)))}}}),"Sigmoid")}}),Yw=y_({sign_:function(e){var t=m_(e,"x","sign");return Ub.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),$w=y_({isNaN_:function(e){var t=m_(e,"x","isNaN");return Ub.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),Jw=y_({isInf_:function(e){var t=m_(e,"x","isInf");return Ub.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),Qw=y_({isFinite_:function(e){var t=m_(e,"x","isFinite");return Ub.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return V_(e)}}}))}}),eC=y_({sin_:function(e){var t=m_(e,"x","sin");return Ub.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},[t])}}),tC=y_({sinh_:function(e){var t=m_(e,"x","sinh");return Ub.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return n.toFloat().cosh().mul(e)}}}))}}),nC=y_({softplus_:function(e){var t=m_(e,"x","softplus");return Ub.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),rC=y_({sqrt_:function(e){var t=m_(e,"x","sqrt");return Ub.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}),"Sqrt",{})}}),aC=y_({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=m_(e,"x","step");return Ub.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return V_(e)}}}))}}),iC=y_({tan_:function(e){var t=m_(e,"x","tan");return Ub.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),oC=y_({tanh_:function(e){var t=m_(e,"x","tanh");return Ub.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return I_(1).sub(n.square()).mul(e)}}}),"Tanh",{},null,[!0])}}),sC={kernelName:Xb,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=b_(Aw(r),Aw(a)),n=Q_(e,J_(a,t)),o=l_(r.shape,i);return o.length>0&&(n=xw(n,o)),q_(n,r.shape)},b:function(){var t=b_(Aw(r),Aw(a)),n=Gw(Q_(e,J_(r,t))),o=l_(a.shape,i);return o.length>0&&(n=xw(n,o)),q_(n,a.shape)}}}};function uC(e,t,n,r,a,i){var o,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=dC(t),c=_slicedToArray(u,2),l=c[0],h=c[1];if("channelsLast"===s)o=[l,h,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));o=[l,h,e[1],e[1]]}return lC(e,o,n,r,a,i,!1,s)}function cC(e,t,n,r,a,i){var o,s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=pC(t),l=_slicedToArray(c,3),h=l[0],f=l[1],d=l[2];if("NDHWC"===u)s="channelsLast",o=[h,f,d,e[4],e[4]];else{if("NCDHW"!==u)throw new Error("Unknown dataFormat ".concat(u));s="channelsFirst",o=[h,f,d,e[1],e[1]]}return hC(e,o,n,r,a,!1,s,i)}function lC(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,c=-1,l=-1,h=-1;if("channelsLast"===s){var f=_slicedToArray(e,4);u=f[0],c=f[1],l=f[2],h=f[3]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var d=_slicedToArray(e,4);u=d[0],h=d[1],c=d[2],l=d[3]}var p,v=_slicedToArray(t,4),m=v[0],g=v[1],y=v[3],b=dC(n),k=_slicedToArray(b,2),_=k[0],w=k[1],C=dC(r),x=_slicedToArray(C,2),S=x[0],A=x[1],I=vC(m,S),T=vC(g,A),E=function(e,t,n,r,a,i,o,s,u){var c,l,h;if("number"==typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=fC(e,t,n));var i=e[1],o=mC((e[0]-t+2*r)/n+1,a);Ry(zy(o),(function(){return"The output # of rows (".concat(o,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var s=mC((i-t+2*r)/n+1,a);return Ry(zy(s),(function(){return"The output # of columns (".concat(s,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[o,s]}([t,n],i,r,e,s);l=f[0],h=f[1]}else if("same"===e){l=Math.ceil(t/r),h=Math.ceil(n/a);var d=Math.max(0,(l-1)*r+i-t),p=Math.max(0,(h-1)*a+o-n),v=Math.floor(d/2),m=d-v,g=Math.floor(p/2);c={top:v,bottom:m,left:g,right:p-g,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!=typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===u?e[1][0]:e[2][0],b="channelsLast"===u?e[1][1]:e[2][1],k="channelsLast"===u?e[2][0]:e[3][0],_="channelsLast"===u?e[2][1]:e[3][1];c={top:y,bottom:b,left:k,right:_,type:0===y&&0===b&&0===k&&0===_?"VALID":"EXPLICIT"},l=mC((t-i+y+b)/r+1,s),h=mC((n-o+k+_)/a+1,s)}return{padInfo:c,outHeight:l,outWidth:h}}(a,c,l,_,w,I,T,i,s),R=E.padInfo,N=E.outHeight,O=E.outWidth,D=o?y*h:y;return"channelsFirst"===s?p=[u,D,N,O]:"channelsLast"===s&&(p=[u,N,O,D]),{batchSize:u,dataFormat:s,inHeight:c,inWidth:l,inChannels:h,outHeight:N,outWidth:O,outChannels:D,padInfo:R,strideHeight:_,strideWidth:w,filterHeight:m,filterWidth:g,effectiveFilterHeight:I,effectiveFilterWidth:T,dilationHeight:S,dilationWidth:A,inShape:e,outShape:p,filterShape:t}}function hC(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=arguments.length>7?arguments[7]:void 0,u=-1,c=-1,l=-1,h=-1,f=-1;if("channelsLast"===o){var d=_slicedToArray(e,5);u=d[0],c=d[1],l=d[2],h=d[3],f=d[4]}else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat ".concat(o));var p=_slicedToArray(e,5);u=p[0],f=p[1],c=p[2],l=p[3],h=p[4]}var v,m=_slicedToArray(t,5),g=m[0],y=m[1],b=m[2],k=m[4],_=pC(n),w=_slicedToArray(_,3),C=w[0],x=w[1],S=w[2],A=pC(r),I=_slicedToArray(A,3),T=I[0],E=I[1],R=I[2],N=vC(g,T),O=vC(y,E),D=vC(b,R),F=function(e,t,n,r,a,i,o,s,u,c,l){var h,f,d,p;if("number"==typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=fC(e,t,r));var o=e[1],s=e[2],u=mC((e[0]-t+2*a)/r+1,i);Ry(zy(u),(function(){return"The output # of depths (".concat(u,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var c=mC((o-t+2*a)/r+1,i);Ry(zy(c),(function(){return"The output # of rows (".concat(c,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var l=mC((s-t+2*a)/r+1,i);return Ry(zy(l),(function(){return"The output # of columns (".concat(l,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[u,c,l,1]}([t,n,r,1],s,0,a,e,l);f=v[0],d=v[1],p=v[2]}else if("same"===e){var m=((f=Math.ceil(t/a))-1)*a+s-t,g=((d=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(m/2),k=m-b,_=Math.floor(g/2),w=g-_,C=Math.floor(y/2);h={top:_,bottom:w,left:C,right:y-C,front:b,back:k,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((t-s+1)/a),d=Math.ceil((n-u+1)/i),p=Math.ceil((r-c+1)/o)}return{padInfo:h,outDepth:f,outHeight:d,outWidth:p}}(a,c,l,h,C,x,S,N,O,D,s),M=F.padInfo,P=F.outDepth,z=F.outHeight,L=F.outWidth,B=i?k*f:k;return"channelsFirst"===o?v=[u,B,P,z,L]:"channelsLast"===o&&(v=[u,P,z,L,B]),{batchSize:u,dataFormat:o,inDepth:c,inHeight:l,inWidth:h,inChannels:f,outDepth:P,outHeight:z,outWidth:L,outChannels:B,padInfo:M,strideDepth:C,strideHeight:x,strideWidth:S,filterDepth:g,filterHeight:y,filterWidth:b,effectiveFilterDepth:N,effectiveFilterHeight:O,effectiveFilterWidth:D,dilationDepth:T,dilationHeight:E,dilationWidth:R,inShape:e,outShape:v,filterShape:t}}function fC(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=vC(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function dC(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function pC(e){return"number"==typeof e?[e,e,e]:e}function vC(e,t){return t<=1?e:e+(e-1)*(t-1)}function mC(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function gC(e){var t=_slicedToArray(dC(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function yC(e,t){return gC(e)||gC(t)}function bC(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}var kC=y_({avgPool3dBackprop_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=m_(e,"dy","avgPool3dBackprop"),u=m_(t,"input","avgPool3dBackprop"),c=s,l=u,h=!1;4===u.rank&&(h=!0,c=q_(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),l=q_(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Ry(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+"".concat(c.rank,".")})),Ry(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+"".concat(l.rank,".")})),Ry(yC(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(r," and dilations '").concat(a,"'")})),null!=o&&Ry(zy(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var f=Ub.runKernelFunc((function(e){var t=cC(l.shape,n,r,a,i,o);return e.avgPool3dBackprop(c,l,t)}),{dy:c,input:l},null,Jb,{filterSize:n,strides:r,dilations:a,pad:i,dimRoundingMode:o});return h?q_(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}}),_C={kernelName:$b,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.filterSize,i=n.strides,o=n.dilations,s=n.pad,u=n.dimRoundingMode,c=null==o?[1,1,1]:o;return{x:function(){return kC(e,r,a,i,c,s,u)}}}},wC=y_({avgPoolBackprop_:function(e,t,n,r,a){var i=m_(e,"dy","avgPoolBackprop"),o=m_(t,"input","avgPoolBackprop");Ry(o.rank===i.rank,(function(){return"Rank of input (".concat(o.rank,") does not match rank of dy (").concat(i.rank,")")}));var s=o,u=i,c=!1;3===o.rank&&(c=!0,s=q_(o,[1,o.shape[0],o.shape[1],o.shape[2]]),u=q_(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ry(4===u.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),Ry(4===s.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+"".concat(s.rank,".")}));var l=Ub.runKernelFunc((function(e){var t=uC(s.shape,n,r,1,a);return e.avgPoolBackprop(u,s,t)}),{dy:u,input:s},null,Yb,{filterSize:n,strides:r,pad:a});return c?q_(l,[l.shape[1],l.shape[2],l.shape[3]]):l}}),CC={kernelName:Zb,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.filterSize,i=n.strides,o=n.pad;return{x:function(){return wC(e,r,a,i,o)}}}},xC=y_({matMul_:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=m_(e,"a","matMul"),o=m_(t,"b","matMul");n=_slicedToArray(Pb(i,o),2),i=n[0],o=n[1],Ry(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, "+"got ranks ".concat(i.rank," and ").concat(o.rank,".")}));var s=r?i.shape[i.rank-2]:i.shape[i.rank-1],u=a?o.shape[o.rank-1]:o.shape[o.rank-2],c=r?i.shape[i.rank-1]:i.shape[i.rank-2],l=a?o.shape[o.rank-2]:o.shape[o.rank-1],h=i.shape.slice(0,-2),f=o.shape.slice(0,-2),d=Fy(h),p=Fy(f);Ry(Py(h,f),(function(){return"Error in matMul: outer dimensions (".concat(h,") and (")+"".concat(f,") of Tensors with shapes ").concat(i.shape," and ")+"".concat(o.shape," must match.")})),Ry(s===u,(function(){return"Error in matMul: inner shapes (".concat(s,") and (")+"".concat(u,") of Tensors with shapes ").concat(i.shape," and ")+"".concat(o.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var v=i.shape.slice(0,-2).concat([c,l]),m=q_(i,r?[d,s,c]:[d,c,s]),g=q_(o,a?[p,l,u]:[p,u,l]),y=Ub.runKernelFunc((function(e,t){return t([m,g]),e.batchMatMul(m,g,r,a)}),{a:m,b:g},null,Qb,{transposeA:r,transposeB:a});return q_(y,v)}}),SC={kernelName:Qb,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.transposeA,s=n.transposeB;return o||s?!o&&s?{a:function(){return xC(e,i,!1,!1)},b:function(){return xC(e,a,!0,!1)}}:o&&!s?{a:function(){return xC(i,e,!1,!0)},b:function(){return xC(a,e,!1,!1)}}:{a:function(){return xC(i,e,!0,!0)},b:function(){return xC(e,a,!0,!0)}}:{a:function(){return xC(e,i,!1,!0)},b:function(){return xC(a,e,!0,!1)}}}},AC=y_({spaceToBatchND_:function(e,t,n){var r=m_(e,"x","spaceToBatchND");return Ry(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),Ry(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),Ry(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())})),Ub.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{x:r},null,t_,{blockShape:t,paddings:n})}}),IC={kernelName:ek,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return AC(e,r,a)}}}},TC={kernelName:tk,gradFunc:function(e,t,n){for(var r=n.inputShape,a=n.shape,i=Array.from(a),o=r.length-1;o>=0;o--)if(r[o]===a[o])i[o]=1;else if(1!==r[o])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(a,"]."));for(var s=[],u=0;u<i.length;u++)i[u]>1&&s.push(u);return{x:function(){return xw(e,s,!0)}}}},EC=y_({split_:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=m_(e,"x","split"),i=Hy(r,a.shape)[0];return"number"==typeof t?(Ry(a.shape[i]%t==0,(function(){return"Number of splits must evenly divide the axis."})),n=new Array(t).fill(a.shape[i]/t)):(Ry(a.shape[i]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),n=t),Ub.runKernelFunc((function(e,t){return e.split(a,n,i)}),{x:a},null,n_,{numOrSizeSplits:t,axis:r})}}),RC={kernelName:rk,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=Hy(n.axis,t[0].shape)[0],i=r.map((function(e){return e[a]}));return EC(e,i,a).map((function(e){return function(){return e}}))}},NC=y_({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=q_(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var u=t;3===u.rank&&(u=q_(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Ry(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),Ry(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(u.shape,".")})),Ry(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];return Ry(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),Ry(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=o&&Ry(zy(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")})),Ub.runKernelFunc((function(e){var t=bC(i),c=lC(s.shape,n,r,1,a,o,!1,t);return e.conv2dDerFilter(s,u,c)}),{x:s,dy:u},null,ik,{strides:r,pad:a,dataFormat:i,dimRoundingMode:o})}}),OC=y_({conv2DBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0;Ry(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=q_(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),Ry(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(s.length,".")})),Ry(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(u.rank)})),Ry(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===i?s[3]:s[1],h="NHWC"===i?u.shape[3]:u.shape[1];Ry(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),Ry(h===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=o&&Ry(zy(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var f=Ub.runKernelFunc((function(e,t){var c=bC(i),l=lC(s,n.shape,r,1,a,o,!1,c),h=e.conv2dDerInput(u,n,l);return t([u,n]),h}),{dy:u,filter:n},null,ok,{strides:r,pad:a,dataFormat:i,dimRoundingMode:o});return c?q_(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),DC={kernelName:ak,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.dilations,s=n.strides,u=n.pad,c=n.dataFormat;return Ry(gC(o),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(o,"'")})),{x:function(){return OC(a.shape,e,i,s,u,c)},filter:function(){return NC(a,e,i.shape,s,u,c)}}}},FC=y_({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=m_(e,"x","conv2d"),u=m_(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=q_(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Ry(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),Ry(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),null!=o&&Ry(zy(r),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h="NHWC"===a?c.shape[3]:c.shape[1];Ry(h===u.shape[2],(function(){return"Error in conv2d: depth of input (".concat(h,") must match ")+"input depth for filter ".concat(u.shape[2],".")})),Ry(yC(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")}));var f=Ub.runKernelFunc((function(e,t){var s=bC(a),l=lC(c.shape,u.shape,n,i,r,o,!1,s),h=e.conv2d(c,u,l);return t([c,u]),h}),{x:c,filter:u},null,ak,{strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o});return l?q_(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),MC={kernelName:ok,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.strides,s=n.pad,u=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return FC(e,i,o,s,u,1,c)},filter:function(){return NC(e,a,i.shape,o,s,u,c)}}}},PC=y_({conv3DBackpropFilter_:function(e,t,n,r,a){var i=e;4===e.rank&&(i=q_(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var o=t;return 4===o.rank&&(o=q_(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Ry(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(i.shape,".")})),Ry(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(o.shape,".")})),Ry(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),Ry(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(i.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),Ry(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(o.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")})),Ub.runKernelFunc((function(e){var t=hC(i.shape,n,r,1,a);return e.conv3dDerFilter(i,o,t)}),{x:i,y:o},null,uk,{strides:r,pad:a})}}),zC=y_({conv3DBackpropInput_:function(e,t,n,r,a){Ry(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=q_(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];Ry(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(i.length,".")})),Ry(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(o.rank)})),Ry(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),Ry(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(u,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),Ry(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l=Ub.runKernelFunc((function(e){var t=hC(i,n.shape,r,1,a);return e.conv3dDerInput(o,n,t)}),{dy:o},null,ck,{pad:a});return s?q_(l,[l.shape[1],l.shape[2],l.shape[3],l.shape[4]]):l}}),LC={kernelName:sk,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad;Ry(gC(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var o=_slicedToArray(t,2),s=o[0],u=o[1];return{x:function(){return zC(s.shape,e,u,a,i)},filter:function(){return PC(s,e,u.shape,a,i)}}}},BC=y_({transpose_:function(e,t){var n=m_(e,"x","transpose");return null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),Ry(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){Ry(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1?n.clone():Ub.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},null,"Transpose",{perm:t})}}),VC=y_({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=m_(e,"x","cumsum");return Ub.runKernelFunc((function(e,i){var o=fw([t],a.rank),s=a;null!=o&&(s=BC(a,o));var u=pw(1,a.rank)[0],c=e.cumsum(s,u,n,r);return i([a]),null!=o&&(c=BC(c,o)),c}),{x:a},null,lk,{axis:t,exclusive:n,reverse:r})}}),WC={kernelName:lk,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.axis,i=n.exclusive,o=n.reverse;return{x:function(){var t=fw([a],r.rank),n=VC(e,a,i,!o);return null!=t&&(n=BC(n,t)),n}}}},UC=y_({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=q_(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var i=t;return 3===i.rank&&(i=q_(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Ub.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(a,i,r)}),{x:a,dy:i},null,dk)}}),jC=y_({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r){var a=t,i=!1;3===t.rank&&(i=!0,a=q_(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var o=Ub.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(a,n,r)}),{dy:a},null,pk);return i?q_(o,[o.shape[1],o.shape[2],o.shape[3]]):o}}),HC={kernelName:fk,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,i=n.pad,o=n.dimRoundingMode,s=null==r?[1,1]:r;Ry(gC(s),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var u=_slicedToArray(t,2),c=u[0],l=u[1];Ry(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),Ry(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),Ry(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),Ry(yC(a,s),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(s,"'.")})),null!=o&&Ry(zy(i),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")}));var h=lC(c.shape,l.shape,a,s,i,o,!0);return{x:function(){return jC(c.shape,e,l,h)},filter:function(){return UC(c,e,l.shape,h)}}}},GC={kernelName:mk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=J_(e,a.toFloat()),n=l_(r.shape,i);return n.length>0?xw(t,n).reshape(r.shape):t},b:function(){var t=Q_(e,r.toFloat()),n=l_(a.shape,i);n.length>0&&(t=q_(xw(t,n),a.shape));var o=Aw(a);return Gw(J_(t,o.toFloat()))}}}},qC={kernelName:gk,outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0],r=function(t){return t.eluDer(e,n)},a={dy:e,y:n};return{x:function(){return Ub.runKernelFunc(r,a,null,yk)}}}},KC={kernelName:kk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=e.div(a.toFloat()),n=l_(r.shape,i);return n.length>0?t.sum(n).reshape(r.shape):t},b:function(){var t=e.mul(r.toFloat()),n=l_(a.shape,i);n.length>0&&(t=t.sum(n).reshape(a.shape));var o=a.square();return t.div(o.toFloat()).neg()}}}},XC=y_({sub_:function(e,t){var n,r=m_(e,"a","sub"),a=m_(t,"b","sub");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.subtract(r,a);return t([r,a]),n}),{a:r,b:a},null,i_)}}),ZC=y_({tile_:function(e,t){var n=m_(e,"x","tile",null);return Ry(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")})),Ub.runKernelFunc((function(e,r){var a=e.tile(n,t);return r([n]),a}),{x:n},null,o_,{reps:t},[n])}}),YC={kernelName:wk,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=_slicedToArray(t,4),i=a[0],o=a[1],s=a[2],u=a[3],c=null==u?I_(1):u,l=l_(o.shape,i.shape),h=[];if(1===o.rank){for(var f=0;f<i.shape.length-1;++f)h.push(i.shape[f]);h.push(1)}var d=XC(i,o),p=Q_(e,c),v=Xw(b_(s,I_(r))),m=Q_(Q_(Q_(v,v),v),I_(-.5));return{x:function(){return q_(Q_(Q_(e,1===o.rank?ZC(v.as4D(1,1,1,o.shape[0]),h):v),c),i.shape)},mean:function(){var e=Q_(Q_(v,I_(-1)),p);return 1===o.rank&&(e=xw(e,l)),q_(e,o.shape)},variance:function(){var e=Q_(Q_(m,d),p);return 1===o.rank&&(e=xw(e,l)),q_(e,o.shape)},scale:function(){var t=Q_(d,v),n=Q_(e,t);return 1===o.rank&&(n=xw(n,l)),q_(n,o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=xw(t,l)),q_(t,o.shape)}}}},$C={kernelName:Sk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return V_(r)},b:function(){return V_(a)}}}},JC={kernelName:Ak,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},QC=y_({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5;return Ub.runKernelFunc((function(s){return s.LRNGrad(n,e,t,r,a,i,o)}),{x:e,y:t,dy:n},null,Nk,{depthRadius:r,bias:a,alpha:i,beta:o})}}),ex={kernelName:Rk,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.depthRadius,s=n.bias,u=n.alpha,c=n.beta;return{x:function(){return QC(a,i,e,o,s,u,c)}}}},tx={kernelName:Ok,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=_slicedToArray(t,2),i=a[0],o=a[1],s=Hy(r,i.shape),u=fw(s,i.rank),c=vw(e,o,i,s,u);return{x:function(){var e=c.x();return null!=u&&(e=BC(e)),e}}}},nx=y_({greaterEqual_:function(e,t){var n,r=m_(e,"a","greaterEqual"),a=m_(t,"b","greaterEqual");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e,t){var n=e.greaterEqual(r,a);return t([r,a]),n}),{a:r,b:a},null,Sk)}}),rx=y_({less_:function(e,t){var n,r=m_(e,"a","less"),a=m_(t,"b","less");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e){return e.less(r,a)}),{a:r,b:a},null,Tk)}}),ax={kernelName:Dk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return Q_(e,H_(nx(r,a),"float32"))},b:function(){return Q_(e,H_(rx(r,a),"float32"))}}}},ix=y_({maxPool3dBackprop_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7?arguments[7]:void 0,u=m_(e,"dy","maxPool3dBackprop"),c=m_(t,"input","maxPool3dBackprop"),l=m_(n,"output","maxPool3dBackprop"),h=u,f=c,d=l,p=!1;4===c.rank&&(p=!0,h=q_(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),f=q_(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=q_(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),Ry(5===h.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+"".concat(h.rank,".")})),Ry(5===f.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+"".concat(f.rank,".")})),Ry(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+"".concat(d.rank,".")})),Ry(yC(a,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(a," and dilations '").concat(i,"'")})),null!=s&&Ry(zy(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(s," but got pad ").concat(o,".")}));var v=Ub.runKernelFunc((function(e){var t=cC(f.shape,r,a,i,o,s);return e.maxPool3dBackprop(h,f,d,t)}),{dy:h,input:f,output:d},null,zk,{filterSize:r,strides:a,dilations:i,pad:o,dimRoundingMode:s});return p?q_(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}}),ox={kernelName:Pk,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.dilations,c=n.pad,l=n.dimRoundingMode,h=null==u?[1,1,1]:u;return{x:function(){return ix(e,a,i,o,s,h,c,l)}}}},sx=y_({maxPoolBackprop_:function(e,t,n,r,a,i,o){var s=m_(e,"dy","maxPoolBackprop"),u=m_(t,"input","maxPoolBackprop"),c=m_(n,"output","maxPoolBackprop");return Ry(u.rank===s.rank,(function(){return"Rank of input (".concat(u.rank,") does not match rank of dy ")+"(".concat(s.rank,")")})),Ry(4===s.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),Ry(4===u.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+"".concat(u.rank,".")})),null!=o&&Ry(zy(i),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(i,".")})),Ub.runKernelFunc((function(e){var t=uC(u.shape,r,a,1,i,o);return e.maxPoolBackprop(s,u,c,t)}),{dy:s,input:u,output:c},null,Mk,{filterSize:r,strides:a,pad:i,dimRoundingMode:o})}}),ux={kernelName:Fk,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=n.filterSize,s=n.strides,u=n.pad;return{x:function(){return sx(e,a,i,o,s,u)}}}},cx=y_({greater_:function(e,t){var n,r=m_(e,"a","greater"),a=m_(t,"b","greater");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e){return e.greater(r,a)}),{a:r,b:a},null,xk)}}),lx=y_({lessEqual_:function(e,t){var n,r=m_(e,"a","lessEqual"),a=m_(t,"b","lessEqual");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e,t){var n=e.lessEqual(r,a);return t([r,a]),n}),{a:r,b:a},null,Ek)}}),hx={kernelName:Bk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1];return{a:function(){return Q_(e,H_(lx(r,a),"float32"))},b:function(){return Q_(e,H_(cx(r,a),"float32"))}}}},fx={kernelName:Vk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=l_(r.shape,i);return t.length>0?q_(xw(e,t),r.shape):e},b:function(){var t=Q_(e,Gw(Ww(J_(r,a)))),n=l_(a.shape,i);return n.length>0?q_(xw(t,n),a.shape):t}}}},dx={kernelName:Wk,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=Q_(e,H_(a,"float32")),n=l_(r.shape,i);return n.length>0?q_(xw(t,n),r.shape):t},b:function(){var t=Q_(e,H_(r,"float32")),n=l_(a.shape,i);return n.length>0?q_(xw(t,n),a.shape):t}}}},px={kernelName:Gk,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return P_(n.shape,"float32")}}}},vx={kernelName:qk,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return e.slice(a,r.shape)}}}};function mx(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=U_(e,"int32"),i=U_([n.length,e.length],"int32"),o=0;o<n.length;o++){var s=a.indexToLoc(n[o]);i.values.set(s,o*e.length)}return i.toTensor()}var gx=y_({logicalAnd_:function(e,t){var n=m_(e,"a","logicalAnd","bool"),r=m_(t,"b","logicalAnd","bool");return h_(n.shape,r.shape),Ub.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),yx=y_({logicalNot_:function(e){var t=m_(e,"x","logicalNot","bool");return Ub.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),bx=y_({logicalOr_:function(e,t){var n=m_(e,"a","logicalOr","bool"),r=m_(t,"b","logicalOr","bool");return h_(n.shape,r.shape),Ub.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),kx=y_({logicalXor_:function(e,t){var n=m_(e,"a","logicalXor","bool"),r=m_(t,"b","logicalXor","bool");return h_(n.shape,r.shape),bx(e,t).logicalAnd(gx(e,t).logicalNot())}}),_x=y_({where_:function(e,t,n){var r=m_(t,"a","where"),a=m_(n,"b","where"),i=m_(e,"condition","where","bool");return Ny(r.shape,a.shape,"Error in where: "),1===i.rank?Ry(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):Ny(i.shape,a.shape,"Error in where: "),Ub.runKernelFunc((function(e,t){var n=e.select(i,r,a);return t([i]),n}),{condition:i,t:r,e:a},(function(e,t){var n=_slicedToArray(t,1)[0];return{condition:function(){return V_(n).toFloat()},t:function(){return e.mul(n.cast(e.dtype))},e:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}),Qk)}}),wx=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m_(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=mx(n.shape,r),e.abrupt("return",(t!==n&&n.dispose(),a));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Cx=y_({pow_:function(e,t){var n,r=m_(e,"base","pow"),a=m_(t,"exp","pow");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.pow(r,a);return t([r,a,n]),n}),{a:r,b:a},null,Xk)}}),xx={kernelName:Xk,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=_slicedToArray(t,3),r=n[0],a=n[1],i=n[2],o=r,s=a,u=h_(o.shape,s.shape);return{a:function(){var t=H_(s,"float32"),n=Q_(e,Q_(t,Cx(o,XC(t,I_(1))))),r=l_(o.shape,u);return r.length>0&&(n=xw(n,r)),q_(n,o.shape)},b:function(){var t=cx(o,0),n=_x(t,Uw(o),V_(o)),r=Q_(e,Q_(i,n)),a=l_(s.shape,u);return a.length>0&&(r=xw(r,a)),q_(r,s.shape)}}}},Sx={kernelName:Zk,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=cx(r,0);return{x:function(){return _x(i,e,Q_(e,a))},alpha:function(){var t=_x(i,V_(e),Q_(e,r)),n=l_(a.shape,e.shape);return n.length>0&&(t=xw(t,n)),q_(t,a.shape)}}}},Ax={kernelName:Jk,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0],r=Q_(lx(n,6),aC(n));return{x:function(){return Q_(e,H_(r,"float32"))}}}},Ix={kernelName:$k,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Q_(e,H_(aC(n),"float32"))}}}},Tx=1.7580993408473768,Ex=1.0507009873554805,Rx={kernelName:e_,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){var t=cx(n,I_(0)),r=I_(Tx),a=I_(Ex),i=Q_(e,a),o=Q_(Q_(e,r),Bw(H_(n,"float32")));return _x(t,i,o)}}}},Nx=y_({batchToSpaceND_:function(e,t,n){var r=m_(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));return Ry(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),Ry(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),Ry(r.shape[0]%a==0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)})),Ub.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{x:r},null,ek,{blockShape:t,crops:n})}}),Ox={kernelName:t_,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return Nx(e,r,a)}}}},Dx={kernelName:n_,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return W_(e,r)}}}},Fx={kernelName:a_,inputsToSave:["x"],gradFunc:function(e,t){var n=_slicedToArray(t,1)[0];return{x:function(){return Q_(e,Q_(n.toFloat(),2))}}}},Mx={kernelName:r_,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=I_(2);return{a:function(){return Q_(e,Q_(i,XC(r,a)))},b:function(){return Q_(e,Q_(i,XC(a,r)))}}}},Px={kernelName:i_,inputsToSave:["a","b"],gradFunc:function(e,t){var n=_slicedToArray(t,2),r=n[0],a=n[1],i=h_(r.shape,a.shape);return{a:function(){var t=e,n=l_(r.shape,i);return n.length>0&&(t=xw(t,n)),q_(t,r.shape)},b:function(){var t=e,n=l_(a.shape,i);return n.length>0&&(t=xw(t,n)),q_(Gw(t),a.shape)}}}},zx=y_({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=m_(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");return Ub.runKernelFunc((function(e,a){return a([r]),e.pad(r,t,n)}),{x:r},null,qk,{paddings:t,constantValue:n})}});function Lx(e,t,n){Ry(e.rank===t.length,(function(){return"Error in slice".concat(e.rank,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(e.rank,").")})),Ry(e.rank===n.length,(function(){return"Error in slice".concat(e.rank,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(e.rank,").")}));for(var r=function(r){Ry(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice".concat(e.rank,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")")}))},a=0;a<e.rank;++a)r(a)}function Bx(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Vx(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function Wx(e,t,n){for(var r=_toConsumableArray(e),a=0;a<n;a++)0===a?r[t]=1:(r.splice(t,0,1),r.pop());return r}function Ux(e,t,n){for(var r=_toConsumableArray(e),a=0;a<n;a++)0===a?r[t]=0:(r.splice(t,0,0),r.pop());return r}function jx(e,t,n,r){for(var a=_toConsumableArray(e),i=0;i<n;i++)0===i?a[t]=Number.MAX_SAFE_INTEGER:(a.splice(t,0,Number.MAX_SAFE_INTEGER),a.pop());for(var o=0;o<a.length;o++)a[o]=Sy(0,a[o],r[o]);return a}function Hx(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function Gx(e,t,n,r,a,i){var o=t[a];(e&1<<a||i&1<<a||null==o)&&(o=(n[a]||1)>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return o<0&&(o+=s),o=Sy(0,o,s-1)}function qx(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var u=r[a];return o<0&&(o+=u),o=s>0?Sy(0,o,u):Sy(-1,o,u-1)}function Kx(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function Xx(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}for(var Zx,Yx=y_({slice_:function(e,t,n){var r,a,i=m_(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(_toConsumableArray(new Array(i.rank-1).fill(0))):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){Ry(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(_toConsumableArray(new Array(i.rank-1).fill(-1))):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(Ry(-1===e,(function(){return"Negative size values should be exactly -1 but got "+"".concat(e," for the slice() size at index ").concat(t,".")})),i.shape[t]-r[t])})),Lx(i,r,a);var o=i.shape;return Ub.runKernelFunc((function(e){return e.slice(i,r,a)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return zx(e,t)}}}),"Slice",{begin:r,size:a})}}),$x=y_({slice1d_:function(e,t,n){var r=m_(e,"x","slice1d");return Ry(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(r.rank," tensor")})),Yx(r,[t],[n])}}),Jx=y_({slice2d_:function(e,t,n){var r=m_(e,"x","slice2d");return Ry(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(r.rank," tensor")})),Yx(r,t,n)}}),Qx=y_({slice3d_:function(e,t,n){var r=m_(e,"x","slice3d");return Ry(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(r.rank," tensor")})),Yx(r,t,n)}}),eS=y_({slice4d_:function(e,t,n){var r=m_(e,"x","slice4d");return Ry(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(r.rank," tensor")})),Yx(r,t,n)}}),tS=0,nS=[f_,d_,sC,CC,_C,SC,IC,TC,RC,DC,MC,LC,WC,HC,GC,qC,KC,YC,$C,JC,ex,px,vx,Dx,tx,Ox,tx,ax,ux,ox,hx,fx,dx,px,vx,xx,Sx,Ix,Ax,Rx,Ox,Dx,Fx,Mx,{kernelName:o_,inputsToSave:["x"],gradFunc:function(e,t,n){var r=_slicedToArray(t,1)[0],a=n.reps;return{x:function(){var t=V_(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=b_(t,Yx(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var i=0;i<a[0];++i)for(var o=0;o<a[1];++o)t=b_(t,Yx(e,[i*r.shape[0],o*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var s=0;s<a[0];++s)for(var u=0;u<a[1];++u)for(var c=0;c<a[2];++c)t=b_(t,Yx(e,[s*r.shape[0],u*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var h=0;h<a[1];++h)for(var f=0;f<a[2];++f)for(var d=0;d<a[3];++d)t=b_(t,Yx(e,[l*r.shape[0],h*r.shape[1],f*r.shape[2],d*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:s_,gradFunc:function(e,t,n){var r=dw(n.perm);return{x:function(){return BC(e,r)}}}},Px];tS<nS.length;tS++){ky(nS[tS])}cy().get("IS_BROWSER")&&cy().setPlatform("browser",new(function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}())),cy().get("IS_NODE")&&cy().setPlatform("node",new(function(){function e(){_classCallCheck(this,e),this.util=n(2),this.textEncoder=new this.util.TextEncoder}return _createClass(e,[{key:"fetch",value:function(e,t){return null!=cy().global.fetch?cy().global.fetch(e,t):(null==Zx&&(Zx=n(1)),Zx(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}()));var rS={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function aS(e,t){return iS.apply(this,arguments)}function iS(){return(iS=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],a=[],i=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),o=function(e){var o=i[e],s=Array.isArray(t)?t[e].tensor:t[o];if("float32"!==s.dtype&&"int32"!==s.dtype&&"bool"!==s.dtype&&"string"!==s.dtype&&"complex64"!==s.dtype)throw new Error("Unsupported dtype in weight '".concat(o,"': ").concat(s.dtype));var u={name:o,shape:s.shape,dtype:s.dtype};if("string"===s.dtype){var c=new Promise(function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,a=new Uint8Array(r),i=0,o=0;o<n.length;o++)u=n[o],c=new Uint8Array(new Uint32Array([u.length]).buffer),a.set(c,i),i+=4,a.set(u,i),i+=u.length;t(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());a.push(c)}else a.push(s.data());null!=n&&(u.group=n),r.push(u)},s=0;s<i.length;++s)o(s);return e.t0=sS,e.next=6,Promise.all(a);case 6:return e.t1=e.sent,e.t2=(0,e.t0)(e.t1),e.t3=r,e.abrupt("return",{data:e.t2,specs:e.t3});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oS(e,t){var n,r,a={},i=0,o=_createForOfIteratorHelper(t);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=s.name,c=s.dtype,l=s.shape,h=Fy(l),f=void 0;if("quantization"in s){var d=s.quantization;if("uint8"===d.dtype||"uint16"===d.dtype){if(!("min"in d&&"scale"in d))throw new Error("Weight ".concat(s.name," with quantization ").concat(d.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==d.dtype)throw new Error("Weight ".concat(s.name," has unknown ")+"quantization dtype ".concat(d.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(s.name," is quantized with ").concat(d.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var p=rS[d.dtype],v=e.slice(i,i+h*p),m="uint8"===d.dtype?new Uint8Array(v):new Uint16Array(v);if("float32"===c)if("uint8"===d.dtype||"uint16"===d.dtype){f=new Float32Array(m.length);for(var g=0;g<m.length;g++)f[g]=m[g]*d.scale+d.min}else{if("float16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type float32.");void 0===n&&(n=dS()),f=n(m)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));if("uint8"!==d.dtype&&"uint16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type int32.");f=new Int32Array(m.length);for(var y=0;y<m.length;y++)f[y]=Math.round(m[y]*d.scale+d.min)}i+=h*p}else if("string"===c){var b=Fy(s.shape);f=[];for(var k=0;k<b;k++){var _=new Uint32Array(e.slice(i,i+4))[0];i+=4;var w=new Uint8Array(e.slice(i,i+_));f.push(w),i+=_}}else{var C=rS[c],x=e.slice(i,i+h*C);if("float32"===c)f=new Float32Array(x);else if("int32"===c)f=new Int32Array(x);else if("bool"===c)f=new Uint8Array(x);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(u,"': ").concat(c));f=new Float32Array(x);for(var S=new Float32Array(f.length/2),A=new Float32Array(f.length/2),I=0;I<S.length;I++)S[I]=f[2*I],A[I]=f[2*I+1];var T=S_(S,l,"float32"),E=S_(A,l,"float32");a[u]=w_(T,E)}i+=h*C}"complex64"!==c&&(a[u]=S_(f,l,c))}}catch(R){o.e(R)}finally{o.f()}return a}function sS(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var uS="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function cS(e){return uS?Buffer.byteLength(e):new Blob([e]).size}function lS(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function hS(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function fS(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:cS(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:cS(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function dS(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0==(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|(n+=947912704)},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o];i[o]=e[n[s>>10]+(1023&s)]+t[s>>10]}return new Float32Array(a)}}var pS=function(){function e(){_classCallCheck(this,e),this.saveRouters=[],this.loadRouters=[]}return _createClass(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),vS=function(e){return pS.registerSaveRouter(e)},mS=function(e){return pS.registerLoadRouter(e)},gS=function(e){return pS.getSaveHandlers(e)},yS=function(e,t){return pS.getLoadHandlers(e,t)},bS=function(){function e(){_classCallCheck(this,e),this.managers={}}return _createClass(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Ry(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith("://")&&(t=t.slice(0,t.indexOf("://"))),Ry(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Ry(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function kS(e){if(-1===e.indexOf("://"))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(bS.getSchemes().join(",")));return{scheme:e.split("://")[0],path:e.split("://")[1]}}function _S(e,t){return wS.apply(this,arguments)}function wS(){return(wS=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=d.length>2&&void 0!==d[2]&&d[2],Ry(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),Ry((a=pS.getLoadHandlers(t)).length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Ry(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],Ry((o=pS.getSaveHandlers(n)).length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Ry(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],u=kS(t).scheme,c=kS(t).path,l=u===kS(t).scheme,e.next=12,i.load();case 12:if(h=e.sent,e.t0=r&&l,!e.t0){e.next=17;break}return e.next=17,bS.getManager(u).removeModel(c);case 17:return e.next=19,s.save(h);case 19:if(f=e.sent,e.t1=r&&!l,!e.t1){e.next=24;break}return e.next=24,bS.getManager(u).removeModel(c);case 24:return e.abrupt("return",f.modelArtifactsInfo);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CS(){return xS.apply(this,arguments)}function xS(){return(xS=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=bS.getSchemes(),n={},r=_createForOfIteratorHelper(t),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=12;break}return i=a.value,e.next=8,bS.getManager(i).listModels();case 8:for(s in o=e.sent)n[i+"://"+s]=o[s];case 10:e.next=4;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(2),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,null,[[2,14,17,20]])})))).apply(this,arguments)}function SS(e){return AS.apply(this,arguments)}function AS(){return(AS=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=kS(t),e.abrupt("return",bS.getManager(n.scheme).removeModel(n.path));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function IS(e,t){return TS.apply(this,arguments)}function TS(){return(TS=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_S(t,n,!1));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ES(e,t){return RS.apply(this,arguments)}function RS(){return(RS=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_S(t,n,!0));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function NS(){if(!cy().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function OS(e){var t=e.result;t.createObjectStore("models_store",{keyPath:"modelPath"}),t.createObjectStore("model_info_store",{keyPath:"modelPath"})}var DS=function(){function e(t){if(_classCallCheck(this,e),this.indexedDB=NS(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}var t,n;return _createClass(e,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return OS(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction("models_store","readonly"),s=o.objectStore("models_store").get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=fS(t),l=i.transaction("model_info_store","readwrite"),h=l.objectStore("model_info_store"),f=h.put({modelPath:n.modelPath,modelArtifactsInfo:c});f.onsuccess=function(){var a=(u=i.transaction("models_store","readwrite")).objectStore("models_store").put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(h=l.objectStore("model_info_store")).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},f.onerror=function(e){return i.close(),r(f.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();DS.URL_SCHEME="indexeddb://";var FS=function(e){return cy().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(DS.URL_SCHEME)?(t=e.slice(DS.URL_SCHEME.length),new DS(t)):null;var t};pS.registerSaveRouter(FS),pS.registerLoadRouter(FS);var MS=function(){function e(){_classCallCheck(this,e),this.indexedDB=NS()}var t,n;return _createClass(e,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return OS(r)},r.onsuccess=function(){var t=r.result,a=t.transaction("model_info_store","readonly"),i=a.objectStore("model_info_store").getAll();i.onsuccess=function(){var t,n={},r=_createForOfIteratorHelper(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t=(n=t).startsWith(DS.URL_SCHEME)?n.slice(DS.URL_SCHEME.length):n,new Promise((function(e,n){var a=r.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return OS(a)},a.onsuccess=function(){var r,i=a.result,o=i.transaction("model_info_store","readwrite"),s=o.objectStore("model_info_store"),u=s.get(t);u.onsuccess=function(){if(null==u.result)return i.close(),n(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(r=i.transaction("models_store","readwrite")).objectStore("models_store").delete(t);a.onsuccess=function(){return e(u.result.modelArtifactsInfo)},a.onerror=function(e){return n(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),n(u.error)}},u.onerror=function(e){return i.close(),n(u.error)},o.oncomplete=function(){null==r?i.close():r.oncomplete=function(){return i.close()}}},a.onerror=function(e){return n(a.error)}}))));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();if(cy().getBool("IS_BROWSER"))try{bS.registerManager(DS.URL_SCHEME,new MS)}catch(AU){}var PS="tensorflowjs_models",zS="info",LS="model_topology",BS="weight_specs",VS="weight_data",WS="model_metadata";function US(e){return{info:[PS,e,zS].join("/"),topology:[PS,e,LS].join("/"),weightSpecs:[PS,e,BS].join("/"),weightData:[PS,e,VS].join("/"),modelMetadata:[PS,e,WS].join("/")}}function jS(e){var t=e.split("/");if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join("/")}var HS=function(){function e(t){if(_classCallCheck(this,e),!cy().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=US(this.modelPath)}var t,n;return _createClass(e,[{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=fS(t),e.prev=3,e.abrupt("return",(this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(uS)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),{modelArtifactsInfo:a}));case 7:throw e.prev=7,e.t0=e.catch(3),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 10:case"end":return e.stop()}}),e,this,[[3,7]])}))),function(e){return n.apply(this,arguments)})},{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=8;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 8:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=12;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 12:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,n.userDefinedMetadata=o.userDefinedMetadata),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=18;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 18:return e.abrupt("return",(n.weightData=function(e){if(uS){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(s),n));case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();HS.URL_SCHEME="localstorage://";var GS=function(e){return cy().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(HS.URL_SCHEME)?(t=e.slice(HS.URL_SCHEME.length),new HS(t)):null;var t};pS.registerSaveRouter(GS),pS.registerLoadRouter(GS);var qS=function(){function e(){_classCallCheck(this,e),Ry(cy().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Ry("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}var t,n;return _createClass(e,[{key:"listModels",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=PS+"/",r="/"+zS,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(t[jS(i)]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"removeModel",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=US(t=(n=t).startsWith(HS.URL_SCHEME)?n.slice(HS.URL_SCHEME.length):n),null!=this.LS.getItem(r.info)){e.next=3;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 3:return a=JSON.parse(this.LS.getItem(r.info)),e.abrupt("return",(this.LS.removeItem(r.info),this.LS.removeItem(r.topology),this.LS.removeItem(r.weightSpecs),this.LS.removeItem(r.weightData),a));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();if(cy().getBool("IS_BROWSER"))try{bS.registerManager(HS.URL_SCHEME,new qS)}catch(AU){}function KS(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var XS=function(){function e(t){if(_classCallCheck(this,e),!cy().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}var t;return _createClass(e,[{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!=typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=5;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 5:return r=window.URL.createObjectURL(new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}]})],{type:"application/json"})),(a=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,a.href=r,e.next=10,KS((function(){return a.dispatchEvent(new MouseEvent("click"))}));case 10:if(null==t.weightData){e.next=16;break}return(i=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,i.href=n,e.next=16,KS((function(){return i.dispatchEvent(new MouseEvent("click"))}));case 16:return e.abrupt("return",{modelArtifactsInfo:fS(t)});case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();XS.URL_SCHEME="downloads://";var ZS=function(){function e(t){if(_classCallCheck(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}var t;return _createClass(e,[{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=r.checkManifestAndWeightFiles(u,n)}catch(AU){return void a(AU)}var l=[],h=[],f=[];u.forEach((function(e){e.paths.forEach((function(e){h.push(e),f.push(null)})),l.push.apply(l,_toConsumableArray(e.weights))})),u.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=h.indexOf(t);f[a]=r,-1===f.indexOf(null)&&e({modelTopology:s,weightSpecs:l,weightData:lS(f),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(c[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return hS(e.name)})),i={},o=_createForOfIteratorHelper(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=hS(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch(AU){o.e(AU)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function YS(e){return new ZS(e)}function $S(e,t,n,r){!function(e){Ry(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Ry(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Ry(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Ry(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function JS(e,t){return QS.apply(this,arguments)}function QS(){return(QS=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?cy().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),null!=n.onProgress){e.next=9;break}return e.next=6,Promise.all(a);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,$S(a,n.onProgress,0,.5);case 11:e.t0=e.sent;case 12:if(i=e.t0.map((function(e){return e.arrayBuffer()})),null!=n.onProgress){e.next=19;break}return e.next=16,Promise.all(i);case 16:e.t1=e.sent,e.next=22;break;case 19:return e.next=21,$S(i,n.onProgress,.5,1);case 21:e.t1=e.sent;case 22:return e.abrupt("return",e.t1);case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function eA(e){return tA.apply(this,arguments)}function tA(){return(tA=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"",r=i.length>2?i[2]:void 0,a=i.length>3?i[3]:void 0,e.abrupt("return",nA((function(e){return JS(e,{requestInit:a})}))(t,n,r));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function nA(e){return function(){var t=_asyncToGenerator(regeneratorRuntime.mark((function t(n){var r,a,i,o,s,u,c,l,h,f,d,p,v=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],u=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r=rS["quantization"in e?e.quantization.dtype:e.dtype]*Fy(e.shape),c=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:r})};null!=a?a.forEach((function(t,n){t===e.name&&(c(),s[n]=!0)})):c(),u.push(e.name),n+=r}))})),s.every((function(e){return e}))){t.next=6;break}throw c=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(c.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(u.join(", "),"."));case 6:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),h=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;h.push(t)}))})),t.next=10,e(h);case 10:return f=t.sent,d={},p=0,t.abrupt("return",(l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=f[p+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),u=0,c=0;c<t;c++){var l=new Uint8Array(f[p+c]);s.set(l,u),u+=l.byteLength}o[e].forEach((function(e){var t=oS(i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)d[n]=t[n]})),p+=t})),d));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}pS.registerSaveRouter((function(e){return cy().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(XS.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new XS(e)}(e.slice(XS.URL_SCHEME.length)):null}));var rA=function(){function e(t,n){if(_classCallCheck(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,null!=n.fetchFunc?(Ry("function"==typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=cy().platform.fetch,Ry(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Ry(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}var t,n,r;return _createClass(e,[{key:"save",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n.body.append("model.json",new Blob([JSON.stringify({modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:[{paths:["./model.weights.bin"],weights:t.weightSpecs}]})],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=6,this.fetch(this.path,n);case 6:if(!(r=e.sent).ok){e.next=9;break}return e.abrupt("return",{modelArtifactsInfo:fS(t),responses:[r]});case 9:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(r.status,"."));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"load",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 15:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,u=n.format,c=n.userDefinedMetadata,null!=a||null!=i){e.next=18;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 18:if(null==i){e.next=25;break}return e.next=21,this.loadWeights(i);case 21:f=e.sent,d=_slicedToArray(f,2),l=d[0],h=d[1];case 25:return e.abrupt("return",{modelTopology:a,weightSpecs:l,weightData:h,userDefinedMetadata:c,generatedBy:o,convertedBy:s,format:u});case 26:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(){return n.apply(this,arguments)})},{key:"loadWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u,c,l,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,p=void 0,v=void 0,p=(d=n).lastIndexOf("/"),v=d.lastIndexOf("?"),r=[d.substring(0,p)+"/",v>p?d.substring(v):""],a=_slicedToArray(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,u=[],c=_createForOfIteratorHelper(t);try{for(c.s();!(l=c.n()).done;)h=l.value,u.push.apply(u,_toConsumableArray(h.weights))}catch(AU){c.e(AU)}finally{c.f()}return f=[],t.forEach((function(e){e.paths.forEach((function(e){f.push(s+e+o)}))})),e.t0=u,e.t1=lS,e.next=9,JS(f,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 9:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.abrupt("return",[e.t0,e.t3]);case 12:case"end":return e.stop()}var d,p,v}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function aA(e){return null!=e.match(rA.URL_SCHEME_REGEX)}rA.URL_SCHEME_REGEX=/^https?:\/\//;var iA=function(e,t){if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return aA(e)})):aA(e))?oA(e,t):null};function oA(e,t){return new rA(e,t)}function sA(e,t){return oA(e,t)}pS.registerSaveRouter(iA),pS.registerLoadRouter(iA);var uA=function(){function e(t){_classCallCheck(this,e),this.modelArtifacts=t}var t;return _createClass(e,[{key:"load",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),cA=function(){function e(t){_classCallCheck(this,e),this.saveHandler=t}var t;return _createClass(e,[{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),e}();function lA(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new uA(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new uA({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new uA({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))}function hA(e){return new cA(e)}var fA,dA=y_({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var a=m_(e,"indices","oneHot","int32"),i=[].concat(_toConsumableArray(a.shape),[t]);return a=a.flatten(),Ub.runKernelFunc((function(e,o){return o([a]),q_(e.oneHot(a,t,n,r),i)}),{indices:a},null,Gk,{depth:t,onValue:n,offValue:r})}}),pA=y_({confusionMatrix_:function(e,t,n){var r=m_(e,"labels","confusionMatrix"),a=m_(t,"predictions","confusionMatrix");Ry(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),Ry(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(r.rank)})),Ry(1===a.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(a.rank)})),Ry(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(r.shape[0]," vs. ").concat(a.shape[0],". ")+"Labels and predictions should have the same number of elements."})),Ry(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var i=dA(r.asType("int32"),n),o=dA(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}});function vA(e,t){return mA.apply(this,arguments)}function mA(){return(mA=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_,w,C,x,S;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m_(t,"img","toPixels"),t instanceof Ab||(r=(a=r).toInt(),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=_slicedToArray(i,2),s=o[0],u=o[1],!((c=2===r.rank?1:r.shape[2])>4||2===c)){e.next=7;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(c));case 7:return e.next=9,r.data();case 9:return l=e.sent,h=r.min(),f=r.max(),e.next=14,Promise.all([h.data(),f.data()]);case 14:if(d=e.sent,p=d[0][0],v=d[1][0],h.dispose(),f.dispose(),"float32"!==r.dtype){e.next=22;break}if(!(p<0||v>1)){e.next=20;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but got range [".concat(p," - ").concat(v,"]."));case 20:e.next=26;break;case 22:if("int32"===r.dtype){e.next=24;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 24:if(!(p<0||v>255)){e.next=26;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but got range [".concat(p," - ").concat(v,"]."));case 26:for(m="float32"===r.dtype?255:1,g=new Uint8ClampedArray(u*s*4),y=0;y<s*u;++y)b=void 0,k=void 0,_=void 0,w=void 0,1===c?(b=l[y]*m,k=l[y]*m,_=l[y]*m,w=255):3===c?(b=l[3*y]*m,k=l[3*y+1]*m,_=l[3*y+2]*m,w=255):4===c&&(b=l[4*y]*m,k=l[4*y+1]*m,_=l[4*y+2]*m,w=l[4*y+3]*m),g[(C=4*y)+0]=Math.round(b),g[C+1]=Math.round(k),g[C+2]=Math.round(_),g[C+3]=Math.round(w);return null!=n&&(n.width=u,n.height=s,x=n.getContext("2d"),S=new ImageData(g,u,s),x.putImageData(S,0,0)),e.abrupt("return",(r!==t&&r.dispose(),g));case 30:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var gA=y_({fromPixels_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));o=!0}if(a){var s=2;if(a&&e.readyState<s)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}if(null!=my(u_,Ub.backendName))return Ub.runKernel(u_,{pixels:e},{numChannels:t});var u,c,l=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],h=_slicedToArray(l,2),f=h[0],d=h[1];if(o?u=e.getContext("2d").getImageData(0,0,f,d).data:r||n?u=e.data:(i||a)&&(null==fA&&(fA=document.createElement("canvas").getContext("2d")),fA.canvas.width=f,fA.canvas.height=d,fA.drawImage(e,0,0,f,d),u=fA.getImageData(0,0,f,d).data),4===t)c=new Int32Array(u);else{var p=f*d;c=new Int32Array(p*t);for(var v=0;v<p;v++)for(var m=0;m<t;++m)c[v*t+m]=u[4*v+m]}return R_(c,[d,f,t],"int32")}});function yA(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[t.rank-1]," vs. ").concat(e.rank));if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var n=t.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=e.shape,s=n.slice();s.pop();for(var u=1,c=r;c<e.rank;++c)u*=o[c],s.push(o[c]);var l=[].concat(_toConsumableArray(ob(e.shape).map((function(e){return e/u}))),[1]).slice(0,r);return[s,a,u,l]}function bA(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}function kA(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}bA(n,t,e)}function _A(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:Fy(t.shape)/u,sliceSize:o,strides:[].concat(_toConsumableArray(ob(n.slice(0,a))),[1]),outputSize:Fy(n)}}var wA=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),CA=function(){function e(){_classCallCheck(this,e),this.classNameMap={}}return _createClass(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function xA(e){Ry(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Ry("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Ry(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),CA.register(e)}var SA=.1;function AA(e,t,n){return null==n&&(n=IA()),TA(e,t,(function(e,t){return OA(e,t,n)}))}function IA(){return 32===Ub.backend.floatPrecision()?.001:SA}function TA(e,t,n){var r=!0;if(($y(e)||$y(t))&&(r=!1),$y(e)&&$y(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: ".concat(a,". ")+"Expected: ".concat(i))}if(Array.isArray(e)&&Array.isArray(t)){var o=p_(e),s=p_(t);if(!Py(o,s))throw new Error("Arrays have different shapes. "+"Actual: [".concat(o,"]. Expected: [").concat(s,"]"))}var u=$y(e)?e:Dy(e),c=$y(t)?t:Dy(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: ".concat(u.length," vs ")+"expected: ".concat(c.length,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."));for(var l=0;l<c.length;++l){var h=u[l],f=c[l];if(!n(h,f))throw new Error("Arrays differ: actual[".concat(l,"] = ").concat(h,", expected[").concat(l,"] = ").concat(f,".\n")+"Actual:   ".concat(u,".\n")+"Expected: ".concat(c,"."))}}function EA(e,t){e().then((function(){return t.fail()}),(function(){return t()}))}function RA(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return eb(e)||eb(e[0])||eb(t)||eb(t[0])?TA(e,n,(function(e,t){return e==t})):TA(e,t,(function(e,t){return OA(e,t,0)}))}function NA(e,t,n){if(null==n&&(n=IA()),!OA(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function OA(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function DA(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function FA(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}var MA="2.0.1";function PA(){cy().set("PROD",!0)}function zA(){cy().set("DEBUG",!0)}function LA(){cy().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function BA(e){cy().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function VA(){Ub.disposeVariables()}function WA(){return Ub}function UA(){return Ub.memory()}function jA(e){return Ub.profile(e)}function HA(e,t){return Ub.tidy(e,t)}function GA(e){Bb(e).forEach((function(e){return e.dispose()}))}function qA(e){return Ub.keep(e)}function KA(e){return Ub.time(e)}function XA(e){return Ub.setBackend(e)}function ZA(){return Ub.ready()}function YA(){return Ub.backendName}function $A(e){Ub.removeBackend(e)}function JA(e){return Ub.findBackend(e)}function QA(e){return Ub.findBackendFactory(e)}function eI(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Ub.registerBackend(e,t,n)}function tI(){return Ub.backend}function nI(e,t){cy().setPlatform(e,t)}var rI=y_({addN_:function(e){Ry(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),Ry(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return m_(e,"tensors".concat(t),"addN")})),n=t[0];return t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!Py(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")})),Ub.runKernelFunc((function(e,n){var r=e.addN(t);return n(t),r}),t,null,Kb)}}),aI=y_({atan2_:function(e,t){var n,r=m_(e,"a","atan2"),a=m_(t,"b","atan2");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.atan2(r,a);return t([r,a]),n}),{a:r,b:a},null,Xb)}}),iI=y_({avgPool_:function(e,t,n,r,a){var i=m_(e,"x","avgPool","float32");Ry(yC(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '1'")}));var o=i,s=!1;3===i.rank&&(s=!0,o=q_(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ry(4===o.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(o.rank,".")})),null!=a&&Ry(zy(r),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u=Ub.runKernelFunc((function(e,i){var s=uC(o.shape,t,n,1,r,a);return i([o]),1===s.filterWidth&&1===s.filterHeight&&Py(s.inShape,s.outShape)?o.clone():e.avgPool(o,s)}),{x:o},null,Zb,{filterSize:t,strides:n,pad:r,dimRoundingMode:a});return u=H_(u,i.dtype),s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),oI=y_({avgPool3d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:BA("dilations is deprecated, this field will be gone in v3.0.0.");var s=m_(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=q_(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Ry(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),Ry("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),Ry(yC(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=a&&Ry(zy(r),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l=Ub.runKernelFunc((function(e,s){null==o&&(o=[1,1,1]);var c=cC(u.shape,t,n,o,r,a,i);return s([u]),e.avgPool3d(u,c)}),{x:u},null,$b,{filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i,dilations:o});return l=H_(l,u.dtype),c?l.as4D(l.shape[1],l.shape[2],l.shape[3],l.shape[4]):l}});function sI(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var uI=y_({batchNorm_:function(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=m_(e,"x","batchNorm"),c=m_(t,"mean","batchNorm"),l=m_(n,"variance","batchNorm");null!=a&&(o=m_(a,"scale","batchNorm")),null!=r&&(s=m_(r,"offset","batchNorm")),Ry(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Ry(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Ry(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var h=function(e){return 0===e.rank||1===e.rank?e.as4D(1,1,1,e.size):2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}(u),f=Ub.runKernelFunc((function(e,t){return t([h,c,l,o]),e.batchNorm(h,sI(c),sI(l),sI(s),sI(o),i)}),{x:h,scale:o,offset:s,mean:c,variance:l},null,wk,{varianceEpsilon:i});return q_(f,u.shape)}}),cI=y_({batchNorm2d_:function(e,t,n,r,a,i){var o,s,u=m_(e,"x","batchNorm"),c=m_(t,"mean","batchNorm"),l=m_(n,"variance","batchNorm");return null!=a&&(o=m_(a,"scale","batchNorm")),null!=r&&(s=m_(r,"offset","batchNorm")),Ry(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),Ry(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ry(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ry(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ry(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(s.rank,".")})),uI(u,c,l,s,o,i)}}),lI=y_({batchNorm3d_:function(e,t,n,r,a,i){var o,s,u=m_(e,"x","batchNorm"),c=m_(t,"mean","batchNorm"),l=m_(n,"variance","batchNorm");return null!=a&&(o=m_(a,"scale","batchNorm")),null!=r&&(s=m_(r,"offset","batchNorm")),Ry(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(u.rank,".")})),Ry(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ry(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ry(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ry(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(s.rank,".")})),uI(u,c,l,s,o,i)}}),hI=y_({batchNorm4d_:function(e,t,n,r,a,i){var o,s,u=m_(e,"x","batchNorm"),c=m_(t,"mean","batchNorm"),l=m_(n,"variance","batchNorm");return null!=a&&(o=m_(a,"scale","batchNorm")),null!=r&&(s=m_(r,"offset","batchNorm")),Ry(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(u.rank,".")})),Ry(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(c.rank,".")})),Ry(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),null!=o&&Ry(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(o.rank,".")})),null!=s&&Ry(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(s.rank,".")})),uI(u,c,l,s,o,i)}}),fI=y_({clone_:function(e){var t=m_(e,"x","clone",null);return Ub.runKernelFunc((function(){return Ub.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{x:t},null,Ak)}}),dI=y_({broadcastTo_:function(e,t){var n=m_(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=q_(n,a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));return 0===o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length?fI(n):Ub.runKernelFunc((function(e){return e.tile(n,o)}),{x:n},null,tk,{shape:t,inputShape:i})}}),pI=y_({concat1d_:function(e){return W_(e,0)}}),vI=y_({concat2d_:function(e,t){return W_(e,t)}}),mI=y_({concat3d_:function(e,t){return W_(e,t)}}),gI=y_({concat4d_:function(e,t){return W_(e,t)}}),yI=y_({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0,s=m_(e,"x","conv1d"),u=m_(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=q_(s,[1,s.shape[0],s.shape[1]])),Ry(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),Ry(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),null!=o&&Ry(zy(r),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")})),Ry(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(u.shape[1],".")})),Ry(yC(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(i,"'")})),Ry("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var h=q_(u,[1,u.shape[0],u.shape[1],u.shape[2]]),f=q_(c,[c.shape[0],1,c.shape[1],c.shape[2]]),d=FC(f,h,[1,n],r,"NHWC",[1,i],o);return q_(d,l?[d.shape[2],d.shape[3]]:[d.shape[0],d.shape[2],d.shape[3]])}}),bI=y_({conv2dTranspose_:function(e,t,n,r,a,i){var o=m_(e,"x","conv2dTranspose"),s=m_(t,"filter","conv2dTranspose");return OC(n,o,s,r,a,"NHWC",i)}}),kI=y_({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],o=m_(e,"x","conv3d"),s=m_(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=q_(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),Ry(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(u.rank,".")})),Ry(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(s.rank,".")})),Ry(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input (".concat(u.shape[4],") must match ")+"input depth for filter ".concat(s.shape[3],".")})),Ry(yC(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),Ry("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")}));var l=Ub.runKernelFunc((function(e,t){var a=hC(u.shape,s.shape,n,i,r),o=e.conv3d(u,s,a);return t([u,s]),o}),{x:u,filter:s},null,sk,{strides:n,pad:r,dataFormat:a,dilations:i});return c?l.as4D(l.shape[1],l.shape[2],l.shape[3],l.shape[4]):l}}),_I=y_({conv3dTranspose_:function(e,t,n,r,a){var i=m_(e,"x","conv3dTranspose"),o=m_(t,"filter","conv3dTranspose");return zC(n,i,o,r,a)}}),wI=y_({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=m_(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return Ry(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),Ry(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(i," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),Ry(o%(t*t)==0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(o," for depthToSpace with input shape ").concat(r.shape)})),Ub.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{x:r},null,hk,{blockSize:t,dataFormat:n})}}),CI=y_({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=m_(e,"x","depthwiseConv2d"),u=m_(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=q_(s,[1,s.shape[0],s.shape[1],s.shape[2]])),Ry(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),Ry(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(u.rank,".")})),Ry(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(c.shape[3],") must match the inChannels dimension in ")+"filter ".concat(u.shape[2],".")})),null!=o&&Ry(zy(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(r,".")}));var h=Ub.runKernelFunc((function(e,t){null==i&&(i=[1,1]),Ry(yC(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(n," and dilations '").concat(i,"'")}));var a=lC(c.shape,u.shape,n,i,r,o,!0),s=e.depthwiseConv2D(c,u,a);return t([c,u]),s}),{x:c,filter:u},null,fk,{strides:n,pad:r,dataFormat:a,dilations:i,dimRoundingMode:o});return l?q_(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),xI=y_({diag_:function(e){var t=m_(e,"x","diag").flatten();return Ub.runKernelFunc((function(n){var r=n.diag(t),a=[].concat(_toConsumableArray(e.shape),_toConsumableArray(e.shape));return q_(r,a)}),{x:t},null,vk)}}),SI=y_({divNoNan_:function(e,t){var n=m_(e,"a","div"),r=m_(t,"b","div"),a=_slicedToArray(Pb(n,r),2);n=a[0],r=a[1];var i=J_(n,r),o=V_(i),s=r.equal(o);return _x(s,o,i)}}),AI=y_({dot_:function(e,t){var n=m_(e,"t1","dot"),r=m_(t,"t2","dot");Ry(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];if(Ry(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(i,".")})),1===n.rank&&1===r.rank){var o=q_(n,[1,-1]),s=q_(r,[-1,1]),u=xC(o,s);return q_(u,[])}if(1===n.rank&&2===r.rank){var c=q_(n,[1,-1]),l=q_(r,[r.shape[0],r.shape[1]]),h=xC(c,l);return q_(h,[h.size])}if(2===n.rank&&1===r.rank){var f=q_(r,[-1,1]),d=xC(n,f);return q_(d,[d.size])}var p=q_(r,[r.shape[0],r.shape[1]]);return xC(n,p)}}),II=y_({elu_:function(e){var t=m_(e,"x","elu");return Ub.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{x:t},null,gk)}}),TI=y_({equal_:function(e,t){var n,r=m_(e,"a","equal"),a=m_(t,"b","equal");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e){return e.equal(r,a)}),{a:r,b:a},null,bk)}}),EI=y_({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=U_([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return ZC(G_(s,0),[n[0],1,1]);if(2===n.length)return ZC(G_(G_(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return ZC(G_(G_(G_(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});function RI(e,t,n){return Ub.runKernelFunc((function(r){return r.fill(e,t,n)}),{},null,_k,{shape:e,value:t,dtype:n})}var NI=y_({maximum_:function(e,t){var n,r=m_(e,"a","maximum"),a=m_(t,"b","maximum");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],"bool"===r.dtype&&(r=H_(r,"int32"),a=H_(a,"int32")),h_(r.shape,a.shape),Ub.runKernelFunc((function(e,t){var n=e.maximum(r,a);return t([r,a]),n}),{a:r,b:a},null,Dk)}}),OI=y_({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=m_(e,"x","leakyRelu");return NI(Q_(I_(t),n),n)}}),DI=y_({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,i=m_(e,"x","localResponseNormalization");Ry(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(i.rank,".")})),Ry(zy(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var o=i,s=!1;3===i.rank&&(s=!0,o=q_(i,[1,i.shape[0],i.shape[1],i.shape[2]]));var u=Ub.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(o,t,n,r,a);return i([o,s]),s}),{x:o},null,Rk,{depthRadius:t,bias:n,alpha:r,beta:a});return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),FI=y_({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"x","max"),a=Ub.runKernelFunc((function(e,n){var a=Hy(t,r.shape),i=fw(a,r.rank),o=r;null!=i&&(o=BC(r,i),a=pw(a.length,o.rank));var s=e.max(o,a);return n([r,s]),null!=i&&e.disposeData(o.dataId),s}),{x:r},null,Ok,{reductionIndices:t,keepDims:n});return n?q_(a,lw(a.shape,Hy(t,r.shape))):a}}),MI=y_({maxPool_:function(e,t,n,r,a){var i=m_(e,"x","maxPool"),o=i,s=!1;3===i.rank&&(s=!0,o=q_(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Ry(4===o.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(o.rank,".")})),Ry(yC(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '1'")})),null!=a&&Ry(zy(r),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var u=Ub.runKernelFunc((function(e,i){var s,u=uC(o.shape,t,n,1,r,a);return s=1===u.filterWidth&&1===u.filterHeight&&Py(u.inShape,u.outShape)?o.clone():e.maxPool(o,u),i([o,s]),s}),{x:o},null,Fk,{filterSize:t,strides:n,pad:r,dimRoundingMode:a});return s?q_(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),PI=y_({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",o=arguments.length>6?arguments[6]:void 0;null==o?o=[1,1,1]:BA("dilations is deprecated, this field will be gone in v3.0.0.");var s=m_(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),Ry(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(u.rank,".")})),Ry("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(i)})),Ry(yC(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),null!=a&&Ry(zy(r),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l=Ub.runKernelFunc((function(e,s){null==o&&(o=[1,1,1]);var c=cC(u.shape,t,n,o,r,a,i),l=e.maxPool3d(u,c);return s([u,l]),l}),{x:u},null,Pk,{filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:i,dilations:o});return c?q_(l,[l.shape[1],l.shape[2],l.shape[3],l.shape[4]]):l}}),zI=y_({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=m_(e,"x","maxPoolWithArgmax"),o=Ub.runKernel(Lk,{x:i},{filterSize:t,strides:n,pad:r,includeBatchInIndex:a});return{result:o[0],indexes:o[1]}}}),LI=y_({minimum_:function(e,t){var n,r=m_(e,"a","minimum"),a=m_(t,"b","minimum");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],"bool"===r.dtype&&(r=H_(r,"int32"),a=H_(a,"int32")),h_(r.shape,a.shape),Ub.runKernelFunc((function(e,t){var n=e.minimum(r,a);return t([r,a]),n}),{a:r,b:a},null,Bk)}}),BI=y_({mod_:function(e,t){var n,r=m_(e,"a","mod"),a=m_(t,"b","mod");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],Ub.runKernelFunc((function(e,t){var n=e.mod(r,a);return t([r,a]),n}),{a:r,b:a},null,Vk)}}),VI=y_({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=m_(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(i,"."));if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(o));n=n||Math.random();var s=1===o?a.as2D(1,-1):a,u=Ub.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===o?u.as1D():u}}),WI=y_({notEqual_:function(e,t){var n,r=m_(e,"a","notEqual"),a=m_(t,"b","notEqual");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e){return e.notEqual(r,a)}),{a:r,b:a},null,Uk)}}),UI=y_({outerProduct_:function(e,t){var n=m_(e,"v1","outerProduct"),r=m_(t,"v2","outerProduct");Ry(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=q_(n,[-1,1]),i=q_(r,[1,-1]);return xC(a,i)}}),jI=y_({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ry(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),zx(e,[t],n)}}),HI=y_({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ry(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),zx(e,t,n)}}),GI=y_({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ry(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),zx(e,t,n)}}),qI=y_({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Ry(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),zx(e,t,n)}}),KI=y_({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=m_(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=q_(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Ry(yC(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(a,"'")}));var c,l=uC(s.shape,t,i,a,r),h=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([l.filterHeight,l.filterWidth],h):[[0,0],[0,0]];var f=1===h[0]&&1===h[1],d=_slicedToArray(function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,o[t]]}))]}([l.inHeight,l.inWidth],h,c),2),p=d[0],v=d[1],m=f?r:"valid",g=f?s:AC(s,h,p),y=("avg"===n?function(){return iI(g,t,i,m)}:function(){return MI(g,t,i,m)})(),b=f?y:Nx(y,h,v);return u?q_(b,[b.shape[1],b.shape[2],b.shape[3]]):b}}),XI=y_({prelu_:function(e,t){var n=m_(e,"x","prelu"),r=m_(t,"alpha","prelu");return Ub.runKernelFunc((function(e,t){var a=e.prelu(n,r);return t([n,r]),a}),{x:n,alpha:r},null,Zk)}}),ZI=y_({rand_:function(e,t,n){var r=Fy(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return Ub.makeTensor(a,e,n)}}),YI=n("YSVl"),$I=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var o=i||Math.random();this.random=YI.alea(o.toString())}return _createClass(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),JI=function(){function e(t,n,r,a){_classCallCheck(this,e),this.alpha=t,this.beta=1/n,this.dtype=r;var i=a||Math.random();this.randu=YI.alea(i.toString()),this.randn=new $I(0,1,r,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return _createClass(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i*=1/this.beta*this.d,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),QI=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(_classCallCheck(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==i&&(i=Math.random()),"number"==typeof i&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=YI.alea(i)}return _createClass(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}(),eT=y_({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type ".concat(r));for(var i=new JI(t,n,r,a),o=U_(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),tT=y_({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type ".concat(r));for(var i=new $I(t,n,r,!1,a),o=U_(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),nT=y_({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0,i=U_(e,r),o=new QI(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),rT=y_({relu_:function(e){var t=m_(e,"x","relu");return Ub.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?t.toInt():e.relu(t)}),{x:t},null,$k)}}),aT=y_({relu6_:function(e){var t=m_(e,"x","relu6");return Ub.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?H_(t,"int32"):e.relu6(t)}),{x:t},null,Jk)}}),iT=y_({selu_:function(e){var t=m_(e,"x","selu");return Ub.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{x:t},null,e_)}}),oT=y_({separableConv2d_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",s=m_(e,"x","separableConv2d"),u=m_(t,"depthwiseFilter","separableConv2d"),c=m_(n,"pointwiseFilter","separableConv2d"),l=s,h=!1;if(3===s.rank&&(h=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Ry(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),Ry(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),Ry(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(u.rank,".")})),Ry(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),Ry(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var f=u.shape[2],d=u.shape[3];Ry(c.shape[2]===f*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(f*d,", ")+"but got ".concat(c.shape[2],".")}));var p=CI(l,u,r,a,o,i),v=FC(p,c,1,"valid",o);return h?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),sT=y_({squaredDifference_:function(e,t){var n,r=m_(e,"a","squaredDifference"),a=m_(t,"b","squaredDifference");return n=_slicedToArray(Pb(r,a),2),r=n[0],a=n[1],h_(r.shape,a.shape),Ub.runKernelFunc((function(e,t){var n=e.squaredDifference(r,a);return t([r,a]),n}),{a:r,b:a},null,r_,{})}}),uT=y_({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new $I(t,n,r,!0,a),o=U_(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),cT=30;function lT(e){return e<=cT?e:ib(e,Math.floor(Math.sqrt(e)))}function hT(e,t){var n,r=!1;for(e<=cT?(n=e,r=!0):n=ib(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=ib(e,n+1);return n}function fT(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)r.push(i!==t?e[i]:n);return r}function dT(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(e.shape[s]),i*=e.shape[s];for(var u=0;u<t.rank;u++)a.push(t.shape[u]);for(var c=n+1;c<e.rank;c++)a.push(e.shape[c]),o*=e.shape[c];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}function pT(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function vT(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var mT=y_({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=m_(e,"x","gather"),a=m_(t,"indices","gather","int32");n=Hy(n,r.shape)[0];var i=dT(r,a,n);return Ub.runKernelFunc((function(e,t){var i=e.gather(r,a.flatten(),n);return t([a]),i}),{x:r,indices:a},(function(e,t){var a=_slicedToArray(t,1)[0];return{x:function(){var t=r.shape,i=a.size,o=t.slice(0,n),s=o.length,u=t.slice(n,t.length).slice(1),c=u.length,l=pT(0,s),h=pT(s+1,s+1+c),f=vT([o,[i],u]),d=e.reshape(f),p=a.reshape([i]),v=vT([[s],l,h]),m=d.transpose(v),g=gT(m,p,r.shape[n]),y=dw(v);return g=g.transpose(y)},indices:function(){return a}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),gT=y_({unsortedSegmentSum_:function(e,t,n){var r=m_(e,"x","unsortedSegmentSum"),a=m_(t,"segmentIds","unsortedSegmentSum","int32");return Ry(zy(n),(function(){return"numSegments must be of dtype int"})),Ub.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,a,n);return t([a]),i}),{$x:r},(function(e,t){var n=_slicedToArray(t,1)[0];return{$x:function(){return function(e,t){for(var n=NI(t,V_(t)),r=mT(e,n),a=nx(t,I_(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=G_(a,o+1);a=gx(a,M_(r.shape,"bool"));var s=V_(r);return _x(a,r,s)}(e,n)}}}))}}),yT=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p,v,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=m_(t,"tensor","boolMask"),i=m_(n,"mask","boolMask","bool"),o=null==r?0:r,s=i.rank,u=a.shape,Ry(s>0,(function(){return"mask cannot be scalar"})),Ny(u.slice(o,o+s),i.shape,"mask's shape must match the first K dimensions of tensor's shape,"),c=1,l=o;l<o+s;l++)c*=u[l];return h=u.slice(0,o).concat([c],u.slice(o+s)),f=a.reshape(h),d=i.reshape([-1]),e.next=9,wx(d);case 9:return p=e.sent,v=p.squeeze([1]),m=mT(f,v,o),e.abrupt("return",(t!==a&&a.dispose(),n!==i&&i.dispose(),v.dispose(),f.dispose(),d.dispose(),p.dispose(),m));case 13:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),bT=y_({reverse_:function(e,t){var n=m_(e,"x","reverse");if(0===n.rank)return n.clone();var r=Hy(t,n.shape);return Ub.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),kT=y_({reverse1d_:function(e){var t=m_(e,"x","reverse");return Ry(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),bT(t,0)}}),_T=y_({reverse2d_:function(e,t){var n=m_(e,"x","reverse");return Ry(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),bT(n,t)}}),wT=y_({reverse3d_:function(e,t){var n=m_(e,"x","reverse");return Ry(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),bT(n,t)}}),CT=y_({reverse4d_:function(e,t){var n=m_(e,"x","reverse");return Ry(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),bT(n,t)}}),xT=y_({equalStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","equalStrict"),r=m_(t,"b","equalStrict");return Ny(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),ST=y_({greaterEqualStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","greaterEqualStrict"),r=m_(t,"b","greaterEqualStrict");return Ny(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),AT=y_({greaterStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","greaterStrict"),r=m_(t,"b","greaterStrict");return Ny(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),IT=y_({lessEqualStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","lessEqualStrict"),r=m_(t,"b","lessEqualStrict");return Ny(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),TT=y_({lessStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","lessStrict"),r=m_(t,"b","lessStrict");return Ny(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),ET=y_({notEqualStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","notEqualStrict"),r=m_(t,"b","notEqualStrict");return Ny(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}}),RT=y_({addStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","addStrict"),r=m_(t,"b","addStrict");return Ny(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),NT=y_({divStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","div"),r=m_(t,"b","div");return Ny(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),OT=y_({maximumStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","maximumStrict"),r=m_(t,"b","maximumStrict");return Ny(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),DT=y_({minimumStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","minimumStrict"),r=m_(t,"b","minimumStrict");return Ny(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),FT=y_({modStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","modStrict"),r=m_(t,"b","modStrict");return Ny(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),MT=y_({mulStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","mul"),r=m_(t,"b","mul");return Ny(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),PT=y_({powStrict_:function(e,t){return BA("strict variants of ops have been deprecated and will be removed in future"),Ny(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),zT=y_({squaredDifferenceStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","squaredDifferenceStrict"),r=m_(t,"b","squaredDifferenceStrict");return Ny(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),LT=y_({subStrict_:function(e,t){BA("strict variants of ops have been deprecated and will be removed in future");var n=m_(e,"a","subStrict"),r=m_(t,"b","subStrict");return Ny(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),BT=y_({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=m_(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));return Ub.runKernelFunc((function(e,r){var a=e.softmax(n,t);return r([a]),a}),{logits:n},(function(e,n){var r=_slicedToArray(n,1)[0],a=e.mul(r);return{logits:function(){return a.sub(a.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),VT=y_({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=m_(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));return iw((function(e,n){var r=e.max(t,!0),a=e.sub(r),i=a.toFloat().sub(a.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=_slicedToArray(n,1)[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),WT=y_({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(I_(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: ".concat(n))}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: ".concat(n))}throw new Error("Error in norm: invalid axis: ".concat(r))}(e=m_(e,"x","norm"),t,n),i=a.shape;if(r){var o=Hy(n,e.shape);i=lw(a.shape,o)}return a.reshape(i)}}),UT=y_({basicLSTMCell_:function(e,t,n,r,a,i){var o=m_(e,"forgetBias","basicLSTMCell"),s=m_(t,"lstmKernel","basicLSTMCell"),u=m_(n,"lstmBias","basicLSTMCell"),c=m_(r,"data","basicLSTMCell"),l=m_(a,"c","basicLSTMCell"),h=m_(i,"h","basicLSTMCell"),f=c.concat(h,1).matMul(s).add(u),d=f.shape[1]/4,p=[f.shape[0],d],v=f.slice([0,0],p),m=f.slice([0,d],p),g=f.slice([0,2*d],p),y=f.slice([0,3*d],p),b=v.sigmoid().mul(m.tanh()).add(l.mul(o.add(g).sigmoid())),k=b.tanh().mul(y.sigmoid());return[b,k]}}),jT=y_({multiRNNCell_:function(e,t,n,r){for(var a=m_(t,"data","multiRNNCell"),i=g_(n,"c","multiRNNCell"),o=g_(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}for(var h=[],f=[],d=0;d<u.length;d+=2)h.push(u[d]),f.push(u[d+1]);return[h,f]}}),HT=y_({movingAverage_:function(e,t,n,r){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=m_(e,"v","movingAverage"),o=m_(t,"x","movingAverage"),s=m_(n,"decay","movingAverage");zb(i,o),Ry(Py(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=I_(1),c=u.sub(s),l=o.sub(i).mul(c);if(a){Ry(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var h=m_(r,"step","movingAverage");l=l.div(u.sub(Cx(s,h)))}return i.add(l)}}),GT=y_({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0;null==r&&(r=new Array(t.length));var c=Bx(o);if(c.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==u)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var l=m_(e,"x","stridedSlice"),h=l.rank-t.length,f=Bx(s),d=l.shape.slice();f.forEach((function(e){t[e]=0,n[e]=1,d.splice(e,0,1)})),l=l.reshape(d);for(var p=0;p<l.rank;p++)t[p]=Gx(a,t,r,l.shape,p,o),n[p]=qx(i,n,r,l.shape,p,o),r[p]=Hx(r,p,o);if(c.length&&h>0){var v=c[0],m=h+1;t=Ux(t,v,m),n=jx(n,v,m,l.shape),r=Wx(r,v,m)}var g=Bx(u);g.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var y=Vx(t,n,r),b=y.filter((function(e,t){return-1===g.indexOf(t)}));return r.every((function(e){return 1===e}))?Yx(l,t,y).reshape(b):Ub.runKernelFunc((function(e){return e.stridedSlice(l,t,n,r)}),{$x:l}).reshape(b)}}),qT=y_({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=m_(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var i=Ub.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r}),o=_slicedToArray(i,2),s=o[0],u=o[1];return{values:s,indices:u}}}),KT=y_({scatterND_:function(e,t,n){var r=m_(e,"indices","scatterND","int32"),a=m_(t,"updates","scatterND");return kA(a,r,n),Ub.runKernelFunc((function(e){return e.scatterND(r,a,n)}),{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),XT=y_({fft_:function(e){Ry("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t=e.shape[e.shape.length-1],n=e.as2D(e.size/t,t);return Ub.runKernelFunc((function(e){return e.fft(n)}),{input:e}).reshape(e.shape)}}),ZT=y_({ifft_:function(e){Ry("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t=e.shape[e.shape.length-1],n=e.as2D(e.size/t,t);return Ub.runKernelFunc((function(e){return e.ifft(n)}),{input:e}).reshape(e.shape)}}),YT=y_({rfft_:function(e,t){Ry("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(P_(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=w_(n,u).as2D(a,r),l=XT(c),h=Math.floor(r/2)+1,f=x_(l),d=C_(l),p=f.split([h,r-h],f.shape.length-1),v=d.split([h,r-h],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=h,w_(p[0],v[0]).reshape(m)}}),$T=y_({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=ZT(r);return x_(a)}var i=[n,2*(t-1)],o=x_(e).as2D(n,t),s=C_(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(I_(-1)),l=o.concat(u,1),h=s.concat(c,1),f=w_(l,h).as2D(i[0],i[1]),d=ZT(f);return x_(d)}}),JT=y_({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=m_(e,"sparseIndices","sparseToDense","int32"),i=m_(t,"sparseValues","sparseToDense"),o=m_(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));if(0!==t.rank&&(1!==t.rank||t.size!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),Ub.runKernelFunc((function(e){return e.sparseToDense(a,i,n,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),QT=y_({gatherND_:function(e,t){var n=m_(t,"indices","gatherND","int32"),r=m_(e,"x","gatherND");return Ub.runKernelFunc((function(e){return e.gatherND(r,n)}),{params:r,indices:n},null,Ck)}}),eE=y_({dropout_:function(e,t,n,r){var a=m_(e,"x","dropout");if(Ry("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(a.dtype," tensor instead.")})),Ry(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof Ab?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(Py(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)n.push(null==t[r]&&null!=e.shape[r]?e.shape[r]:t[r]);return n}return t}(a,n),o=1-t,s=nT(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function tE(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return T_(a,"float32")}var nE,rE=y_({hannWindow_:function(e){return tE(e,.5,.5)}}),aE=y_({hammingWindow_:function(e){return tE(e,.54,.46)}}),iE=y_({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Yx(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=W_([Yx(e,i,t-s),RI([s],a)]);o.push(u),i+=n}return 0===o.length?E_([],[0,t]):W_(o).as2D(o.length,t)}}),oE=y_({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:rE;null==r&&(r=Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2)))));for(var i=iE(e,t,n),o=Q_(i,a(t)),s=[],u=0;u<i.shape[0];u++)s.push(YT(o.slice([u,0],[1,t]),r));return W_(s)}}),sE=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h,f,d,p,v,m,g,y=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=y.length>2&&void 0!==y[2]?y[2]:1,a=m_(t,"predictions","inTopK"),i=m_(n,"targets","inTopK"),Ry(a.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(a.rank)})),Ry(a.rank-1===i.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(a.rank," and targets rank ").concat(i.rank)})),Ny(a.shape.slice(0,a.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),o=a.shape[a.shape.length-1],Ry(r>0&&r<=o,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(o,"), but got ").concat(r)})),e.next=7,a.data();case 7:return s=e.sent,e.next=10,i.data();case 10:u=e.sent,c=s.length/o,l=o,h=qy("bool",c),f=0;case 15:if(!(f<c)){e.next=30;break}for(d=f*l,p=s.subarray(d,d+l),v=[],m=0;m<p.length;m++)v.push({value:p[m],index:m});v.sort((function(e,t){return t.value-e.value})),h[f]=0,g=0;case 20:if(!(g<r)){e.next=27;break}if(v[g].index!==u[f]){e.next=24;break}return h[f]=1,e.abrupt("break",27);case 24:g++,e.next=20;break;case 27:f++,e.next=15;break;case 30:return e.abrupt("return",(t!==a&&a.dispose(),n!==i&&i.dispose(),S_(h,i.shape,"bool")));case 31:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(nE||(nE={}));var uE=y_({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nE.SUM_BY_NONZERO_WEIGHTS,a=m_(e,"labels","absoluteDifference"),i=m_(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=m_(n,"weights","absoluteDifference")),Ny(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return cE(s,o,r)}}),cE=y_({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:nE.SUM_BY_NONZERO_WEIGHTS,r=m_(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=m_(t,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===nE.NONE)return i;if(n===nE.SUM)return i.sum();if(n===nE.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(I_(o)):s}if(n===nE.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(I_(r.size));var u=a.mul(M_(r.shape)).notEqual(I_(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: ".concat(n))}}),lE=y_({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nE.SUM_BY_NONZERO_WEIGHTS,i=m_(e,"labels","cosineDistance"),o=m_(t,"predictions","cosineDistance"),s=null;null!=r&&(s=m_(r,"weights","cosineDistance")),Ny(i.shape,o.shape,"Error in cosineDistance: ");var u=I_(1).sub(i.mul(o).sum(n,!0));return cE(u,s,a)}}),hE=y_({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nE.SUM_BY_NONZERO_WEIGHTS,a=m_(e,"labels","hingeLoss"),i=m_(t,"predictions","hingeLoss"),o=null;null!=n&&(o=m_(n,"weights","hingeLoss")),Ny(a.shape,i.shape,"Error in hingeLoss: ");var s=I_(1);a=I_(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return cE(u,o,r)}}),fE=y_({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nE.SUM_BY_NONZERO_WEIGHTS,i=m_(e,"labels","huberLoss"),o=m_(t,"predictions","huberLoss"),s=null;null!=n&&(s=m_(n,"weights","huberLoss")),Ny(i.shape,o.shape,"Error in huberLoss: ");var u=I_(r),c=o.sub(i).abs(),l=LI(c,u),h=c.sub(l),f=I_(.5).mul(l.square()).add(u.mul(h));return cE(f,s,a)}}),dE=y_({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nE.SUM_BY_NONZERO_WEIGHTS,i=m_(e,"labels","logLoss"),o=m_(t,"predictions","logLoss"),s=null;null!=n&&(s=m_(n,"weights","logLoss")),Ny(i.shape,o.shape,"Error in logLoss: ");var u=I_(1),c=I_(r),l=i.mul(o.add(c).log()).neg().sub(u.sub(i).mul(u.sub(o).add(c).log()));return cE(l,s,a)}}),pE=y_({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:nE.SUM_BY_NONZERO_WEIGHTS,a=m_(e,"labels","meanSquaredError"),i=m_(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=m_(n,"weights","meanSquaredError")),Ny(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return cE(s,o,r)}}),vE=y_({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nE.SUM_BY_NONZERO_WEIGHTS,i=m_(e,"multiClassLabels","sigmoidCrossEntropy"),o=m_(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=m_(n,"weights","sigmoidCrossEntropy")),Ny(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=I_(r),c=I_(1),l=I_(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var h=function(e,t){var n=m_(e,"labels","sigmoidCrossEntropyWithLogits"),r=m_(t,"logits","sigmoidCrossEntropyWithLogits");Ny(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return cE(h,s,a)}}),mE=y_({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:nE.SUM_BY_NONZERO_WEIGHTS,i=m_(e,"onehotLabels","softmaxCrossEntropy"),o=m_(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=m_(n,"weights","softmaxCrossEntropy")),Ny(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=I_(r),c=I_(1),l=I_(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var h=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));return iw((function(e,t,r){var a=t.logSumExp([n],!0),i=t.toFloat().sub(a);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=_slicedToArray(t,2),a=r[0],i=r[1],o=lw(e.shape,[n]);return[e.reshape(o).mul(a.toFloat().sub(i.exp())),e.reshape(o).mul(i.exp().sub(a.toFloat()))]}}}))(e,t)}(i,o);return cE(h,s,a)}});function gE(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Ub.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor."));for(var n=e.shape[0],r=e.shape[1],a=EI(n),i=e.clone(),o=E_([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=a;t=_slicedToArray(Ub.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),c=i.slice([e,e],[1,1]),l=E_([[-1]]).where(c.greater(0),E_([[1]])),h=c.sub(l.mul(u)),f=t.div(h);s=1===f.shape[0]?o.clone():o.concat(f.slice([1,0],[f.shape[0]-1,f.shape[1]]),0);var d=l.matMul(h).div(u).neg(),p=i.slice([e,0],[n-e,r]),v=d.mul(s),m=s.transpose();if(0===e)i=p.sub(v.matMul(m.matMul(p)));else{var g=p.sub(v.matMul(m.matMul(p)));i=i.slice([0,0],[e,r]).concat(g,0)}var y=v.transpose(),b=a.slice([0,e],[n,a.shape[1]-e]);if(0===e)a=b.sub(b.matMul(s).matMul(y));else{var k=b.sub(b.matMul(s).matMul(y));a=a.slice([0,0],[n,e]).concat(k,1)}return[s,i,a]})),3),s=t[0],i=t[1],a=t[2],GA([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]}))}var yE=y_({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got ".concat(t,"."));if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got ".concat(n,"."));var r=m_(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got ".concat(r.rank,"."));var a=r.shape,i=_slicedToArray(r.shape.slice(-2),2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(o,")."));if(!(n<=s))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(s,")."));t<0&&(t=o),n<0&&(n=s);var u=L_(0,o,1,"int32").reshape([-1,1]),c=L_(0,s,1,"int32"),l=XC(u,c),h=gx(l.lessEqual(I_(+t,"int32")),l.greaterEqual(I_(-n,"int32"))),f=P_([o,s],r.dtype);return X_(Z_(r.reshape([-1,o,s])).map((function(e){return _x(h,e,f)}))).reshape(a)}}),bE=y_({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Ry(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Ry(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=EC(e,e.shape[0],0).map((function(e){return K_(e,[0])}))),Ry(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(Ub.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=xw(n[a].mul(t)).mul(n[a]);t=t.sub(i)}return t.div(WT(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?X_(n,0):n}}),kE=y_({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank));if(2===e.rank)return gE(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Z_(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=_slicedToArray(gE(e,t),2),r=n[0],o=n[1];a.push(r),i.push(o)})),[X_(a,0).reshape(e.shape),X_(i,0).reshape(e.shape)]}});function _E(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||wE)}(e,t,n);e.splice(r<0?-(r+1):r,0,t)}function wE(e,t){return e>t?1:e<t?-1:0}function CE(e,t,n,r,a){var i=SE(e,t,n,r,a,0);return i.selectedScores.dispose(),i.numValidOutputs.dispose(),i.selectedIndices}function xE(e,t,n,r,a,i){var o=SE(e,t,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function SE(e,t,n,r,a,i){arguments.length>6&&void 0!==arguments[6]&&arguments[6];for(var o=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=[],u=0;u<t.length;u++)t[u]>a&&s.push({score:t[u],boxIndex:u,suppressBeginIndex:0});s.sort(TE);for(var c=i>0?-.5/i:0,l=[],h=[];l.length<n&&s.length>0;){var f=s.pop(),d=f.score,p=f.boxIndex,v=f.suppressBeginIndex;if(d<a)break;for(var m=!1,g=l.length-1;g>=v;--g){var y=AE(e,p,l[g]);if(y>=r){m=!0;break}if(f.score=f.score*IE(r,c,y),f.score<=a)break}f.suppressBeginIndex=l.length,m||(f.score===d?(l.push(p),h.push(f.score)):f.score>a&&_E(s,f,TE))}var b=l.length;return o&&(l.fill(0,b),h.fill(0,b)),{selectedIndices:T_(l,"int32"),selectedScores:T_(h,"float32"),numValidOutputs:I_(b,"int32")}}function AE(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),h=Math.max(a[0],a[2]),f=Math.max(a[1],a[3]),d=(s-i)*(u-o),p=(h-c)*(f-l);if(d<=0||p<=0)return 0;var v=Math.max(i,c),m=Math.max(o,l),g=Math.min(s,h),y=Math.min(u,f),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(d+p-b)}function IE(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function TE(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function EE(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),Ry(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),Ry(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),Ry(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),Ry(1===t.rank,(function(){return"scores must be a 1D tensor"})),Ry(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),Ry(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var RE=y_({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=m_(e,"boxes","nonMaxSuppression"),o=m_(t,"scores","nonMaxSuppression"),s=EE(i,o,n,r,a);return Ub.runKernelFunc((function(e){return e.nonMaxSuppression(i,o,n,r,a)}),{boxes:i,scores:o},null,jk,{maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold})}}),NE=y_({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"images","resizeBilinear");Ry(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),Ry(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=_slicedToArray(t,2),s=o[0],u=o[1],c=Ub.runKernelFunc((function(e,t){return t([a]),e.resizeBilinear(a,s,u,n)}),{x:a},(function(e,t){return{x:function(){return Ub.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:s,newWidth:u});return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),OE=y_({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=m_(e,"images","resizeNearestNeighbor");Ry(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),Ry(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),Ry("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=_slicedToArray(t,2),s=o[0],u=o[1],c=Ub.runKernelFunc((function(e,t){return t([a]),e.resizeNearestNeighbor(a,s,u,n)}),{batchImages:a},(function(e,t){return{batchImages:function(){return Ub.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c}}),DE=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>3&&void 0!==h[3]?h[3]:.5,i=h.length>4&&void 0!==h[4]?h[4]:Number.NEGATIVE_INFINITY,o=m_(t,"boxes","nonMaxSuppressionAsync"),s=m_(n,"scores","nonMaxSuppressionAsync"),u=EE(o,s,r,a,i),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,e.next=6,Promise.all([o.data(),s.data()]);case 6:return c=e.sent,l=CE(c[0],c[1],r,a,i),e.abrupt("return",(o!==t&&o.dispose(),s!==n&&s.dispose(),l));case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),FE=y_({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=m_(e,"boxes","nonMaxSuppression"),s=m_(t,"scores","nonMaxSuppression"),u=EE(o,s,n,r,a,i),c=Ub.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},{maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma});return{selectedIndices:c[0],selectedScores:c[1]}}}),ME=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=f.length>3&&void 0!==f[3]?f[3]:.5,i=f.length>4&&void 0!==f[4]?f[4]:Number.NEGATIVE_INFINITY,o=f.length>5&&void 0!==f[5]?f[5]:0,s=m_(t,"boxes","nonMaxSuppressionAsync"),u=m_(n,"scores","nonMaxSuppressionAsync"),c=EE(s,u,r,a,i,o),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,o=c.softNmsSigma,e.next=7,Promise.all([s.data(),u.data()]);case 7:return l=e.sent,h=xE(l[0],l[1],r,a,i,o),e.abrupt("return",(s!==t&&s.dispose(),u!==n&&u.dispose(),h));case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),PE=y_({cropAndResize_:function(e,t,n,r,a,i){var o=m_(e,"image","cropAndResize"),s=m_(t,"boxes","cropAndResize","float32"),u=m_(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return Ry(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),Ry(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(s.shape,".")})),Ry(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(s.shape,".")})),Ry(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),Ry(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),Ry("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)})),Ub.runKernelFunc((function(e,t){return e.cropAndResize(o,s,u,r,a,i)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),zE=function(e,t){return!(e>0)||"linear"===t},LE=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation ".concat(n," has not been ")+"implemented yet.")},BE=function(e,t){var n=t,r=l_(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},VE=function(e,t,n){if("linear"===t)return e;if("relu"===t)return rT(e);if("elu"===t)return II(e);if("relu6"===t)return aT(e);if("prelu"===t)return XI(e,n);throw new Error("Unknown fused activation ".concat(t,"."))},WE=y_({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,i=void 0!==a&&a,o=e.transposeB,s=void 0!==o&&o,u=e.bias,c=e.activation,l=void 0===c?"linear":c,h=e.preluActivationWeights;if(!1===zE(Ub.state.gradientDepth,l)){var f=xC(n,r,i,s);return null!=u&&(f=b_(f,u)),VE(f,l,h)}var d=m_(n,"a","fused matMul"),p=m_(r,"b","fused matMul"),v=_slicedToArray(Pb(d,p),2);d=v[0],p=v[1];var m=i?d.shape[d.rank-2]:d.shape[d.rank-1],g=s?p.shape[p.rank-1]:p.shape[p.rank-2],y=i?d.shape[d.rank-1]:d.shape[d.rank-2],b=s?p.shape[p.rank-2]:p.shape[p.rank-1],k=d.shape.slice(0,-2),_=p.shape.slice(0,-2),w=Fy(k),C=Fy(_);Ry(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least "+"2, got ranks ".concat(d.rank," and ").concat(p.rank,".")})),Ry(Py(k,_),(function(){return"Error in fused matMul: outer dimensions (".concat(k,") and (")+"".concat(_,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," must match.")})),Ry(m===g,(function(){return"Error in fused matMul: inner shapes (".concat(m,") and (")+"".concat(g,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," and transposeA=").concat(i)+" and transposeB=".concat(s," must match.")}));var x,S,A=d.shape.slice(0,-2).concat([y,b]),I=i?d.as3D(w,m,y):d.as3D(w,y,m),T=s?p.as3D(C,b,g):p.as3D(C,g,b);null!=u&&(t=_slicedToArray(Pb(x=m_(u,"bias","fused matMul"),d),1),h_(A,(x=t[0]).shape)),null!=h&&(S=m_(h,"prelu weights","fused matMul"));var E={a:I,b:T};return null!=u&&(E.bias=x),null!=h&&(E.preluActivationWeights=S),Ub.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:I,b:T,transposeA:i,transposeB:s,bias:x,activation:l,preluActivationWeights:S});return t([I,T,n]),n}),E,(function(e,t){var n=_slicedToArray(t,3),r=n[0],a=n[1],o=n[2],c=LE(e,o,l),h={};return null!=u&&(h={bias:function(){return BE(x,c)}}),Object.assign(i||s?!i&&s?{a:function(){return c.matMul(a,!1,!1)},b:function(){return c.matMul(r,!0,!1)}}:i&&!s?{a:function(){return a.matMul(c,!1,!0)},b:function(){return r.matMul(c,!1,!1)}}:{a:function(){return a.matMul(c,!0,!0)},b:function(){return c.matMul(r,!0,!0)}}:{a:function(){return c.matMul(a,!1,!0)},b:function(){return r.matMul(c,!0,!1)}},h)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},[I,T],[!0]).reshape(A)}}),UE=y_({fusedConv2d_:function(e){var t,n=e.x,r=e.filter,a=e.strides,i=e.pad,o=e.dataFormat,s=void 0===o?"NHWC":o,u=e.dilations,c=void 0===u?[1,1]:u,l=e.dimRoundingMode,h=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(!1===zE(Ub.state.gradientDepth,d=d||"linear")){var v=FC(n,r,a,i,s,c,l);return null!=h&&(v=b_(v,h)),VE(v,d,p)}var m=m_(n,"x","conv2d"),g=m_(r,"filter","conv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),Ry(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(y.rank,".")})),Ry(4===g.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(g.rank,".")})),null!=l&&Ry(zy(i),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(i,".")})),Ry(y.shape[3]===g.shape[2],(function(){return"Error in conv2d: depth of input (".concat(y.shape[3],") must match ")+"input depth for filter ".concat(g.shape[2],".")})),Ry(yC(a,c),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(a," and dilations '").concat(c,"'")})),Ry("NHWC"===s,(function(){return"Error in conv2d: got dataFormat of ".concat(s," but only NHWC is currently supported.")}));var k,_,w=lC(y.shape,g.shape,a,c,i,l);null!=h&&(t=_slicedToArray(Pb(k=m_(h,"bias","fused conv2d"),m),1),k=t[0],h_(w.outShape,k.shape)),null!=p&&(_=m_(p,"prelu weights","fused conv2d"));var C={x:y,filter:g};null!=h&&(C.bias=k),null!=p&&(C.preluActivationWeights=_);var x=Ub.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:y,filter:g,convInfo:w,bias:k,activation:d,preluActivationWeights:_});return t([g,y,n]),n}),C,(function(e,t){var n=_slicedToArray(t,3),r=n[0],o=n[1],s=n[2],u=LE(e,s,d);Ry(gC(c),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(c,"'")}));var l={};return null!=h&&(l={bias:function(){return BE(k,u)}}),Object.assign({x:function(){return OC(o.shape,u,r,a,i)},filter:function(){return NC(o,u,r.shape,a,i)}},l)}),"FusedConv2D",{convInfo:w,activation:d},[g,y],[!0]);return b?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),jE=y_({fusedDepthwiseConv2d_:function(e){var t,n=e.x,r=e.filter,a=e.strides,i=e.pad,o=e.dataFormat,s=void 0===o?"NHWC":o,u=e.dilations,c=void 0===u?[1,1]:u,l=e.dimRoundingMode,h=e.bias,f=e.activation,d=void 0===f?"linear":f,p=e.preluActivationWeights;if(!1===zE(Ub.state.gradientDepth,d)){var v=CI(n,r,a,i,s,c,l);return null!=h&&(v=b_(v,h)),VE(v,d,p)}var m=m_(n,"x","depthwiseConv2d"),g=m_(r,"filter","depthwiseConv2d"),y=m,b=!1;3===m.rank&&(b=!0,y=m.as4D(1,m.shape[0],m.shape[1],m.shape[2])),Ry(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(y.rank,".")})),Ry(4===g.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(g.rank,".")})),Ry(y.shape[3]===g.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(y.shape[3],") must match the inChannels dimension in ")+"filter ".concat(g.shape[2],".")})),null==c&&(c=[1,1]),Ry(yC(a,c),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(a," and dilations '").concat(c,"'")})),null!=l&&Ry(zy(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(i,".")}));var k,_,w=lC(y.shape,g.shape,a,c,i,l,!0);null!=h&&(t=_slicedToArray(Pb(k=m_(h,"bias","fused conv2d"),m),1),k=t[0],h_(w.outShape,k.shape)),null!=p&&(_=m_(p,"prelu weights","fused depthwiseConv2d"));var C={x:y,filter:g};null!=h&&(C.bias=k),null!=p&&(C.preluActivationWeights=_);var x=Ub.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:y,filter:g,convInfo:w,bias:k,activation:d,preluActivationWeights:_});return t([g,y,n]),n}),C,(function(e,t){Ry(gC(c),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(c,"'")}));var n=_slicedToArray(t,3),r=n[0],a=n[1],i=n[2],o=LE(e,i,d),s={};return null!=h&&(s={bias:function(){return BE(k,o)}}),Object.assign({x:function(){return jC(a.shape,o,r,w)},filter:function(){return UC(a,o,r.shape,w)}},s)}),"FusedDepthwiseConv2D",{convInfo:w,activation:d},[g,y],[!0]);return b?x.as3D(x.shape[1],x.shape[2],x.shape[3]):x}}),HE=function(e){_inherits(o,e);var t,n,r,a,i=_createSuper(o);function o(){return _classCallCheck(this,o),i.apply(this,arguments)}return _createClass(o,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return GA(i),t?a:(a.dispose(),null)}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return aw(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&GA(this.iterations_)}},{key:"saveIterations",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(null==this.iterations_&&(this.iterations_=0),{name:"iter",tensor:I_(this.iterations_,"int32")}));case 1:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getWeights",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"setWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(this.getClassName()));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"extractIterations",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t[0].tensor.data();case 2:return this.iterations_=e.sent[0],e.abrupt("return",t.slice(1));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}}]),o}(wA);Object.defineProperty(HE,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var GE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return _classCallCheck(this,a),(n=r.call(this)).learningRate=e,n.rho=t,n.epsilon=i,n.accumulatedGrads=[],n.accumulatedUpdates=[],null==i&&(n.epsilon=Ub.backend.epsilon()),n}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Ub.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:HA((function(){return V_(a).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:HA((function(){return V_(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;HA((function(){var e=o.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(a);a.assign(u)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(GA(this.accumulatedGrads.map((function(e){return e.variable}))),GA(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedGrads),_toConsumableArray(this.accumulatedUpdates)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:e.t0=(t=e.sent).length,n=e.t0/2,this.accumulatedGrads=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),a}(HE);GE.className="Adadelta",xA(GE);var qE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return _classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.initialAccumulatorValue=n,t.accumulatedGrads=[],t}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Ub.registeredVariables[n];if(null==t.accumulatedGrads[r]){t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:HA((function(){return RI(a.shape,t.initialAccumulatorValue).variable(!1)}))}}var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;HA((function(){var e=o.add(i.square());o.assign(e);var n=i.div(e.add(Ub.backend.epsilon()).sqrt()).mul(-t.learningRate).add(a);a.assign(n)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&GA(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,this.accumulatedGrads=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),a}(HE);qE.className="Adagrad",xA(qE);var KE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _classCallCheck(this,a),(i=r.call(this)).learningRate=e,i.beta1=t,i.beta2=n,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],HA((function(){i.accBeta1=I_(t).variable(),i.accBeta2=I_(n).variable()})),null==o&&(i.epsilon=Ub.backend.epsilon()),i}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);HA((function(){var r=XC(1,t.accBeta1),a=XC(1,t.accBeta2);n.forEach((function(n,i){var o=Ub.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:HA((function(){return V_(o).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:"".concat(n,"/v"),variable:HA((function(){return V_(o).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),h=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),f=l.div(r),d=h.div(a);u.assign(l),c.assign(h);var p=f.div(d.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(p)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&GA(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&GA(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedFirstMoment),_toConsumableArray(this.accumulatedSecondMoment)),e.next=3,this.saveIterations();case 3:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,HA((function(){r.accBeta1.assign(Cx(r.beta1,r.iterations_+1)),r.accBeta2.assign(Cx(r.beta2,r.iterations_+1))})),n=t.length/2,this.accumulatedFirstMoment=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),a}(HE);KE.className="Adam",xA(KE);var XE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return _classCallCheck(this,a),(i=r.call(this)).learningRate=e,i.beta1=t,i.beta2=n,i.epsilon=o,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],HA((function(){i.iteration=I_(0).variable(),i.accBeta1=I_(t).variable()})),null==o&&(i.epsilon=Ub.backend.epsilon()),i}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);HA((function(){var r=XC(1,t.accBeta1),a=J_(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var o=Ub.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:"".concat(n,"/m"),variable:V_(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:"".concat(n,"/v"),variable:V_(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),h=c.mul(t.beta2),f=s.abs(),d=h.maximum(f);u.assign(l),c.assign(d);var p=a.div(r).mul(l.div(d.add(t.epsilon))).add(o);o.assign(p)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&GA(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&GA(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),a}(HE);XE.className="Adamax",xA(XE);var ZE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.setLearningRate(e),t}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=Ub.registeredVariables[n];HA((function(){var e=t.c.mul(a).add(i);i.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=qA(I_(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:if(e.t0=(t=e.sent).length,0===e.t0){e.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),a}(HE);ZE.className="SGD",xA(ZE);var YE=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return _classCallCheck(this,a),(n=r.call(this,e)).learningRate=e,n.momentum=t,n.useNesterov=i,n.accumulations=[],n.m=I_(n.momentum),n}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Ub.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:HA((function(){return V_(a).variable(!1)}))}}var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&HA((function(){var e,n=t.m.mul(i).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(a):t.c.mul(n).add(a),i.assign(n),a.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&GA(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveIterations();case 2:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,this.accumulations=t.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),a}(ZE);YE.className="Momentum",xA(YE);var $E=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,a),(t=r.call(this)).learningRate=e,t.decay=n,t.momentum=i,t.epsilon=o,t.accumulatedMeanSquares=[],t.accumulatedMoments=[],t.accumulatedMeanGrads=[],t.centered=s,null==o&&(t.epsilon=Ub.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return _possibleConstructorReturn(t)}return _createClass(a,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Ub.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:HA((function(){return V_(a).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:HA((function(){return V_(a).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:HA((function(){return V_(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;HA((function(){var e=o.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(u),s.assign(c);var l=a.sub(c);a.assign(l)}else{var h=o.mul(t.decay).add(i.square().mul(1-t.decay)),f=s.mul(t.momentum).add(i.mul(t.learningRate).div(h.add(t.epsilon).sqrt()));o.assign(h),s.assign(f);var d=a.sub(f);a.assign(d)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&GA(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&GA(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&GA(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[].concat(_toConsumableArray(this.accumulatedMeanSquares),_toConsumableArray(this.accumulatedMoments)),this.centered&&t.push.apply(t,_toConsumableArray(this.accumulatedMeanGrads)),e.next=4,this.saveIterations();case 4:return e.t0=e.sent,e.abrupt("return",[e.t0].concat(t.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"setWeights",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.extractIterations(t);case 2:t=e.sent,n=this.centered?t.length/3:t.length/2,this.accumulatedMeanSquares=t.slice(0,n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=t.slice(n,2*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=t.slice(2*n,3*n).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),a}(HE);$E.className="RMSProp",xA($E);var JE=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"sgd",value:function(e){return new ZE(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new YE(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new $E(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new KE(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new GE(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new XE(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new qE(e,t)}}]),e}(),QE={sgd:JE.sgd,momentum:JE.momentum,adadelta:JE.adadelta,adagrad:JE.adagrad,rmsprop:JE.rmsprop,adamax:JE.adamax,adam:JE.adam},eR="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(e){return e()};function tR(){return new Promise((function(e){return eR((function(){return e()}))}))}function nR(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function rR(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2==1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function aR(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];a.push(r?e[0]/n:e[0]*n);for(var i=1;i<e.length;++i)a.push(i<=t.length?r?t[i-1]*e[i]:e[i]/t[i-1]:e[i]);return a}function iR(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function oR(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var sR=.3275911,uR=.254829592,cR=-.284496736,lR=1.421413741,hR=-1.453152027,fR=1.061405429;function dR(){var e;cy().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function pR(){var e;cy().getBool("IS_TEST")||(e=console).log.apply(e,arguments)}function vR(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function mR(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function gR(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function yR(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function bR(e,t){return{real:e[2*t],imag:e[2*t+1]}}function kR(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function _R(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function wR(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function CR(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=P_(e.shape),a=e.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!Yy(e.dtype,t))return Ub.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e),s=o.cast(t);return o.dispose(),s}if("int32"===t)return n.int(e);if("bool"===t){var u=I_(0,e.dtype),c=n.notEqual(e,u);return u.dispose(),c}throw new Error("Error in Cast: failed to cast ".concat(e.dtype," to ").concat(t))}function xR(e,t){return Ub.makeTensorFromDataId(e.dataId,t,e.dtype)}function SR(e,t,n){var r=(t-e)/(n-1),a=lb(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return T_(a,"float32")}function AR(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map((function(t){var i=_toConsumableArray(a);i[n]=t;var o=e.slice(r,i);return r[n]+=t,o}))}function IR(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=U_(n,e.dtype),i=0;i<a.values.length;++i){for(var o=a.indexToLoc(i),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=o[u]%e.shape[u];var c=e.locToIndex(s);a.values[i]=e.values[c]}return a.toTensor()}function TR(e,t,n,r,a){for(var i=t[t.length-1],o=e.length/i,s=i,u=qy(n,o*r),c=qy("int32",o*r),l=0;l<o;l++){for(var h=l*s,f=e.subarray(h,h+s),d=[],p=0;p<f.length;p++)d.push({value:f[p],index:p});d.sort((function(e,t){return t.value-e.value}));for(var v=l*r,m=u.subarray(v,v+r),g=c.subarray(v,v+r),y=0;y<r;y++)m[y]=d[y].value,g[y]=d[y].index}var b=t.slice();return b[b.length-1]=r,[S_(u,b,n),S_(c,b,"int32")]}var ER,RR,NR=function(){function e(t,n){_classCallCheck(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return _createClass(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),OR=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"time",value:function(e){return DR("time")}},{key:"read",value:function(e){return DR("read")}},{key:"readSync",value:function(e){return DR("readSync")}},{key:"numDataIds",value:function(){return DR("numDataIds")}},{key:"disposeData",value:function(e){return DR("disposeData")}},{key:"write",value:function(e,t,n){return DR("write")}},{key:"move",value:function(e,t,n,r){return DR("move")}},{key:"memory",value:function(){return DR("memory")}},{key:"floatPrecision",value:function(){return DR("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(e,t,n,r){return DR("batchMatMul")}},{key:"fusedBatchMatMul",value:function(e){return _objectDestructuringEmpty(e),DR("fusedBatchMatMul")}},{key:"slice",value:function(e,t,n){return DR("slice")}},{key:"stridedSlice",value:function(e,t,n,r){return DR("stridedSlice")}},{key:"unstack",value:function(e,t){return DR("unstack")}},{key:"reverse",value:function(e,t){return DR("reverse")}},{key:"concat",value:function(e,t){return DR("concat")}},{key:"neg",value:function(e){return DR("neg")}},{key:"add",value:function(e,t){return DR("add")}},{key:"addN",value:function(e){return DR("addN")}},{key:"subtract",value:function(e,t){return DR("subtract")}},{key:"multiply",value:function(e,t){return DR("multiply")}},{key:"realDivide",value:function(e,t){return DR("realDivide")}},{key:"floorDiv",value:function(e,t){return DR("floorDiv")}},{key:"sum",value:function(e,t){return DR("sum")}},{key:"prod",value:function(e,t){return DR("prod")}},{key:"unsortedSegmentSum",value:function(e,t,n){return DR("unsortedSegmentSum")}},{key:"argMin",value:function(e,t){return DR("argMin")}},{key:"argMax",value:function(e,t){return DR("argMax")}},{key:"equal",value:function(e,t){return DR("equal")}},{key:"notEqual",value:function(e,t){return DR("notEqual")}},{key:"less",value:function(e,t){return DR("less")}},{key:"lessEqual",value:function(e,t){return DR("lessEqual")}},{key:"greater",value:function(e,t){return DR("greater")}},{key:"greaterEqual",value:function(e,t){return DR("greaterEqual")}},{key:"logicalNot",value:function(e){return DR("logicalNot")}},{key:"logicalAnd",value:function(e,t){return DR("logicalAnd")}},{key:"logicalOr",value:function(e,t){return DR("logicalOr")}},{key:"where",value:function(e){return DR("where")}},{key:"select",value:function(e,t,n){return DR("select")}},{key:"topk",value:function(e,t,n){return DR("topk")}},{key:"min",value:function(e,t){return DR("min")}},{key:"minimum",value:function(e,t){return DR("minimum")}},{key:"mod",value:function(e,t){return DR("mod")}},{key:"max",value:function(e,t){return DR("max")}},{key:"maximum",value:function(e,t){return DR("maximum")}},{key:"all",value:function(e,t){return DR("all")}},{key:"any",value:function(e,t){return DR("any")}},{key:"squaredDifference",value:function(e,t){return DR("squaredDifference")}},{key:"ceil",value:function(e){return DR("ceil")}},{key:"floor",value:function(e){return DR("floor")}},{key:"round",value:function(e){return DR("round")}},{key:"sign",value:function(e){return DR("sign")}},{key:"isNaN",value:function(e){return DR("isNaN")}},{key:"isInf",value:function(e){return DR("isInf")}},{key:"isFinite",value:function(e){return DR("isFinite")}},{key:"pow",value:function(e,t){return DR("pow")}},{key:"exp",value:function(e){return DR("exp")}},{key:"expm1",value:function(e){return DR("expm1")}},{key:"softmax",value:function(e,t){return DR("softmax")}},{key:"log",value:function(e){return DR("log")}},{key:"log1p",value:function(e){return DR("log1p")}},{key:"sqrt",value:function(e){return DR("sqrt")}},{key:"rsqrt",value:function(e){return DR("rsqrt")}},{key:"square",value:function(e){return DR("square")}},{key:"reciprocal",value:function(e){return DR("reciprocal")}},{key:"relu",value:function(e){return DR("relu")}},{key:"relu6",value:function(e){return DR("relu6")}},{key:"prelu",value:function(e,t){return DR("prelu")}},{key:"elu",value:function(e){return DR("elu")}},{key:"eluDer",value:function(e,t){return DR("eluDer")}},{key:"selu",value:function(e){return DR("selu")}},{key:"int",value:function(e){return DR("int")}},{key:"clip",value:function(e,t,n){return DR("clip")}},{key:"abs",value:function(e){return DR("abs")}},{key:"complexAbs",value:function(e){return DR("complexAbs")}},{key:"sigmoid",value:function(e){return DR("sigmoid")}},{key:"softplus",value:function(e){return DR("softplus")}},{key:"sin",value:function(e){return DR("sin")}},{key:"cos",value:function(e){return DR("cos")}},{key:"tan",value:function(e){return DR("tan")}},{key:"asin",value:function(e){return DR("asin")}},{key:"acos",value:function(e){return DR("acos")}},{key:"atan",value:function(e){return DR("atan")}},{key:"atan2",value:function(e,t){return DR("atan2")}},{key:"sinh",value:function(e){return DR("sinh")}},{key:"cosh",value:function(e){return DR("cosh")}},{key:"tanh",value:function(e){return DR("tanh")}},{key:"asinh",value:function(e){return DR("asinh")}},{key:"acosh",value:function(e){return DR("acosh")}},{key:"atanh",value:function(e){return DR("atanh")}},{key:"erf",value:function(e){return DR("erf")}},{key:"step",value:function(e,t){return DR("step")}},{key:"fusedConv2d",value:function(e){return _objectDestructuringEmpty(e),DR("fusedConv2d")}},{key:"conv2d",value:function(e,t,n){return DR("conv2d")}},{key:"conv2dDerInput",value:function(e,t,n){return DR("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(e,t,n){return DR("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(e){return _objectDestructuringEmpty(e),DR("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(e,t,n){return DR("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){return DR("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){return DR("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(e,t,n){return DR("conv3d")}},{key:"conv3dDerInput",value:function(e,t,n){return DR("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(e,t,n){return DR("conv3dDerFilter")}},{key:"maxPool",value:function(e,t){return DR("maxPool")}},{key:"maxPoolBackprop",value:function(e,t,n,r){return DR("maxPoolBackprop")}},{key:"avgPool",value:function(e,t){return DR("avgPool")}},{key:"avgPoolBackprop",value:function(e,t,n){return DR("avgPoolBackprop")}},{key:"avgPool3d",value:function(e,t){return DR("avgPool3d")}},{key:"avgPool3dBackprop",value:function(e,t,n){return DR("avgPool3dBackprop")}},{key:"maxPool3d",value:function(e,t){return DR("maxPool3d")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){return DR("maxPool3dBackprop")}},{key:"reshape",value:function(e,t){return DR("reshape")}},{key:"cast",value:function(e,t){return DR("cast")}},{key:"tile",value:function(e,t){return DR("tile")}},{key:"pad",value:function(e,t,n){return DR("pad")}},{key:"transpose",value:function(e,t){return DR("transpose")}},{key:"gather",value:function(e,t,n){return DR("gather")}},{key:"gatherND",value:function(e,t){return DR("gatherND")}},{key:"scatterND",value:function(e,t,n){return DR("scatterND")}},{key:"batchToSpaceND",value:function(e,t,n){return DR("batchToSpaceND")}},{key:"spaceToBatchND",value:function(e,t,n){return DR("spaceToBatchND")}},{key:"resizeBilinear",value:function(e,t,n,r){return DR("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(e,t,n){return DR("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){return DR("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){return DR("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(e,t,n,r,a,i){return DR("batchNorm")}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){return DR("localResponseNormalization4D")}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){return DR("LRNGrad")}},{key:"multinomial",value:function(e,t,n,r){return DR("multinomial")}},{key:"oneHot",value:function(e,t,n,r){return DR("oneHot")}},{key:"cumsum",value:function(e,t,n,r){return DR("cumsum")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){return DR("nonMaxSuppression")}},{key:"fft",value:function(e){return DR("fft")}},{key:"ifft",value:function(e){return DR("ifft")}},{key:"complex",value:function(e,t){return DR("complex")}},{key:"real",value:function(e){return DR("real")}},{key:"imag",value:function(e){return DR("imag")}},{key:"cropAndResize",value:function(e,t,n,r,a,i){return DR("cropAndResize")}},{key:"depthToSpace",value:function(e,t,n){return DR("depthToSpace")}},{key:"split",value:function(e,t,n){return DR("split")}},{key:"sparseToDense",value:function(e,t,n,r){return DR("sparseToDense")}},{key:"diag",value:function(e){return DR("diag")}},{key:"fill",value:function(e,t,n){return DR("fill")}},{key:"onesLike",value:function(e){return DR("onesLike")}},{key:"zerosLike",value:function(e){return DR("zerosLike")}},{key:"linspace",value:function(e,t,n){return DR("linspace")}},{key:"dispose",value:function(){return DR("dispose")}}]),e}();function DR(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"Did you forget to import the kernel?")}Ab.prototype.add=function(e){return this.throwIfDisposed(),b_(this,e)},Ab.prototype.atan2=function(e){return this.throwIfDisposed(),aI(this,e)},Ab.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),iI(this,e,t,n,r)},Ab.prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),uI(this,e,t,n,r,a)},Ab.prototype.broadcastTo=function(e){return this.throwIfDisposed(),dI(this,e)},Ab.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),Nx(this,e,t)},Ab.prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Ab&&(e=[e]),W_([this].concat(_toConsumableArray(e)),t)},Ab.prototype.conv1d=function(e,t,n,r,a,i){return this.throwIfDisposed(),yI(this,e,t,n,r,a,i)},Ab.prototype.conv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),FC(this,e,t,n,r,a,i)},Ab.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),bI(this,e,t,n,r,a)},Ab.prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),VC(this,e,t,n)},Ab.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),wI(this,e,t)},Ab.prototype.depthwiseConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),CI(this,e,t,n,r,a,i)},Ab.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return BA("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),CI(this,e,t,n,r,a,i)},Ab.prototype.div=function(e){return this.throwIfDisposed(),J_(this,e)},Ab.prototype.divNoNan=function(e){return this.throwIfDisposed(),SI(this,e)},Ab.prototype.dot=function(e){return this.throwIfDisposed(),AI(this,e)},Ab.prototype.elu=function(){return this.throwIfDisposed(),II(this)},Ab.prototype.equal=function(e){return this.throwIfDisposed(),TI(this,e)},Ab.prototype.floorDiv=function(e){return this.throwIfDisposed(),$_(this,e)},Ab.prototype.greater=function(e){return this.throwIfDisposed(),cx(this,e)},Ab.prototype.greaterEqual=function(e){return this.throwIfDisposed(),nx(this,e)},Ab.prototype.leakyRelu=function(e){return this.throwIfDisposed(),OI(this,e)},Ab.prototype.less=function(e){return this.throwIfDisposed(),rx(this,e)},Ab.prototype.lessEqual=function(e){return this.throwIfDisposed(),lx(this,e)},Ab.prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),DI(this,e,t,n,r)},Ab.prototype.matMul=function(e,t,n){return this.throwIfDisposed(),xC(this,e,t,n)},Ab.prototype.max=function(e,t){return this.throwIfDisposed(),FI(this,e,t)},Ab.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),MI(this,e,t,n,r)},Ab.prototype.maximum=function(e){return this.throwIfDisposed(),NI(this,e)},Ab.prototype.minimum=function(e){return this.throwIfDisposed(),LI(this,e)},Ab.prototype.mod=function(e){return this.throwIfDisposed(),BI(this,e)},Ab.prototype.mul=function(e){return this.throwIfDisposed(),Q_(this,e)},Ab.prototype.notEqual=function(e){return this.throwIfDisposed(),WI(this,e)},Ab.prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),dA(this,e,t,n)},Ab.prototype.pad=function(e,t){return this.throwIfDisposed(),zx(this,e,t)},Ab.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),KI(this,e,t,n,r,a)},Ab.prototype.pow=function(e){return this.throwIfDisposed(),Cx(this,e)},Ab.prototype.prelu=function(e){return this.throwIfDisposed(),XI(this,e)},Ab.prototype.relu=function(){return this.throwIfDisposed(),rT(this)},Ab.prototype.relu6=function(){return this.throwIfDisposed(),aT(this)},Ab.prototype.selu=function(){return this.throwIfDisposed(),iT(this)},Ab.prototype.separableConv2d=function(e,t,n,r,a,i){return this.throwIfDisposed(),oT(this,e,t,n,r,a,i)},Ab.prototype.split=function(e,t){return this.throwIfDisposed(),EC(this,e,t)},Ab.prototype.squaredDifference=function(e){return this.throwIfDisposed(),sT(this,e)},Ab.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),AC(this,e,t)},Ab.prototype.sub=function(e){return this.throwIfDisposed(),XC(this,e)},Ab.prototype.tile=function(e){return this.throwIfDisposed(),ZC(this,e)},Ab.prototype.transpose=function(e){return this.throwIfDisposed(),BC(this,e)},Sb=_,function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(ER||(ER={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(RR||(RR={}));var FR={};function MR(e){return FR[e]}function PR(e,t,n,r){var a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return zR(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return t.inputNames.slice(i,o).map((function(e){return zR(e,n,r)}));var s=Array.prototype.slice.call(zR(t.inputNames.slice(i)[0],n,r).dataSync());return"number"===a.type?s[0]:s}var u=t.attrParams[e];return u&&u.value}function zR(e,t,n){var r=_slicedToArray(VR(e),2),a=r[0],i=r[1],o=n.currentContextIds.find((function(e){return!!t[BR(a,e)]}));return void 0!==o?t[BR(a,o)][i]:void 0}function LR(e,t){var n=_slicedToArray(VR(e),2),r=n[0],a=n[1];return[BR(r,t&&t.currentContextId),a]}function BR(e,t){return t?"".concat(e,"-").concat(t):e}function VR(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function WR(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var UR=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jR=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],HR=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]}],GR=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}],qR=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],KR=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],XR=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],ZR=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],YR=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],$R=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],JR=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],QR=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],eN=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],tN=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],nN=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],rN=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];function aN(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=cy().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function iN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?aN(a.s,r):n}function oN(e,t,n){var r=e[t];return r?r.b:n}function sN(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function uN(e){switch("string"==typeof e&&(e=ER[e]),e){case ER.DT_FLOAT:return"float32";case ER.DT_INT32:case ER.DT_INT64:case ER.DT_INT8:case ER.DT_UINT8:return"int32";case ER.DT_BOOL:return"bool";case ER.DT_DOUBLE:return"float32";case ER.DT_STRING:return"string";default:return null}}function cN(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function lN(e,t,n){var r=e[t];return r&&r.type?uN(r.type):n}function hN(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return uN(e)})):n}function fN(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"==typeof e.size?e.size:parseInt(e.size,10)})):[]}function dN(e,t,n){var r=e[t];return r&&r.shape?fN(r.shape):n}function pN(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"==typeof e?e:parseInt(e,10)})):n}function vN(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return aN(e,r)})):n}function mN(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return fN(e)})):n}function gN(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var yN=function(){function e(t,n,r){var a=this;_classCallCheck(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return _createClass(e,[{key:"getInput",value:function(e){return zR(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return zR(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return sN(this.node.rawAttrs,e,t);if(null!=n.s)return iN(this.node.rawAttrs,e,t);if(null!=n.b)return oN(this.node.rawAttrs,e,t);if(null!=n.shape)return dN(this.node.rawAttrs,e,t);if(null!=n.type)return lN(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return pN(this.node.rawAttrs,e,t);if(null!=n.list.s)return vN(this.node.rawAttrs,e,t);if(null!=n.list.shape)return mN(this.node.rawAttrs,e,t);if(null!=n.list.b)return gN(this.node.rawAttrs,e,t);if(null!=n.list.type)return hN(this.node.rawAttrs,e,t)}return t}}]),e}();function bN(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";r.assert(function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0}(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}var kN=function(){function e(t,n,r,a,i,o,s){_classCallCheck(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return _createClass(e,[{key:"clearAndClose",value:function(){this.tensors.forEach((function(e){return e.tensor.dispose()})),this.tensors=[],this.closed_=!0}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),bN(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n&&n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n&&n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return S_([],[0].concat(this.elementShape));var r=this.readMany(e);return bN(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),X_(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return S_([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return bN(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),W_(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,_toConsumableArray(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Z_(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];HA((function(){t=t.reshape([1,r,i]);for(var s=0;s<e.length;++s)o[s]=Yx(t,[0,0===s?0:a[s-1],0],[1,e[s],i]).reshape(n.elementShape);return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)}},{key:"closed",get:function(){return this.closed_}}]),e}();function _N(e,t,n){var a=function(e,t,n){switch(e.category){case"arithmetic":return HA((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[b_(PR("a",e,t,n),PR("b",e,t,n))];case"AddN":return[rI(PR("tensors",e,t,n))];case"FloorMod":case"Mod":return[BI(PR("a",e,t,n),PR("b",e,t,n))];case"Mul":return[Q_(PR("a",e,t,n),PR("b",e,t,n))];case"RealDiv":case"Div":return[J_(PR("a",e,t,n),PR("b",e,t,n))];case"DivNoNan":return[SI(PR("a",e,t,n),PR("b",e,t,n))];case"FloorDiv":return[$_(PR("a",e,t,n),PR("b",e,t,n))];case"Sub":return[XC(PR("a",e,t,n),PR("b",e,t,n))];case"Minimum":return[LI(PR("a",e,t,n),PR("b",e,t,n))];case"Maximum":return[NI(PR("a",e,t,n),PR("b",e,t,n))];case"Pow":return[Cx(PR("a",e,t,n),PR("b",e,t,n))];case"SquaredDifference":return[sT(PR("a",e,t,n),PR("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return HA((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Iw(PR("x",e,t,n))];case"Acos":return[Tw(PR("x",e,t,n))];case"Acosh":return[Ew(PR("x",e,t,n))];case"Asin":return[Rw(PR("x",e,t,n))];case"Asinh":return[Nw(PR("x",e,t,n))];case"Atan":return[Ow(PR("x",e,t,n))];case"Atan2":return[aI(PR("x",e,t,n),PR("y",e,t,n))];case"Atanh":return[Dw(PR("x",e,t,n))];case"Ceil":return[Fw(PR("x",e,t,n))];case"Complex":return[w_(PR("real",e,t,n),PR("imag",e,t,n))];case"Cos":return[Pw(PR("x",e,t,n))];case"Cosh":return[zw(PR("x",e,t,n))];case"Elu":return[II(PR("x",e,t,n))];case"Erf":return[Lw(PR("x",e,t,n))];case"Exp":return[Bw(PR("x",e,t,n))];case"Expm1":return[Vw(PR("x",e,t,n))];case"Floor":return[Ww(PR("x",e,t,n))];case"Log":return[Uw(PR("x",e,t,n))];case"Log1p":return[jw(PR("x",e,t,n))];case"Imag":return[C_(PR("x",e,t,n))];case"Neg":return[Gw(PR("x",e,t,n))];case"Reciprocal":return[qw(PR("x",e,t,n))];case"Real":return[x_(PR("x",e,t,n))];case"Relu":return[rT(PR("x",e,t,n))];case"Round":return[Kw(PR("x",e,t,n))];case"Selu":return[iT(PR("x",e,t,n))];case"Sigmoid":return[Zw(PR("x",e,t,n))];case"Sin":return[eC(PR("x",e,t,n))];case"Sign":return[Yw(PR("x",e,t,n))];case"Sinh":return[tC(PR("x",e,t,n))];case"Softplus":return[nC(PR("x",e,t,n))];case"Sqrt":return[rC(PR("x",e,t,n))];case"Square":return[Aw(PR("x",e,t,n))];case"Tanh":return[oC(PR("x",e,t,n))];case"Tan":return[iC(PR("x",e,t,n))];case"Relu6":case"ClipByValue":return[Mw(PR("x",e,t,n),PR("clipValueMin",e,t,n),PR("clipValueMax",e,t,n))];case"Rsqrt":return[Xw(zR(e.inputNames[0],t,n))];case"Prod":return[Sw(PR("x",e,t,n),PR("axes",e,t,n))];case"LeakyRelu":return[OI(PR("x",e,t,n),PR("alpha",e,t,n))];case"Prelu":return[XI(PR("x",e,t,n),PR("alpha",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_,w,C,x,S,A,I,T,E,R,N,O,D,F,M,P,z,L,B,V,W,U,j,H,G,q,K,X;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0?3:"StatelessIf"===e.t0?3:"While"===e.t0?12:"StatelessWhile"===e.t0?12:"LoopCond"===e.t0?35:"Switch"===e.t0?36:"Merge"===e.t0?45:"Enter"===e.t0?47:"Exit"===e.t0?49:"NextIteration"===e.t0?51:"TensorArrayV3"===e.t0?53:"TensorArrayWriteV3"===e.t0?55:"TensorArrayReadV3"===e.t0?57:"TensorArrayGatherV3"===e.t0?59:"TensorArrayScatterV3"===e.t0?61:"TensorArrayConcatV3"===e.t0?63:"TensorArraySplitV3"===e.t0?65:"TensorArraySizeV3"===e.t0?67:"TensorArrayCloseV3"===e.t0?69:71;break;case 3:return a=PR("thenBranch",t,n,r),i=PR("elseBranch",t,n,r),o=PR("cond",t,n,r),s=PR("args",t,n,r),e.next=6,o.data();case 6:if(!e.sent[0]){e.next=10;break}e.t1=r.functionMap[a].executeFunctionAsync(s),e.next=11;break;case 10:e.t1=r.functionMap[i].executeFunctionAsync(s);case 11:return e.abrupt("return",e.t1);case 12:return u=PR("body",t,n,r),c=PR("cond",t,n,r),l=PR("args",t,n,r),e.next=17,r.functionMap[c].executeFunctionAsync(l);case 17:return h=e.sent[0],e.next=20,h.data();case 20:f=e.sent,d=l;case 22:if(!f[0]){e.next=34;break}return e.next=25,r.functionMap[u].executeFunctionAsync(d);case 25:return d=e.sent,e.next=28,r.functionMap[c].executeFunctionAsync(d);case 28:return p=e.sent[0],e.next=31,p.data();case 31:f=e.sent;case 32:e.next=22;break;case 34:return e.abrupt("return",d);case 35:return e.abrupt("return",[PR("pred",t,n,r).clone()]);case 36:return v=PR("pred",t,n,r),m=PR("data",t,n,r),e.next=39,v.data();case 39:if(!e.sent[0]){e.next=43;break}e.t2=[void 0,m.clone()],e.next=44;break;case 43:e.t2=[m.clone(),void 0];case 44:return e.abrupt("return",e.t2);case 45:return g=t.inputNames.find((function(e){return void 0!==zR(e,n,r)})),e.abrupt("return",g?[zR(g,n,r).clone()]:void 0);case 47:return y=PR("frameName",t,n,r),b=PR("tensor",t,n,r),e.abrupt("return",(r.enterFrame(y),[b.clone()]));case 49:return k=PR("tensor",t,n,r),e.abrupt("return",(r.exitFrame(),[k.clone()]));case 51:return _=PR("tensor",t,n,r),e.abrupt("return",(r.nextIteration(),[_.clone()]));case 53:return w=PR("size",t,n,r),C=PR("dtype",t,n,r),x=PR("elementShape",t,n,r),S=PR("dynamicSize",t,n,r),A=PR("clearAfterRead",t,n,r),I=PR("identicalElementShapes",t,n,r),T=PR("name",t,n,r),E=new kN(T,C,w,x,I,S,A),e.abrupt("return",(r.addTensorArray(E),[I_(E.id),I_(1)]));case 55:return R=PR("tensorArrayId",t,n,r),N=PR("index",t,n,r),O=PR("tensor",t,n,r),e.abrupt("return",(r.getTensorArray(R).write(N,O),[I_(1)]));case 57:return D=PR("tensorArrayId",t,n,r),F=PR("index",t,n,r),e.abrupt("return",[r.getTensorArray(D).read(F)]);case 59:return M=PR("tensorArrayId",t,n,r),P=PR("indices",t,n,r),z=PR("dtype",t,n,r),e.abrupt("return",[r.getTensorArray(M).gather(P,z)]);case 61:return L=PR("tensorArrayId",t,n,r),B=PR("indices",t,n,r),V=PR("tensor",t,n,r),e.abrupt("return",(r.getTensorArray(L).scatter(B,V),[I_(1)]));case 63:return W=PR("tensorArrayId",t,n,r),U=r.getTensorArray(W),j=PR("dtype",t,n,r),e.abrupt("return",[U.concat(j)]);case 65:return H=PR("tensorArrayId",t,n,r),G=PR("tensor",t,n,r),q=PR("lengths",t,n,r),e.abrupt("return",(r.getTensorArray(H).split(q,G),[I_(1)]));case 67:return K=PR("tensorArrayId",t,n,r),e.abrupt("return",[I_(r.getTensorArray(K).size(),"int32")]);case 69:return X=PR("tensorArrayId",t,n,r),e.abrupt("return",(r.getTensorArray(X).clearAndClose(),[I_(0)]));case 71:throw TypeError("Node type ".concat(t.op," is not implemented"));case 72:case"end":return e.stop()}}),e)}))),function(e,t,n){return o.apply(this,arguments)})(e,t,n);case"convolution":return HA((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=PR("stride",e,t,n),a=PR("pad",e,t,n),i=PR("dataFormat",e,t,n).toUpperCase(),o=PR("dilation",e,t,n);return[yI(PR("x",e,t,n),PR("filter",e,t,n),r,a,i,o)];case"Conv2D":var s=PR("strides",e,t,n),u=PR("pad",e,t,n),c=PR("dataFormat",e,t,n).toUpperCase(),l=PR("dilations",e,t,n);return[FC(PR("x",e,t,n),PR("filter",e,t,n),[s[1],s[2]],u,c,[l[1],l[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var h=_slicedToArray(PR("fusedOps",e,t,n),2),f=h[0],d=h[1],p="biasadd"===f,v="prelu"===d,m="fusedbatchnorm"===f,g=PR("numArgs",e,t,n);if(p){if(v&&2!==g)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!v&&1!==g)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(m)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");var y=PR("strides",e,t,n),b=PR("pad",e,t,n),_=PR("dataFormat",e,t,n).toUpperCase(),w=PR("dilations",e,t,n),C=_slicedToArray(PR("args",e,t,n),2),x=C[0],S=C[1];return[("_FusedConv2D"===e.op?k.conv2d:k.depthwiseConv2d)({x:PR("x",e,t,n),filter:PR("filter",e,t,n),strides:[y[1],y[2]],pad:b,dataFormat:_,dilations:[w[1],w[2]],bias:x,activation:d,preluActivationWeights:S})];case"Conv2DBackpropInput":case"Conv2dTranspose":var A=PR("outputShape",e,t,n),I=PR("strides",e,t,n),T=PR("pad",e,t,n);return[bI(PR("x",e,t,n),PR("filter",e,t,n),A,[I[1],I[2]],T)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var E=PR("strides",e,t,n),R=PR("pad",e,t,n),N=PR("dilations",e,t,n),O=PR("dataFormat",e,t,n).toUpperCase();return[CI(PR("input",e,t,n),PR("filter",e,t,n),[E[1],E[2]],R,O,[N[1],N[2]])];case"Conv3D":var D=PR("strides",e,t,n),F=PR("pad",e,t,n),M=PR("dataFormat",e,t,n).toUpperCase(),P=PR("dilations",e,t,n);return[kI(PR("x",e,t,n),PR("filter",e,t,n),[D[1],D[2],D[3]],F,M,[P[1],P[2],P[3]])];case"AvgPool":var z=PR("strides",e,t,n),L=PR("pad",e,t,n),B=PR("kernelSize",e,t,n);return[iI(PR("x",e,t,n),[B[1],B[2]],[z[1],z[2]],L)];case"MaxPool":var V=PR("strides",e,t,n),W=PR("pad",e,t,n),U=PR("kernelSize",e,t,n);return[MI(PR("x",e,t,n),[U[1],U[2]],[V[1],V[2]],W)];case"MaxPoolWithArgmax":var j=PR("strides",e,t,n),H=PR("pad",e,t,n),G=PR("kernelSize",e,t,n),q=PR("includeBatchInIndex",e,t,n),K=zI(PR("x",e,t,n),[G[1],G[2]],[j[1],j[2]],H,q);return[K.result,K.indexes];case"AvgPool3D":var X=PR("strides",e,t,n),Z=PR("pad",e,t,n),Y=PR("kernelSize",e,t,n);return[oI(PR("x",e,t,n),[Y[1],Y[2],Y[3]],[X[1],X[2],X[3]],Z)];case"MaxPool3D":var $=PR("strides",e,t,n),J=PR("pad",e,t,n),Q=PR("kernelSize",e,t,n);return[PI(PR("x",e,t,n),[Q[1],Q[2],Q[3]],[$[1],$[2],$[3]],J)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return HA((function(){return function(e,t,n){switch(e.op){case"Fill":var r=PR("shape",e,t,n),a=PR("dtype",e,t,n);return[RI(r,PR("value",e,t,n),a)];case"LinSpace":return[z_(PR("start",e,t,n),PR("stop",e,t,n),PR("num",e,t,n))];case"Multinomial":var i=PR("logits",e,t,n),o=PR("numSamples",e,t,n),s=PR("seed",e,t,n);return[VI(i,o,s)];case"OneHot":var u=PR("indices",e,t,n),c=PR("depth",e,t,n),l=PR("onValue",e,t,n),h=PR("offValue",e,t,n);return[dA(u,c,l,h)];case"Ones":return[M_(PR("shape",e,t,n),PR("dtype",e,t,n))];case"OnesLike":return[B_(PR("x",e,t,n))];case"RandomUniform":return[nT(PR("shape",e,t,n),PR("minval",e,t,n),PR("maxval",e,t,n),PR("dtype",e,t,n))];case"Range":return[L_(PR("start",e,t,n),PR("stop",e,t,n),PR("step",e,t,n),PR("dtype",e,t,n))];case"TruncatedNormal":var f=PR("shape",e,t,n),d=PR("mean",e,t,n),p=PR("stdDev",e,t,n),v=PR("seed",e,t,n);return[uT(f,d,p,PR("dtype",e,t,n),v)];case"Zeros":return[P_(PR("shape",e,t,n),PR("dtype",e,t,n))];case"ZerosLike":return[V_(PR("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a,i,o,s,u,c,l,h,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV3"===e.t0?3:"NonMaxSuppressionV2"===e.t0?3:"Where"===e.t0?14:"ListDiff"===e.t0?20:21;break;case 3:if(a=PR("boxes",t,n,r),i=PR("scores",t,n,r),o=PR("maxOutputSize",t,n,r),s=PR("iouThreshold",t,n,r),u=PR("scoreThreshold",t,n,r),"NonMaxSuppressionV5"!==t.op){e.next=10;break}return c=PR("softNmsSigma",t,n,r),e.next=8,b.nonMaxSuppressionWithScoreAsync(a,i,o,s,u,c);case 8:return l=e.sent,e.abrupt("return",[l.selectedIndices,l.selectedScores]);case 10:return e.next=12,b.nonMaxSuppressionAsync(a,i,o,s,u);case 12:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 14:return h=PR("condition",t,n,r).asType("bool"),e.next=17,wx(h);case 17:return e.t2=e.sent,f=[e.t2],e.abrupt("return",(h.dispose(),f));case 20:return e.abrupt("return",Y_(PR("x",t,n,r),PR("y",t,n,r)));case 21:throw TypeError("Node type ".concat(t.op," is not implemented"));case 22:case"end":return e.stop()}}),e)}))),function(e,t,n){return i.apply(this,arguments)})(e,t,n);case"evaluation":return HA((function(){return function(e,t,n){switch(e.op){case"TopKV2":var r=PR("x",e,t,n),a=PR("k",e,t,n),i=PR("sorted",e,t,n),o=qT(r,a,i);return[o.values,o.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return HA((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=PR("images",e,t,n),a=PR("size",e,t,n),i=PR("alignCorners",e,t,n);return[b.resizeBilinear(r,[a[0],a[1]],i)];case"ResizeNearestNeighbor":var o=PR("images",e,t,n),s=PR("size",e,t,n),u=PR("alignCorners",e,t,n);return[b.resizeNearestNeighbor(o,[s[0],s[1]],u)];case"CropAndResize":var c=PR("image",e,t,n),l=PR("boxes",e,t,n),h=PR("boxInd",e,t,n),f=PR("cropSize",e,t,n),d=PR("method",e,t,n),p=PR("extrapolationValue",e,t,n);return[b.cropAndResize(c,l,h,f,d,p)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return HA((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=PR("default",e,t,n);return[zR(e.name,t,n)||r];case"Placeholder":return[zR(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":return[PR("x",e,t,n).clone()];case"IdentityN":return PR("x",e,t,n).map((function(e){return e.clone()}));case"Snapshot":return[PR("x",e,t,n).clone()];case"Shape":return[T_(PR("x",e,t,n).shape,"int32")];case"ShapeN":return PR("x",e,t,n).map((function(e){return T_(e.shape)}));case"Size":return[I_(PR("x",e,t,n).size,"int32")];case"Rank":return[I_(PR("x",e,t,n).rank,"int32")];case"NoOp":return[I_(1)];case"Print":var a=PR("x",e,t,n),i=PR("data",e,t,n),o=PR("message",e,t,n),s=PR("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return HA((function(){return function(e,t,n){switch(e.op){case"Equal":return[TI(PR("a",e,t,n),PR("b",e,t,n))];case"NotEqual":return[WI(PR("a",e,t,n),PR("b",e,t,n))];case"Greater":return[cx(PR("a",e,t,n),PR("b",e,t,n))];case"GreaterEqual":return[nx(PR("a",e,t,n),PR("b",e,t,n))];case"Less":return[rx(PR("a",e,t,n),PR("b",e,t,n))];case"LessEqual":return[lx(PR("a",e,t,n),PR("b",e,t,n))];case"LogicalAnd":return[gx(PR("a",e,t,n),PR("b",e,t,n))];case"LogicalNot":return[yx(PR("a",e,t,n))];case"LogicalOr":return[bx(PR("a",e,t,n),PR("b",e,t,n))];case"Select":case"SelectV2":return[_x(PR("condition",e,t,n),PR("a",e,t,n),PR("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return HA((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[xC(PR("a",e,t,n),PR("b",e,t,n),PR("transposeA",e,t,n),PR("transposeB",e,t,n))];case"Transpose":return[BC(PR("x",e,t,n),PR("perm",e,t,n))];case"_FusedMatMul":var r=_slicedToArray(PR("fusedOps",e,t,n),2),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u=PR("numArgs",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=_slicedToArray(PR("args",e,t,n),2),l=c[0],h=c[1];return[k.matMul({a:PR("a",e,t,n),b:PR("b",e,t,n),transposeA:PR("transposeA",e,t,n),transposeB:PR("transposeB",e,t,n),bias:l,activation:i,preluActivationWeights:h})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return HA((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[uI(PR("x",e,t,n),PR("mean",e,t,n),PR("variance",e,t,n),PR("offset",e,t,n),PR("scale",e,t,n),PR("epsilon",e,t,n))];case"LRN":return[DI(PR("x",e,t,n),PR("radius",e,t,n),PR("bias",e,t,n),PR("alpha",e,t,n),PR("beta",e,t,n))];case"Softmax":return[BT(PR("x",e,t,n))];case"LogSoftmax":return[VT(PR("x",e,t,n))];case"SparseToDense":return[JT(PR("sparseIndices",e,t,n),PR("outputShape",e,t,n),PR("sparseValues",e,t,n),PR("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return HA((function(){return function(e,t,n){switch(e.op){case"Max":var r=PR("axis",e,t,n),a=PR("keepDims",e,t,n);return[FI(PR("x",e,t,n),r,a)];case"Mean":var i=PR("axis",e,t,n),o=PR("keepDims",e,t,n);return[_w(PR("x",e,t,n),i,o)];case"Min":var s=PR("axis",e,t,n),u=PR("keepDims",e,t,n);return[ww(PR("x",e,t,n),s,u)];case"Sum":var c=PR("axis",e,t,n),l=PR("keepDims",e,t,n);return[xw(PR("x",e,t,n),c,l)];case"All":var h=PR("axis",e,t,n),f=PR("keepDims",e,t,n);return[mw(PR("x",e,t,n),h,f)];case"Any":var d=PR("axis",e,t,n),p=PR("keepDims",e,t,n);return[gw(PR("x",e,t,n),d,p)];case"ArgMax":var v=PR("axis",e,t,n);return[yw(PR("x",e,t,n),v)];case"ArgMin":var m=PR("axis",e,t,n);return[bw(PR("x",e,t,n),m)];case"Prod":var g=PR("axis",e,t,n),y=PR("keepDims",e,t,n);return[Sw(PR("x",e,t,n),g,y)];case"Cumsum":var b=PR("axis",e,t,n),k=PR("exclusive",e,t,n),_=PR("reverse",e,t,n);return[VC(PR("x",e,t,n),b,k,_)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return HA((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var a=PR("n",e,t,n),i=PR("axis",e,t,n),o=PR("tensors",e,t,n);return o=o.slice(0,a),[W_(o,i)];case"GatherV2":case"Gather":var s=PR("axis",e,t,n),u=PR("x",e,t,n),c=PR("indices",e,t,n);return[mT(u,c.asType("int32"),s)];case"ReverseV2":case"Reverse":var l=PR("axis",e,t,n),h=PR("x",e,t,n);return[bT(h,l)];case"Slice":var f=PR("begin",e,t,n),d=PR("size",e,t,n);return[Yx(PR("x",e,t,n),f,d)];case"StridedSlice":var p=PR("begin",e,t,n),v=PR("end",e,t,n),m=PR("strides",e,t,n),g=PR("beginMask",e,t,n),y=PR("endMask",e,t,n),b=PR("ellipsisMask",e,t,n),k=PR("newAxisMask",e,t,n),_=PR("shrinkAxisMask",e,t,n),w=PR("x",e,t,n);if(1===p.length&&w.shape.length>1)for(var C=1;C<w.shape.length;C++)p.push(0),v.push(w.shape[C]),m.push(m[0]);return[GT(w,p,v,m,g,y,b,k,_)];case"Pack":return HA((function(){var a=PR("axis",e,t,n),i=PR("tensors",e,t,n),o=i[0].shape,s=i[0].squeeze().shape,u=i.map((function(e){var t=r.arraysEqual(e.shape,o);if(!t&&!r.arraysEqual(e.squeeze().shape,s))throw new Error("the input tensors shape does not match");return t?e:e.reshape(o)}));return[X_(u,a)]}));case"Unpack":return HA((function(){var r=PR("axis",e,t,n),a=PR("tensor",e,t,n);return Z_(a,r)}));case"Tile":var x=PR("reps",e,t,n);return[ZC(PR("x",e,t,n),x)];case"Split":case"SplitV":var S=PR("axis",e,t,n),A=PR("numOrSizeSplits",e,t,n);return EC(PR("x",e,t,n),A,S);case"ScatterNd":var I=PR("indices",e,t,n),T=PR("values",e,t,n),E=PR("shape",e,t,n);return[KT(I,T,E)];case"GatherNd":var R=PR("x",e,t,n),N=PR("indices",e,t,n);return[QT(R,N)];case"SparseToDense":var O=PR("sparseIndices",e,t,n),D=PR("outputShape",e,t,n),F=PR("sparseValues",e,t,n),M=PR("defaultValue",e,t,n);return[JT(O,F,D,F.dtype===M.dtype?M:M.asType(F.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return HA((function(){return function(e,t,n){switch(e.op){case"FFT":return[XT(PR("x",e,t,n))];case"IFFT":return[ZT(PR("x",e,t,n))];case"RFFT":return[YT(PR("x",e,t,n))];case"IRFFT":return[$T(PR("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return HA((function(){return function(e,t,n){switch(e.op){case"Cast":return[H_(PR("x",e,t,n),PR("dtype",e,t,n))];case"ExpandDims":var r=PR("axis",e,t,n);return[G_(PR("x",e,t,n),r)];case"Squeeze":var a=PR("axis",e,t,n);return[K_(PR("x",e,t,n),a)];case"Reshape":return[q_(PR("x",e,t,n),PR("shape",e,t,n))];case"PadV2":case"Pad":return[zx(PR("x",e,t,n),WR(PR("padding",e,t,n),2),PR("constantValue",e,t,n))];case"SpaceToBatchND":var i=PR("blockShape",e,t,n),o=WR(PR("paddings",e,t,n),2);return[AC(PR("x",e,t,n),i,o)];case"BatchToSpaceND":var s=PR("blockShape",e,t,n),u=WR(PR("crops",e,t,n),2);return[Nx(PR("x",e,t,n),s,u)];case"DepthToSpace":var c=PR("blockSize",e,t,n),l=PR("dataFormat",e,t,n).toUpperCase();return[wI(PR("x",e,t,n),c,l)];case"BroadcastTo":return[dI(PR("x",e,t,n),PR("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"custom":var a=MR(e.op);if(a&&a.customExecutor)return a.customExecutor(new yN(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}var i,o}(e,t,n);return a instanceof Promise?a.then((function(e){return[].concat(e)})):[].concat(a)}kN.nextId=0;var wN=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,e),this.weightMap=t,this.tensorArrayMap=n,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return _createClass(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"currentContext",set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},get:function(){return this.contexts}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}}]),e}();function CN(e,t,n){for(var r=new Set,a=[],i=null,o=null,s=new Set,u=Object.keys(e).map((function(e){return VR(e)[0]})),c=_toConsumableArray(t);c.length>0;){var l=c.pop();(AN(l)||IN(l))&&null==i&&(o=(i=l).children.map((function(e){return e.name})).filter((function(e){return r.has(e)}))),r.add(l.name),null==n[l.name]&&-1===u.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(e){s.has(e.name)||(s.add(e.name),c.push(e))})):a.push(l.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}var xN=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile"],SN=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function AN(e){return xN.indexOf(e.op)>=0}function IN(e){return SN.indexOf(e.op)>=0}var TN=function(){function e(t,n){var r=this;_classCallCheck(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}var t,n,a;return _createClass(e,[{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=CN(e,t,this.weightMap),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[];Object.keys(a).map((function(e){return VR(e)[0]})).map((function(t){return e.nodes[t]})).forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var o=new Set,s=[];i.length>0;){var u=i.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach((function(e){!o.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return o.has(e.name)}))&&i.push(e)}))}return s}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[VR(e)[0]]})),i=t.map((function(e){return n.graph.nodes[VR(e)[0]]})),o=this.getCompilationKey(a,i),s=this.compiledMap.get(o);null==s&&(s=this.compile(e,i),this.compiledMap.set(o,s));var u={};return HA((function(){var r=new wN(n.weightMap,u,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=_slicedToArray(VR(t),2),r=n[0],i=[];i[n[1]]=e[t],a[r]=i}));for(var i=n.getFrozenTensorIds(a),o={},c=0;c<s.length;c++){var l=s[c];if(!a[l.name]){var h=_N(l,a,r);if(h instanceof Promise)throw new Error("The execution of the op '".concat(l.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[l.name]=h,n.checkTensorForDisposal(l.name,l,a,r,i,t,o)}}return t.map((function(e){return zR(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[BR(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c=this,l=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n),a=new wN(this.weightMap,{},this.functionExecutorMap),e.next=5,this.executeWithControlFlow(t,a,n,r);case 5:return i=e.sent,o=n.map((function(e){return zR(e,i,a)})),s=new Set(o.map((function(e){return e.id}))),u=new Set(Object.keys(t).map((function(e){return t[e].id}))),e.abrupt("return",(Object.keys(i).forEach((function(e){i[e].forEach((function(e){!e||e.isDisposed||s.has(e.id)||u.has(e.id)||-1!==c.weightIds.indexOf(e.id)||e.dispose()}))})),o));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"executeFunctionAsync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.reduce((function(e,t,n){return e[r.inputs[n].name]=t,e}),{}),e.abrupt("return",this.executeAsync(n,this.outputNodes,!0));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"executeWithControlFlow",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=Object.keys(t),o=i.map((function(e){return _.graph.nodes[VR(e)[0]]})),s=r.map((function(e){return _.graph.nodes[VR(e)[0]]})),u=CN(t,s,this.weightMap),c=u.usedNodes,l=u.missingInputs,h=u.dynamicNode,f=u.syncInputs,d=[].concat(_toConsumableArray(o),_toConsumableArray(this.graph.weights)).map((function(e){return{node:e,contexts:n.currentContext}})),p=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=_slicedToArray(VR(e),2),r=n[0],a=[];a[n[1]]=t[e],p[r]=a})),v={},m=this.getFrozenTensorIds(p),g={};case 3:if(!(d.length>0)){e.next=9;break}return y=this.processStack(o,d,n,p,g,m,r,v,c),e.next=7,Promise.all(y);case 7:e.next=3;break;case 9:if(null!=h||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((b=s.filter((function(e){return!AN(e)&&!zR(e.name,p,n)})).map((function(e){return e.name}))).length>0)){e.next=14;break}throw k="",null!=h&&(k="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(f,"]")),new Error("Cannot compute the outputs [".concat(b,"] from the provided ")+"inputs [".concat(i,"]. Consider providing the following inputs: ")+"[".concat(l,"]. ").concat(k));case 14:return e.abrupt("return",p);case 15:case"end":return e.stop()}}),e,this)}))),function(e,n,r,a){return t.apply(this,arguments)})},{key:"processStack",value:function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],h=function(){var h,f=t.pop();n.currentContext=f.contexts;var d="";if("Enter"===f.node.op&&PR("isConstant",f.node,r,n)&&(h=_slicedToArray(LR(f.node.name,n),1),d=h[0]),-1===e.indexOf(f.node)){var p,v=_N(f.node,r,n);d||(p=_slicedToArray(LR(f.node.name,n),1),d=p[0]);var m=n.currentContext;v instanceof Promise?l.push(v.then((function(e){return r[d]=e,n.currentContext=m,c.checkTensorForDisposal(d,f.node,r,n,i,o,s),c.processChildNodes(f.node,t,n,r,a,u),e}))):(r[d]=v,c.checkTensorForDisposal(d,f.node,r,n,i,o,s),c.processChildNodes(f.node,t,n,r,a,u))}else c.processChildNodes(f.node,t,n,r,a,u)};t.length>0;)h();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=_slicedToArray(LR(e.name,n),1)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!zR(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!zR(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a=e[n],i=_slicedToArray(VR(n),1)[0],o=t.graph.nodes[i];if(o.attrParams.shape&&o.attrParams.shape.value){var s=o.attrParams.shape.value,u=s.length===a.shape.length&&a.shape.every((function(e,t){return-1===s[t]||s[t]===e}));r.assert(u,(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(s,"], but was ")+"[".concat(a.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&r.assert(a.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(a.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=_slicedToArray(VR(e),1)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=_slicedToArray(VR(e),1)[0];if(!t.graph.nodes[n])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}},{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,_toConsumableArray(n)),this._weightMap=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}}]),e}(),EN=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={})}var t,n,r;return _createClass(e,[{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=s.browserHTTPRequest(e,this.loadOptions);else{var t=s.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(s.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=2;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 2:return e.next=4,this.handler.load();case 4:return t=e.sent,e.abrupt("return",this.loadSync(t));case 6:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadSync",value:function(e){this.artifacts=e;var t=this.artifacts.modelTopology,n={};null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version="".concat(t.versions.producer,".").concat(t.versions.minConsumer);var r=s.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);return this.executor=new TN(function(){function e(){var t;_classCallCheck(this,e);var n=(t=[]).concat.apply(t,_toConsumableArray([S,A,I,T,E,R,N,F,D,O,M,P,z,L,B,V].map((function(e){return e.json}))));this.opMappers=n.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return _createClass(e,null,[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),_createClass(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],a=[],i=e.node.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")&&r.push(e[n.name]),"Const"===n.op&&a.push(e[n.name]),e}),{}),o=[],s=[],u={},c={};null!=n&&(u=this.mapSignatureEntries(n.inputs),c=this.mapSignatureEntries(n.outputs));var l=Object.keys(i);l.forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=_slicedToArray(LR(e),1)[0];t.inputs.push(i[n]),i[n].children.push(t)}))})),0===Object.keys(c).length?l.forEach((function(e){var t=i[e];0===t.children.length&&s.push(t)})):Object.keys(c).forEach((function(e){var t=_slicedToArray(LR(e),1)[0],n=i[t];null!=n&&(n.signatureKey=c[e],s.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((function(e){var t=_slicedToArray(LR(e),1)[0],n=i[t];n&&(n.signatureKey=u[e],o.push(n))})):o=r;var h={};return null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{})),{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:n,functions:h}}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=MR(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=iN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=iN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=vN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=vN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=sN(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=sN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=pN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=pN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=oN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=oN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=gN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=gN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=dN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=dN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=mN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=mN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=lN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=lN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=hN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=hN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=cN(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=cN(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var i=[],o=[];e.signature.inputArg.forEach((function(e){var t=_slicedToArray(LR(e.name),1)[0],n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:uN(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,i.push(n),a[t]=n})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e){var n=_slicedToArray(LR(e),1)[0];t.inputs.push(a[n]),a[n].children.push(t)}))}));var s=e.ret;e.signature.outputArg.forEach((function(e){var t=_slicedToArray(LR(s[e.name]),2),n=t[0],r=t[1],i=a[n];null!=i&&(i.defaultOutput=r,o.push(i))}));var u=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:o,weights:r,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}]),e}().Instance.transformGraph(t,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),!0}},{key:"save",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}if(0!==(r=s.getSaveHandlers(t)).length){e.next=4;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 4:if(!(r.length>1)){e.next=6;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 6:t=r[0];case 7:if(null!=t.save){e.next=9;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 9:return e.abrupt("return",t.save(this.artifacts));case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof Ab||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=3,this.executor.executeAsync(t,n);case 3:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 5:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose()}},{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}}]),e}();function RN(e){return NN.apply(this,arguments)}function NN(){return(NN=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t,"model.json?tfjs-format=file")),r=new EN(t,n),e.next=7,r.load();case 7:return e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ON(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function DN(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var FN,MN={0:"tench, Tinca tinca",1:"goldfish, Carassius auratus",2:"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias",3:"tiger shark, Galeocerdo cuvieri",4:"hammerhead, hammerhead shark",5:"electric ray, crampfish, numbfish, torpedo",6:"stingray",7:"cock",8:"hen",9:"ostrich, Struthio camelus",10:"brambling, Fringilla montifringilla",11:"goldfinch, Carduelis carduelis",12:"house finch, linnet, Carpodacus mexicanus",13:"junco, snowbird",14:"indigo bunting, indigo finch, indigo bird, Passerina cyanea",15:"robin, American robin, Turdus migratorius",16:"bulbul",17:"jay",18:"magpie",19:"chickadee",20:"water ouzel, dipper",21:"kite",22:"bald eagle, American eagle, Haliaeetus leucocephalus",23:"vulture",24:"great grey owl, great gray owl, Strix nebulosa",25:"European fire salamander, Salamandra salamandra",26:"common newt, Triturus vulgaris",27:"eft",28:"spotted salamander, Ambystoma maculatum",29:"axolotl, mud puppy, Ambystoma mexicanum",30:"bullfrog, Rana catesbeiana",31:"tree frog, tree-frog",32:"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui",33:"loggerhead, loggerhead turtle, Caretta caretta",34:"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea",35:"mud turtle",36:"terrapin",37:"box turtle, box tortoise",38:"banded gecko",39:"common iguana, iguana, Iguana iguana",40:"American chameleon, anole, Anolis carolinensis",41:"whiptail, whiptail lizard",42:"agama",43:"frilled lizard, Chlamydosaurus kingi",44:"alligator lizard",45:"Gila monster, Heloderma suspectum",46:"green lizard, Lacerta viridis",47:"African chameleon, Chamaeleo chamaeleon",48:"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis",49:"African crocodile, Nile crocodile, Crocodylus niloticus",50:"American alligator, Alligator mississipiensis",51:"triceratops",52:"thunder snake, worm snake, Carphophis amoenus",53:"ringneck snake, ring-necked snake, ring snake",54:"hognose snake, puff adder, sand viper",55:"green snake, grass snake",56:"king snake, kingsnake",57:"garter snake, grass snake",58:"water snake",59:"vine snake",60:"night snake, Hypsiglena torquata",61:"boa constrictor, Constrictor constrictor",62:"rock python, rock snake, Python sebae",63:"Indian cobra, Naja naja",64:"green mamba",65:"sea snake",66:"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus",67:"diamondback, diamondback rattlesnake, Crotalus adamanteus",68:"sidewinder, horned rattlesnake, Crotalus cerastes",69:"trilobite",70:"harvestman, daddy longlegs, Phalangium opilio",71:"scorpion",72:"black and gold garden spider, Argiope aurantia",73:"barn spider, Araneus cavaticus",74:"garden spider, Aranea diademata",75:"black widow, Latrodectus mactans",76:"tarantula",77:"wolf spider, hunting spider",78:"tick",79:"centipede",80:"black grouse",81:"ptarmigan",82:"ruffed grouse, partridge, Bonasa umbellus",83:"prairie chicken, prairie grouse, prairie fowl",84:"peacock",85:"quail",86:"partridge",87:"African grey, African gray, Psittacus erithacus",88:"macaw",89:"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita",90:"lorikeet",91:"coucal",92:"bee eater",93:"hornbill",94:"hummingbird",95:"jacamar",96:"toucan",97:"drake",98:"red-breasted merganser, Mergus serrator",99:"goose",100:"black swan, Cygnus atratus",101:"tusker",102:"echidna, spiny anteater, anteater",103:"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus",104:"wallaby, brush kangaroo",105:"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus",106:"wombat",107:"jelly fish",108:"sea anemone, anemone",109:"brain coral",110:"flatworm, platyhelminth",111:"nematode, nematode worm, roundworm",112:"conch",113:"snail",114:"slug",115:"sea slug, nudibranch",116:"chiton, coat-of-mail shell, sea cradle, polyplacophore",117:"chambered nautilus, pearly nautilus, nautilus",118:"Dungeness crab, Cancer magister",119:"rock crab, Cancer irroratus",120:"fiddler crab",121:"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica",122:"American lobster, Northern lobster, Maine lobster, Homarus americanus",123:"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish",124:"crayfish, crawfish, crawdad, crawdaddy",125:"hermit crab",126:"isopod",127:"white stork, Ciconia ciconia",128:"black stork, Ciconia nigra",129:"spoonbill",130:"flamingo",131:"little blue heron, Egretta caerulea",132:"American egret, great white heron, Egretta albus",133:"bittern",134:"crane",135:"limpkin, Aramus pictus",136:"European gallinule, Porphyrio porphyrio",137:"American coot, marsh hen, mud hen, water hen, Fulica americana",138:"bustard",139:"ruddy turnstone, Arenaria interpres",140:"red-backed sandpiper, dunlin, Erolia alpina",141:"redshank, Tringa totanus",142:"dowitcher",143:"oystercatcher, oyster catcher",144:"pelican",145:"king penguin, Aptenodytes patagonica",146:"albatross, mollymawk",147:"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus",148:"killer whale, killer, orca, grampus, sea wolf, Orcinus orca",149:"dugong, Dugong dugon",150:"sea lion",151:"Chihuahua",152:"Japanese spaniel",153:"Maltese dog, Maltese terrier, Maltese",154:"Pekinese, Pekingese, Peke",155:"Shih-Tzu",156:"Blenheim spaniel",157:"papillon",158:"toy terrier",159:"Rhodesian ridgeback",160:"Afghan hound, Afghan",161:"basset, basset hound",162:"beagle",163:"bloodhound, sleuthhound",164:"bluetick",165:"black-and-tan coonhound",166:"Walker hound, Walker foxhound",167:"English foxhound",168:"redbone",169:"borzoi, Russian wolfhound",170:"Irish wolfhound",171:"Italian greyhound",172:"whippet",173:"Ibizan hound, Ibizan Podenco",174:"Norwegian elkhound, elkhound",175:"otterhound, otter hound",176:"Saluki, gazelle hound",177:"Scottish deerhound, deerhound",178:"Weimaraner",179:"Staffordshire bullterrier, Staffordshire bull terrier",180:"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier",181:"Bedlington terrier",182:"Border terrier",183:"Kerry blue terrier",184:"Irish terrier",185:"Norfolk terrier",186:"Norwich terrier",187:"Yorkshire terrier",188:"wire-haired fox terrier",189:"Lakeland terrier",190:"Sealyham terrier, Sealyham",191:"Airedale, Airedale terrier",192:"cairn, cairn terrier",193:"Australian terrier",194:"Dandie Dinmont, Dandie Dinmont terrier",195:"Boston bull, Boston terrier",196:"miniature schnauzer",197:"giant schnauzer",198:"standard schnauzer",199:"Scotch terrier, Scottish terrier, Scottie",200:"Tibetan terrier, chrysanthemum dog",201:"silky terrier, Sydney silky",202:"soft-coated wheaten terrier",203:"West Highland white terrier",204:"Lhasa, Lhasa apso",205:"flat-coated retriever",206:"curly-coated retriever",207:"golden retriever",208:"Labrador retriever",209:"Chesapeake Bay retriever",210:"German short-haired pointer",211:"vizsla, Hungarian pointer",212:"English setter",213:"Irish setter, red setter",214:"Gordon setter",215:"Brittany spaniel",216:"clumber, clumber spaniel",217:"English springer, English springer spaniel",218:"Welsh springer spaniel",219:"cocker spaniel, English cocker spaniel, cocker",220:"Sussex spaniel",221:"Irish water spaniel",222:"kuvasz",223:"schipperke",224:"groenendael",225:"malinois",226:"briard",227:"kelpie",228:"komondor",229:"Old English sheepdog, bobtail",230:"Shetland sheepdog, Shetland sheep dog, Shetland",231:"collie",232:"Border collie",233:"Bouvier des Flandres, Bouviers des Flandres",234:"Rottweiler",235:"German shepherd, German shepherd dog, German police dog, alsatian",236:"Doberman, Doberman pinscher",237:"miniature pinscher",238:"Greater Swiss Mountain dog",239:"Bernese mountain dog",240:"Appenzeller",241:"EntleBucher",242:"boxer",243:"bull mastiff",244:"Tibetan mastiff",245:"French bulldog",246:"Great Dane",247:"Saint Bernard, St Bernard",248:"Eskimo dog, husky",249:"malamute, malemute, Alaskan malamute",250:"Siberian husky",251:"dalmatian, coach dog, carriage dog",252:"affenpinscher, monkey pinscher, monkey dog",253:"basenji",254:"pug, pug-dog",255:"Leonberg",256:"Newfoundland, Newfoundland dog",257:"Great Pyrenees",258:"Samoyed, Samoyede",259:"Pomeranian",260:"chow, chow chow",261:"keeshond",262:"Brabancon griffon",263:"Pembroke, Pembroke Welsh corgi",264:"Cardigan, Cardigan Welsh corgi",265:"toy poodle",266:"miniature poodle",267:"standard poodle",268:"Mexican hairless",269:"timber wolf, grey wolf, gray wolf, Canis lupus",270:"white wolf, Arctic wolf, Canis lupus tundrarum",271:"red wolf, maned wolf, Canis rufus, Canis niger",272:"coyote, prairie wolf, brush wolf, Canis latrans",273:"dingo, warrigal, warragal, Canis dingo",274:"dhole, Cuon alpinus",275:"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus",276:"hyena, hyaena",277:"red fox, Vulpes vulpes",278:"kit fox, Vulpes macrotis",279:"Arctic fox, white fox, Alopex lagopus",280:"grey fox, gray fox, Urocyon cinereoargenteus",281:"tabby, tabby cat",282:"tiger cat",283:"Persian cat",284:"Siamese cat, Siamese",285:"Egyptian cat",286:"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor",287:"lynx, catamount",288:"leopard, Panthera pardus",289:"snow leopard, ounce, Panthera uncia",290:"jaguar, panther, Panthera onca, Felis onca",291:"lion, king of beasts, Panthera leo",292:"tiger, Panthera tigris",293:"cheetah, chetah, Acinonyx jubatus",294:"brown bear, bruin, Ursus arctos",295:"American black bear, black bear, Ursus americanus, Euarctos americanus",296:"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus",297:"sloth bear, Melursus ursinus, Ursus ursinus",298:"mongoose",299:"meerkat, mierkat",300:"tiger beetle",301:"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle",302:"ground beetle, carabid beetle",303:"long-horned beetle, longicorn, longicorn beetle",304:"leaf beetle, chrysomelid",305:"dung beetle",306:"rhinoceros beetle",307:"weevil",308:"fly",309:"bee",310:"ant, emmet, pismire",311:"grasshopper, hopper",312:"cricket",313:"walking stick, walkingstick, stick insect",314:"cockroach, roach",315:"mantis, mantid",316:"cicada, cicala",317:"leafhopper",318:"lacewing, lacewing fly",319:"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk",320:"damselfly",321:"admiral",322:"ringlet, ringlet butterfly",323:"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus",324:"cabbage butterfly",325:"sulphur butterfly, sulfur butterfly",326:"lycaenid, lycaenid butterfly",327:"starfish, sea star",328:"sea urchin",329:"sea cucumber, holothurian",330:"wood rabbit, cottontail, cottontail rabbit",331:"hare",332:"Angora, Angora rabbit",333:"hamster",334:"porcupine, hedgehog",335:"fox squirrel, eastern fox squirrel, Sciurus niger",336:"marmot",337:"beaver",338:"guinea pig, Cavia cobaya",339:"sorrel",340:"zebra",341:"hog, pig, grunter, squealer, Sus scrofa",342:"wild boar, boar, Sus scrofa",343:"warthog",344:"hippopotamus, hippo, river horse, Hippopotamus amphibius",345:"ox",346:"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis",347:"bison",348:"ram, tup",349:"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis",350:"ibex, Capra ibex",351:"hartebeest",352:"impala, Aepyceros melampus",353:"gazelle",354:"Arabian camel, dromedary, Camelus dromedarius",355:"llama",356:"weasel",357:"mink",358:"polecat, fitch, foulmart, foumart, Mustela putorius",359:"black-footed ferret, ferret, Mustela nigripes",360:"otter",361:"skunk, polecat, wood pussy",362:"badger",363:"armadillo",364:"three-toed sloth, ai, Bradypus tridactylus",365:"orangutan, orang, orangutang, Pongo pygmaeus",366:"gorilla, Gorilla gorilla",367:"chimpanzee, chimp, Pan troglodytes",368:"gibbon, Hylobates lar",369:"siamang, Hylobates syndactylus, Symphalangus syndactylus",370:"guenon, guenon monkey",371:"patas, hussar monkey, Erythrocebus patas",372:"baboon",373:"macaque",374:"langur",375:"colobus, colobus monkey",376:"proboscis monkey, Nasalis larvatus",377:"marmoset",378:"capuchin, ringtail, Cebus capucinus",379:"howler monkey, howler",380:"titi, titi monkey",381:"spider monkey, Ateles geoffroyi",382:"squirrel monkey, Saimiri sciureus",383:"Madagascar cat, ring-tailed lemur, Lemur catta",384:"indri, indris, Indri indri, Indri brevicaudatus",385:"Indian elephant, Elephas maximus",386:"African elephant, Loxodonta africana",387:"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens",388:"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca",389:"barracouta, snoek",390:"eel",391:"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch",392:"rock beauty, Holocanthus tricolor",393:"anemone fish",394:"sturgeon",395:"gar, garfish, garpike, billfish, Lepisosteus osseus",396:"lionfish",397:"puffer, pufferfish, blowfish, globefish",398:"abacus",399:"abaya",400:"academic gown, academic robe, judge's robe",401:"accordion, piano accordion, squeeze box",402:"acoustic guitar",403:"aircraft carrier, carrier, flattop, attack aircraft carrier",404:"airliner",405:"airship, dirigible",406:"altar",407:"ambulance",408:"amphibian, amphibious vehicle",409:"analog clock",410:"apiary, bee house",411:"apron",412:"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin",413:"assault rifle, assault gun",414:"backpack, back pack, knapsack, packsack, rucksack, haversack",415:"bakery, bakeshop, bakehouse",416:"balance beam, beam",417:"balloon",418:"ballpoint, ballpoint pen, ballpen, Biro",419:"Band Aid",420:"banjo",421:"bannister, banister, balustrade, balusters, handrail",422:"barbell",423:"barber chair",424:"barbershop",425:"barn",426:"barometer",427:"barrel, cask",428:"barrow, garden cart, lawn cart, wheelbarrow",429:"baseball",430:"basketball",431:"bassinet",432:"bassoon",433:"bathing cap, swimming cap",434:"bath towel",435:"bathtub, bathing tub, bath, tub",436:"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon",437:"beacon, lighthouse, beacon light, pharos",438:"beaker",439:"bearskin, busby, shako",440:"beer bottle",441:"beer glass",442:"bell cote, bell cot",443:"bib",444:"bicycle-built-for-two, tandem bicycle, tandem",445:"bikini, two-piece",446:"binder, ring-binder",447:"binoculars, field glasses, opera glasses",448:"birdhouse",449:"boathouse",450:"bobsled, bobsleigh, bob",451:"bolo tie, bolo, bola tie, bola",452:"bonnet, poke bonnet",453:"bookcase",454:"bookshop, bookstore, bookstall",455:"bottlecap",456:"bow",457:"bow tie, bow-tie, bowtie",458:"brass, memorial tablet, plaque",459:"brassiere, bra, bandeau",460:"breakwater, groin, groyne, mole, bulwark, seawall, jetty",461:"breastplate, aegis, egis",462:"broom",463:"bucket, pail",464:"buckle",465:"bulletproof vest",466:"bullet train, bullet",467:"butcher shop, meat market",468:"cab, hack, taxi, taxicab",469:"caldron, cauldron",470:"candle, taper, wax light",471:"cannon",472:"canoe",473:"can opener, tin opener",474:"cardigan",475:"car mirror",476:"carousel, carrousel, merry-go-round, roundabout, whirligig",477:"carpenter's kit, tool kit",478:"carton",479:"car wheel",480:"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM",481:"cassette",482:"cassette player",483:"castle",484:"catamaran",485:"CD player",486:"cello, violoncello",487:"cellular telephone, cellular phone, cellphone, cell, mobile phone",488:"chain",489:"chainlink fence",490:"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour",491:"chain saw, chainsaw",492:"chest",493:"chiffonier, commode",494:"chime, bell, gong",495:"china cabinet, china closet",496:"Christmas stocking",497:"church, church building",498:"cinema, movie theater, movie theatre, movie house, picture palace",499:"cleaver, meat cleaver, chopper",500:"cliff dwelling",501:"cloak",502:"clog, geta, patten, sabot",503:"cocktail shaker",504:"coffee mug",505:"coffeepot",506:"coil, spiral, volute, whorl, helix",507:"combination lock",508:"computer keyboard, keypad",509:"confectionery, confectionary, candy store",510:"container ship, containership, container vessel",511:"convertible",512:"corkscrew, bottle screw",513:"cornet, horn, trumpet, trump",514:"cowboy boot",515:"cowboy hat, ten-gallon hat",516:"cradle",517:"crane",518:"crash helmet",519:"crate",520:"crib, cot",521:"Crock Pot",522:"croquet ball",523:"crutch",524:"cuirass",525:"dam, dike, dyke",526:"desk",527:"desktop computer",528:"dial telephone, dial phone",529:"diaper, nappy, napkin",530:"digital clock",531:"digital watch",532:"dining table, board",533:"dishrag, dishcloth",534:"dishwasher, dish washer, dishwashing machine",535:"disk brake, disc brake",536:"dock, dockage, docking facility",537:"dogsled, dog sled, dog sleigh",538:"dome",539:"doormat, welcome mat",540:"drilling platform, offshore rig",541:"drum, membranophone, tympan",542:"drumstick",543:"dumbbell",544:"Dutch oven",545:"electric fan, blower",546:"electric guitar",547:"electric locomotive",548:"entertainment center",549:"envelope",550:"espresso maker",551:"face powder",552:"feather boa, boa",553:"file, file cabinet, filing cabinet",554:"fireboat",555:"fire engine, fire truck",556:"fire screen, fireguard",557:"flagpole, flagstaff",558:"flute, transverse flute",559:"folding chair",560:"football helmet",561:"forklift",562:"fountain",563:"fountain pen",564:"four-poster",565:"freight car",566:"French horn, horn",567:"frying pan, frypan, skillet",568:"fur coat",569:"garbage truck, dustcart",570:"gasmask, respirator, gas helmet",571:"gas pump, gasoline pump, petrol pump, island dispenser",572:"goblet",573:"go-kart",574:"golf ball",575:"golfcart, golf cart",576:"gondola",577:"gong, tam-tam",578:"gown",579:"grand piano, grand",580:"greenhouse, nursery, glasshouse",581:"grille, radiator grille",582:"grocery store, grocery, food market, market",583:"guillotine",584:"hair slide",585:"hair spray",586:"half track",587:"hammer",588:"hamper",589:"hand blower, blow dryer, blow drier, hair dryer, hair drier",590:"hand-held computer, hand-held microcomputer",591:"handkerchief, hankie, hanky, hankey",592:"hard disc, hard disk, fixed disk",593:"harmonica, mouth organ, harp, mouth harp",594:"harp",595:"harvester, reaper",596:"hatchet",597:"holster",598:"home theater, home theatre",599:"honeycomb",600:"hook, claw",601:"hoopskirt, crinoline",602:"horizontal bar, high bar",603:"horse cart, horse-cart",604:"hourglass",605:"iPod",606:"iron, smoothing iron",607:"jack-o'-lantern",608:"jean, blue jean, denim",609:"jeep, landrover",610:"jersey, T-shirt, tee shirt",611:"jigsaw puzzle",612:"jinrikisha, ricksha, rickshaw",613:"joystick",614:"kimono",615:"knee pad",616:"knot",617:"lab coat, laboratory coat",618:"ladle",619:"lampshade, lamp shade",620:"laptop, laptop computer",621:"lawn mower, mower",622:"lens cap, lens cover",623:"letter opener, paper knife, paperknife",624:"library",625:"lifeboat",626:"lighter, light, igniter, ignitor",627:"limousine, limo",628:"liner, ocean liner",629:"lipstick, lip rouge",630:"Loafer",631:"lotion",632:"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system",633:"loupe, jeweler's loupe",634:"lumbermill, sawmill",635:"magnetic compass",636:"mailbag, postbag",637:"mailbox, letter box",638:"maillot",639:"maillot, tank suit",640:"manhole cover",641:"maraca",642:"marimba, xylophone",643:"mask",644:"matchstick",645:"maypole",646:"maze, labyrinth",647:"measuring cup",648:"medicine chest, medicine cabinet",649:"megalith, megalithic structure",650:"microphone, mike",651:"microwave, microwave oven",652:"military uniform",653:"milk can",654:"minibus",655:"miniskirt, mini",656:"minivan",657:"missile",658:"mitten",659:"mixing bowl",660:"mobile home, manufactured home",661:"Model T",662:"modem",663:"monastery",664:"monitor",665:"moped",666:"mortar",667:"mortarboard",668:"mosque",669:"mosquito net",670:"motor scooter, scooter",671:"mountain bike, all-terrain bike, off-roader",672:"mountain tent",673:"mouse, computer mouse",674:"mousetrap",675:"moving van",676:"muzzle",677:"nail",678:"neck brace",679:"necklace",680:"nipple",681:"notebook, notebook computer",682:"obelisk",683:"oboe, hautboy, hautbois",684:"ocarina, sweet potato",685:"odometer, hodometer, mileometer, milometer",686:"oil filter",687:"organ, pipe organ",688:"oscilloscope, scope, cathode-ray oscilloscope, CRO",689:"overskirt",690:"oxcart",691:"oxygen mask",692:"packet",693:"paddle, boat paddle",694:"paddlewheel, paddle wheel",695:"padlock",696:"paintbrush",697:"pajama, pyjama, pj's, jammies",698:"palace",699:"panpipe, pandean pipe, syrinx",700:"paper towel",701:"parachute, chute",702:"parallel bars, bars",703:"park bench",704:"parking meter",705:"passenger car, coach, carriage",706:"patio, terrace",707:"pay-phone, pay-station",708:"pedestal, plinth, footstall",709:"pencil box, pencil case",710:"pencil sharpener",711:"perfume, essence",712:"Petri dish",713:"photocopier",714:"pick, plectrum, plectron",715:"pickelhaube",716:"picket fence, paling",717:"pickup, pickup truck",718:"pier",719:"piggy bank, penny bank",720:"pill bottle",721:"pillow",722:"ping-pong ball",723:"pinwheel",724:"pirate, pirate ship",725:"pitcher, ewer",726:"plane, carpenter's plane, woodworking plane",727:"planetarium",728:"plastic bag",729:"plate rack",730:"plow, plough",731:"plunger, plumber's helper",732:"Polaroid camera, Polaroid Land camera",733:"pole",734:"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria",735:"poncho",736:"pool table, billiard table, snooker table",737:"pop bottle, soda bottle",738:"pot, flowerpot",739:"potter's wheel",740:"power drill",741:"prayer rug, prayer mat",742:"printer",743:"prison, prison house",744:"projectile, missile",745:"projector",746:"puck, hockey puck",747:"punching bag, punch bag, punching ball, punchball",748:"purse",749:"quill, quill pen",750:"quilt, comforter, comfort, puff",751:"racer, race car, racing car",752:"racket, racquet",753:"radiator",754:"radio, wireless",755:"radio telescope, radio reflector",756:"rain barrel",757:"recreational vehicle, RV, R.V.",758:"reel",759:"reflex camera",760:"refrigerator, icebox",761:"remote control, remote",762:"restaurant, eating house, eating place, eatery",763:"revolver, six-gun, six-shooter",764:"rifle",765:"rocking chair, rocker",766:"rotisserie",767:"rubber eraser, rubber, pencil eraser",768:"rugby ball",769:"rule, ruler",770:"running shoe",771:"safe",772:"safety pin",773:"saltshaker, salt shaker",774:"sandal",775:"sarong",776:"sax, saxophone",777:"scabbard",778:"scale, weighing machine",779:"school bus",780:"schooner",781:"scoreboard",782:"screen, CRT screen",783:"screw",784:"screwdriver",785:"seat belt, seatbelt",786:"sewing machine",787:"shield, buckler",788:"shoe shop, shoe-shop, shoe store",789:"shoji",790:"shopping basket",791:"shopping cart",792:"shovel",793:"shower cap",794:"shower curtain",795:"ski",796:"ski mask",797:"sleeping bag",798:"slide rule, slipstick",799:"sliding door",800:"slot, one-armed bandit",801:"snorkel",802:"snowmobile",803:"snowplow, snowplough",804:"soap dispenser",805:"soccer ball",806:"sock",807:"solar dish, solar collector, solar furnace",808:"sombrero",809:"soup bowl",810:"space bar",811:"space heater",812:"space shuttle",813:"spatula",814:"speedboat",815:"spider web, spider's web",816:"spindle",817:"sports car, sport car",818:"spotlight, spot",819:"stage",820:"steam locomotive",821:"steel arch bridge",822:"steel drum",823:"stethoscope",824:"stole",825:"stone wall",826:"stopwatch, stop watch",827:"stove",828:"strainer",829:"streetcar, tram, tramcar, trolley, trolley car",830:"stretcher",831:"studio couch, day bed",832:"stupa, tope",833:"submarine, pigboat, sub, U-boat",834:"suit, suit of clothes",835:"sundial",836:"sunglass",837:"sunglasses, dark glasses, shades",838:"sunscreen, sunblock, sun blocker",839:"suspension bridge",840:"swab, swob, mop",841:"sweatshirt",842:"swimming trunks, bathing trunks",843:"swing",844:"switch, electric switch, electrical switch",845:"syringe",846:"table lamp",847:"tank, army tank, armored combat vehicle, armoured combat vehicle",848:"tape player",849:"teapot",850:"teddy, teddy bear",851:"television, television system",852:"tennis ball",853:"thatch, thatched roof",854:"theater curtain, theatre curtain",855:"thimble",856:"thresher, thrasher, threshing machine",857:"throne",858:"tile roof",859:"toaster",860:"tobacco shop, tobacconist shop, tobacconist",861:"toilet seat",862:"torch",863:"totem pole",864:"tow truck, tow car, wrecker",865:"toyshop",866:"tractor",867:"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi",868:"tray",869:"trench coat",870:"tricycle, trike, velocipede",871:"trimaran",872:"tripod",873:"triumphal arch",874:"trolleybus, trolley coach, trackless trolley",875:"trombone",876:"tub, vat",877:"turnstile",878:"typewriter keyboard",879:"umbrella",880:"unicycle, monocycle",881:"upright, upright piano",882:"vacuum, vacuum cleaner",883:"vase",884:"vault",885:"velvet",886:"vending machine",887:"vestment",888:"viaduct",889:"violin, fiddle",890:"volleyball",891:"waffle iron",892:"wall clock",893:"wallet, billfold, notecase, pocketbook",894:"wardrobe, closet, press",895:"warplane, military plane",896:"washbasin, handbasin, washbowl, lavabo, wash-hand basin",897:"washer, automatic washer, washing machine",898:"water bottle",899:"water jug",900:"water tower",901:"whiskey jug",902:"whistle",903:"wig",904:"window screen",905:"window shade",906:"Windsor tie",907:"wine bottle",908:"wing",909:"wok",910:"wooden spoon",911:"wool, woolen, woollen",912:"worm fence, snake fence, snake-rail fence, Virginia fence",913:"wreck",914:"yawl",915:"yurt",916:"web site, website, internet site, site",917:"comic book",918:"crossword puzzle, crossword",919:"street sign",920:"traffic light, traffic signal, stoplight",921:"book jacket, dust cover, dust jacket, dust wrapper",922:"menu",923:"plate",924:"guacamole",925:"consomme",926:"hot pot, hotpot",927:"trifle",928:"ice cream, icecream",929:"ice lolly, lolly, lollipop, popsicle",930:"French loaf",931:"bagel, beigel",932:"pretzel",933:"cheeseburger",934:"hotdog, hot dog, red hot",935:"mashed potato",936:"head cabbage",937:"broccoli",938:"cauliflower",939:"zucchini, courgette",940:"spaghetti squash",941:"acorn squash",942:"butternut squash",943:"cucumber, cuke",944:"artichoke, globe artichoke",945:"bell pepper",946:"cardoon",947:"mushroom",948:"Granny Smith",949:"strawberry",950:"orange",951:"lemon",952:"fig",953:"pineapple, ananas",954:"banana",955:"jackfruit, jak, jack",956:"custard apple",957:"pomegranate",958:"hay",959:"carbonara",960:"chocolate sauce, chocolate syrup",961:"dough",962:"meat loaf, meatloaf",963:"pizza, pizza pie",964:"potpie",965:"burrito",966:"red wine",967:"espresso",968:"cup",969:"eggnog",970:"alp",971:"bubble",972:"cliff, drop, drop-off",973:"coral reef",974:"geyser",975:"lakeside, lakeshore",976:"promontory, headland, head, foreland",977:"sandbar, sand bar",978:"seashore, coast, seacoast, sea-coast",979:"valley, vale",980:"volcano",981:"ballplayer, baseball player",982:"groom, bridegroom",983:"scuba diver",984:"rapeseed",985:"daisy",986:"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum",987:"corn",988:"acorn",989:"hip, rose hip, rosehip",990:"buckeye, horse chestnut, conker",991:"coral fungus",992:"agaric",993:"gyromitra",994:"stinkhorn, carrion fungus",995:"earthstar",996:"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa",997:"bolete",998:"ear, spike, capitulum",999:"toilet tissue, toilet paper, bathroom tissue"},PN={"1.00":"module_apply_default/MobilenetV1/Logits/global_pool","2.00":"module_apply_default/MobilenetV2/Logits/AvgPool"},zN={"1.00":{.25:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_025_224/classification/1",inputRange:[0,1]},"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_050_224/classification/1",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_075_224/classification/1",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v1_100_224/classification/1",inputRange:[0,1]}},"2.00":{"0.50":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_050_224/classification/2",inputRange:[0,1]},.75:{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_075_224/classification/2",inputRange:[0,1]},"1.00":{url:"https://tfhub.dev/google/imagenet/mobilenet_v2_100_224/classification/2",inputRange:[0,1]}}},LN=function(){function e(e,t,n,r,a){void 0===r&&(r=-1),void 0===a&&(a=1),this.version=e,this.alpha=t,this.modelUrl=n,this.inputMin=r,this.inputMax=a,this.normalizationConstant=(a-r)/255}return e.prototype.load=function(){return ON(this,void 0,void 0,(function(){var e,t,n,r=this;return DN(this,(function(a){switch(a.label){case 0:return this.modelUrl?(e=this,[4,RN(this.modelUrl)]):[3,2];case 1:return e.model=a.sent(),[3,4];case 2:return t=this,[4,RN(zN[this.version][this.alpha].url,{fromTFHub:!0})];case 3:t.model=a.sent(),a.label=4;case 4:return[4,(n=HA((function(){return r.model.predict(P_([1,224,224,3]))}))).data()];case 5:return a.sent(),n.dispose(),[2]}}))}))},e.prototype.infer=function(e,t){var n=this;return void 0===t&&(t=!1),HA((function(){e instanceof Ab||(e=c.fromPixels(e));var r=e.toFloat().mul(n.normalizationConstant).add(n.inputMin),a=r;224===e.shape[0]&&224===e.shape[1]||(a=b.resizeBilinear(r,[224,224],!0));var i=a.reshape([-1,224,224,3]);return t?n.model.execute(i,PN[n.version]).squeeze([1,2]):n.model.predict(i).slice([0,1],[-1,1e3])}))},e.prototype.classify=function(e,t){return void 0===t&&(t=3),ON(this,void 0,void 0,(function(){var n,r;return DN(this,(function(a){switch(a.label){case 0:return[4,BN(n=this.infer(e),t)];case 1:return r=a.sent(),n.dispose(),[2,r]}}))}))},e}();function BN(e,t){return ON(this,void 0,void 0,(function(){var n,r,a,i,o,s,u;return DN(this,(function(c){switch(c.label){case 0:return[4,(n=e.softmax()).data()];case 1:for(r=c.sent(),n.dispose(),a=[],u=0;u<r.length;u++)a.push({value:r[u],index:u});for(a.sort((function(e,t){return t.value-e.value})),i=new Float32Array(t),o=new Int32Array(t),u=0;u<t;u++)i[u]=a[u].value,o[u]=a[u].index;for(s=[],u=0;u<o.length;u++)s.push({className:MN[o[u]],probability:i[u]});return[2,s]}}))}))}function VN(){return null==FN&&(FN=tI().epsilon()),FN}var WN=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),UN=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),jN=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),HN=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}(),GN=function(e){_inherits(n,_wrapNativeSuper(Error));var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,e),Object.setPrototypeOf(_assertThisInitialized(r),n.prototype),r}return n}();function qN(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function KN(e,t){if(!e)throw new GN(t)}function XN(e,t){var n,r=0,a=_createForOfIteratorHelper(e);try{for(a.s();!(n=a.n()).done;){n.value===t&&r++}}catch(AU){a.e(AU)}finally{a.f()}return r}function ZN(e){return 1===e.length?e[0]:e}function YN(e){return Array.isArray(e)?e:[e]}function $N(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function JN(e){return e.length<=1?e:-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}Error;var QN={};function eO(e){if(null==e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function tO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){var i,o=e;if(o in n)i=n[o];else if(o in QN)i=QN[o];else if(null==(i=t[o]))throw new jN("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var s,u,c,l=e;if(null==l.className||null==l.config)throw new jN("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(l),".\n")+"'className' and 'config' must set.");var h,f,d=l.className;if(d in n?(h=(s=_slicedToArray(n[d],2))[0],f=s[1]):d in QN?(h=(u=_slicedToArray(QN.className,2))[0],f=u[1]):d in t&&(h=(c=_slicedToArray(t[d],2))[0],f=c[1]),null==h)throw new jN("Unknown ".concat(r,": ").concat(d,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=f){for(var p={},v=0,m=Object.keys(QN);v<m.length;v++){var g=m[v];p[g]=QN[g]}for(var y=0,b=Object.keys(n);y<b.length;y++){var k=b[y];p[k]=n[k]}l.config.customObjects=p;for(var _=Object.assign({},QN),w=0,C=Object.keys(n);w<C.length;w++){var x=C[w];QN[x]=n[x]}!function e(t){if(null!=t&&"object"==typeof t)if(Array.isArray(t))t.forEach((function(t){return e(t)}));else for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n],i=t[a];null!=i&&"object"==typeof i&&(Array.isArray(i)||"ndarray"!==i.type||"number"!=typeof i.value?e(i):t[a]=i.value)}}(l.config);var S=f(h,l.config,n,a);return QN=Object.assign({},_),S}for(var A=Object.assign({},QN),I=0,T=Object.keys(n);I<T.length;I++){var E=T[I];QN[E]=n[E]}var R=new h(l.config);return QN=Object.assign({},A),R}function nO(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function rO(e){if(null==e)return e;var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;-1===n.indexOf(a)&&n.push(a)}}catch(AU){r.e(AU)}finally{r.f()}return n}function aO(e){if(null==e)throw new jN("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function iO(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new jN("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function oO(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return KN(n>=0),KN(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return typeof e===t}))}function sO(e,t){Array.isArray(e)?(r.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return sO(e,"element ".concat(n+1," of ").concat(t))}))):r.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(function e(t){return null===t?"null":Array.isArray(t)?"["+t.map((function(t){return e(t)})).join(",")+"]":"string"==typeof t?'"'.concat(t,'"'):"".concat(t)}(e),".")}))}function uO(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function cO(e,t){return HA((function(){return rC(xw(Q_(e,e),t,!0))}))}var lO=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(f.Serializable),hO=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return HA((function(){var n=cO(e,t.axis),r=Mw(n,0,t.maxValue);return Q_(e,J_(r,b_(VN(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(lO);hO.className="MaxNorm",f.registerClass(hO);var fO=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return HA((function(){return J_(e,b_(VN(),cO(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(lO);fO.className="UnitNorm",f.registerClass(fO);var dO=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rT(e)}}]),n}(lO);dO.className="NonNeg",f.registerClass(dO);var pO=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return HA((function(){var n=cO(e,t.axis),r=b_(Q_(t.rate,Mw(n,t.minValue,t.maxValue)),Q_(1-t.rate,n));return Q_(e,J_(r,b_(VN(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(lO);pO.className="MinMaxNorm",f.registerClass(pO);var vO={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function mO(e){return eO(e)}function gO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tO(e,f.SerializationMap.getMap().classNameMap,t,"constraint")}function yO(e){return null==e?null:"string"==typeof e?gO({className:e in vO?vO[e]:e,config:{}}):e instanceof lO?e:gO(e)}var bO=["channelsFirst","channelsLast"],kO=["valid","same","causal"],_O=["max","avg"],wO=["sum","mul","concat","ave"],CO=new Map;function xO(e){iO(bO,"DataFormat",e)}function SO(e){iO(kO,"PaddingMode",e)}function AO(e){iO(_O,"PoolMode",e)}var IO=[];function TO(e,t){IO.push(e);try{var n=t();return IO.pop(),n}catch(r){throw IO.pop(),r}}function EO(e){if(!OO(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===IO.length?"":IO.join("/")+"/")+e}function RO(e){if(!OO(e))throw new Error("Not a valid tensor name: '"+e+"'");CO.has(e)||CO.set(e,0);var t=CO.get(e);if(CO.set(e,CO.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return CO.set(n,1),n}return e}var NO=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function OO(e){return!!e.match(NO)}function DO(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function FO(e){return T_(e=Array.isArray(e)?new Float32Array(e):e)}function MO(e){return ww(FO(e)).dataSync()[0]}function PO(e){return FI(FO(e)).dataSync()[0]}function zO(e,t){if(t<e)throw new jN("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function LO(e,t){return e.asType(t)}function BO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function VO(e,t,n){return HA((function(){switch(e.rank){case 1:return $x(e,t,n);case 2:return Jx(e,[t,0],[n,e.shape[1]]);case 3:return Qx(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return eS(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Yx(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Yx(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new jN("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function WO(e,t,n){return HA((function(){switch(e.rank){case 1:return $x(e,t,n);case 2:return Jx(e,[0,t],[e.shape[0],n]);case 3:return Qx(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return eS(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new jN("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function UO(e,t,n,r){return HA((function(){switch(e.rank){case 1:return $x(e,t,n);case 2:switch(r){case 1:return VO(e,t,n);case 2:return WO(e,t,n);default:throw new jN("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return VO(e,t,n);case 2:return Qx(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return WO(e,t,n);default:throw new jN("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return VO(e,t,n);case 2:return eS(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return eS(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return WO(e,t,n);default:throw new jN("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new jN("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function jO(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),W_(e,n)}function HO(e,t){switch(e.rank){case 1:return pI([e,t]);case 2:return vI([e,t],0);case 3:return mI([e,t],0);case 4:return gI([e,t],0);default:throw new jN("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function GO(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new jN("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return ZC(e,t)}function qO(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return tT(e,t,n,r,a)}function KO(e,t,n,r){if(e.rank<2||t.rank<2)throw new HN("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new HN("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank)return k.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YO(e.rank,r,"channelsLast"):null,activation:n});var a=e.shape.slice(),i=a.pop();e=e.reshape([-1,i]);var o=t.shape.slice(),s=o.pop(),u=o.pop(),c=[].concat(_toConsumableArray(o),[s]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(l).reshape([u,-1]);var h=[].concat(_toConsumableArray(a),_toConsumableArray(c));return k.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?YO(e.rank,r,"channelsLast"):null,activation:n}).reshape(h)}function XO(e,t,n){return HA((function(){return t=Array.isArray(t)?T_(t,"int32"):t.toInt(),mT(e,t,n)}))}function ZO(e){return Q_(e,e)}function YO(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new jN("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1,1,1]:[1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,1,1,r[0]]:[1].concat(r))}else if(4===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1,1]:[1,r[2],r[0],r[1]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,1,r[0]]:[1].concat(r))}else if(3===e){if("channelsFirst"===n)return t.reshape(1===r.length?[1,r[0],1]:[1,r[1],r[0]]);if("channelsLast"===n)return t.reshape(1===r.length?[1,1,r[0]]:[1].concat(r))}else if(e<3)return t;throw new jN("Unsupported input rank by biasAdd: ".concat(t.rank))}function $O(e,t,n){return HA((function(){return null==n&&(n="channelsLast"),xO(n),e.add(YO(e.rank,t,n))}))}function JO(e,t,n,r){return HA((function(){return eE(e,t,n,r)}))}function QO(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var eD=["fanIn","fanOut","fanAvg"],tD=["normal","uniform","truncatedNormal"],nD=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(f.Serializable),rD=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){return P_(e,t)}}]),n}(nD);rD.className="Zeros",f.registerClass(rD);var aD=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){return M_(e,t)}}]),n}(nD);aD.className="Ones",f.registerClass(aD);var iD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this),"object"!=typeof e)throw new jN("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new jN("config must have value set but got ".concat(e));return r.value=e.value,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return HA((function(){return Q_(I_(n.value),M_(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(nD);iD.className="Constant",f.registerClass(iD);var oD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){return nT(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(nD);oD.className="RandomUniform",f.registerClass(oD);var sD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new HN("randomNormal does not support dType ".concat(t,"."));return qO(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(nD);sD.className="RandomNormal",f.registerClass(sD);var uD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return _createClass(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new HN("truncatedNormal does not support dType ".concat(t,"."));return uT(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(nD);uD.className="TruncatedNormal",f.registerClass(uD);var cD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return HA((function(){if(2!==e.length||e[0]!==e[1])throw new jN("Identity matrix initializer can only be used for 2D square matrices.");return Q_(n.gain,EI(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(nD);cD.className="Identity",f.registerClass(cD);var lD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a;if(_classCallCheck(this,n),r=t.call(this),e.scale<0)throw new jN("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,iO(eD,"FanMode",r.mode),r.distribution=null==e.distribution?"normal":e.distribution,a=r.distribution,iO(tD,"Distribution",a),r.seed=e.seed,_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(xO(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=DO(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=DO(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=DO(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if(i/="fanIn"===this.mode?Math.max(1,r):"fanOut"===this.mode?Math.max(1,a):Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new HN("".concat(this.getClassName()," does not support dType ").concat(t,"."));return uT(e,0,o,t,this.seed)}var s=Math.sqrt(3*i);return nT(e,-s,s,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(nD);lD.className="VarianceScaling",f.registerClass(lD);var hD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);hD.className="GlorotUniform",f.registerClass(hD);var fD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);fD.className="GlorotNormal",f.registerClass(fD);var dD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);dD.className="HeNormal",f.registerClass(dD);var pD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);pD.className="HeUniform",f.registerClass(pD);var vD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);vD.className="LeCunNormal",f.registerClass(vD);var mD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return _createClass(n,[{key:"getClassName",value:function(){return lD.className}}]),n}(lD);mD.className="LeCunNormal",f.registerClass(mD);var gD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new HN("Random seed is not implemented for Orthogonal Initializer yet.");return _possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){var n=this;return HA((function(){if(2!==e.length)throw new HN("The Orthogonal Initializer does not support non-2D shapes yet.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=qO(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=y.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Q_(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(nD);gD.className="Orthogonal",f.registerClass(gD);var yD={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function bD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tO(e,f.SerializationMap.getMap().classNameMap,t,"initializer")}function kD(e){return eO(e)}function _D(e){if("string"==typeof e){var t=e in yD?yD[e]:e;if("GlorotNormal"===t)return new fD;if("GlorotUniform"===t)return new hD;if("HeNormal"===t)return new dD;if("HeUniform"===t)return new pD;if("LeCunNormal"===t)return new vD;if("LeCunUniform"===t)return new mD;var n={};return n.className=t,n.config={},bD(n)}return e instanceof nD?e:bD(e)}var wD=0;function CD(){return wD++}var xD={};function SD(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in xD||(xD[e]=0),xD[e]+=1,e+xD[e].toString()}function AD(e){return Array.isArray(e)&&Array.isArray(e[0])}function ID(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function TD(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new jN("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function ED(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return(e=e)[0];throw new jN("Expected exactly 1 Shape; got ".concat(e.length))}return e}function RD(e){var t,n=0,r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n+=0===a.shape.length?1:a.shape.reduce((function(e,t){return e*t}))}}catch(AU){r.e(AU)}finally{r.f()}return n}var ND=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Variable",a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;_classCallCheck(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=CD(),this.originalName=EO(r=null==r?"Variable":r),this.name=RO(this.originalName),this.trainable_=a,this.constraint=i,this.val=F_(t,this.trainable_,this.name,this.dtype)}return _createClass(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function OD(e){return e.map((function(e){return e.read()}))}function DD(e){e.forEach((function(e){e[0].write(e[1])}))}var FD,MD=function e(t){_classCallCheck(this,e),this.dtype=t.dtype,this.shape=t.shape,this.ndim=null!=t.shape?t.shape.length:t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},PD=function e(t,n,r,a,i,o,s){_classCallCheck(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=s,this.id=CD(),null!=o&&(this.originalName=EO(o),this.name=RO(this.originalName)),this.rank=n.length},zD=0,LD=function(){function e(t,n){_classCallCheck(this,e),this.callArgs=n,this.id=zD++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r,a=_createForOfIteratorHelper(t.inboundLayers);try{for(a.s();!(r=a.n()).done;){var i=r.value;null!=i&&i.outboundNodes.push(this)}}catch(AU){a.e(AU)}finally{a.f()}t.outboundLayer.inboundNodes.push(this)}return _createClass(e,[{key:"getConfig",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.inboundLayers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push(null!=r?r.name:null)}}catch(AU){n.e(AU)}finally{n.f()}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:t,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),BD=0,VD=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=BD++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=$N(i)+"_"+SD(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var s=null;null!=r.batchSize&&(s=r.batchSize),o=[s].concat(r.inputShape)}e.batchInputShape=o;var u=r.dtype;null==u&&(u=r.inputDType),null==u&&(u="float32"),e.dtype=u}return e.initialWeights=null!=r.weights?r.weights:null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return _createClass(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new UN("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new jN("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return ZN(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return ZN(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=YN(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=YN(this.inputSpec);if(e.length!==t.length)throw new jN("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new jN("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new jN("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new jN("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new jN("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var s in a.axes){var u=Number(s),c=a.axes[s],l=u>=0?o[u]:o[o.length+u];if(null!=c&&-1===[c,null].indexOf(l))throw new jN("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(u," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var h=0;h<a.shape.length;++h){var f=a.shape[h],d=r.shape[h];if(null!=f&&null!=d&&f!==d)throw new jN("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r,a=YN(e),i=!0,o=_createForOfIteratorHelper(a);try{for(o.s();!(r=o.n()).done;){if(!(r.value instanceof PD)){i=!1;break}}}catch(AU){o.e(AU)}finally{o.f()}var s,u=!0,c=_createForOfIteratorHelper(a);try{for(c.s();!(s=c.n()).done;){if(s.value instanceof PD){u=!1;break}}}catch(AU){c.e(AU)}finally{c.f()}if(i===u)throw new jN("Arguments to apply() must be all SymbolicTensors or all Tensors");return TO(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var r,i=[],o=_createForOfIteratorHelper(YN(e));try{for(o.s();!(r=o.n()).done;){var s=r.value;i.push(s.shape)}}catch(AU){o.e(AU)}finally{o.f()}n.build(ZN(i)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&u&&(n._refCount=1)}if(n.assertInputCompatibility(e),u){var c,l=n.call(e,t),h=[],f=_createForOfIteratorHelper(YN(l));try{for(f.s();!(c=f.n()).done;){var d=c.value;-1!==a.indexOf(d)&&(d=d.clone()),h.push(d)}}catch(AU){f.e(AU)}finally{f.f()}if(l=ZN(h),null!=n.activityRegularizer)throw new HN("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}var p,v=function(e){var t,n=[],r=_createForOfIteratorHelper(e=YN(e));try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(a.shape)}}catch(AU){r.e(AU)}finally{r.f()}return ZN(n)}(e),m=n.computeOutputShape(v);if(n.warnOnIncompatibleInputShape(Array.isArray(e)?v[0]:v),p=null!=m&&m.length>0&&Array.isArray(m[0])?m.map((function(r,a){return new PD("float32",r,n,YN(e),t,n.name,a)})):new PD("float32",m,n,YN(e),t,n.name),n.addInboundNode(e,p,null,null,v,m,t),n._refCount++,null!=n.activityRegularizer)throw new HN("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return p}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"countParams",value:function(){if(!this.built)throw new UN("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return RD(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return OD(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;HA((function(){var n=t.weights;if(n.length!==e.length)throw new jN('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var a=[],i=OD(n),o=0;o<i.length;++o){var s=i[o],u=n[o],c=e[o];if(!r.arraysEqual(s.shape,c.shape))throw new jN("Layer weight shape ".concat(s.shape," ")+"not compatible with provided weight shape ".concat(c.shape));a.push([u,c])}DD(a)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new jN("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=_D("zeros"));var s=r.apply(t,n),u=new ND(s,n,e,i,o);return s.dispose(),null!=a&&this.addLoss((function(){return a.apply(u.read())})),null==i&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=YN(e),null!=this._losses&&(t=this.losses).push.apply(t,_toConsumableArray(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){var n=this;if(!this.supportsMasking){if(null!=t){if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=YN(e);t=YN(t),n=YN(n),r=YN(r),a=ID(a),i=ID(i);var u,c=[],l=[],h=[],f=_createForOfIteratorHelper(s);try{for(f.s();!(u=f.n()).done;){var d=u.value;c.push(d.sourceLayer),l.push(d.nodeIndex),h.push(d.tensorIndex)}}catch(AU){f.e(AU)}finally{f.f()}new LD({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:h,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new WN("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new WN("Layer ".concat(this.name)+" is not connected, no input to return.");return ZN(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new WN("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new WN("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return ZN(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new WN("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e,t=[],n=_createForOfIteratorHelper(this.inboundNodes);try{for(n.s();!(e=n.n()).done;){var r=e.value,a=JSON.stringify(r.outputShapes);-1===t.indexOf(a)&&t.push(a)}}catch(AU){n.e(AU)}finally{n.f()}if(1===t.length){var i=this.inboundNodes[0].outputShapes;return Array.isArray(i)&&Array.isArray(i[0])&&1===i.length?i[0]:i}throw new WN("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "outut shape" is ill-defined for the layer.')}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(f.Serializable),WD=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:SD("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new jN("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new jN("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new jN("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new PD(r.dtype,r.batchInputShape,_assertThisInitialized(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new LD({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),_possibleConstructorReturn(r)}return _createClass(n,[{key:"apply",value:function(e,t){throw new jN("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(VD);function UD(e){return jD.apply(this,arguments)}function jD(){return(jD=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t){e.next=2;break}return e.abrupt("return");case 2:for(i in n=[],r=[],a=[],t)"number"!=typeof(o=t[i])&&(s=o,n.push(s.data()),r.push(i),a.push(s));if(!(n.length>0)){e.next=10;break}return e.next=7,Promise.all(n);case 7:for(u=e.sent,c=0;c<u.length;++c)t[r[c]]=u[c][0];GA(a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function HD(e){if(null!=e)for(var t in e){var n=e[t];"number"!=typeof n&&n.dispose()}}WD.className="InputLayer",f.registerClass(WD),function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(FD||(FD={}));var GD=function(){function e(){_classCallCheck(this,e),this.validationData=null}var t,n,r,a,i,o;return _createClass(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"setModel",value:function(e){}}]),e}(),qD=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;_classCallCheck(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}var t,n,r,a,i,o;return _createClass(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setParams(e)}}catch(AU){n.e(AU)}finally{n.f()}}},{key:"setModel",value:function(e){var t,n=_createForOfIteratorHelper(this.callbacks);try{for(n.s();!(t=n.n()).done;){t.value.setModel(e)}}catch(AU){n.e(AU)}finally{n.f()}}},{key:"onEpochBegin",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return o.apply(this,arguments)})},{key:"onEpochEnd",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onEpochEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchBegin",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchBegin(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return a.apply(this,arguments)})},{key:"onBatchEnd",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==n&&(n={}),r=_createForOfIteratorHelper(this.callbacks),e.prev=2,r.s();case 4:if((a=r.n()).done){e.next=10;break}return i=a.value,e.next=8,i.onBatchEnd(t,n);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),r.e(e.t0);case 15:return e.prev=15,r.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e,t){return r.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=_createForOfIteratorHelper(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainBegin(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==t&&(t={}),n=_createForOfIteratorHelper(this.callbacks),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a.onTrainEnd(t);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])}))),function(e){return t.apply(this,arguments)})}]),e}(),KD=function(e){_inherits(i,e);var t,n,r,a=_createSuper(i);function i(){return _classCallCheck(this,i),a.call(this)}return _createClass(i,[{key:"onEpochBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.seen=0,this.totals={};case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onBatchEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i in null==n&&(n={}),r=null==n.size?0:n.size,this.seen+=r,a=function(e){var t=n[e];if("number"==typeof t)o.totals.hasOwnProperty(e)||(o.totals[e]=0),o.totals[e]=o.totals[e]+t*r;else{var a;e in o.totals?a=o.totals[e]:o.totals[e]=0;var i=HA((function(){return b_(o.totals[e],Q_(t,r))}));o.totals[e]=i,null!=a&&a.dispose()}},n)a(i);case 5:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"onEpochEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){r=_createForOfIteratorHelper(this.params.metrics);try{for(i=function(){var e=a.value;null!=o.totals[e]&&("number"==typeof o.totals[e]?n[e]=o.totals[e]/o.seen:HA((function(){var t=Q_(J_(1,o.seen),o.totals[e]);n[e]=t,o.totals[e].dispose(),qA(n[e])})))},r.s();!(a=r.n()).done;)i()}catch(AU){r.e(AU)}finally{r.f()}}case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),i}(GD),XD=function(e){_inherits(i,e);var t,n,r,a=_createSuper(i);function i(){return _classCallCheck(this,i),a.apply(this,arguments)}return _createClass(i,[{key:"onTrainBegin",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.epoch=[],this.history={};case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onEpochEnd",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in null==n&&(n={}),this.epoch.push(t),n)null==this.history[r]&&(this.history[r]=[]),this.history[r].push(n[r]);case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"syncData",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,a,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a in t=[],n=[],r=[],this.history)for(i=this.history[a],o=0;o<i.length;++o)"number"!=typeof i[o]&&(t.push(i[o].data()),n.push(a),r.push(o));return e.next=4,Promise.all(t);case 4:for(s=e.sent,u=0;u<s.length;++u)this.history[n[u]][r[u]].dispose(),this.history[n[u]][r[u]]=s[u][0];case 6:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(GD),ZD=function(e){_inherits(l,e);var t,n,a,i,o,s,u,c=_createSuper(l);function l(e,t){var n,a,i,o,s;if(_classCallCheck(this,l),(n=c.call(this)).currentEpoch=0,n.yieldEvery=t||"auto","auto"===n.yieldEvery&&(n.yieldEvery=125),"never"===n.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return r.isNumber(n.yieldEvery)&&(n.maybeWait=(a=n.maybeWait.bind(_assertThisInitialized(n)),i=n.yieldEvery,s=r.now(),function(){var e=r.now();return e-s<i?o:(s=e,o=a.apply(void 0,arguments))})),n.trainBegin=e.onTrainBegin,n.trainEnd=e.onTrainEnd,n.epochBegin=e.onEpochBegin,n.epochEnd=e.onEpochEnd,n.batchBegin=e.onBatchBegin,n.batchEnd=e.onBatchEnd,n.yield=e.onYield,_possibleConstructorReturn(n)}return _createClass(l,[{key:"maybeWait",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],e.t0=null!=this.yield,!e.t0){e.next=6;break}return e.next=5,UD(r);case 5:a.push(this.yield(t,n,r));case 6:return a.push(tR()),e.next=9,Promise.all(a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return u.apply(this,arguments)})},{key:"onEpochBegin",value:(s=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentEpoch=t,e.t0=null!=this.epochBegin,!e.t0){e.next=7;break}return e.next=5,UD(n);case 5:return e.next=7,this.epochBegin(t,n);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"onEpochEnd",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],e.t0=null!=this.epochEnd,!e.t0){e.next=6;break}return e.next=5,UD(n);case 5:r.push(this.epochEnd(t,n));case 6:return"epoch"===this.yieldEvery&&r.push(tR()),e.next=9,Promise.all(r);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"onBatchBegin",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.batchBegin,!e.t0){e.next=6;break}return e.next=4,UD(n);case 4:return e.next=6,this.batchBegin(t,n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"onBatchEnd",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=[],e.t0=null!=this.batchEnd,!e.t0){e.next=6;break}return e.next=5,UD(n);case 5:a.push(this.batchEnd(t,n));case 6:return"batch"===this.yieldEvery?a.push(tR()):r.isNumber(this.yieldEvery)&&a.push(this.maybeWait(this.currentEpoch,t,n)),e.next=9,Promise.all(a);case 9:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"onTrainBegin",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.trainBegin,!e.t0){e.next=6;break}return e.next=4,UD(t);case 4:return e.next=6,this.trainBegin(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onTrainEnd",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=null!=this.trainEnd,!e.t0){e.next=6;break}return e.next=4,UD(t);case 4:return e.next=6,this.trainEnd(t);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),l}(GD);function YD(e,t){return null==e&&(e={}),e instanceof GD?[e]:Array.isArray(e)&&e[0]instanceof GD?e:YN(e).map((function(e){return new ZD(e,t)}))}var $D=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"registerCallbackConstructor",value:function(t,n){r.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors)e.constructors[+n].forEach((function(e){if(e===t)throw new jN("Duplicate callback constructor.")}))}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a=+r;t>=a&&n.push.apply(n,_toConsumableArray(e.constructors[a]))}return n.map((function(e){return new e}))}}]),e}();function JD(e,t,n,r,a,i,o,s,u){var c=new XD,l=[new KD].concat(_toConsumableArray($D.createCallbacks(t)));null!=e&&l.push.apply(l,_toConsumableArray(e)),l.push(c);var h=new qD(l);return h.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:s,metrics:u}),{callbackList:h,history:c}}function QD(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return tO(e,f.SerializationMap.getMap().classNameMap,t,"layer",n)}function eF(e,t){return HA((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=xw(ZO(e),t,!0),r=RI(n.shape,VN()),a=rC(NI(n,r));return J_(e,a)}))}function tF(e,t){return HA((function(){return _w(ZO(XC(t,e)),-1)}))}function nF(e,t){return HA((function(){return _w(Iw(XC(t,e)),-1)}))}function rF(e,t){return HA((function(){var n=XC(e,t),r=Mw(Iw(e),VN(),Number.MAX_VALUE),a=Iw(J_(n,r));return Q_(100,_w(a,-1))}))}function aF(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return HA((function(){if(n)t=BT(t);else{var r=xw(t,t.shape.length-1,!0);t=J_(t,r)}return t=Mw(t,VN(),1-VN()),Gw(xw(Q_(e.toFloat(),Uw(t)),t.shape.length-1))}))}function iF(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return HA((function(){var r,a,i=Ww((r=e,a=[DO(r.shape)],r.reshape(a))).toInt(),o=(t=Mw(t,VN(),1-VN())).shape;return aF(dA(i,o[o.length-1]).reshape(o),t,n)}))}function oF(e,t){return HA((function(){var n;return n=Mw(t,VN(),1-VN()),n=Uw(J_(n,XC(1,n))),_w(function(e,t){if(!r.arraysEqual(e.shape,t.shape))throw new jN("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return HA((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function sF(e,t){return HA((function(){var n=eF(e,-1),r=eF(t,-1),a=Q_(n,r);return Gw(xw(a,-1))}))}$D.constructors={};var uF={meanSquaredError:tF,meanAbsoluteError:nF,meanAbsolutePercentageError:rF,meanSquaredLogarithmicError:function(e,t){return HA((function(){var n=Mw(t,VN(),Number.MAX_VALUE),r=Uw(b_(1,n)),a=Mw(e,VN(),Number.MAX_VALUE),i=Uw(b_(1,a));return _w(ZO(XC(r,i)),-1)}))},squaredHinge:function(e,t){return HA((function(){var n=NI(0,XC(1,Q_(e,t)));return _w(ZO(n),-1)}))},hinge:function(e,t){return HA((function(){var n=NI(0,XC(1,Q_(e,t)));return _w(n,-1)}))},categoricalHinge:function(e,t){return HA((function(){var n=xw(Q_(e,t),-1),r=FI(Q_(XC(1,e),t),-1);return NI(0,b_(1,XC(r,n)))}))},logcosh:function(e,t){return HA((function(){var n=Math.log(2),r=XC(t,e),a=XC(b_(r,nC(Q_(-2,r))),n);return _w(a,-1)}))},categoricalCrossentropy:aF,sparseCategoricalCrossentropy:iF,binaryCrossentropy:oF,kullbackLeiblerDivergence:function(e,t){return HA((function(){var n=Mw(e,VN(),1),r=Mw(t,VN(),1);return xw(Q_(e,Uw(J_(n,r))),-1)}))},poisson:function(e,t){return HA((function(){var n=Uw(b_(VN(),t));return _w(XC(t,Q_(e,n)),-1)}))},cosineProximity:sF};function cF(e){if("string"==typeof e){if(e in uF)return uF[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new jN(t)}return e}function lF(e,t){return HA((function(){var n=Q_(.5,B_(t)),r=LO(cx(t,n),e.dtype);return _w(TI(e,r),-1)}))}function hF(e,t){return HA((function(){return LO(TI(yw(e,-1),yw(t,-1)),"float32")}))}function fF(e,t){return oF(e,t)}function dF(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),TI(e,t).asType("float32")}var pF=aF,vF=iF,mF={binaryAccuracy:lF,categoricalAccuracy:hF,precision:function(e,t){return HA((function(){var n=function(e,t){return HA((function(){return gx(e.equal(1),t.equal(1)).sum().cast("float32")}))}(e,t),r=function(e,t){return HA((function(){return gx(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return _x(cx(a,0),n.div(a),0).cast("float32")}))},categoricalCrossentropy:pF,sparseCategoricalCrossentropy:vF,mse:tF,MSE:tF,mae:nF,MAE:nF,mape:rF,MAPE:rF,cosine:sF};function gF(e){if("string"==typeof e&&e in mF)return mF[e];if("string"!=typeof e&&null!=e)return e;throw new jN("Unknown metric ".concat(e))}function yF(e){if(KN(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"==typeof e)return e;for(var t,n=0,r=Object.keys(uF);n<r.length;n++){var a=r[n];if(uF[a]===e){t=a;break}}if(void 0!==t)return t;for(var i=0,o=Object.keys(mF);i<o.length;i++){var s=o[i];if(mF[s]===e){t=s;break}}return void 0!==t?t:e.name}function bF(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!function e(t){if(null===t)return!0;if("object"==typeof t){if(Object.getPrototypeOf(t)===Object.prototype){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n];if("string"!=typeof a)return!1;if(!e(t[a]))return!1}return!0}if(Array.isArray(t)){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;){if(!e(i.value))return!1}}catch(AU){o.e(AU)}finally{o.f()}return!0}return!1}var s=typeof t;return"string"===s||"number"===s||"boolean"===s}(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>1048576&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.")}}function kF(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function _F(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(AU){r="multiple"}kF(["".concat(e.name," (").concat(e.getClassName(),")"),r,e.countParams().toString()],t,n)}function wF(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(AU){a="multiple"}var i,o=[],s=_createForOfIteratorHelper(e.inboundNodes);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(u)))for(var c=0;c<u.inboundLayers.length;++c)o.push("".concat(u.inboundLayers[c].name,"[").concat(u.nodeIndices[c],"][").concat(u.tensorIndices[c],"]"))}}catch(AU){s.e(AU)}finally{s.f()}var l=e.name,h=e.getClassName(),f=0===o.length?"":o[0];kF(["".concat(l," (").concat(h,")"),a,e.countParams().toString(),f],t,r);for(var d=1;d<o.length;++d)kF(["","","",o[d]],t,r)}function CF(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}var xF=function(){function e(t){if(_classCallCheck(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r,a=_createForOfIteratorHelper(t);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.add(i.key,i.value)}}catch(AU){a.e(AU)}finally{a.f()}}}return _createClass(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new jN("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return H_(t,e.dtype)}catch(AU){throw new jN("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof PD){if(null==this.id2Value[e.id])throw new jN("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new jN("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof PD){if(null==this.id2Value[e.id])throw new jN("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new jN("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&GA(this.id2Mask)}}]),e}(),SF={},AF={};function IF(e,t,n,a){var i,o=null!=n&&n.training,s=Array.isArray(e),u=s?e:[e],c=u.map((function(e){return e.name})),l=[],h=t.names(),f=_createForOfIteratorHelper(c);try{for(f.s();!(i=f.n()).done;){var d=i.value;-1!==h.indexOf(d)?l.push(t.getValue(d)):l.push(null)}}catch(AU){f.e(AU)}finally{f.f()}null!=a&&(a.maxNumTensors=-1/0,a.minNumTensors=1/0);var p,v,m=c.join(",")+"|"+t.names().join(",");if(null==SF[m]){var g=function(e,t){r.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],a={};if(1===e.length){var i=EF(e[0],t);n=i.sorted,a=i.recipientMap}else{var o,s=new Set,u=_createForOfIteratorHelper(e);try{for(u.s();!(o=u.n()).done;){var c,l=EF(o.value,t),h=l.sorted,f=l.recipientMap,d=_createForOfIteratorHelper(h);try{for(d.s();!(c=d.n()).done;){var p=c.value;s.has(p.name)||(n.push(p),s.add(p.name))}}catch(AU){d.e(AU)}finally{d.f()}var v=function(e){null==a[e]&&(a[e]=new Set),f[e].forEach((function(t){return a[e].add(t)}))};for(var m in f)v(m)}}catch(AU){u.e(AU)}finally{u.f()}}return{sorted:n,recipientCounts:TF(a)}}(u,t);p=g.sorted,v=g.recipientCounts,SF[m]=p,AF[m]=v}p=SF[m],v={},o||Object.assign(v,AF[m]);for(var y=new xF(t),b=0;b<p.length;++b){if(null!=a){var k=UA().numTensors;k>a.maxNumTensors&&(a.maxNumTensors=k),k<a.minNumTensors&&(a.minNumTensors=k)}var _=p[b],w=_.sourceLayer;if(!(w instanceof WD)){var C,x=[],S=[],A=[],I=!1,T=_createForOfIteratorHelper(_.inputs);try{for(T.s();!(C=T.n()).done;){var E=C.value,R=y.getValue(E),N=y.getMask(E);x.push(R),S.push(N),null!=N&&(I=!0),o||(v[E.name]--,0!==v[E.name]||t.hasKey(E)||-1!==c.indexOf(E.name)||R.isDisposed||!0===E.sourceLayer.stateful||A.push(R))}}catch(AU){T.e(AU)}finally{T.f()}I&&((n=n||{}).mask=S[0]);var O=YN(w.apply(x,n)),D=null;w.supportsMasking&&(D=w.computeMask(x,S));for(var F=RF(_),M=Array.isArray(F)?F:[F],P=0;P<M.length;++P){y.hasKey(M[P])||y.add(M[P],O[P],Array.isArray(D)?D[0]:D);var z=c.indexOf(M[P].name);-1!==z&&(l[z]=O[P])}o||GA(A)}}return y.disposeMasks(),s?l:l[0]}function TF(e){var t={};for(var n in e)t[n]=e[n].size;return t}function EF(e,t){var n,r=new Set,a=[],i={},o=_createForOfIteratorHelper(t.names());try{for(o.s();!(n=o.n()).done;){var s=n.value;r.add(s)}}catch(AU){o.e(AU)}finally{o.f()}var u=[],c=[];for(u.push(e);u.length>0;){var l=u[u.length-1];if(r.has(l.name))u.pop();else{var h=c[c.length-1]===u.length-1;if(0===l.inputs.length||h)u.pop(),a.push(l),r.add(l.name),h&&c.pop();else{c.push(u.length-1);var f,d=_createForOfIteratorHelper(l.inputs);try{for(d.s();!(f=d.n()).done;){var p=f.value;null==i[p.name]&&(i[p.name]=new Set),i[p.name].add(l.name),r.has(p.name)||u.push(p)}}catch(AU){d.e(AU)}finally{d.f()}}}}return{sorted:a,recipientMap:i}}function RF(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a,i=_createForOfIteratorHelper(e.sourceLayer.inboundNodes[r].outputTensors);try{for(i.s();!(a=i.n()).done;){if(a.value.id===e.id){n=r;break}}}catch(AU){i.e(AU)}finally{i.f()}}t=e.sourceLayer.getOutputAt(n)}return t}function NF(e,t){return function(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided classWeight is an array of ".concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){a.push(t in e?e[t]:null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so classWeight must be either an array with "+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided classWeight not understood: ".concat(JSON.stringify(e)))}(e,t)}function OF(e,t,n,r){return DF.apply(this,arguments)}function DF(){return(DF=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&null==a){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==r){e.next=12;break}return i=HA((function(){if(1===t.shape.length)return t.clone();if(2===t.shape.length){if(t.shape[1]>1)return t.argMax(1);if(1===t.shape[1])return t.reshape([t.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(t.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(t.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,i.data();case 7:return e.t1=e.sent,o=e.t0.from.call(e.t0,e.t1),GA(i),s=[],e.abrupt("return",(o.forEach((function(e){if(null==r[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(r[e])})),T_(s,"float32")));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function FF(e,t){return Q_(e,t)}function MF(e,t){var n,a;n=t.xs,a=t.ys,r.assert(null!=n&&null!=a,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var i=PF("input",e.inputNames,n),o=PF("output",e.outputNames,a),s=i[0].shape[0];r.assert(i.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(i.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),r.assert(o.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(o.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var u=function(t){r.assert(i[t].shape[0]===s,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(i[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},c=0;c<i.length;c++)u(c);for(var l=function(t){r.assert(o[t].shape[0]===s,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(o[t].shape[0],"; ")+"expected  ".concat(s," based on input ").concat(e.inputNames[0],".")}))},h=0;h<o.length;h++)l(h);return{xs:i,ys:o}}function PF(e,t,n){if(n instanceof Ab)return[n];if(Array.isArray(n))return r.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var a,i=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(null==n[s])throw new jN("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(s,"'."));i.push(n[s])}}catch(AU){o.e(AU)}finally{o.f()}return i}function zF(e){return"function"==typeof e.iterator}function LF(e){r.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function BF(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return VO(e,t,n-t)})):VO(e,t,n-t)}function VF(e,t){return HA((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return VF(e,t)})):XO(e,"int32"===t.dtype?t:t.toInt())}))}function WF(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function UF(e){var t=[];e instanceof Ab&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(BO(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function jF(e,t){if(null!=e){var n=[];if(t instanceof Ab)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t)n.push(t[r].id);var a=[];if(e instanceof Ab)-1===n.indexOf(e.id)&&a.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&a.push(e)}));else if(null!=e)for(var i in e){var o=e[i];-1===n.indexOf(o.id)&&a.push(o)}a.forEach((function(e){e.isDisposed||e.dispose()}))}}function HF(e){return Array.isArray(e)}function GF(e){return!function(e){return e instanceof Ab}(e)&&!HF(e)}function qF(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(HF(e)&&e.length>0)o=!0;else if(GF(e)){for(var s in e)if(e.hasOwnProperty(s)){o=!0;break}}else o=!0;if(o)throw new jN("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(GF(e)){e=e,r=[];var u,c=_createForOfIteratorHelper(t);try{for(c.s();!(u=c.n()).done;){var l=u.value;if(null==e[l])throw new jN('No data provided for "'.concat(l,'". Need data for each key in: ')+"".concat(t));r.push(e[l])}}catch(AU){c.e(AU)}finally{c.f()}}else if(HF(e)){if((e=e).length!==t.length)throw new jN("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(e=e,t.length>1)throw new jN("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=UF(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var f=r[h];if(f.shape.length!==n[h].length)throw new jN("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(f.shape));for(var d=0;d<n[h].length;++d)if(0!==d||a){var p=f.shape[d],v=n[h][d];if(null!=v&&v>=0&&p!==v)throw new jN("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have shape [".concat(n[h],"], but got array with shape ")+"[".concat(f.shape,"]."))}}return r}function KF(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new jN("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new jN("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var s=r[o];if(s.shape.length!==n[o].length)throw new jN("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(s.shape)));for(var u=0;u<n[o].length;++u)if(0!==u||a){var c=s.shape[u],l=n[o][u];if(null!=l&&l!==c)throw new jN("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(s.shape),"."))}}}var XF=function(e){_inherits(l,e);var t,n,a,i,o,u,c=_createSuper(l);function l(e){var t;return _classCallCheck(this,l),(t=c.call(this,e)).isTraining=!1,t}return _createClass(l,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new jN("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");!function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,i=function(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);for(var i=0,o=n;i<o.length;i++){var s=o[i];if(s.length>1||1===s.length&&s[0].inboundLayers.length>1){t=!1;break}r.push.apply(r,_toConsumableArray(s))}if(t){var u,c=_createForOfIteratorHelper(e.layers);try{for(c.s();!(u=c.n()).done;){var l,h=u.value,f=!1,d=_createForOfIteratorHelper(h.inboundNodes);try{for(d.s();!(l=d.n()).done;){var p=l.value;if(-1!==r.indexOf(p)){if(f){t=!1;break}f=!0}}}catch(AU){d.e(AU)}finally{d.f()}if(!t)break}}catch(AU){c.e(AU)}finally{c.f()}}return t}(e),o=["Layer (type)","Output shape","Param #"];if(i?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!i)for(var s in o.push("Receives inputs"),r=[],e.nodesByDepth){var u;(u=r).push.apply(u,_toConsumableArray(e.nodesByDepth[s]))}a("_".repeat(t)),kF(o,n,a),a("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)i?_F(c[l],n,a):wF(c[l],n,r,a),a((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var h=function(e){return RD(null!=e.collectedTrainableWeights?e.collectedTrainableWeights:e.trainableWeights)}(e),f=RD(e.nonTrainableWeights);a("Total params: ".concat(h+f)),a("Trainable params: ".concat(h)),a("Non-trainable params: ".concat(f)),a("_".repeat(t))}(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return QE.adagrad(.01)},Adadelta:function(){return QE.adadelta(1,.95,VN())},Adam:function(){return QE.adam(.001,.9,.999,VN())},Adamax:function(){return QE.adamax(.002,.9,.999,VN(),0)},RMSProp:function(){return QE.rmsprop(.001,.9,0,VN())},SGD:function(){return QE.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new jN("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof HE))throw new jN("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new jN("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));n=e.loss.map((function(e){return cF(e)}))}else{var r=cF(e.loss);this.outputs.forEach((function(e){n.push(r)}))}else{for(var a in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(a))throw new jN('Unknown entry in loss dictionary: "'.concat(a,'". ')+"Only expected the following keys: ".concat(this.outputNames));var i,o=_createForOfIteratorHelper(this.outputNames);try{for(o.s();!(i=o.n()).done;){var s=i.value;null==e.loss[s]&&console.warn('Output "'.concat(s,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(s," during training")),n.push(cF(e.loss[s]))}}catch(AU){o.e(AU)}finally{o.f()}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var u=0;u<this.outputs.length;++u){var c=this.internalOutputShapes[u];this.feedOutputNames.push(this.outputNames[u]),this.feedOutputShapes.push(c),this.feedLossFns.push(this.lossFunctions[u])}var l=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],TO("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===l.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var h=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r,a=[],i=_createForOfIteratorHelper(t);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=n.hasOwnProperty(o)?n[o]:[];Array.isArray(s)||(s=[s]),a.push(s)}}catch(AU){i.e(AU)}finally{i.f()}return a}(e.metrics,this.outputNames),f=function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])};TO("metric",(function(){for(var e=function(e){-1===l.indexOf(e)&&function(n){var r,a,i,o,s=_createForOfIteratorHelper(n);try{for(s.s();!(o=s.n()).done;){var u=o.value;if("string"==typeof u&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(u)){var c=t.internalOutputShapes[e],l=void 0;1===c[c.length-1]||t.lossFunctions[e]===oF?-1!==["accuracy","acc"].indexOf(u)?a=lF:-1!==["crossentropy","ce"].indexOf(u)&&(a=fF):t.lossFunctions[e]===iF?-1!==["accuracy","acc"].indexOf(u)?a=dF:-1!==["crossentropy","ce"].indexOf(u)&&(a=vF):-1!==["accuracy","acc"].indexOf(u)?a=hF:-1!==["crossentropy","ce"].indexOf(u)&&(a=pF),-1!==["accuracy","acc"].indexOf(u)?l="acc":-1!==["crossentropy","ce"].indexOf(u)&&(l="ce"),i=a,r=""+l}else{var h=gF(u);i=h,r=""+yF(u)}var d=void 0;TO(r,(function(){d=i})),f(e,r,d)}}catch(AU){s.e(AU)}finally{s.f()}}(h[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;LF(r);var a=this.standardizeUserDataXY(e,t,!0,r);try{var i=a[0].concat(a[1]);return this.makeTestFunction(),ZN(this.testLoop(this.testFunction,i,r,n.verbose,n.steps))}finally{jF(a[0],e),jF(a[1],t)}}},{key:"evaluateDataset",value:(u=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.makeTestFunction(),function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,a){var i,o,s,u,c,l,h,f,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=(a=a||{}).batches,o=t.testFunction,s=[],!(a.verbose>0)){e.next=4;break}throw new HN("Verbose mode is not implemented yet.");case 4:if(r.assert(!i||a.batches>0&&Number.isInteger(a.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(a.batches))})),"function"!=typeof n.next){e.next=9;break}e.t0=n,e.next=12;break;case 9:return e.next=11,n.iterator();case 11:e.t0=e.sent;case 12:u=e.t0,c=0,l=0,h=regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.next();case 2:if(n=e.sent,s=HA((function(){return n.value&&function(){var e=MF(t,n.value),r=e.xs,a=e.ys,i=r.concat(a),u=HA((function(){return o(i)}));if(GA(i),0===l)for(var h=0;h<u.length;++h)s.push(I_(0));for(var f=i[0].shape[0],d=function(e){var t=u[e],n=s[e];s[e]=HA((function(){return b_(s[e],Q_(f,t))})),l>0&&GA(n)},p=0;p<u.length;++p)d(p);GA(u),c+=f,++l}(),s})),!n.done){e.next=6;break}return i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(a.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("return","break");case 6:case"end":return e.stop()}}),e)}));case 15:if(i&&!(l<a.batches)){e.next=22;break}return e.delegateYield(h(),"t1",17);case 17:if("break"!==e.t1){e.next=20;break}return e.abrupt("break",22);case 20:e.next=15;break;case 22:for(f=0;f<s.length;++f)d=s[f],s[f]=J_(s[f],c),GA(d);return e.abrupt("return",ZN(s));case 24:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n)));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return u.apply(this,arguments)})},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new jN("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new jN("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new jN("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=this.retrieveSymbolicTensors(n?t:[t]),a=new xF;if(e instanceof Ab&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new jN("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var i=0;i<this.inputs.length;++i)a.add(this.inputs[i],e[i])}else{var o,s=_createForOfIteratorHelper(this.inputs);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=e[u.name];if(null==c)throw new jN("No value is provided for the model's input ".concat(u.name));a.add(u,c)}}catch(AU){s.e(AU)}finally{s.f()}}var l=IF(r,a);return n?l:l[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t,n=qN(null,e.length),r=e.length,a=_createForOfIteratorHelper(this.layers);try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=Array.isArray(i.output)?i.output:[i.output],s=o.map((function(e){return e.name})),u=0;u<e.length;++u){var c=s.indexOf(e[u]);if(-1!==c&&(n[u]=o[c],r--),0===r)break}if(0===r)break}}catch(AU){a.e(AU)}finally{a.f()}if(r>0){var l=[];throw n.forEach((function(t,n){null==t&&l.push(e[n])})),new jN("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(l)))}return n}},{key:"predictLoop",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return HA((function(){var a=t.checkNumSamples(e);if(r)throw new HN("Verbose predictLoop() is not implemented yet.");for(var i=WF(a,n),o=t.outputs.map((function(e){return[]})),s=function(n){HA((function(){var r=BF(e,i[n][0],i[n][1]),a=[];if(Array.isArray(r))for(var o=0;o<r.length;++o)a.push({key:t.inputs[o],value:r[o]});else a.push({key:t.inputs[0],value:r});var s=new xF(a);return IF(t.outputs,s)})).forEach((function(e,t){return o[t].push(e)}))},u=0;u<i.length;++u)s(u);return ZN(o.map((function(e){return W_(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=UF(e);KF(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return LF(r),this.predictLoop(n,r)}finally{jF(n,e)}}},{key:"predictOnBatch",value:function(e){KF(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new UN("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var a=[],i=0;i<this.feedOutputShapes.length;++i){var o=this.feedOutputShapes[i];a.push(this.feedLossFns[i]===iF?o.slice(0,o.length-1).concat([1]):o)}if(function(e,t,n){var a=rO(e.map((function(e){return e.shape[0]})));a.sort();var i=rO(t.map((function(e){return e.shape[0]})));if(i.sort(),a.length>1)throw new jN("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(i.length>1)throw new jN("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(a.length>0&&i.length>0&&!r.arraysEqual(a,i))throw new jN("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(a[0]," input sample(s) and ").concat(i[0]," target ")+"sample(s).")}(e=qF(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=qF(t,this.feedOutputNames,a,!1,"target")),function(e,t,n){for(var r=[tF,oF,aF],a=0;a<e.length;++a){var i=e[a],o=t[a],s=n[a];if(null!=o){if(o===aF&&1===i.shape[i.shape.length-1])throw new jN("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var u=i.shape.slice(1),c=s.slice(1),l=0;l<u.length;++l){var h=u[l],f=c[l];if(null!=f&&h!==f)throw new jN("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(s,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!=0)throw new jN("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,r,a){var i,o,s,u,c,l,h,f,d,p=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=!(p.length>4&&void 0!==p[4])||p[4],o=p.length>5?p[5]:void 0,s=this.standardizeUserDataXY(t,n,i,o),u=_slicedToArray(s,2),c=u[0],l=u[1],null==r){e.next=5;break}throw new Error("sample weight is not supported yet.");case 5:if(h=null,null==a){e.next=19;break}f=NF(a,this.outputNames),h=[],d=0;case 10:if(!(d<f.length)){e.next=19;break}return e.t0=h,e.next=14,OF(l[d],null,f[d]);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:++d,e.next=10;break;case 19:return e.abrupt("return",[c,l,h]);case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return o.apply(this,arguments)})},{key:"testLoop",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;return HA((function(){var o=r.checkNumSamples(t,n,i,"steps"),s=[];if(a>0)throw new HN("Verbose mode is not implemented yet.");if(null!=i)throw new HN("steps mode in testLoop() is not implemented yet");for(var u=WF(o,n),c=T_(zO(0,o)),l=0;l<u.length;++l){var h=u[l][0],f=u[l][1],d=VO(c,h,f-h),p=VF(t,d),v=e(p);if(0===l)for(var m=0;m<v.length;++m)s.push(I_(0));for(var g=0;g<v.length;++g)s[g]=b_(s[g],Q_(f-h,v[g]))}for(var y=0;y<s.length;++y)s[y]=J_(s[y],o);return s}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;XN(e,r)>1&&(a+="_".concat(XN(e.slice(0,n),r))),t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=[],r=t.slice(0,e.inputs.length),a=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),i=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),o=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var t=[],s=0;s<e.inputs.length;++s)t.push({key:e.inputs[s],value:r[s]});for(var u,c=new xF(t),l=IF(e.outputs,c,{training:!0}),h=0;h<e.lossFunctions.length;++h){var f=(0,e.lossFunctions[h])(a[h],l[h]);null!=i[h]&&(f=FF(f,i[h]));var d=_w(f);n.push(d),u=0===h?f:b_(u,f)}for(var p=0;p<e.metricsTensors.length;++p){var v=void 0;if(e.outputs.length>1&&p<e.outputs.length)v=n[p];else{var m=e.metricsTensors[p][1];v=_w((0,e.metricsTensors[p][0])(a[m],l[m]))}qA(v),o.push(v)}return u=_w(u),e.calculateLosses().forEach((function(e){u=b_(u,e)})),u}),!0,s)].concat(o)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){return HA((function(){for(var n,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=[],s=0;s<e.inputs.length;++s)o.push({key:e.inputs[s],value:a[s]});for(var u=new xF(o),c=IF(e.outputs,u),l=0;l<e.lossFunctions.length;++l){var h=_w((0,e.lossFunctions[l])(i[l],c[l]));n=0===l?h:b_(n,h),r.push(n)}for(var f=0;f<e.metricsTensors.length;++f){var d=e.metricsTensors[f][1],p=_w((0,e.metricsTensors[f][0])(i[d],c[d]));r.push(p)}return r}))}}},{key:"fit",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var a,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.length>2&&void 0!==i[2]?i[2]:{},e.abrupt("return",function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,a){var i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_,w,C,x,S,A,I,T=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=T.length>3&&void 0!==T[3]?T[3]:{},!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,LF(d=null==i.batchSize?32:i.batchSize),p=!1,e.next=10,t.standardizeUserData(n,a,i.sampleWeight,i.classWeight,p,d);case 10:if(v=e.sent,o=v[0],s=v[1],f=v[2],g=!1,!(null!=i.validationData&&i.validationData.length>0)){e.next=24;break}if(g=!0,2===i.validationData.length){e.next=16;break}throw 3===i.validationData.length?new HN("validationData including sample weights is not supported yet."):new jN("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(i.validationData," is invalid."));case 16:return u=i.validationData[0],c=i.validationData[1],y=!0,e.next=20,t.standardizeUserData(u,c,null,null,y,d);case 20:b=e.sent,l=b[0],h=b[1],m=l.concat(h),e.next=25;break;case 24:null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1?(g=!0,k=Math.floor(o[0].shape[0]*(1-i.validationSplit)),_=o[0].shape[0],l=BF(o,k,_),o=BF(o,0,k),h=BF(s,k,_),s=BF(s,0,k),m=l.concat(h)):null!=i.validationSteps&&(g=!0);case 25:return w=o.concat(s).concat(f),t.checkTrainableWeightsConsistency(),C=t.makeTrainFunction(),x=t.getDedupedMetricsNames(),g?(t.makeTestFunction(),S=t.testFunction,A=x.slice().concat(x.map((function(e){return"val_"+e})))):(S=null,m=[],A=x.slice()),I=YD(i.callbacks,i.yieldEvery),e.next=32,function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,a,i,o,s,u,c,l,h,f,d,p,v,m){var g,y,b,k,_,w,C,x;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null==o&&(o=32),null==s&&(s=1),null==f&&(f=!0),null==p&&(p=0),g=!1,null!=l&&null!=h&&(g=!0),null!=(y=t.checkNumSamples(a,o,null,"steps_per_epoch"))&&(b=zO(0,y)),null==u&&(u=1),k=JD(c,u,s,p,y,null,o,g,d),_=k.callbackList,w=k.history,_.setModel(t),t.history=w,e.next=10,_.onTrainBegin();case 10:t.stopTraining_=!1,C=regeneratorRuntime.mark((function e(s){var u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_.onEpochBegin(s);case 2:return u={},e.delegateYield(regeneratorRuntime.mark((function e(){var s,c,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("batch"!==f){e.next=2;break}throw new HN("batch shuffling is not implemneted yet");case 2:f&&r.shuffle(b),s=T_(b),c=WF(y,o),d=regeneratorRuntime.mark((function e(r){var f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f={},e.next=3,_.onBatchBegin(r,f);case 3:return HA((function(){var e=c[r][0],d=c[r][1],p=VO(s,e,d-e);f.batch=r,f.size=d-e;for(var v=VF(a,p),m=n(v),y=0;y<i.length;++y){var b=m[y];f[i[y]]=b,qA(b)}if(r===c.length-1&&g)for(var k=t.testLoop(l,h,o),_=0;_<i.length;++_){var w=i[_],C=k[_];qA(C),u["val_"+w]=C}})),e.next=6,_.onBatchEnd(r,f);case 6:if(HD(f),!t.stopTraining_){e.next=9;break}return e.abrupt("return","break");case 9:case"end":return e.stop()}}),e)})),p=0;case 6:if(!(p<c.length)){e.next=14;break}return e.delegateYield(d(p),"t0",8);case 8:if("break"!==e.t0){e.next=11;break}return e.abrupt("break",14);case 11:++p,e.next=6;break;case 14:s.dispose();case 15:case"end":return e.stop()}}),e)}))(),"t0",4);case 4:return e.next=6,_.onEpochEnd(s,u);case 6:if(!t.stopTraining_){e.next=8;break}return e.abrupt("return","break");case 8:case"end":return e.stop()}}),e)})),x=p;case 13:if(!(x<s)){e.next=21;break}return e.delegateYield(C(x),"t0",15);case 15:if("break"!==e.t0){e.next=18;break}return e.abrupt("break",21);case 18:++x,e.next=13;break;case 21:return e.next=23,_.onTrainEnd();case 23:return e.next=25,t.history.syncData();case 25:return e.abrupt("return",t.history);case 26:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i,o,s,u,c,l,h,f,d,p,v){return e.apply(this,arguments)}}()(t,C,w,x,d,i.epochs,i.verbose,I,S,m,i.shuffle,A,i.initialEpoch);case 32:return e.abrupt("return",e.sent);case 33:return e.prev=33,t.isTraining=!1,jF(o,n),jF(s,a),jF(l,u),jF(h,c),null!=f&&GA(f),e.finish(33);case 36:case"end":return e.stop()}}),e,null,[[4,,33,36]])})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n,a));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"fitDataset",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n,a){var i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_,w,C,x,S,A,I,T,E,R,N,O,D,F,M,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=a.batchesPerEpoch,r.assert(null!=t.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),r.assert(null!=a,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),r.assert(null!=a.epochs&&a.epochs>0&&Number.isInteger(a.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(a.epochs)})),r.assert(!i||a.batchesPerEpoch>0&&Number.isInteger(a.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(a.batchesPerEpoch)})),r.assert(null==a.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!t.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return t.isTraining=!0,e.prev=4,(o=null!=a.validationData)&&(zF(a.validationData)?r.assert(null==a.validationBatches||a.validationBatches>0&&Number.isInteger(a.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(a.validationBatches)})):(c=function(e){if(3===e.length)throw new HN("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}(a.validationData),s=c.xs,u=c.ys)),l=t.makeTrainFunction(),h=t.getDedupedMetricsNames(),f=o?h.slice().concat(h.map((function(e){return"val_"+e}))):h.slice(),d=YD(a.callbacks,a.yieldEvery),p=null==a.verbose?1:a.verbose,v=JD(d,p,a.epochs,null,null,function(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}(n,a),null,o,f),m=v.callbackList,g=v.history,m.setModel(t),t.history=g,e.next=14,m.onTrainBegin();case 14:return t.stopTraining_=!1,y=null==a.initialEpoch?0:a.initialEpoch,e.next=18,n.iterator();case 18:b=e.sent;case 19:if(!(y<a.epochs)){e.next=89;break}return k={},e.next=23,m.onEpochBegin(y);case 23:if(_=0,w=0,e.t0=i,e.t0){e.next=29;break}return e.next=28,n.iterator();case 28:b=e.sent;case 29:if(i&&!(_<a.batchesPerEpoch)){e.next=82;break}return e.next=32,b.next();case 32:if(C=e.sent,!i||!C.done){e.next=36;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(a.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(_," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(a.batchesPerEpoch*a.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",82);case 36:if(null==C.value){e.next=63;break}return x=MF(t,C.value),S=x.xs,A=x.ys,(I={}).batch=w,I.size=S[0].shape[0],e.next=42,m.onBatchBegin(w,I);case 42:if(T=[],null==a.classWeight){e.next=55;break}E=NF(a.classWeight,t.outputNames),R=0;case 46:if(!(R<E.length)){e.next=55;break}return e.t1=T,e.next=50,OF(A[R],null,E[R]);case 50:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 52:++R,e.next=46;break;case 55:for(N=S.concat(A).concat(T),O=l(N),GA(N),D=0;D<h.length;++D)F=O[D],I[h[D]]=F,qA(F);return e.next=60,m.onBatchEnd(w,I);case 60:HD(I),w++,_++;case 63:if(!(i?_>=a.batchesPerEpoch:C.done)){e.next=78;break}if(!o){e.next=77;break}if(M=void 0,!zF(a.validationData)){e.next=74;break}return e.t4=YN,e.next=70,t.evaluateDataset(a.validationData,{batches:a.validationBatches});case 70:e.t5=e.sent,e.t3=(0,e.t4)(e.t5),e.next=75;break;case 74:e.t3=YN(t.evaluate(s,u,{batchSize:null==a.validationBatchSize?32:a.validationBatchSize,verbose:0}));case 75:for(M=e.t3,P=0;P<t.metricsNames.length;++P)k["val_".concat(t.metricsNames[P])]=M[P];case 77:return e.abrupt("break",82);case 78:if(!t.stopTraining_){e.next=80;break}return e.abrupt("break",82);case 80:e.next=29;break;case 82:return e.next=84,m.onEpochEnd(y,k);case 84:if(y++,!t.stopTraining_){e.next=87;break}return e.abrupt("break",89);case 87:e.next=19;break;case 89:return e.next=91,m.onTrainEnd();case 91:return e.next=93,t.history.syncData();case 93:return e.abrupt("return",t.history);case 94:return e.prev=94,t.isTraining=!1,e.finish(94);case 97:case"end":return e.stop()}}),e,null,[[4,,94,97]])})));return function(t,n,r){return e.apply(this,arguments)}}()(this,t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"trainOnBatch",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,s,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.standardizeUserData(t,n);case 2:r=e.sent,a=r[0],i=r[1],o=this.makeTrainFunction()(a.concat(i)),s=[],u=_createForOfIteratorHelper(o),e.prev=8,u.s();case 10:if((c=u.n()).done){e.next=18;break}return l=c.value,e.next=14,l.data();case 14:h=e.sent,s.push(h[0]);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),u.e(e.t0);case 23:return e.prev=23,u.f(),e.finish(23);case 26:return e.abrupt("return",(GA(o),ZN(s)));case 27:case"end":return e.stop()}}),e,this,[[8,20,23,26]])}))),function(e,t){return n.apply(this,arguments)})},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"dispose",value:function(){var e=_get(_getPrototypeOf(l.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=UA().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-UA().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"==typeof this.loss)e=$N(this.loss);else if(Array.isArray(this.loss)){var t,n=_createForOfIteratorHelper(this.loss);try{for(n.s();!(t=n.n()).done;){if("string"!=typeof t.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(AU){n.e(AU)}finally{n.f()}e=this.loss.map((function(e){return $N(e)}))}else{var r=Object.keys(this.loss);e={};for(var a=this.loss,i=0,o=r;i<o.length;i++){var s=o[i];if("string"!=typeof a[s])throw new Error("Serialization of non-string loss is not supported.");e[s]=$N(a[s])}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[$N(yF(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return $N(yF(e))}));var e={};for(var t in this.metrics)e[t]=$N(yF(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=QD(function e(t,n){if(null===t)return null;if("string"==typeof t)return JN(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],a=t.length,i=0;i<a;++i){var o=t[i];CF(n,i,o)?r.push(o):r.push(e(o,n))}return r}for(var s={},u=0,c=Object.keys(t);u<c.length;u++){var l=c[u],h=t[l];if("name"===l&&"string"==typeof h)s[l]=h;else{var f=JN(l);s[f]=e(h,f)}}return s}(e.optimizer_config));if("string"==typeof e.loss)t=JN(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return JN(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=JN(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return JN(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=JN(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a,i,o,u,c,l,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=7;break}if(0!==(r=s.getSaveHandlers(t)).length){e.next=4;break}throw new jN("Cannot find any save handlers for URL '".concat(t,"'"));case 4:if(!(r.length>1)){e.next=6;break}throw new jN("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 6:t=r[0];case 7:if(null!=t.save){e.next=9;break}throw new jN("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 9:return e.next=11,s.encodeWeights(this.getNamedWeights(n));case 11:if(a=e.sent,i={modelTopology:this.toJSON(null,!1),format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v2.0.1",convertedBy:null},null==n||!n.includeOptimizer||null==this.optimizer){e.next=27;break}return i.trainingConfig=this.getTrainingConfig(),u="optimizer",e.t0=s,e.next=19,this.optimizer.getWeights();case 19:return e.t1=e.sent,e.t2=u,e.next=23,e.t0.encodeWeights.call(e.t0,e.t1,e.t2);case 23:c=e.sent,l=c.data,h=c.specs,(o=a.specs).push.apply(o,_toConsumableArray(h)),a.data=s.concatenateArrayBuffers([a.data,l]);case 27:return e.abrupt("return",(null!=this.userDefinedMetadata&&(bF(this.userDefinedMetadata,this.name,!0),i.userDefinedMetadata=this.userDefinedMetadata),i.weightData=a.data,i.weightSpecs=a.specs,t.save(i)));case 28:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"setUserDefinedMetadata",value:function(e){bF(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}},{key:"stopTraining",set:function(e){this.stopTraining_=e},get:function(){return this.stopTraining_}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}}]),l}(function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=SD(a)}if(r.supportsMasking=!1,r.trainable_=!0,r.inputs=Array.isArray(e.inputs)?e.inputs.slice():[e.inputs],r.outputs=Array.isArray(e.outputs)?e.outputs.slice():[e.outputs],rO(r.inputs).length!==r.inputs.length)throw new jN("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));rO(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i,o=_createForOfIteratorHelper(r.outputs);try{for(o.s();!(i=o.n()).done;){var s=i.value,u=s.nodeIndex,c=s.tensorIndex;r.outputLayers.push(s.sourceLayer),r.outputLayersNodeIndices.push(u),r.outputLayersTensorIndices.push(c)}}catch(AU){o.e(AU)}finally{o.f()}var l,h=_createForOfIteratorHelper(r.inputs);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=f.sourceLayer,p=f.nodeIndex,v=f.tensorIndex;KN(0===p,"input layer has >1 nodes"),KN(0===v,"input layer has >1 tensors"),r.inputLayers.push(d),r.inputLayersNodeIndices.push(p),r.inputLayersTensorIndices.push(v)}}catch(AU){h.e(AU)}finally{h.f()}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var m=0;m<r.inputLayers.length;m++){var g=r.inputLayers[m];if(!(g instanceof WD))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(m," (0-based) originates ")+"from layer type ".concat(g.getClassName(),"."));r.inputNames.push(g.name),r.feedInputShapes.push(g.batchInputShape),r.feedInputNames.push(g.name)}var y,b=_createForOfIteratorHelper(r.outputLayers);try{for(b.s();!(y=b.n()).done;){var k=y.value;r.outputNames.push(k.name)}}catch(AU){b.e(AU)}finally{b.f()}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var _,w={},C={},x={},S={},A={},I=[],T=function e(t,a,i,o,s,u){null!=o&&null!=s&&null!=u||(o=t.sourceLayer,s=t.nodeIndex,u=t.tensorIndex);var c=o.inboundNodes[s];if(-1!==i.indexOf(c))throw new UN("The tensor ".concat(t.name,' at layer "').concat(o.name,'" ')+"is part of a cycle.");if(-1===a.indexOf(c)){r.containerNodes.add(n.nodeKey(o,s)),o.id in A||(A[o.id]=Object.keys(A).length),-1===i.indexOf(c)&&i.push(c);for(var l=c.inboundLayers.length,h=0;h<l;h++)e(c.inputTensors[h],a,i,c.inboundLayers[h],c.nodeIndices[h],c.tensorIndices[h]);for(a.push(c);i.indexOf(c)>=0;)i.splice(i.indexOf(c),1);I.push(c)}},E=[],R=[],N=_createForOfIteratorHelper(r.outputs);try{for(N.s();!(_=N.n()).done;){T(_.value,E,R)}}catch(AU){N.e(AU)}finally{N.f()}var O,D=_createForOfIteratorHelper(I.slice().reverse());try{for(D.s();!(O=D.n()).done;){var F=O.value;C[F.id]=F,F.id in w||(w[F.id]=0);var M=w[F.id];M=Math.max(M,null==x[F.outboundLayer.id]?0:x[F.outboundLayer.id]),x[F.outboundLayer.id]=M,S[F.outboundLayer.id]=F.outboundLayer,w[F.id]=M;for(var P=0;P<F.inboundLayers.length;P++){var z=F.inboundLayers[P].inboundNodes[F.nodeIndices[P]];w[z.id]=Math.max(M+1,null==w[z.id]?0:w[z.id]),C[z.id]=z}}}catch(AU){D.e(AU)}finally{D.f()}var L={};for(var B in w){var V=w[B];V in L||(L[V]=[]),L[V].push(C[B])}var W={};for(var U in x){var j=x[U];j in W||(W[j]=[]),W[j].push(S[U])}var H=Object.keys(W).map((function(e){return parseInt(e,10)})).sort(nO);r.layers=[];var G,q=_createForOfIteratorHelper(H);try{for(q.s();!(G=q.n()).done;){var K=W[G.value];K.sort((function(e,t){var n=A[e.id],r=A[t.id];return n<r?-1:n>r?1:0}));var X,Z=_createForOfIteratorHelper(K);try{for(Z.s();!(X=Z.n()).done;){var Y=X.value;Y instanceof n&&r.internalContainerRefs.push(Y),r.layers.push(Y)}}catch(AU){Z.e(AU)}finally{Z.f()}}}catch(AU){q.e(AU)}finally{q.f()}r.layersByDepth=W,H=Object.keys(L).map((function(e){return parseInt(e,10)})).sort(nO);var $,J=r.inputs.slice(),Q=[],ee=_createForOfIteratorHelper(H);try{for(ee.s();!($=ee.n()).done;){var te,ne=_createForOfIteratorHelper(L[$.value]);try{for(ne.s();!(te=ne.n()).done;){var re=te.value,ae=re.outboundLayer;if(null!=ae){var ie,oe=_createForOfIteratorHelper(re.inputTensors);try{for(oe.s();!(ie=oe.n()).done;){var se=ie.value;if(-1===J.indexOf(se))throw new UN("Graph disconnected: cannot obtain value for tensor ".concat(se)+' at layer "'.concat(ae.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(Q))}}catch(AU){oe.e(AU)}finally{oe.f()}var ue,ce=_createForOfIteratorHelper(re.outputTensors);try{for(ce.s();!(ue=ce.n()).done;){var le=ue.value;J.push(le)}}catch(AU){ce.e(AU)}finally{ce.f()}Q.push(ae.name)}}}catch(AU){ne.e(AU)}finally{ne.f()}}}catch(AU){ee.e(AU)}finally{ee.f()}r.nodesByDepth=L;var he,fe=r.layers.map((function(e){return e.name})),de=_createForOfIteratorHelper(fe);try{var pe=function(){var e=he.value,t=fe.filter((function(t){return t===e})).length;if(1!==t)throw new UN('The name "'.concat(e,'" is used ').concat(t," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(fe))};for(de.s();!(he=de.n()).done;)pe()}catch(AU){de.e(AU)}finally{de.f()}return r.outboundNodes=[],r.inboundNodes=[],new LD({outboundLayer:_assertThisInitialized(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,_possibleConstructorReturn(r)}return _createClass(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){var t,n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.numDisposedVariables+=r.dispose().numDisposedVariables}}catch(AU){n.e(AU)}finally{n.f()}var a,i=_createForOfIteratorHelper(this.internalContainerRefs);try{for(i.s();!(a=i.n()).done;){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(AU){i.e(AU)}finally{i.f()}}return e.refCountAfterDispose=this._refCount,e}},{key:"loadWeights",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r={},a=0,i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(t=i.n()).done;){var o,s=t.value,u=_createForOfIteratorHelper(s.weights);try{for(u.s();!(o=u.n()).done;){var c=o.value;if(null!=r[c.originalName])throw new jN("Duplicate weight name: ".concat(c.originalName));r[c.originalName]=c,a++}}catch(AU){u.e(AU)}finally{u.f()}}}catch(AU){i.e(AU)}finally{i.f()}var l=[];for(var h in e){var f=h;if(null==r[h]){var d=h.split("/");f=d.slice(0,-2).concat([d[d.length-1]]).join("/")}if(null!=r[f])l.push([r[f],e[h]]);else if(n)throw new jN("Provided weight data has no target variable: ".concat(h));delete r[f]}if(n){var p=[];for(var v in r)p.push(v);if(p.length>0)throw new jN("".concat(p.length," of ").concat(a," weights are not set: ")+"".concat(p))}DD(l)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers 2.0.1",t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=function e(t,n){if(null==t)return null;if("string"==typeof t)return $N(t);if("number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Array){for(var r=[],a=t.length,i=0;i<a;++i){var o=t[i];CF(n,i,o)?r.push(o):r.push(e(o,n))}return r}for(var s={},u=0,c=Object.keys(t);u<c.length;u++){var l=c[u],h=t[l];s[$N(l)]="name"!==l&&"className"!==l||"string"!=typeof h?e(h,l):h}return s}(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return HA((function(){e=YN(e);for(var r=new xF,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return IF(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return HA((function(){var r;return e=YN(e),r=null==t?qN(null,e.length):YN(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=ID(e);if(t.length!==this.inputLayers.length)throw new jN("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++)n[this.inputLayers[r].name+"_0_0"]=t[r];var a=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nO);if(a.length>1){var i,o=_createForOfIteratorHelper(a);try{for(o.s();!(i=o.n()).done;){var s,u=i.value,c=_createForOfIteratorHelper(this.nodesByDepth[u]);try{for(c.s();!(s=c.n()).done;){var l=s.value,h=l.outboundLayer;if(-1===this.inputLayers.map((function(e){return e.id})).indexOf(h.id)){for(var f=[],d=0;d<l.inboundLayers.length;d++)f.push(n["".concat(l.inboundLayers[d].name,"_").concat(l.nodeIndices[d],"_").concat(l.tensorIndices[d])]);for(var p=ID(h.computeOutputShape(ZN(f))),v=h.inboundNodes.indexOf(l),m=0;m<p.length;m++)n["".concat(h.name,"_").concat(v,"_").concat(m)]=p[m]}}}catch(AU){c.e(AU)}finally{c.f()}}}catch(AU){o.e(AU)}finally{o.f()}}for(var g=[],y=[],b=0;b<this.outputLayers.length;b++)y.push("".concat(this.outputLayers[b].name,"_").concat(this.outputLayersNodeIndices[b],"_").concat(this.outputLayersTensorIndices[b]));for(var k=0;k<y.length;k++){var _=y[k];KN(_ in n),g.push(n[_])}return ZN(g)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=qN(null,e.length));for(var n={},r=0;r<this.inputs.length;++r)n[this.inputs[r].id]=[e[r],t[r]];var a,i=_createForOfIteratorHelper(Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(nO));try{for(i.s();!(a=i.n()).done;){var o,s=a.value,u=_createForOfIteratorHelper(this.nodesByDepth[s]);try{for(u.s();!(o=u.n()).done;){var c,l=o.value,h=l.outboundLayer,f=l.inputTensors,d=l.outputTensors,p=new Array,v=_createForOfIteratorHelper(f);try{for(v.s();!(c=v.n()).done;){var m=c.value;m.id in n&&p.push(n[m.id])}}catch(AU){v.e(AU)}finally{v.f()}if(p.length===f.length){var g=void 0,y=void 0,b=void 0,k=void 0,_={};if(null!=l.callArgs&&(_=l.callArgs),1===p.length){var w=_slicedToArray(p[0],2),C=w[0],x=w[1];null==_.mask&&(_.mask=x),b=YN(h.call(C,_)),k=YN(h.computeMask(C,x)),g=[C],y=[x]}else g=p.map((function(e){return e[0]})),y=p.map((function(e){return e[1]})),null==_.mask&&(_.mask=y),b=YN(h.call(g,_)),k=YN(h.computeMask(g,y));if(h.activityRegularizer)throw new HN("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var S=0;S<d.length;++S)n[d[S].id]=[b[S],k[S]]}}}catch(AU){u.e(AU)}finally{u.f()}}}catch(AU){i.e(AU)}finally{i.f()}var A,I=[],T=[],E=[],R=_createForOfIteratorHelper(this.outputs);try{for(R.s();!(A=R.n()).done;){var N=A.value;KN(N.id in n,"Could not compute output ".concat(N.name," : ").concat(N.id));var O=_slicedToArray(n[N.id],2),D=O[0],F=O[1];E.push(D.shape),I.push(D),T.push(F)}}catch(AU){R.e(AU)}finally{R.f()}return[I,T,E]}},{key:"buildNodeConversionMap",value:function(e){var t,r,a={},i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o instanceof n?1:0;for(var s=0;s<o.inboundNodes.length;s++){var u=n.nodeKey(o,s);this.containerNodes.has(u)&&(a[u]=t,t+=1)}}}catch(AU){i.e(AU)}finally{i.f()}return a}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new jN("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new jN("Provide either a layer name or layer index");var n,r=_createForOfIteratorHelper(this.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.name===e)return a}}catch(AU){r.e(AU)}finally{r.f()}throw new jN("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return HA((function(){var t,r=[],a=_createForOfIteratorHelper(e.layers);try{for(a.s();!(t=a.n()).done;)for(var i=t.value,o=0;o<i.inboundNodes.length;++o){var s=n.nodeKey(i,o);e.containerNodes.has(s)&&r.push.apply(r,_toConsumableArray(i.calculateLosses()))}}catch(AU){a.e(AU)}finally{a.f()}return r}))}},{key:"getConfig",value:function(){var e,t={name:this.name},r=this.buildNodeConversionMap(this.layers),a=[],i=_createForOfIteratorHelper(this.layers);try{for(i.s();!(e=i.n()).done;){for(var o=e.value,s=o.getClassName(),u=o.getConfig(),c=[],l=0;l<o.inboundNodes.length;l++){var h=o.inboundNodes[l],f=n.nodeKey(o,l),d={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),d=h.callArgs}catch(AU){console.warn("Layer ".concat(o.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),d={}}if(h.inboundLayers.length>0){for(var p=[],v=0;v<h.inboundLayers.length;v++){var m=h.inboundLayers[v],g=h.tensorIndices[v],y=r[n.nodeKey(m,h.nodeIndices[v])];null==y&&(y=0),p.push([m.name,y,g,d])}c.push(p)}}}var b={};b.name=o.name,b.className=s,b.config=u,b.inboundNodes=c,a.push(b)}}catch(AU){i.e(AU)}finally{i.f()}t.layers=a;for(var k=[],_=0;_<this.inputLayers.length;_++){var w=this.inputLayers[_],C=n.nodeKey(w,this.inputLayersNodeIndices[_]);if(this.containerNodes.has(C)){var x=r[C];null==x&&(x=0),k.push([w.name,x,this.inputLayersTensorIndices[_]])}}t.inputLayers=k;for(var S=[],A=0;A<this.outputLayers.length;A++){var I=this.outputLayers[A],T=n.nodeKey(I,this.outputLayersNodeIndices[A]);if(this.containerNodes.has(T)){var E=r[T];null==E&&(E=0),S.push([I.name,E,this.outputLayersTensorIndices[A]])}}return t.outputLayers=S,t}},{key:"resetStates",value:function(){var e=this;HA((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new jN("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t=t.concat(r.trainableWeights)}}catch(AU){n.e(AU)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.nonTrainableWeights))}}catch(AU){n.e(AU)}finally{n.f()}if(!this.trainable){var a,i=[],o=_createForOfIteratorHelper(this.layers);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,_toConsumableArray(s.trainableWeights))}}catch(AU){o.e(AU)}finally{o.f()}return i.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){if(this._stateful)throw new jN("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e,t=_createForOfIteratorHelper(this.layers);try{for(t.s();!(e=t.n()).done;){if(e.value.stateful)return!0}}catch(AU){t.e(AU)}finally{t.f()}return!1}}],[{key:"fromConfig",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a,o=[],s=_createForOfIteratorHelper(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=u[0],l=u[1],h=u[2];if(n=null==u[3]?{}:u[3],!(c in r))return void i(e,t);var f=r[c];if(f.inboundNodes.length<=l)return void i(e,t);o.push(f.inboundNodes[l].outputTensors[h])}}catch(AU){s.e(AU)}finally{s.f()}o.length>0&&e.apply(ZN(o),n)}function s(e){var a=e.name,o=QD(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new jN("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var u,c=t.name,l=t.layers,h=_createForOfIteratorHelper(l);try{for(h.s();!(u=h.n()).done;){var f=u.value;s(f)}}catch(AU){h.e(AU)}finally{h.f()}for(;!aO(a);){var d,p=_createForOfIteratorHelper(l);try{for(p.s();!(d=p.n()).done;){var v=d.value,m=r[v.name];if(m.name in a){var g=a[m.name];delete a[m.name];var y,b=_createForOfIteratorHelper(g);try{for(b.s();!(y=b.n()).done;){var k=y.value;o(m,k)}}catch(AU){b.e(AU)}finally{b.f()}}}}catch(AU){p.e(AU)}finally{p.f()}}var _,w=[],C=[],x=t.inputLayers,S=_createForOfIteratorHelper(x);try{for(S.s();!(_=S.n()).done;){var A=_.value,I=A[0],T=A[1],E=A[2];KN(I in r),w.push(r[I].inboundNodes[T].outputTensors[E])}}catch(AU){S.e(AU)}finally{S.f()}var R,N=t.outputLayers,O=_createForOfIteratorHelper(N);try{for(O.s();!(R=O.n()).done;){var D=R.value,F=D[0],M=D[1],P=D[2];KN(F in r),C.push(r[F].inboundNodes[M].outputTensors[P])}}catch(AU){O.e(AU)}finally{O.f()}return new e({inputs:w,outputs:C,name:c})}}]),n}(VD));XF.className="Model",f.registerClass(XF);var ZF=function(e){_inherits(s,e);var t,n,a,i,o=_createSuper(s);function s(e){var t;if(_classCallCheck(this,s),e=e||{},(t=o.call(this,{inputs:[],outputs:[]})).trainable=!0,t.built=!1,t.name=null!=e.name?e.name:SD("sequential_"),null!=e.layers){var n,r=_createForOfIteratorHelper(e.layers);try{for(r.s();!(n=r.n()).done;){var a=n.value;t.add(a)}}catch(AU){r.e(AU)}finally{r.f()}}return _possibleConstructorReturn(t)}return _createClass(s,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new jN("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,n=e instanceof s||e instanceof XF;if(n){if(1!==(t=e).outputs.length)throw new jN("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new jN("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new jN("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var r=function(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new jN("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new WD({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new jN("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new jN("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=function e(t,n,r){if((null==n||null!=r&&r>0)&&(n=t.sourceLayer,r=t.nodeIndex),0===n.inboundNodes.length)return[t];var a=n.inboundNodes[r];if(0===a.inboundLayers.length)return a.inputTensors;for(var i=[],o=0;o<a.inboundLayers.length;o++){var s,u=_createForOfIteratorHelper(e(a.inputTensors[o],a.inboundLayers[o],a.nodeIndices[o]));try{for(u.s();!(s=u.n()).done;){var c=s.value;-1===i.indexOf(c)&&i.push(c)}}catch(AU){u.e(AU)}finally{u.f()}}return i}(this.outputs[0])}this.inboundNodes=[],new LD({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:qN(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var a=e.apply(this.outputs[0]);if(Array.isArray(a))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[a],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(ED(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new XF({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),_get(_getPrototypeOf(s.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),_get(_getPrototypeOf(s.prototype),"summary",this).call(this,e,t,n)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new UN("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new UN("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.evaluateDataset(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"fit",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){var r,a=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.length>2&&void 0!==a[2]?a[2]:{},this.built){e.next=3;break}throw new UN("The model needs to be compiled before being used.");case 3:return e.abrupt("return",this.model.fit(t,n,r));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"fitDataset",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.built){e.next=2;break}throw new UN("The model needs to be compiled before being used.");case 2:return e.abrupt("return",this.model.fitDataset(t,n));case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"trainOnBatch",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.model.trainOnBatch(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getConfig",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.layers);try{for(n.s();!(e=n.n()).done;){var r=e.value,a={};a.className=r.getClassName(),a.config=r.getConfig(),t.push(a)}}catch(AU){n.e(AU)}finally{n.f()}return{name:this.name,layers:t}}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"stopTraining",set:function(e){if(null==this.model)throw new jN("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e},get:function(){if(null==this.model)throw new jN("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}}],[{key:"fromConfig",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new jN("Legacy serialization format not supported yet.");n=t}else r.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),n=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof s))throw new HN("Sequential.fromConfig called on non-Sequential input: ".concat(o));var u,c=_createForOfIteratorHelper(n);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=QD(l,void 0,a);a&&h.setFastWeightInitDuringBuild(!0),o.add(h)}}catch(AU){c.e(AU)}finally{c.f()}return o}}]),s}(XF);ZF.className="Sequential",f.registerClass(ZF);var YF=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"getConfig",value:function(){return{}}}]),n}(f.Serializable),$F=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new HN("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return II(e)}(e,t)}}]),n}(YF);$F.className="elu",f.registerClass($F);var JF=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return iT(e)}}]),n}(YF);JF.className="selu",f.registerClass(JF);var QF=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return rT(e)}}]),n}(YF);QF.className="relu",f.registerClass(QF);var eM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return HA((function(){return LI(6,rT(e))}))}}]),n}(YF);eM.className="relu6",f.registerClass(eM);var tM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return e}}]),n}(YF);tM.className="linear",f.registerClass(tM);var nM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return Zw(e)}}]),n}(YF);nM.className="sigmoid",f.registerClass(nM);var rM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return function(e){return HA((function(){var t=b_(.5,Q_(.2,e));return Mw(t,0,1)}))}(e)}}]),n}(YF);rM.className="hardSigmoid",f.registerClass(rM);var aM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return nC(e)}}]),n}(YF);aM.className="softplus",f.registerClass(aM);var iM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return function(e){return HA((function(){return J_(e,Iw(e).add(1))}))}(e)}}]),n}(YF);iM.className="softsign",f.registerClass(iM);var oM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){return oC(e)}}]),n}(YF);oM.className="tanh",f.registerClass(oM);var sM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return BT(e,t)}}]),n}(YF);sM.className="softmax",f.registerClass(sM);var uM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return VT(e,t)}}]),n}(YF);function cM(e){return e.getClassName()}function lM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tO(e,f.SerializationMap.getMap().classNameMap,t,"activation")}function hM(e){if(null==e)return lM({className:"linear",config:{}});if("string"==typeof e){var t={};return t.className=e,t.config={},lM(t)}return e instanceof YF?e:lM(e)}uM.className="logSoftmax",f.registerClass(uM);var fM=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(f.Serializable),dM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this),function(e){if(null!=e&&"object"!=typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return _createClass(n,[{key:"apply",value:function(e){var t=this;return HA((function(){var n=P_([1]);return t.hasL1&&(n=b_(n,xw(Q_(t.l1,Iw(e))))),t.hasL2&&(n=b_(n,xw(Q_(t.l2,ZO(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(fM);dM.className="L1L2",f.registerClass(dM);var pM={l1l2:"L1L2"};function vM(e){return eO(e)}function mM(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return tO(e,f.SerializationMap.getMap().classNameMap,t,"regularizer")}function gM(e){return null==e?null:"string"==typeof e?mM({className:e in pM?pM[e]:e,config:{}}):e instanceof fM?e:mM(e)}var yM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return _createClass(n,[{key:"call",value:function(e,t){e=TD(e);var n=rT(e);return null!=this.maxValue&&(n=Mw(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);yM.className="ReLU",f.registerClass(yM);var bM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return _createClass(n,[{key:"call",value:function(e,t){var n=TD(e);return OI(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);bM.className="LeakyReLU",f.registerClass(bM);var kM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=_D(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=gM(e.alphaRegularizer),r.alphaConstraint=yO(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new jN("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=ED(e)).slice(1);if(null!=this.sharedAxes){var n,r=_createForOfIteratorHelper(this.sharedAxes);try{for(r.s();!(n=r.n()).done;){t[n.value-1]=1}}catch(AU){r.e(AU)}finally{r.f()}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var a={};if(null!=this.sharedAxes)for(var i=1;i<e.length;++i)a[i]=e[i];this.inputSpec=[new MD({ndim:e.length,axes:a})],this.built=!0}},{key:"call",value:function(e,t){return e=TD(e),XI(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:kD(this.alphaInitializer),alphaRegularizer:vM(this.alphaRegularizer),alphaConstraint:mO(this.alphaConstraint),sharedAxes:this.sharedAxes},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);kM.className="PReLU",f.registerClass(kM);var _M=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new HN("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,_possibleConstructorReturn(r)}return _createClass(n,[{key:"call",value:function(e,t){var n=TD(e);return II(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);_M.className="ELU",f.registerClass(_M);var wM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return _createClass(n,[{key:"call",value:function(e,t){var n=TD(e);return n.mul(LO(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);wM.className="ThresholdedReLU",f.registerClass(wM);var CM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new sM).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return _createClass(n,[{key:"call",value:function(e,t){var n=TD(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);function xM(e,t,n){if("number"==typeof e)return qN(e,t);if(e.length!==t)throw new jN("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if((i=a)!==parseInt(i.toString(),10))throw new jN("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e;var i}function SM(e,t,n,r){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;return null==e?e:(a="same"===n?e:e-(t+(t-1)*(i-1))+1,Math.floor((a+r-1)/r))}function AM(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+PO([n-t,0]);else{if("same"!==r)throw new jN("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function IM(e,t){return HA((function(){return xO(t),"channelsFirst"===t?BC(e,[0,2,3,1]):e}))}function TM(e,t){return HA((function(){return xO(t),"channelsFirst"===t?BC(e,[0,2,3,4,1]):e}))}function EM(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return HA((function(){if(null==i&&(i="channelsLast"),xO(i),3!==e.rank&&4!==e.rank)throw new jN("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new jN("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var u=IM(e,i);if("causal"===a)throw new HN("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return u=k.conv2d({x:u,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:s}),"channelsFirst"===i&&(u=BC(u,[0,3,1,2])),u}))}CM.className="Softmax",f.registerClass(CM);var RM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,sO(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new HN("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=xM(r.kernelSize,e,"kernelSize"),a.strides=xM(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,SO(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,xO(a.dataFormat),a.activation=hM(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=_D(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=yO(r.biasConstraint),a.biasRegularizer=gM(r.biasRegularizer),a.activityRegularizer=gM(r.activityRegularizer),a.dilationRate=xM(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new jN("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new jN("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new jN("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return _possibleConstructorReturn(a)}return _createClass(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:cM(this.activation),useBias:this.useBias,biasInitializer:kD(this.biasInitializer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),biasConstraint:mO(this.biasConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(KN("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!oO(e.kernelSize,"number",1,3))throw new jN("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(VD),NM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,sO(a.filters,"filters"),a.kernelInitializer=_D(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=yO(r.kernelConstraint),a.kernelRegularizer=gM(r.kernelRegularizer),a}return _createClass(n,[{key:"build",value:function(e){e=ED(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new jN("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:_defineProperty({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var t;e=TD(e);var r=null==n.bias?null:n.bias.read(),a=uO(n.activation.getClassName());if(null!=a&&2===n.rank)t=EM(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return HA((function(){if(null==i&&(i="channelsLast"),xO(i),3!==e.shape.length)throw new jN("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new jN("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new jN("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=BC(e,[0,2,1])),"causal"===a)throw new HN("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var s=yI(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(s=$O(s,n)),s}))}(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=EM(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new HN("convolutions greater than 3D are not implemented yet.");t=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return HA((function(){if(null==i&&(i="channelsLast"),xO(i),4!==e.rank&&5!==e.rank)throw new jN("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new jN("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var s=TM(e,i);if("causal"===a)throw new HN("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return s=kI(s,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(s=$O(s,n)),"channelsFirst"===i&&(s=BC(s,[0,4,1,2,3])),s}))}(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=ED(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=SM(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:kD(this.kernelInitializer),kernelRegularizer:vM(this.kernelRegularizer),kernelConstraint:mO(this.kernelConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new jN("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(RM),OM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,2,e),n.verifyArgs(e),r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!oO(e.kernelSize,"number",1,2))throw new jN("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(NM);OM.className="Conv2D",f.registerClass(OM);var DM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,3,e),n.verifyArgs(e),r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new jN("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(NM);DM.className="Conv3D",f.registerClass(DM);var FM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[new MD({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new jN("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return _possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){if(4!==(e=ED(e)).length)throw new jN("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new jN("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new MD({ndim:4,axes:_defineProperty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var t=TD(e);if(4!==t.shape.length)throw new jN("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape;"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var o=i[a],s=n.kernelSize[1],u=n.strides[1],c=[i[0],AM(i[r],n.strides[0],n.kernelSize[0],n.padding),AM(o,u,s,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=BC(t,[0,2,3,1]));var l=bI(t,n.kernel.read(),c,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(l=BC(l,[0,3,1,2])),null!=n.bias&&(l=$O(l,n.bias.read(),n.dataFormat)),null!=n.activation&&(l=n.activation.apply(l)),l}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=ED(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],u=this.strides[1];return a[t]=this.filters,a[n]=AM(a[n],s,i,this.padding),a[r]=AM(a[r],u,o,this.padding),a}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(OM);FM.className="Conv2DTranspose",f.registerClass(FM);var MM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;if(_classCallCheck(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new jN("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new jN("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new jN("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=_D(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=gM(r.depthwiseRegularizer),a.depthwiseConstraint=yO(r.depthwiseConstraint),a.pointwiseInitializer=_D(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=gM(r.pointwiseRegularizer),a.pointwiseConstraint=yO(r.pointwiseConstraint),_possibleConstructorReturn(a)}return _createClass(n,[{key:"build",value:function(e){if((e=ED(e)).length<this.rank+2)throw new jN("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new jN("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.inputSpec=[new MD({ndim:this.rank+2,axes:_defineProperty({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var t;if(e=TD(e),1===n.rank)throw new HN("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=BC(e,[0,2,3,1])),t=oT(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=$O(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=BC(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=kD(this.depthwiseInitializer),e.pointwiseInitializer=kD(this.pointwiseInitializer),e.depthwiseRegularizer=vM(this.depthwiseRegularizer),e.pointwiseRegularizer=vM(this.pointwiseRegularizer),e.depthwiseConstraint=mO(this.depthwiseConstraint),e.pointwiseConstraint=mO(this.pointwiseConstraint),e}}]),n}(NM);MM.className="SeparableConv";var PM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,2,e)}return n}(MM);PM.className="SeparableConv2D",f.registerClass(PM);var zM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!oO(e.kernelSize,"number",1,1))throw new jN("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(NM);zM.className="Conv1D",f.registerClass(zM);var LM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).cropping="number"==typeof e.cropping?[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){if(e=TD(e),"channelsLast"===n.dataFormat){var t=UO(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return UO(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=UO(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return UO(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);LM.className="Cropping2D",f.registerClass(LM);var BM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],null==e[2]?null:this.size[0]*e[2],null==e[3]?null:this.size[1]*e[3]]:[e[0],null==e[1]?null:this.size[0]*e[1],null==e[2]?null:this.size[1]*e[2],e[3]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){var t=TD(e),r=t.shape;if("channelsFirst"===n.dataFormat){var a=(t=BC(t,[0,2,3,1])).resizeNearestNeighbor([n.size[0]*r[2],n.size[1]*r[3]]);return BC(a,[0,3,1,2])}return t.resizeNearestNeighbor([n.size[0]*r[1],n.size[1]*r[2]])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);BM.className="UpSampling2D",f.registerClass(BM);var VM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=_D(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=yO(e.depthwiseConstraint),r.depthwiseRegularizer=gM(e.depthwiseRegularizer),r}return _createClass(n,[{key:"build",value:function(e){if((e=ED(e)).length<4)throw new jN("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new jN("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t];this.depthwiseKernel=this.addWeight("depthwise_kernel",[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier],null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.bias=this.useBias?this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return HA((function(){null==a&&(a="channelsLast"),xO(a);var o=IM(e,a);if(4!==e.rank)throw new jN("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new jN("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=CI(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=BC(o,[0,3,1,2])),o}))}(e=TD(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=$O(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=ED(e);var t="channelsFirst"===this.dataFormat?e[3]:e[2],n="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,r=SM("channelsFirst"===this.dataFormat?e[2]:e[1],this.kernelSize[0],this.padding,this.strides[0]),a=SM(t,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],n,r,a]:[e[0],r,a,n]}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=kD(this.depthwiseInitializer),e.depthwiseRegularizer=vM(this.depthwiseRegularizer),e.depthwiseConstraint=mO(this.depthwiseRegularizer),e}}]),n}(RM);VM.className="DepthwiseConv2D",f.registerClass(VM);var WM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return _createClass(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);if(0<n.rate&&n.rate<1){var a=null!=t.training&&t.training,i=n.getNoiseShape(r);return QO((function(){return JO(r,n.rate,i,n.seed)}),(function(){return r}),a)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return _get(_getPrototypeOf(n.prototype),"dispose",this).call(this)}}]),n}(VD);WM.className="Dropout",f.registerClass(WM);var UM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return _createClass(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(WM);UM.className="SpatialDropout1D",f.registerClass(UM);var jM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,sO(r.units,"units"),r.activation=hM(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=_D(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=_D(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=yO(e.kernelConstraint),r.biasConstraint=yO(e.biasConstraint),r.kernelRegularizer=gM(e.kernelRegularizer),r.biasRegularizer=gM(e.biasRegularizer),r.activityRegularizer=gM(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=ED(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:_defineProperty({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=ED(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r,a=TD(e),i=uO(n.activation.getClassName());return null!=i?r=KO(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=KO(a,n.kernel.read()),null!=n.bias&&(r=$O(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),biasInitializer:kD(this.biasInitializer),kernelRegularizer:vM(this.kernelRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),biasConstraint:mO(this.biasConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);jM.className="Dense",f.registerClass(jM);var HM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e=e||{})).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t,n=_createForOfIteratorHelper((e=ED(e)).slice(1));try{for(n.s();!(t=n.n()).done;){if(null==t.value)throw new jN('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(AU){n.e(AU)}finally{n.f()}return[e[0],DO(e,1)]}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new jN("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],DO(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);HM.className="Flatten",f.registerClass(HM);var GM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=hM(e.activation),r}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:cM(this.activation)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);GM.className="Activation",f.registerClass(GM);var qM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){return e=TD(e),t=e,r=n.n,HA((function(){if(2!==t.shape.length)throw new jN("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(t.shape.length," tensor."));return GO(BO(t,1),[1,r,1])}));var t,r}))}},{key:"getConfig",value:function(){var e={n:this.n},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);qM.className="RepeatVector",f.registerClass(qM);var KM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return _createClass(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var s=r[o];if(this.isUnknown(s)){if(null!==i)throw new jN("Can only specifiy one unknown dimension.");i=o}else a*=s}var u=DO(e);if(null!==i){if(0===a||u%a!=0)throw new jN(n);r[i]=u/a}else if(u!==a)throw new jN(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);KM.className="Reshape",f.registerClass(KM);var XM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var a;if(_classCallCheck(this,n),a=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var i=zO(1,e.dims.length+1);if(!r.arraysEqual(e.dims.slice().sort(),i))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return a.dims=e.dims,a.dimsIncludingBatch=[0].concat(a.dims),a.inputSpec=[new MD({ndim:a.dims.length+1})],_possibleConstructorReturn(a)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t=(e=ED(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return BC(TD(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);XM.className="Permute",f.registerClass(XM);var ZM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=TD(e);return gw(WI(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e),a=gw(WI(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(VD);ZM.className="Masking",f.registerClass(ZM);var YM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=null==e.inputLength?[a,null]:[a].concat(YN(e.inputLength))}return r.inputDim=e.inputDim,sO(r.inputDim,"inputDim"),r.outputDim=e.outputDim,sO(r.outputDim,"outputDim"),r.embeddingsInitializer=_D(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=gM(e.embeddingsRegularizer),r.activityRegularizer=gM(e.activityRegularizer),r.embeddingsConstraint=yO(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return HA((function(){return n.maskZero?(e=TD(e),WI(e,V_(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=ED(e),null==this.inputLength)return[].concat(_toConsumableArray(e),[this.outputDim]);var t=YN(this.inputLength);if(t.length!==e.length-1)throw new jN('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new jN('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(_toConsumableArray(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);return"int32"!==r.dtype&&(r=LO(r,"int32")),XO(n.embeddings.read(),r.as1D()).reshape(ED(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:kD(this.embeddingsInitializer),embeddingsRegularizer:vM(this.embeddingsRegularizer),activityRegularizer:vM(this.activityRegularizer),embeddingsConstraint:mO(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);YM.className="Embedding",f.registerClass(YM);var $M=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return _createClass(n,[{key:"mergeFunction",value:function(e){throw new HN}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new jN("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[ED(e)]),(e=e).length<2)throw new jN("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t,n=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;null!=a&&null!==a[0]&&n.push(a[0])}}catch(AU){r.e(AU)}finally{r.f()}if((n=rO(n)).length>1)throw new jN("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var i=null==e[0]?null:e[0].slice(1),o=1;o<e.length;++o){var s=null==e[o]?null:e[o].slice(1);i=this.computeElementwiseOpOutputShape(i,s)}var u=e.map((function(e){return e.length}));this.reshapeRequired=-1!==e.indexOf(null)||1!==rO(u).length}},{key:"call",value:function(e,t){var n=this;return HA((function(){if(e=e,n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a,i=PO(r),o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){for(var s=a.value,u=s.rank,c=0;c<i-u;++c)s=BO(s,1);t.push(s)}}catch(AU){o.e(AU)}finally{o.f()}return n.mergeFunction(t)}var l,h=!1,f=_createForOfIteratorHelper(e);try{for(f.s();!(l=f.n()).done;){var d=l.value,p=d.rank;if(null==p){var v=d.shape,m=v[0],g=v.slice(1).concat([m]),y=d.reshape([m].concat(DO(v.slice(1))));y=(y=BC(y,[1,0])).reshape(g),t.push(y),h=!0}else if(p>1){var b=zO(1,p).concat([0]);t.push(BC(d,b)),h=!0}else t.push(d)}}catch(AU){f.e(AU)}finally{f.f()}var k=n.mergeFunction(t),_=k.rank;if(h)if(null==_){var w=k.shape,C=w[w.length-1],x=[C].concat(w.slice(0,w.length-1));k=BC(k.reshape([-1,C]),[1,0]).reshape(x)}else if(_>1){var S=[_-1].concat(zO(0,_-1));k=BC(k,S)}return k}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==(e=e)[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a,i=[],o=_createForOfIteratorHelper(e);try{for(o.s();!(a=o.n()).done;){var s=a.value;null!=s&&null!==s[0]&&i.push(s[0])}}catch(AU){o.e(AU)}finally{o.f()}return t=1===(i=rO(i)).length?i.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return HA((function(){if(null==t)return null;if(!Array.isArray(t))throw new jN("`mask` should be an Array");if(!Array.isArray(e))throw new jN("`inputs` should be an Array");if(t.length!==e.length)throw new jN("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:G_(e,0)})))[0],r=1;r<t.length-1;++r)n=gx(n,t[r]);return n}))}}]),n}(VD),JM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return HA((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=b_(t,e[n]);return t}))}}]),n}($M);JM.className="Add",f.registerClass(JM);var QM=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return HA((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Q_(t,e[n]);return t}))}}]),n}($M);QM.className="Multiply",f.registerClass(QM);var eP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return HA((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=b_(t,e[n]);return Q_(1/e.length,t)}))}}]),n}($M);eP.className="Average",f.registerClass(eP);var tP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return HA((function(){for(var t=e[0],n=1;n<e.length;++n)t=NI(t,e[n]);return t}))}}]),n}($M);tP.className="Maximum",f.registerClass(tP);var nP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"mergeFunction",value:function(e){return HA((function(){for(var t=e[0],n=1;n<e.length;++n)t=LI(t,e[n]);return t}))}}]),n}($M);nP.className="Minimum",f.registerClass(nP);var rP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new jN("A `Concatenate` layer should be called on a list of at least 2 inputs");var t,n=!0,a=_createForOfIteratorHelper(e=e);try{for(a.s();!(t=a.n()).done;){if(null!=t.value){n=!1;break}}}catch(AU){a.e(AU)}finally{a.f()}if(!n){for(var i=[],o=0;o<e.length;++o){var s=e[o].slice();s.splice(this.axis,1);var u,c=!1,l=_createForOfIteratorHelper(i);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(r.arraysEqual(h,s)){c=!0;break}}}catch(AU){l.e(AU)}finally{l.f()}c||i.push(s)}if(i.length>1)throw new jN("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return HA((function(){return jO(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new jN("A `Concatenate` layer should be called on a list of inputs.");var t,n=e,r=n[0].slice(),a=this.axis<0?r.length+this.axis:this.axis,i=_createForOfIteratorHelper(n.slice(1));try{for(i.s();!(t=i.n()).done;){var o=t.value;if(null==r[a]||null==o[a]){r[a]=null;break}r[a]+=o[a]}}catch(AU){i.e(AU)}finally{i.f()}return r}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new jN("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new jN("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new jN("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return HA((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)a.push(null==t[i]?B_(e[i]).asType("bool"):t[i].rank<e[i].rank?G_(t[i],-1):t[i]);var o=W_(a,n.axis);return mw(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}($M);function aP(e,t){for(;e<0;)e+=t;return e}rP.className="Concatenate",f.registerClass(rP);var iP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return _createClass(n,[{key:"build",value:function(e){r.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new HN("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(t,n);if(t[a[0]]!==n[a[1]])throw new jN("Dimension incompatibility: "+"".concat(t[a[0]]," !== ").concat(n[a[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new jN("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],a=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return aP(t,e[n].shape.length)})):[aP(this.axes,n.shape.length),aP(this.axes,a.shape.length)],this.normalize&&(n=eF(n,t[0]),a=eF(a,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new HN("batchDot is not implemented for tensors of 4D or higher rank yet");if(r.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),r.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new HN("batchDot is not implemented for complex64-type Tensors yet.");var a=e.shape.length,i=t.shape.length;null==n&&(n=[a-1,i-2]);var o=n;return HA((function(){var n,r;if(a>i){n=a-i;for(var s=[],u=0;u<n;++u)s.push(1);t=t.reshape(t.shape.concat(s))}else if(i>a){n=i-a;for(var c=[],l=0;l<n;++l)c.push(1);e=e.reshape(e.shape.concat(c))}else n=0;if(r=2===e.shape.length&&2===t.shape.length?o[0]===o[1]?e.mul(t).sum(o[0]):e.transpose([1,0]).mul(t).sum(o[1]):e.matMul(t,o[0]!==e.shape.length-1,o[1]===t.shape.length-1),n>0){for(var h,f=[],d=h=a>i?a+i-3:a-1;d<h+n;++d)f.push(d);r=r.squeeze(f)}return 1===r.shape.length&&(r=r.expandDims(1)),r}))}(n,a,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[aP(this.axes,e.length),aP(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){r.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new HN("Dot layer does not support tensors of 4D or higher rank yet.");var a=this.interpretAxes(t,n);t.splice(a[0],1),n.splice(a[1],1),n.splice(0,1);var i=t.concat(n);return 1===i.length&&i.push(1),i}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}($M);iP.className="Dot",f.registerClass(iP);var oP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);return QO((function(){return qO(r.shape,0,n.stddev).add(r)}),(function(){return r}),t.training||!1)}))}}]),n}(VD);oP.className="GaussianNoise",f.registerClass(oP);var sP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t);var r=TD(e);return n.rate>0&&n.rate<1?QO((function(){var e=Math.sqrt(n.rate/(1-n.rate));return r.mul(qO(r.shape,1,e))}),(function(){return r}),t.training||!1):r}))}}]),n}(VD);sP.className="GaussianDropout",f.registerClass(sP);var uP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return _createClass(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||TD(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return HA((function(){if(n.rate<1&&n.rate>0){var r=n._getNoiseShape(e);return QO((function(){var t=TD(e),a=-1.7580993408473766,i=nx(nT(r),n.rate);i=LO(i,"float32");var o=Math.pow((1-n.rate)*(1+n.rate*Math.pow(a,2)),-.5),s=-o*a*n.rate;return t.mul(i).add(i.add(-1).mul(a)).mul(o).add(s)}),(function(){return TD(e)}),t.training||!1)}return e}))}}]),n}(VD);function cP(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=cI(e,t,n,r,a,o);else if(3===e.rank)i=lI(e,t,n,r,a,o);else{if(4!==e.rank)throw new HN("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=hI(e,t,n,r,a,o)}return i}uP.className="AlphaDropout",f.registerClass(uP);var lP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=_D(e.betaInitializer||"zeros"),r.gammaInitializer=_D(e.gammaInitializer||"ones"),r.movingMeanInitializer=_D(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=_D(e.movingVarianceInitializer||"ones"),r.betaConstraint=yO(e.betaConstraint),r.gammaConstraint=yO(e.gammaConstraint),r.betaRegularizer=gM(e.betaRegularizer),r.gammaRegularizer=gM(e.gammaRegularizer),r}return _createClass(n,[{key:"build",value:function(e){e=ED(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new jN("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new MD({ndim:e.length,axes:_defineProperty({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var a=null!=t.training&&t.training,i=TD(e),o=i.shape,s=o.length,u=zO(0,s),c=n.axis>=0?n.axis:n.axis+s;u.splice(c,1);var l=qN(1,s);l[c]=o[c];var h=u.slice();h.sort();var f=!r.arraysEqual(h,zO(0,s).slice(0,s-1));if(!a)return function(){if(f){var e=n.movingMean.read().reshape(l),t=n.movingVariance.read().reshape(l),r=n.center?n.beta.read().reshape(l):null,a=n.scale?n.gamma.read().reshape(l):null;return cP(i,e,t,r,a,n.epsilon)}return cP(i,n.movingMean.read(),n.movingVariance.read(),null==n.beta?null:n.beta.read(),null==n.gamma?null:n.gamma.read(),n.epsilon)}();var d=_slicedToArray(function(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return r.arraysEqual(a.slice().sort(),zO(0,e.rank-1))?function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return HA((function(){var i=Cw(e,r),o=i.mean,s=i.variance;return[cP(e,o,s,n,t,a),o,s]}))}(e,t,n,a,i):function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return HA((function(){var i,o=Cw(e,r),s=o.mean,u=o.variance,c=[],l=_createForOfIteratorHelper(zO(0,e.rank));try{for(l.s();!(i=l.n()).done;){var h=i.value;-1!==r.indexOf(h)?c.push(1):c.push(e.shape[h])}}catch(AU){l.e(AU)}finally{l.f()}var f=s.reshape(c),d=u.reshape(c),p=null==t?null:t.reshape(c),v=null==n?null:n.reshape(c);return[cP(e,f,d,v,p,a),s,u]}))}(e,t,n,a,i)}(i,n.gamma.read(),n.beta.read(),u,n.epsilon),3),p=d[0],v=d[1],m=d[2],g=function(e,t,n){HA((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return g(n.movingMean,v,n.momentum),g(n.movingVariance,m,n.momentum),p}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kD(this.betaInitializer),gammaInitializer:kD(this.gammaInitializer),movingMeanInitializer:kD(this.movingMeanInitializer),movingVarianceInitializer:kD(this.movingVarianceInitializer),betaRegularizer:vM(this.betaRegularizer),gammaRegularizer:vM(this.gammaRegularizer),betaConstraint:mO(this.betaConstraint),gammaConstraint:mO(this.gammaConstraint)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);lP.className="BatchNormalization",f.registerClass(lP);var hP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis,"number"==typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));var a,i=_createForOfIteratorHelper(r.axis);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(!Number.isInteger(o))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(AU){i.e(AU)}finally{i.f()}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=_D(e.betaInitializer||"zeros"),r.gammaInitializer=_D(e.gammaInitializer||"ones"),r.betaRegularizer=gM(e.betaRegularizer),r.gammaRegularizer=gM(e.gammaRegularizer),r.supportsMasking=!0,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){var t=(e=ED(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r,a=_createForOfIteratorHelper(this.axis);try{for(a.s();!(r=a.n()).done;){var i=r.value;if(i<0||i>=t)throw new Error("Invalid axis: ".concat(i))}}catch(AU){a.e(AU)}finally{a.f()}if(this.axis.length!==rO(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var o=this.axis.map((function(t){return e[t]}));this.gamma=this.scale?this.addWeight("gamma",o,"float32",this.gammaInitializer,this.gammaRegularizer,!0):null,this.beta=this.center?this.addWeight("beta",o,"float32",this.betaInitializer,this.betaRegularizer,!0):null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=TD(e),a=r.shape,i=a.length;return HA((function(){var e,t=Cw(r,n.axis,!0),o=t.mean,s=t.variance,u=qN(1,i),c=_createForOfIteratorHelper(n.axis);try{for(c.s();!(e=c.n()).done;){var l=e.value;u[l]=a[l]}}catch(AU){c.e(AU)}finally{c.f()}for(var h=function(e){return null!=e&&e.shape.length!==i&&n.axis!==[i-1]?e.reshape(u):e},f=h(n.gamma.read()),d=h(n.beta.read()),p=[],v=[],m=0;m<i;++m)-1!==n.axis.indexOf(m)?(p.push(a[m]),v.push(1)):(p.push(1),v.push(a[m]));return o=o.tile(p),s=s.tile(p),f=f.tile(v),d=d.tile(v),cP(r,o,s,d,f,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:kD(this.betaInitializer),gammaInitializer:kD(this.gammaInitializer),betaRegularizer:vM(this.betaRegularizer),gammaRegularizer:vM(this.gammaRegularizer)},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);hP.className="LayerNormalization",f.registerClass(hP);var fP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new jN("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"==typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new jN("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new jN("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new MD({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=ED(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return HA((function(){return t=TD(e),r=n.padding,a=n.dataFormat,HA((function(){if(4!==t.rank)throw new jN("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(t.rank,"-D tensor."));if(null==r&&(r=[[1,1],[1,1]]),2!==r.length||2!==r[0].length||2!==r[1].length)throw new jN("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==a&&(a="channelsLast"),"channelsLast"!==a&&"channelsFirst"!==a)throw new jN("Unknown data format: ".concat(a,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var e;return e="channelsFirst"===a?[[0,0],[0,0],r[0],r[1]]:[[0,0],r[0],r[1],[0,0]],zx(t,e)}));var t,r,a}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD);function dP(e,t,n,r,a,i){return HA((function(){var o;xO(a),AO(i),SO(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=IM(e,a);var s="same"===r?"same":"valid";return o="max"===i?MI(e,t,n,s):iI(e,t,n,s),"channelsFirst"===a&&(o=BC(o,[0,3,1,2])),o}))}function pP(e,t,n,r,a,i){return HA((function(){var o;xO(a),AO(i),SO(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=TM(e,a);var s="same"===r?"same":"valid";return o="max"===i?PI(e,t,n,s):oI(e,t,n,s),"channelsFirst"===a&&(o=BC(o,[0,4,1,2,3])),o}))}fP.className="ZeroPadding2D",f.registerClass(fP);var vP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"==typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new jN("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(sO(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"==typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new jN("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return sO(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,SO(r.padding),r.inputSpec=[new MD({ndim:3})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){var t=SM((e=ED(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){n.invokeCallHook(e,t),e=BO(TD(e),2);var r=n.poolingFunction(TD(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return K_(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD),mP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),dP(e,t,n,r,a,"max")}}]),n}(vP);mP.className="MaxPooling1D",f.registerClass(mP);var gP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),dP(e,t,n,r,a,"avg")}}]),n}(vP);gP.className="AveragePooling1D",f.registerClass(gP);var yP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new jN("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return sO(r.poolSize,"poolSize"),sO(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xO(r.dataFormat),SO(r.padding),r.inputSpec=[new MD({ndim:4})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){e=ED(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=SM(t,this.poolSize[0],this.padding,this.strides[0]),n=SM(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){return n.invokeCallHook(e,t),n.poolingFunction(TD(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD),bP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),dP(e,t,n,r,a,"max")}}]),n}(yP);bP.className="MaxPooling2D",f.registerClass(bP);var kP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),dP(e,t,n,r,a,"avg")}}]),n}(yP);kP.className="AveragePooling2D",f.registerClass(kP);var _P=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new jN("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return sO(r.poolSize,"poolSize"),sO(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xO(r.dataFormat),SO(r.padding),r.inputSpec=[new MD({ndim:5})],_possibleConstructorReturn(r)}return _createClass(n,[{key:"computeOutputShape",value:function(e){e=ED(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=SM(t,this.poolSize[0],this.padding,this.strides[0]),n=SM(n,this.poolSize[1],this.padding,this.strides[1]),r=SM(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return HA((function(){return n.invokeCallHook(e,t),n.poolingFunction(TD(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD),wP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),pP(e,t,n,r,a,"max")}}]),n}(_P);wP.className="MaxPooling3D",f.registerClass(wP);var CP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e)}return _createClass(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return xO(a),SO(r),pP(e,t,n,r,a,"avg")}}]),n}(_P);CP.className="AveragePooling3D",f.registerClass(CP);var xP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).inputSpec=[new MD({ndim:3})],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new HN}}]),n}(VD),SP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e||{})}return _createClass(n,[{key:"call",value:function(e,t){return HA((function(){var t=TD(e);return _w(t,1)}))}}]),n}(xP);SP.className="GlobalAveragePooling1D",f.registerClass(SP);var AP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),t.call(this,e||{})}return _createClass(n,[{key:"call",value:function(e,t){return HA((function(){var t=TD(e);return FI(t,1)}))}}]),n}(xP);AP.className="GlobalMaxPooling1D",f.registerClass(AP);var IP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,xO(r.dataFormat),r.inputSpec=[new MD({ndim:4})],r}return _createClass(n,[{key:"computeOutputShape",value:function(e){return e=e,"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new HN}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(VD),TP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return HA((function(){var t=TD(e);return _w(t,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(IP);TP.className="GlobalAveragePooling2D",f.registerClass(TP);var EP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return HA((function(){var t=TD(e);return FI(t,"channelsLast"===n.dataFormat?[1,2]:[2,3])}))}}]),n}(IP);function RP(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new jN("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function NP(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return HA((function(){var u=t.shape.length;if(u<3)throw new jN("Input should be at least 3D, but is ".concat(u,"D."));var c=[1,0].concat(zO(2,u));if(t=BC(t,c),null!=i)throw new HN("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===u-1&&(a=G_(a,-1)),a=BC(a,c)),r&&(t=bT(t,0),null!=a&&(a=bT(a,0)));var l,h,f,d=[],p=n,v=t.shape[0],m=Z_(t);null!=a&&(h=Z_(a));for(var g=function(t){var n=m[t],r=HA((function(){return e(n,p)}));if(null==a)l=r[0],p=r[1];else{var i=HA((function(){var e=h[t],n=B_(e).sub(e);return{output:r[0].mul(e).add(p[0].mul(n)),newStates:p.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));l=i.output,p=i.newStates}s&&d.push(l)},y=0;y<v;++y)g(y);return s&&(f=X_(d,1)),[l,f,p]}))}EP.className="GlobalMaxPooling2D",f.registerClass(EP);var OP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r,a;if(_classCallCheck(this,n),r=t.call(this,e),null==e.cell)throw new jN("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new VP({cells:e.cell}):e.cell).stateSize)throw new jN("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new MD({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],_possibleConstructorReturn(r)}return _createClass(n,[{key:"getStates",value:function(){return null==this.states_?zO(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){AD(e)&&(e=e[0]),e=e;var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a,i=[],o=_createForOfIteratorHelper(t);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push([e[0],s])}}catch(AU){o.e(AU)}finally{o.f()}return[n].concat(i)}return n}},{key:"computeMask",value:function(e,t){var n=this;return HA((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"build",value:function(e){if(null!=this.numConstants)throw new HN("Constants support is not implemented in RNN yet.");AD(e)&&(e=e[0]),e=e,this.inputSpec[0]=new MD({shape:[this.stateful?e[0]:null,null,e[e.length-1]]});var t,n=[e[0]].concat(e.slice(2));if(this.cell.build(n),t=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!r.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),t))throw new jN("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=t.map((function(e){return new MD({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];HA((function(){if(!t.stateful)throw new WN("Cannot call resetStates() on an RNN Layer that is not stateful.");var a=t.inputSpec[0].shape[0];if(null==a)throw new jN("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==t.states_)t.states_=Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return P_([a,e])})):[P_([a,t.cell.stateSize])];else if(null==e)GA(t.states_),null!=t.keptStates&&(GA(t.keptStates),t.keptStates=[]),Array.isArray(t.cell.stateSize)?t.states_=t.cell.stateSize.map((function(e){return P_([a,e])})):t.states_[0]=P_([a,t.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==t.states_.length)throw new jN("Layer ".concat(t.name," expects ").concat(t.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===n?t.keptStates.push(t.states_.slice()):GA(t.states_);for(var i=0;i<t.states_.length;++i){var o=e[i],s=Array.isArray(t.cell.stateSize)?t.cell.stateSize[i]:t.cell.stateSize,u=[a,s];if(!r.arraysEqual(o.shape,u))throw new jN("State ".concat(i," is incompatible with layer ").concat(t.name,": ")+"expected shape=".concat(u,", received shape=").concat(o.shape));t.states_[i]=o}}t.states_=t.states_.map((function(e){return qA(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=RP(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],s=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var u,c=_createForOfIteratorHelper(r);try{for(c.s();!(u=c.n()).done;){var l=u.value;this.stateSpec.push(new MD({shape:l.shape}))}}catch(AU){c.e(AU)}finally{c.f()}s=s.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof PD){var h=[e].concat(o),f=this.inputSpec.concat(s),d=this.inputSpec;this.inputSpec=f;var p=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=d,p}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return HA((function(){var r=null==t?null:t.mask,a=null==t?null:t.training,i=null==t?null:t.initialState;e=TD(e),null==i&&(i=n.stateful?n.states_:n.getInitialState(e));var o=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(i.length!==o)throw new jN("RNN Layer has ".concat(o," state(s) but was passed ")+"".concat(i.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:a},u=NP((function(e,t){var r=n.cell.call([e].concat(t),s);return[r[0],r.slice(1)]}),e,i,n.goBackwards,r,null,n.unroll,n.returnSequences),c=u[0],l=u[1],h=u[2];n.stateful&&n.resetStates(h,a);var f=n.returnSequences?l:c;return n.returnState?[f].concat(h):f}))}},{key:"getInitialState",value:function(e){var t=this;return HA((function(){var n=P_(e.shape);return n=BO(n=xw(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?GO(n,[1,e]):n})):t.cell.stateSize>1?[GO(n,[1,t.cell.stateSize])]:[n]}))}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var t=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:t};var r=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,r),e}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=QD(t.cell,n);return new e(Object.assign(t,{cell:r}))}}]),n}(VD);OP.className="RNN",f.registerClass(OP);var DP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(VD),FP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sO(r.units,"units"),r.activation=hM(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=_D(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=_D(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=_D(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=gM(e.kernelRegularizer),r.recurrentRegularizer=gM(e.recurrentRegularizer),r.biasRegularizer=gM(e.biasRegularizer),r.kernelConstraint=yO(e.kernelConstraint),r.recurrentConstraint=yO(e.recurrentConstraint),r.biasConstraint=yO(e.biasConstraint),r.dropout=MO([1,PO([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MO([1,PO([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(e){e=ED(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){if(2!==(e=e).length)throw new jN("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=WP((function(){return B_(e)}),n.dropout,i)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=WP((function(){return B_(r)}),n.recurrentDropout,i));var o=n.dropoutMask,s=n.recurrentDropoutMask;a=KO(null!=o?Q_(e,o):e,n.kernel.read()),null!=n.bias&&(a=$O(a,n.bias.read())),null!=s&&(r=Q_(r,s));var u=b_(a,KO(r,n.recurrentKernel.read()));return null!=n.activation&&(u=n.activation.apply(u)),[u,u]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(DP);FP.className="SimpleRNNCell",f.registerClass(FP);var MP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),e.cell=new FP(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return HA((function(){return null!=r.cell.dropoutMask&&(GA(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(GA(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(OP);MP.className="SimpleRNN",f.registerClass(MP);var PP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;if(_classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new jN("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,sO(r.units,"units"),r.activation=hM(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=hM(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=_D(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=_D(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=_D(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=gM(e.kernelRegularizer),r.recurrentRegularizer=gM(e.recurrentRegularizer),r.biasRegularizer=gM(e.biasRegularizer),r.kernelConstraint=yO(e.kernelConstraint),r.recurrentConstraint=yO(e.recurrentConstraint),r.biasConstraint=yO(e.biasConstraint),r.dropout=MO([1,PO([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MO([1,PO([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,_possibleConstructorReturn(r)}return _createClass(n,[{key:"build",value:function(e){e=ED(e),this.kernel=this.addWeight("kernel",[e[e.length-1],3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.bias=this.useBias?this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){if(2!==(e=e).length)throw new jN("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=WP((function(){return B_(e)}),n.dropout,r,3)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=WP((function(){return B_(a)}),n.recurrentDropout,r,3));var i,o,s,u=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Q_(e,n.dropoutMask[0]));var c=KO(e,n.kernel.read());n.useBias&&(c=$O(c,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Q_(a,u[0]));var l=n.recurrentKernel.read(),h=_slicedToArray(EC(l,[2*n.units,n.units],l.rank-1),2),f=h[0],d=h[1],p=KO(a,f),v=_slicedToArray(EC(c,3,c.rank-1),3),m=v[0],g=v[1],y=v[2],b=_slicedToArray(EC(p,2,p.rank-1),2),k=b[0],_=b[1];i=n.recurrentActivation.apply(b_(m,k)),o=n.recurrentActivation.apply(b_(g,_));var w=KO(Q_(o,a),d);s=n.activation.apply(b_(y,w));var C=b_(Q_(i,a),Q_(b_(1,Gw(i)),s));return[C,C]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),recurrentActivation:cM(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(DP);PP.className="GRUCell",f.registerClass(PP);var zP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new PP(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return HA((function(){return null!=r.cell.dropoutMask&&(GA(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(GA(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),recurrentActivation:cM(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(OP);zP.className="GRU",f.registerClass(zP);var LP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,sO(r.units,"units"),r.activation=hM(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=hM(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=_D(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=_D(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=_D(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=gM(e.kernelRegularizer),r.recurrentRegularizer=gM(e.recurrentRegularizer),r.biasRegularizer=gM(e.biasRegularizer),r.kernelConstraint=yO(e.kernelConstraint),r.recurrentConstraint=yO(e.recurrentConstraint),r.biasConstraint=yO(e.biasConstraint),r.dropout=MO([1,PO([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=MO([1,PO([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return _createClass(n,[{key:"build",value:function(e){var t,n;if(e=ED(e),this.kernel=this.addWeight("kernel",[e[e.length-1],4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var r=this.biasInitializer,a=this.units;n=new((t=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"apply",value:function(e,t){var n=r.apply([a]),i=(new aD).apply([a]),o=r.apply([2*a]);return HO(HO(n,i),o)}}]),n}(nD)).className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return HA((function(){var r=null!=t.training&&t.training;if(3!==(e=e).length)throw new jN("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=WP((function(){return B_(e)}),n.dropout,r,4)),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=WP((function(){return B_(a)}),n.recurrentDropout,r,4));var o,s,u,c,l=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Q_(e,n.dropoutMask[0]));var h=KO(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Q_(a,l[0])),h=b_(h,KO(a,n.recurrentKernel.read())),n.useBias&&(h=$O(h,n.bias.read()));var f=_slicedToArray(EC(h,4,h.rank-1),4),d=f[0],p=f[1],v=f[2],m=f[3];o=n.recurrentActivation.apply(d),s=n.recurrentActivation.apply(p),u=b_(Q_(s,i),Q_(o,n.activation.apply(v))),c=n.recurrentActivation.apply(m);var g=Q_(c,n.activation.apply(u));return[g,g,u]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),recurrentActivation:cM(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(DP);LP.className="LSTMCell",f.registerClass(LP);var BP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){return _classCallCheck(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new LP(e),t.call(this,e)}return _createClass(n,[{key:"call",value:function(e,t){var r=this;return HA((function(){return null!=r.cell.dropoutMask&&(GA(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(GA(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),_get(_getPrototypeOf(n.prototype),"call",r).call(r,e,{mask:null==t?null:t.mask,training:null==t?null:t.training,initialState:null==t?null:t.initialState})}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:cM(this.activation),recurrentActivation:cM(this.recurrentActivation),useBias:this.useBias,kernelInitializer:kD(this.kernelInitializer),recurrentInitializer:kD(this.recurrentInitializer),biasInitializer:kD(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:vM(this.kernelRegularizer),recurrentRegularizer:vM(this.recurrentRegularizer),biasRegularizer:vM(this.biasRegularizer),activityRegularizer:vM(this.activityRegularizer),kernelConstraint:mO(this.kernelConstraint),recurrentConstraint:mO(this.recurrentConstraint),biasConstraint:mO(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"unitForgetBias",get:function(){return this.cell.unitForgetBias}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(OP);BP.className="LSTM",f.registerClass(BP);var VP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).cells=e.cells,r}return _createClass(n,[{key:"call",value:function(e,t){var n=this;return HA((function(){var r,a=(e=e).slice(1),i=[],o=_createForOfIteratorHelper(n.cells.slice().reverse());try{for(o.s();!(r=o.n()).done;){var s=r.value;Array.isArray(s.stateSize)?i.push(a.splice(0,s.stateSize.length)):i.push(a.splice(0,1))}}catch(AU){o.e(AU)}finally{o.f()}i.reverse();for(var u,c=[],l=0;l<n.cells.length;++l){var h=n.cells[l];a=i[l],u=0===l?[e[0]].concat(a):[u[0]].concat(a),u=h.call(u,t),c.push(u.slice(1))}a=[];var f,d=_createForOfIteratorHelper(c.slice().reverse());try{for(d.s();!(f=d.n()).done;){var p,v=f.value;(p=a).push.apply(p,_toConsumableArray(v))}}catch(AU){d.e(AU)}finally{d.f()}return[u[0]].concat(a)}))}},{key:"build",value:function(e){var t;AD(e)&&(e=e[0]),e=e,this.cells.forEach((function(n,r){TO("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e,t=[],r=_createForOfIteratorHelper(this.cells);try{for(r.s();!(e=r.n()).done;){var a=e.value;t.push({className:a.getClassName(),config:a.getConfig()})}}catch(AU){r.e(AU)}finally{r.f()}var i={cells:t},o=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(i,o),i}},{key:"getWeights",value:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.weights))}}catch(AU){n.e(AU)}finally{n.f()}return OD(t)}},{key:"setWeights",value:function(e){var t,n=[],r=_createForOfIteratorHelper(this.cells);try{for(r.s();!(t=r.n()).done;)for(var a=t.value,i=e.splice(a.weights.length),o=0;o<a.weights.length;++o)n.push([a.weights[o],i[o]])}catch(AU){r.e(AU)}finally{r.f()}DD(n)}},{key:"stateSize",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells.slice().reverse());try{for(n.s();!(e=n.n()).done;){var r=e.value;Array.isArray(r.stateSize)?t.push.apply(t,_toConsumableArray(r.stateSize)):t.push(r.stateSize)}}catch(AU){n.e(AU)}finally{n.f()}return t}},{key:"trainableWeights",get:function(){if(!this.trainable)return[];var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.trainableWeights))}}catch(AU){n.e(AU)}finally{n.f()}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=_createForOfIteratorHelper(this.cells);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.push.apply(t,_toConsumableArray(r.nonTrainableWeights))}}catch(AU){n.e(AU)}finally{n.f()}if(!this.trainable){var a,i=[],o=_createForOfIteratorHelper(this.cells);try{for(o.s();!(a=o.n()).done;){var s=a.value;i.push.apply(i,_toConsumableArray(s.trainableWeights))}}catch(AU){o.e(AU)}finally{o.f()}return i.concat(t)}return t}}],[{key:"fromConfig",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],i=_createForOfIteratorHelper(t.cells);try{for(i.s();!(n=i.n()).done;){var o=n.value;a.push(QD(o,r))}}catch(AU){i.e(AU)}finally{i.f()}return new e({cells:a})}}]),n}(DP);function WP(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;function a(){return JO(e(),t)}if(r>1){for(var i=[],o=0;o<r;o++)i.push(QO(a,e,n));return i.map((function(e){return qA(e.clone())}))}return qA(QO(a,e,n).clone())}VP.className="StackedRNNCells",f.registerClass(VP);var UP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).layer=e.layer,r}return _createClass(n,[{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=QD(t.layer,n);delete t.layer;var a={layer:r};return Object.assign(a,t),new e(a)}}]),n}(VD),jP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;return _classCallCheck(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return _createClass(n,[{key:"build",value:function(e){if((e=ED(e)).length<3)throw new jN("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),_get(_getPrototypeOf(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=ED(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t);return[n[0],e[1]].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return HA((function(){return NP((function(e,r){return[TD(n.layer.call(e,t)),[]]}),e=TD(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(UP);jP.className="TimeDistributed",f.registerClass(jP);var HP=function(e){_inherits(n,e);var t=_createSuper(n);function n(e){var r;_classCallCheck(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=QD(i),a.goBackwards=!0!==a.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=a,r.backwardLayer=QD(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,iO(wO,"BidirectionalMergeMode",r.mergeMode),e.weights)throw new HN("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return _createClass(n,[{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=Math.floor(e.length/2);this.forwardLayer.setWeights(e.slice(0,t)),this.backwardLayer.setWeights(e.slice(t))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),a=a,this.returnState?(r=a.slice(1),t=a[0]):t=a[0],t=t,"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):ZN(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=RP(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t);var o=[],s=[];if(null!=r){var u=r.length;if(u%2>0)throw new jN("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,o.push.apply(o,_toConsumableArray(r));var c=r.map((function(e){return new MD({shape:e.shape})}));this.forwardLayer.stateSpec=c.slice(0,u/2),this.backwardLayer.stateSpec=c.slice(u/2),s.push.apply(s,_toConsumableArray(c))}if(null!=a)throw new HN("Support for constants in Bidirectional layers is not implemented yet.");for(var l=o[0]instanceof PD,h=0,f=o;h<f.length;h++){if(f[h]instanceof PD!==l)throw new jN("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}if(l){var d=[e].concat(o),p=this.inputSpec.concat(s),v=this.inputSpec;this.inputSpec=p;var m=_get(_getPrototypeOf(n.prototype),"apply",this).call(this,d,t);return this.inputSpec=v,m}return _get(_getPrototypeOf(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return HA((function(){var r,a,i,o,s=t.initialState;if(null==s)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var u=s.slice(0,s.length/2),c=s.slice(s.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:u})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=bT(a,1)),"concat"===n.mergeMode?o=jO([r,a]):"sum"===n.mergeMode?o=b_(r,a):"ave"===n.mergeMode?o=Q_(.5,b_(r,a)):"mul"===n.mergeMode?o=Q_(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;TO(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),TO(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"setFastWeightInitDuringBuild",value:function(e){_get(_getPrototypeOf(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=_get(_getPrototypeOf(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}}],[{key:"fromConfig",value:function(e,t){var n=QD(t.layer);if(delete t.layer,null!=t.numConstants)throw new HN("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(UP);function GP(e){return null===e?null:qP(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function qP(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof Ab))}function KP(e){return e instanceof Ab?{value:e.clone(),recurse:!1}:qP(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}HP.className="Bidirectional",f.registerClass(HP);var XP=function(){function e(t){if(_classCallCheck(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return _createClass(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t,n=_createForOfIteratorHelper(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.push(r)}}catch(AU){n.e(AU)}finally{n.f()}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),ZP=function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.call(this,n.INITIAL_CAPACITY)}return _createClass(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){_get(_getPrototypeOf(n.prototype),"isFull",this).call(this)&&this.expand(),_get(_getPrototypeOf(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(XP);ZP.INITIAL_CAPACITY=32;var YP,$P=function(){function e(){_classCallCheck(this,e)}var t,n,r,a,i,o;return _createClass(e,[{key:"toArray",value:(o=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.next();case 3:n=e.sent;case 4:if(n.done){e.next=11;break}return t.push(n.value),e.next=8,this.next();case 8:n=e.sent;case 9:e.next=4;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"toArrayForTest",value:(i=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.prefetch(100),n=[],e.next=3,t.next();case 3:r=e.sent;case 4:if(r.done){e.next=11;break}return n.push(r.value),e.next=8,t.next();case 8:r=e.sent;case 9:e.next=4;break;case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"resolveFully",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:t=e.sent;case 3:if(t.done){e.next=9;break}return e.next=6,this.next();case 6:t=e.sent;case 7:e.next=3;break;case 9:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"resolveWhile",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.next();case 2:n=e.sent,r=t(n.value);case 4:if(n.done||!r){e.next=11;break}return e.next=7,this.next();case 7:n=e.sent,r=t(n.value);case 9:e.next=4;break;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"handleErrors",value:function(e){return new oz(this,e)}},{key:"filter",value:function(e){return new az(this,e)}},{key:"map",value:function(e){return new iz(this,e)}},{key:"mapAsync",value:function(e){return new sz(this,e)}},{key:"serialMapAsync",value:function(e){return new sz(this,e).serial()}},{key:"flatmap",value:function(e){return new uz(this,e)}},{key:"forEachAsync",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.map(t).resolveFully());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"serialForEach",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.serialMapAsync(t).resolveWhile((function(e){return!0===e})));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new rz(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:GP;return this.rowMajorBatch(e,t).map((function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:GP;return function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,a=t[0];if(r.has(a))throw new Error("Circular references are not supported.");var i=n(t);if(i.recurse&&null!==i.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(i.recurse){if(qP(a)){var o=Array.isArray(a)?[]:{};r.add(a);var s=function(a){var i=e(t.map((function(e){return e[a]})),n,r);o[a]=i};for(var u in a)s(u);return r.delete(a),o}throw new Error("Can't recurse into non-iterable type: ".concat(a))}return i.value}(e,t)}(e,n)}))}},{key:"concatenate",value:function(e,t){return new cz(new JP([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new nz(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new tz(this,e)}},{key:"prefetch",value:function(e){return new lz(this,e)}},{key:"shuffle",value:function(e,t){return new hz(this,e,t)}},{key:"serial",value:function(){return new ez(this)}}]),e}(),JP=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e){var t;return _classCallCheck(this,r),(t=n.call(this)).items=e,t.trav=0,t}return _createClass(r,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.trav>=this.items.length)){e.next=2;break}return e.abrupt("return",{value:null,done:!0});case 2:return t=this.items[this.trav],e.abrupt("return",(this.trav++,{value:(n=t,function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==t)return null;if(a.has(t))throw new Error("Circular references are not supported.");if(r.has(t))return r.get(t);var i=n(t);if(i.recurse&&null!==i.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(i.recurse){if(qP(t)){var o=Array.isArray(t)?[]:{};for(var s in a.add(t),t){var u=e(t[s],n,r,a);o[s]=u}return a.delete(t),o}throw new Error("Can't recurse into non-iterable type: ".concat(t))}return r.set(t,i.value),i.value}(n,KP)),done:!1}));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}($P),QP=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e){var t;return _classCallCheck(this,r),(t=n.call(this)).nextFn=e,t}return _createClass(r,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",this.nextFn());case 4:throw e.prev=4,e.t0=e.catch(0),e.t0.message="Error thrown while iterating through a dataset: ".concat(e.t0.message),e.t0;case 7:case"end":return e.stop()}}),e,this,[[0,4]])}))),function(){return t.apply(this,arguments)})}]),r}($P),ez=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e){var t;return _classCallCheck(this,a),(t=r.call(this)).upstream=e,t.lastRead=Promise.resolve({value:null,done:!1}),t}return _createClass(a,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.upstream.next());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}($P),tz=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.maxCount=t,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.count++<this.maxCount)){e.next=9;break}return e.next=3,this.upstream.next();case 3:if(!(t=e.sent).done){e.next=6;break}return e.abrupt("return",t);case 6:GA(t.value);case 7:e.next=0;break;case 9:return e.abrupt("return",this.upstream.next());case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}($P),nz=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.maxCount=t,a.count=0,a}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}($P),rz=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.batchSize=t,n.enableSmallLastBatch=i,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[];case 1:if(!(t.length<this.batchSize)){e.next=10;break}return e.next=4,this.upstream.next();case 4:if(!(n=e.sent).done){e.next=7;break}return e.abrupt("return",this.enableSmallLastBatch&&t.length>0?{value:t,done:!1}:{value:null,done:!0});case 7:t.push(n.value);case 8:e.next=1;break;case 10:return e.abrupt("return",{value:t,done:!1});case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}($P),az=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.predicate=t,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done&&!this.predicate(t.value)){e.next=5;break}return e.abrupt("return",t);case 5:GA(t.value);case 6:e.next=0;break;case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}($P),iz=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:n=a.getTensorsInContainer(t.value),r=this.transform(t.value),i=a.getTensorsInContainer(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,a.isTensorInList(u,i)||u.dispose()}catch(AU){o.e(AU)}finally{o.f()}return e.abrupt("return",{value:r,done:!1});case 9:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}($P),oz=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).upstream=e,n.handler=t,n.count=0,n.lastRead=Promise.resolve({value:null,done:!1}),n}return _createClass(a,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.upstream.next();case 3:return e.abrupt("return",e.sent);case 6:if(e.prev=6,e.t0=e.catch(0),this.handler(e.t0)){e.next=10;break}return e.abrupt("return",{value:null,done:!0});case 10:e.next=0;break;case 12:case"end":return e.stop()}}),e,this,[[0,6]])}))),function(){return t.apply(this,arguments)})}]),a}($P),sz=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:return n=a.getTensorsInContainer(t.value),e.next=8,this.transform(t.value);case 8:r=e.sent,i=a.getTensorsInContainer(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,a.isTensorInList(u,i)||u.dispose()}catch(AU){o.e(AU)}finally{o.f()}return e.abrupt("return",{value:r,done:!1});case 13:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}($P),uz=function(e){_inherits(r,e);var t,n=_createSuper(r);function r(e,t){var a;return _classCallCheck(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return _createClass(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n,r,i,o,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.upstream.next();case 2:if(!(t=e.sent).done){e.next=5;break}return e.abrupt("return",!1);case 5:n=a.getTensorsInContainer(t.value),r=this.transform(t.value),i=a.getTensorsInContainer(r),this.outputQueue.pushAll(r),o=_createForOfIteratorHelper(n);try{for(o.s();!(s=o.n()).done;)u=s.value,a.isTensorInList(u,i)||u.dispose()}catch(AU){o.e(AU)}finally{o.f()}return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(){var e;return _classCallCheck(this,a),(e=r.call(this)).outputQueue=new ZP,e.lastRead=Promise.resolve({value:null,done:!1}),e}return _createClass(a,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==this.outputQueue.length()){e.next=7;break}return e.next=3,this.pump();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",{value:null,done:!0});case 5:e.next=0;break;case 7:return e.abrupt("return",{value:this.outputQueue.shift(),done:!1});case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}($P)),cz=function(e){_inherits(a,e);var t,n,r=_createSuper(a);function a(e,t){var n;return _classCallCheck(this,a),(n=r.call(this)).baseErrorHandler=t,n.lastRead=null,n.iterator=null,n.moreIterators=e,n}return _createClass(a,[{key:"summary",value:function(){return"TODO: fill in upstream of chained summaries -> Chained"}},{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.readFromChain(this.lastRead),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"readFromChain",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null!=this.iterator){e.next=9;break}return e.next=5,this.moreIterators.next();case 5:if(!(n=e.sent).done){e.next=8;break}return e.abrupt("return",{value:null,done:!0});case 8:this.iterator=n.value,null!=this.baseErrorHandler&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler));case 9:return e.next=11,this.iterator.next();case 11:return r=e.sent,e.abrupt("return",r.done?(this.iterator=null,this.readFromChain(t)):r);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),a}($P);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(YP||(YP={}));var lz=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new XP(r),a}return _createClass(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}($P),hz=function(e){_inherits(i,e);var t,n,a=_createSuper(i);function i(e,t,n){var o;return _classCallCheck(this,i),(o=a.call(this,e,t)).upstream=e,o.windowSize=t,o.upstreamExhausted=!1,o.random=YI.alea(n||r.now().toString()),o.lastRead=Promise.resolve({value:null,done:!1}),o}return _createClass(i,[{key:"next",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.lastRead=this.lastRead.then((function(){return t.serialNext()})),this.lastRead));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.upstreamExhausted||this.refill();case 1:if(this.buffer.isEmpty()){e.next=11;break}return t=this.chooseIndex(),e.next=5,this.buffer.shuffleExcise(t);case 5:if((n=e.sent).done){e.next=8;break}return e.abrupt("return",(this.refill(),n));case 8:this.upstreamExhausted=!0;case 9:e.next=1;break;case 11:return e.abrupt("return",{value:null,done:!0});case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(lz),fz=function(){function e(){_classCallCheck(this,e),this.size=null}var t,n,a;return _createClass(e,[{key:"batch",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;return r.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),t=this.size===1/0||null==this.size?this.size:n?Math.ceil(this.size/e):Math.floor(this.size/e),dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,n,pz));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"concatenate",value:function(e){var t,n=this;return t=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),t)}))),t)}},{key:"filter",value:function(e){var t,n=this;return t=this.size===1/0?1/0:null,dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return HA((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"forEachAsync",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.iterator();case 2:return e.abrupt("return",e.sent.forEachAsync(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"map",value:function(e){var t=this;return dz(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.map((function(t){return HA((function(){return e(t)}))})));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"mapAsync",value:function(e){var t=this;return dz(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.mapAsync(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var t=this;return dz(_asyncToGenerator(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.iterator();case 2:return n.abrupt("return",n.sent.prefetch(e));case 3:case"end":return n.stop()}}),n)}))),this.size)}},{key:"repeat",value:function(e){var t,n=this;return t=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(r=(a=function(){var e=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.iterator();case 2:return e.t0=e.sent,e.t1=!1,e.abrupt("return",{value:e.t0,done:e.t1});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),new QP(a)).take(e),new cz(r,void 0)));case 1:case"end":return t.stop()}}),t)}))),t)}},{key:"skip",value:function(e){var t,n=this;return t=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"shuffle",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var a=this,i=YI.alea(t||r.now().toString());return dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=i.int32(),n&&(r+=i.int32()),t.next=4,a.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,r.toString()));case 5:case"end":return t.stop()}}),t)}))),this.size)}},{key:"take",value:function(e){var t,n=this;return t=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,dz(_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),t)}))),t)}},{key:"toArray",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArray());case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"toArrayForTest",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.size!==1/0){e.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return e.next=4,this.iterator();case 4:return e.abrupt("return",e.sent.toArrayForTest());case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}();function dz(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(n){_inherits(i,n);var r,a=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=a.apply(this,arguments)).size=t,e}return _createClass(i,[{key:"iterator",value:(r=_asyncToGenerator(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}]),i}(fz))}function pz(e){return null===e?null:null==(t=e[0])||null===(n=t)||"object"!=typeof n&&"function"!=typeof n||Array.isArray(t)||"object"==typeof t&&t instanceof Ab||r.isTypedArray(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof Ab?X_(e):S_(e)}(e),recurse:!1}:{value:null,recurse:!0};var t,n}function vz(e,t,n,a){for(var i=r.getTypedArrayFromDType(a,r.sizeFromShape(n)),o=0;o<i.length;++o){for(var s=o*t,u=e[s],c=0;c<t;++c){var l=e[s+c];l>u&&(u=l)}i[o]=u}return i}function mz(e,t,n,a,i){for(var o=t.length,s=r.sizeFromShape(t),u=r.computeStrides(t),c=r.computeStrides(i),l=r.getTypedArrayFromDType(n,r.sizeFromShape(i)),h=0;h<s;++h){for(var f=r.indexToLoc(h,o,u),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[a[p]];l[r.locToIndex(d,o,c)]=e[h]}return l}function gz(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&r.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}function yz(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,h=a.effectiveFilterWidth,f=a.padInfo.top,d=a.padInfo.left,p="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=U_(a.outShape,n),m=v.values,g=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],b=a.outShape[3],k=0;k<a.batchSize;++k)for(var _=k*g,w=k*r[0],C=0;C<a.inChannels;++C)for(var x=0;x<a.outHeight;++x)for(var S=x*o-f,A=Math.max(0,S),I=Math.min(a.inHeight,l+S),T=_+x*y,E=0;E<a.outWidth;++E){for(var R=E*s-d,N=Math.max(0,R),O=Math.min(a.inWidth,h+R),D=p,F=0,M=0,P=A;P<I;P+=u){for(var z=w+P*r[1],L=N;L<O;L+=c){var B=e[z+L*r[2]+C];"max"===i&&B>D?D=B:"avg"===i&&(F+=B,M++)}if(isNaN(D))break}m[T+E*b+C]="avg"===i?F/M:D}return v}function bz(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=U_(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=r.padInfo.top,p=r.padInfo.left,v=U_(t,n,e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.outHeight;++y){for(var b=y*s-d,k=b;k<0;)k+=c;for(var _=Math.min(r.inHeight,h+b),w=0;w<r.outWidth;++w){for(var C=w*u-p,x=C;x<0;)x+=l;for(var S=Math.min(r.inWidth,f+C),A=Number.NEGATIVE_INFINITY,I=-1,T=k;T<_;T+=c)for(var E=T-b,R=x;R<S;R+=l){var N=R-C,O=v.get(m,T,R,g);O>A&&(A=O,I=a?i?((m*r.inHeight+T)*r.inWidth+R)*r.inChannels+g:(T*r.inWidth+R)*r.inChannels+g:E*f+N)}o.set(I,m,y,w,g)}}return o}fz.MAX_BUFFER_SIZE=1e4,Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");var kz=C.nonMaxSuppressionV3,_z=C.split,wz=C.tile,Cz=C.topkImpl,xz=C.whereImpl;function Sz(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}var Az=function(e){_inherits(i,e);var t,n,a=_createSuper(i);function i(){var e;return _classCallCheck(this,i),(e=a.call(this)).blockSize=48,e.firstUse=!0,e.data=new NR(_assertThisInitialized(e),WA()),e}return _createClass(i,[{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,cy().get("IS_NODE")&&w.warn("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r}},{key:"move",value:function(e,t,n,r){this.data.set(e,{values:t,dtype:r})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.readSync(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;if("complex64"===n){var a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return w.mergeRealAndImagArrays(a,i)}return this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return r.decodeString(e)}))}catch(a){throw new Error("Failed to decode encoded string bytes into utf-8")}return U_(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return WA().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}}},{key:"time",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.now(),e.abrupt("return",(t(),{kernelMs:r.now()-n}));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"complex",value:function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:WA().keep(e.clone()),imag:WA().keep(t.clone())},n}},{key:"real",value:function(e){return this.data.get(e.dataId).complexTensors.real.clone()}},{key:"imag",value:function(e){return this.data.get(e.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(e,t,n){if(gz(e,"slice"),o.isSliceContinous(e.shape,t,n)){var a=o.computeFlatOffset(t,e.strides),i=r.sizeFromShape(n);return S_(this.readSync(e.dataId).subarray(a,a+i),n,e.dtype)}for(var s=U_(n,e.dtype),u=this.bufferSync(e),c=0;c<s.size;++c){var l=s.indexToLoc(c).map((function(e,n){return e+t[n]}));s.values[c]=u.get.apply(u,_toConsumableArray(l))}return s.toTensor()}},{key:"stridedSlice",value:function(e,t,n,r){gz(e,"stridedSlice");var a=o.computeOutShape(t,n,r);if(a.some((function(e){return 0===e})))return S_([],a);for(var i=U_(a,e.dtype),s=this.bufferSync(e),u=0;u<i.size;u++){for(var c=i.indexToLoc(u),l=new Array(c.length),h=0;h<l.length;h++)l[h]=c[h]*r[h]+t[h];i.set.apply(i,[s.get.apply(s,l)].concat(_toConsumableArray(c)))}return i.toTensor()}},{key:"diag",value:function(e){for(var t=this.readSync(e.dataId),n=U_([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()}},{key:"unstack",value:function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;for(var u=new Array(n),c=0;c<u.length;c++)o[t]=c,u[c]=this.slice(e,o,s).reshape(r);return u}},{key:"reverse",value:function(e,t){gz(e,"reverse");for(var n=U_(e.shape,e.dtype),r=this.bufferSync(e),a=function(a){var i=n.indexToLoc(a),o=i.slice();t.forEach((function(t){return o[t]=e.shape[t]-1-o[t]})),n.set.apply(n,[r.get.apply(r,_toConsumableArray(o))].concat(_toConsumableArray(i)))},i=0;i<n.size;i++)a(i);return n.toTensor()}},{key:"concat",value:function(e,t){var n=this;if("complex64"===e[0].dtype){var a=e.map((function(e){return x_(e)})),i=e.map((function(e){return C_(e)}));return w_(this.concat(a,t),this.concat(i,t))}var o=e.map((function(e){var n=r.sizeFromShape(e.shape.slice(t));return e.as2D(-1,n)})),s=w.computeOutShape(o.map((function(e){return e.shape})),1),u=U_(s,e[0].dtype).values;if(1===o[0].shape[0]){var c=0;o.forEach((function(e){u.set(n.readSync(e.dataId),c),c+=e.size}))}else{var l=0;o.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,a=0;a<e.shape[0];++a)for(var i=a*s[1]+l,o=0;o<e.shape[1];++o)u[i+o]=t[r++];l+=e.shape[1]}))}var h=w.computeOutShape(e.map((function(e){return e.shape})),t);return S_(u,h,e[0].dtype)}},{key:"neg",value:function(e){return gz(e,"neg"),this.multiply(I_(-1),e)}},{key:"add",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,Fb(e.dtype,t.dtype),(function(e,t){return e+t}))}},{key:"addN",value:function(e){var t=this;gz(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=U_(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()}},{key:"softmax",value:function(e,t){var n=r.parseAxisParam([t],e.shape),a=FI(e,n),i=w.expandShapeToKeepDim(a.shape,n),o=this.subtract(e,a.reshape(i)),s=this.exp(o),u=this.sum(s,n).reshape(i);return J_(s,u)}},{key:"subtract",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,Fb(e.dtype,t.dtype),(function(e,t){return e-t}))}},{key:"pow",value:function(e,t){return gz([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))}},{key:"batchMatMul",value:function(e,t,n,r){gz([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=_slicedToArray(n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],3),h=l[0],f=l[1],d=l[2],p=_slicedToArray(r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],3),v=p[0],m=p[1],g=p[2],y=i*o,b=U_([s,i,o],e.dtype),k=b.values,_=this.blockSize,w=0;w<s;w++)for(var C=0;C<i;C+=_)for(var x=0;x<o;x+=_)for(var S=0;S<a;S+=_)for(var A=Math.min(C+_,i),I=Math.min(x+_,o),T=Math.min(S+_,a),E=C;E<A;E++)for(var R=x;R<I;R++){for(var N=0,O=S;O<T;O++)N+=u[w*h+E*f+O*d]*c[O*v+R*m+w*g];k[w*y+(E*o+R)]+=N}return b.toTensor()}},{key:"fusedBatchMatMul",value:function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,a);return i&&(u=this.add(u,i)),o&&(u=Sz(this,u,o,s)),u}},{key:"multiply",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,Fb(e.dtype,t.dtype),(function(e,t){return e*t}))}},{key:"floorDiv",value:function(e,t){return gz([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))}},{key:"sum",value:function(e,t){gz(e,"sum"),w.assertAxesAreInnerMostDims("sum",t,e.rank);for(var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=P_(a,Fb(e.dtype,"int32")),s=r.sizeFromShape(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var h=l*s,f=0,d=0;d<s;++d)f+=c[h+d];u[l]=f}return o}},{key:"prod",value:function(e,t){gz(e,"sum");for(var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=P_(a,Fb(e.dtype,"int32")),s=r.sizeFromShape(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var h=l*s,f=1,d=0;d<s;++d)f*=c[h+d];u[l]=f}return o}},{key:"unsortedSegmentSum",value:function(e,t,n){gz(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(var o=0;o<n;++o){var s=I_(o,"int32"),u=TI(s,t).asType("float32").mul(e).sum(0);r.push(u)}return X_(r)}},{key:"argMin",value:function(e,t){gz(e,"argMin");var n=[t];w.assertAxesAreInnerMostDims("argMin",n,e.rank);for(var a=_slicedToArray(w.computeOutAndReduceShapes(e.shape,n),2),i=a[0],o=a[1],s=P_(i,"int32"),u=r.sizeFromShape(o),c=this.readSync(s.dataId),l=this.readSync(e.dataId),h=0;h<c.length;++h){for(var f=h*u,d=l[f],p=0,v=0;v<u;++v){var m=l[f+v];m<d&&(d=m,p=v)}c[h]=p}return s}},{key:"argMax",value:function(e,t){gz(e,"argMax");var n=[t];w.assertAxesAreInnerMostDims("argMax",n,e.rank);for(var a=_slicedToArray(w.computeOutAndReduceShapes(e.shape,n),2),i=a[0],o=a[1],s=P_(i,"int32"),u=r.sizeFromShape(o),c=this.readSync(s.dataId),l=this.readSync(e.dataId),h=0;h<c.length;++h){for(var f=h*u,d=l[f],p=0,v=0;v<u;++v){var m=l[f+v];m>d&&(d=m,p=v)}c[h]=p}return s}},{key:"cumsum",value:function(e,t,n,r){if(gz(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(e.rank-1," ")+"but got axis=".concat(t));for(var a=Fb(e.dtype,"int32"),i=P_(e.shape,a),o=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var h=0;h<u;h++){var f=c(l,h);if(0===h)o[f]=n?0:s[f];else{var d=c(l,h-1);o[f]=n?s[d]+o[d]:s[f]+o[d]}}return i}},{key:"equal",value:function(e,t){return gz([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))}},{key:"notEqual",value:function(e,t){return gz([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))}},{key:"less",value:function(e,t){return gz([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))}},{key:"lessEqual",value:function(e,t){return gz([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))}},{key:"greater",value:function(e,t){return gz([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))}},{key:"greaterEqual",value:function(e,t){return gz([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))}},{key:"logicalNot",value:function(e){gz(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")}},{key:"logicalAnd",value:function(e,t){return gz([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))}},{key:"logicalOr",value:function(e,t){return gz([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))}},{key:"select",value:function(e,t,n){gz([e,t,n],"select");for(var a=this.readSync(e.dataId),i=this.readSync(t.dataId),o=this.readSync(n.dataId),s=P_(t.shape,Fb(t.dtype,n.dtype)),u=this.readSync(s.dataId),c=0,l=0===e.rank||e.rank>1||1===t.rank?1:r.sizeFromShape(t.shape.slice(1)),h=0;h<a.length;h++)for(var f=0;f<l;f++)u[c++]=1===a[h]?i[h]:o[h];return s}},{key:"where",value:function(e){gz([e],"where");var t=this.readSync(e.dataId);return xz(e.shape,t)}},{key:"topk",value:function(e,t,n){gz(e,"topk");var r=this.readSync(e.dataId);return Cz(r,e.shape,e.dtype,t,n)}},{key:"min",value:function(e,t){gz(e,"min"),w.assertAxesAreInnerMostDims("min",t,e.rank);for(var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=P_(a,e.dtype),s=r.sizeFromShape(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],d=0;d<s;++d){var p=c[h+d];p<f&&(f=p)}u[l]=f}return o}},{key:"minimum",value:function(e,t){return gz([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))}},{key:"mod",value:function(e,t){return gz([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))}},{key:"maximum",value:function(e,t){return gz([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))}},{key:"all",value:function(e,t){gz(e,"all"),w.assertAxesAreInnerMostDims("all",t,e.rank);for(var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=P_(a,e.dtype),s=r.sizeFromShape(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],d=0;d<s;++d){var p=c[h+d];f=f&&p}u[l]=f}return o}},{key:"any",value:function(e,t){gz(e,"any"),w.assertAxesAreInnerMostDims("any",t,e.rank);for(var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=P_(a,e.dtype),s=r.sizeFromShape(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var h=l*s,f=c[h],d=0;d<s;++d){var p=c[h+d];f=f||p}u[l]=f}return o}},{key:"squaredDifference",value:function(e,t){return gz([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))}},{key:"ceil",value:function(e){gz(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"floor",value:function(e){gz(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"sign",value:function(e){gz(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=t[r]<0?-1:t[r]>0?1:0;return this.makeOutput(n,e.shape,"float32")}},{key:"isNaN",value:function(e){gz(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"isInf",value:function(e){gz(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"isFinite",value:function(e){gz(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"round",value:function(e){gz(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);n[r]=t[r]-a<.5?Math.floor(t[r]):t[r]-a>.5?Math.ceil(t[r]):a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")}},{key:"exp",value:function(e){gz(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"expm1",value:function(e){gz(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"log",value:function(e){gz(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.log(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"log1p",value:function(e){gz(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.log1p(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"sqrt",value:function(e){gz(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.sqrt(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"rsqrt",value:function(e){gz(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/Math.sqrt(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"reciprocal",value:function(e){gz(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")}},{key:"linear",value:function(e){return e}},{key:"relu",value:function(e){gz(e,"relu");for(var t=P_(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t}},{key:"relu6",value:function(e){gz(e,"relu");for(var t=P_(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t}},{key:"prelu",value:function(e,t){return gz([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))}},{key:"elu",value:function(e){gz(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")}},{key:"eluDer",value:function(e,t){gz([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")}},{key:"selu",value:function(e){gz(e,"selu");for(var t=w.SELU_SCALEALPHA,n=w.SELU_SCALE,r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>=0?n*o:t*(Math.exp(o)-1)}return this.makeOutput(r,e.shape,"float32")}},{key:"clip",value:function(e,t,n){gz(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,"float32")}},{key:"abs",value:function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"complexAbs",value:function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r)t[r]=Math.hypot(n[2*r],n[2*r+1]);return this.makeOutput(t,e.shape,"float32")}},{key:"int",value:function(e){gz(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")}},{key:"sigmoid",value:function(e){gz(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")}},{key:"softplus",value:function(e){gz(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i,o=r[a]>-t,s=r[a]<t,u=Math.exp(r[a]);i=s?u:o?r[a]:Math.log(1+u),n[a]=i}return this.makeOutput(n,e.shape,"float32")}},{key:"sin",value:function(e){gz(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"cos",value:function(e){gz(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"tan",value:function(e){gz(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"asin",value:function(e){gz(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"acos",value:function(e){gz(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atan",value:function(e){gz(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atan2",value:function(e,t){return gz([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))}},{key:"sinh",value:function(e){gz(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"cosh",value:function(e){gz(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"tanh",value:function(e){gz(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),a=0;a<n.length;++a)t[a]=r.tanh(n[a]);return this.makeOutput(t,e.shape,"float32")}},{key:"asinh",value:function(e){gz(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"acosh",value:function(e){gz(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atanh",value:function(e){gz(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"erf",value:function(e){gz(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=w.ERF_P,a=w.ERF_A1,i=w.ERF_A2,o=w.ERF_A3,s=w.ERF_A4,u=w.ERF_A5,c=0;c<n.length;++c){var l=Math.sign(n[c]),h=Math.abs(n[c]),f=1/(1+r*h);t[c]=l*(1-((((u*f+s)*f+o)*f+i)*f+a)*f*Math.exp(-h*h))}return this.makeOutput(t,e.shape,"float32")}},{key:"step",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;gz(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];n[a]=isNaN(i)?NaN:i>0?1:t}return this.makeOutput(n,e.shape,"float32")}},{key:"fusedConv2d",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return a&&(s=this.add(s,a)),i&&(s=Sz(this,s,i,o)),s}},{key:"conv2d",value:function(e,t,n){gz([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=U_(n.outShape,e.dtype),h=e.strides[0],f=c?e.strides[1]:e.strides[2],d=c?e.strides[2]:1,p=c?1:e.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(e.dataId),k=this.readSync(t.dataId),_=l.values,w=0;w<n.batchSize;++w)for(var C=w*h,x=w*v,S=0;S<n.outHeight;++S)for(var A=x+S*m,I=S*n.strideHeight-u,T=0;T<r;T++){var E=I+T*i;if(!(E<0||E>=n.inHeight))for(var R=T*t.strides[0],N=C+E*f,O=0;O<n.outWidth;++O)for(var D=A+O*g,F=O*n.strideWidth-s,M=0;M<a;M++){var P=F+M*o;if(!(P<0||P>=n.inWidth))for(var z=N+P*d,L=R+M*t.strides[1],B=0;B<n.inChannels;++B){for(var V=b[z+B*p],W=0;W<n.outChannels;++W)_[D+W*y]+=V*k[L+W];L+=n.outChannels}}}return l.toTensor()}},{key:"conv3d",value:function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,h=n.padInfo.top,f=U_(n.outShape,e.dtype),d=this.readSync(e.dataId),p=this.readSync(t.dataId),v=f.values,m=0;m<n.batchSize;++m)for(var g=m*e.strides[0],y=m*f.strides[0],b=0;b<n.outDepth;++b)for(var k=y+b*f.strides[1],_=b*n.strideDepth-c,w=0;w<r;w++){var C=_+w*o;if(!(C<0||C>=n.inDepth))for(var x=w*t.strides[0],S=g+C*e.strides[1],A=0;A<n.outHeight;++A)for(var I=k+A*f.strides[2],T=A*n.strideHeight-h,E=0;E<a;E++){var R=T+E*s;if(!(R<0||R>=n.inHeight))for(var N=x+E*t.strides[1],O=S+R*e.strides[2],D=0;D<n.outWidth;++D)for(var F=I+D*n.outChannels,M=D*n.strideWidth-l,P=0;P<i;P++){var z=M+P*u;if(!(z<0||z>=n.inWidth))for(var L=O+z*n.inChannels,B=N+P*t.strides[2],V=0;V<n.inChannels;++V){for(var W=d[L+V],U=0;U<n.outChannels;++U)v[F+U]+=W*p[B+U];B+=n.outChannels}}}}return f.toTensor()}},{key:"conv2dDerInput",value:function(e,t,n){gz([e,t],"conv2dDerInput");for(var r=U_(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),s=_slicedToArray(t.strides,3),u=s[0],c=s[1],l=s[2],h=n.batchSize,f=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,k=n.strideHeight,_=n.strideWidth,w=n.dataFormat,C=f-1-n.padInfo.top,x=d-1-n.padInfo.left,S="channelsLast"===w,A=r.strides[0],I=S?r.strides[1]:r.strides[2],T=S?r.strides[2]:1,E=S?1:r.strides[1],R=e.strides[0],N=S?e.strides[1]:e.strides[2],O=S?e.strides[2]:1,D=S?1:e.strides[1],F=0;F<h;++F)for(var M=0;M<p;++M)for(var P=0;P<v;++P)for(var z=P-C,L=Math.max(0,Math.ceil(z/k)),B=Math.min(y,(f+z)/k),V=0;V<m;++V){for(var W=V-x,U=Math.max(0,Math.ceil(W/_)),j=Math.min(b,(d+W)/_),H=0,G=L;G<B;++G)for(var q=G*k-z,K=U;K<j;++K)for(var X=R*F+N*G+O*K,Z=u*(f-1-q)+c*(d-1-(K*_-W))+l*M,Y=0;Y<g;++Y)H+=i[X+D*Y]*o[Z+Y];a[A*F+I*P+T*V+E*M]=H}return r.toTensor()}},{key:"conv3dDerInput",value:function(e,t,n){for(var r=U_(n.inShape,"float32"),a=r.values,i=_slicedToArray(r.strides,4),o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),h=_slicedToArray(e.strides,4),f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(t.dataId),g=_slicedToArray(t.strides,4),y=g[0],b=g[1],k=g[2],_=g[3],w=n.batchSize,C=n.filterDepth,x=n.filterHeight,S=n.filterWidth,A=n.inChannels,I=n.inDepth,T=n.inHeight,E=n.inWidth,R=n.outChannels,N=n.outDepth,O=n.outHeight,D=n.outWidth,F=n.strideDepth,M=n.strideHeight,P=n.strideWidth,z=C-1-n.padInfo.front,L=x-1-n.padInfo.top,B=S-1-n.padInfo.left,V=0;V<w;++V)for(var W=0;W<A;++W)for(var U=0;U<I;++U)for(var j=U-z,H=Math.max(0,Math.ceil(j/F)),G=Math.min(N,(C+j)/F),q=0;q<T;++q)for(var K=q-L,X=Math.max(0,Math.ceil(K/M)),Z=Math.min(O,(x+K)/M),Y=0;Y<E;++Y){for(var $=Y-B,J=Math.max(0,Math.ceil($/P)),Q=Math.min(D,(S+$)/P),ee=0,te=H;te<G;++te)for(var ne=te*F-j,re=X;re<Z;++re)for(var ae=re*M-K,ie=J;ie<Q;++ie)for(var oe=f*V+d*te+p*re+v*ie,se=y*(C-1-ne)+b*(x-1-ae)+k*(S-1-(ie*P-$))+_*W,ue=0;ue<R;++ue)ee+=l[oe+ue]*m[se+ue];a[o*V+s*U+u*q+c*Y+W]=ee}return r.toTensor()}},{key:"conv2dDerFilter",value:function(e,t,n){gz([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=U_(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,h=this.bufferSync(e),f=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),m=0;m<o;++m)for(var g=Math.max(0,Math.ceil((c-m)/a)),y=Math.min(n.outWidth,(n.inWidth+c-m)/a),b=0;b<n.inChannels;++b)for(var k=0;k<n.outChannels;++k){for(var _=0,w=0;w<n.batchSize;++w)for(var C=p;C<v;++C)for(var x=d+C*r-l,S=g;S<y;++S){var A=m+S*a-c;_+=s?h.get(w,x,A,b)*f.get(w,C,S,k):h.get(w,b,x,A)*f.get(w,k,C,S)}u.set(_,d,m,b,k)}return u.toTensor()}},{key:"conv3dDerFilter",value:function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=U_(n.filterShape,"float32"),l=c.values,h=_slicedToArray(c.strides,4),f=h[0],d=h[1],p=h[2],v=h[3],m=this.readSync(t.dataId),g=_slicedToArray(t.strides,4),y=g[0],b=g[1],k=g[2],_=g[3],w=this.readSync(e.dataId),C=_slicedToArray(e.strides,4),x=C[0],S=C[1],A=C[2],I=C[3],T=n.padInfo.front,E=n.padInfo.left,R=n.padInfo.top,N=0;N<o;++N)for(var O=Math.max(0,Math.ceil((T-N)/r)),D=Math.min(n.outDepth,(n.inDepth+T-N)/r),F=N*f,M=0;M<s;++M)for(var P=Math.max(0,Math.ceil((R-M)/a)),z=Math.min(n.outHeight,(n.inHeight+R-M)/a),L=M*d+F,B=0;B<u;++B)for(var V=Math.max(0,Math.ceil((E-B)/i)),W=Math.min(n.outWidth,(n.inWidth+E-B)/i),U=B*p+L,j=0;j<n.inChannels;++j)for(var H=j*v+U,G=0;G<n.outChannels;++G){for(var q=0,K=0;K<n.batchSize;++K)for(var X=K*x,Z=K*y,Y=O;Y<D;++Y)for(var $=(N+Y*r-T)*S+X,J=Y*b+Z,Q=P;Q<z;++Q)for(var ee=(M+Q*a-R)*A+$,te=Q*k+J,ne=V;ne<W;++ne)q+=w[(B+ne*i-E)*I+ee+j]*m[ne*_+te+G];l[H+G]=q}return c.toTensor()}},{key:"fusedDepthwiseConv2D",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return a&&(s=this.add(s,a)),i&&(s=Sz(this,s,i,o)),s}},{key:"depthwiseConv2D",value:function(e,t,n){gz([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=U_(n.outShape,e.dtype),h=this.readSync(e.dataId),f=this.readSync(t.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*e.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,k=0;k<r;++k){var _=b+k*i;if(!(_<0||_>=n.inHeight))for(var w=k*t.strides[0],C=v+_*e.strides[1],x=0;x<n.outWidth;++x)for(var S=y+x*l.strides[2],A=x*n.strideWidth-u,I=0;I<a;++I){var T=A+I*o;if(!(T<0||T>=n.inWidth))for(var E=C+T*n.inChannels,R=S,N=w+I*t.strides[1],O=0;O<n.inChannels;++O){for(var D=h[E+O],F=0;F<c;++F)d[R+F]+=D*f[N+F];R+=c,N+=c}}}return l.toTensor()}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){gz([e,t],"depthwiseConv2DDerInput");for(var r=U_(n.inShape,"float32"),a=r.values,i=_slicedToArray(r.strides,3),o=i[0],s=i[1],u=i[2],c=this.readSync(e.dataId),l=_slicedToArray(e.strides,3),h=l[0],f=l[1],d=l[2],p=this.readSync(t.dataId),v=_slicedToArray(t.strides,3),m=v[0],g=v[1],y=v[2],b=n.batchSize,k=n.filterHeight,_=n.filterWidth,w=n.inChannels,C=n.inHeight,x=n.inWidth,S=n.outChannels,A=n.outHeight,I=n.outWidth,T=n.strideHeight,E=n.strideWidth,R=k-1-n.padInfo.top,N=_-1-n.padInfo.left,O=S/w,D=0;D<b;++D)for(var F=0;F<w;++F)for(var M=0;M<C;++M)for(var P=M-R,z=Math.max(0,Math.ceil(P/T)),L=Math.min(A,(k+P)/T),B=0;B<x;++B){for(var V=B-N,W=Math.max(0,Math.ceil(V/E)),U=Math.min(I,(_+V)/E),j=0,H=z;H<L;++H)for(var G=H*T-P,q=W;q<U;++q)for(var K=h*D+f*H+d*q,X=m*(k-1-G)+g*(_-1-(q*E-V))+y*F,Z=0;Z<O;++Z)j+=c[K+(F*O+Z)]*p[X+Z];a[o*D+s*M+u*B+F]=j}return r.toTensor()}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){gz([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=U_(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,h=this.bufferSync(e),f=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<o;++m)for(var g=Math.max(0,Math.ceil((u-m)/a)),y=Math.min(n.outWidth,(n.inWidth+u-m)/a),b=0;b<n.outChannels;++b){for(var k=Math.trunc(b/l),_=b%l,w=0,C=0;C<n.batchSize;++C)for(var x=p;x<v;++x)for(var S=d+x*r-c,A=g;A<y;++A)w+=h.get(C,S,m+A*a-u,k)*f.get(C,x,A,b);s.set(w,d,m,k,_)}return s.toTensor()}},{key:"tile",value:function(e,t){return gz(e,"tile"),wz(this.bufferSync(e),t)}},{key:"pad",value:function(e,t,n){gz(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),a=t.map((function(e){return e[0]})),i=this.bufferSync(e),o=U_(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),c=u.map((function(e,t){return e+a[t]}));o.set.apply(o,[i.get.apply(i,_toConsumableArray(u))].concat(_toConsumableArray(c)))}return o.toTensor()}},{key:"gather",value:function(e,t,n){gz([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=U_(r,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=a[u[n]];var l=o.locToIndex(c);i.values[s]=o.values[l]}return i.toTensor()}},{key:"batchToSpaceND",value:function(e,t,n){gz([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),a=w.getReshaped(e.shape,t,r),i=w.getPermuted(a.length,t.length),o=w.getReshapedPermuted(e.shape,t,r),s=w.getSliceBeginCoords(n,t.length),u=w.getSliceSize(o,n,t.length);return BC(e.reshape(a),i).reshape(o).slice(s,u)}},{key:"spaceToBatchND",value:function(e,t,n){gz([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,_toConsumableArray(n));for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=w.getReshaped(o.shape,t,r,!1),u=w.getPermuted(s.length,t.length,!1),c=w.getReshapedPermuted(o.shape,t,r,!1);return BC(o.reshape(s),u).reshape(c)}},{key:"maxPool",value:function(e,t){return gz(e,"maxPool"),yz(this.readSync(e.dataId),0,e.dtype,e.strides,t,"max").toTensor()}},{key:"maxPoolBackprop",value:function(e,t,n,r){gz([t,n],"maxPoolBackprop");for(var a=this.readSync(t.dataId),i=U_(r.outShape,t.dtype,bz(a,t.shape,t.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=h-1-r.padInfo.left,d=l-1-r.padInfo.top,p=U_(t.shape,"float32"),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var k=y-d,_=b-f,w=0,C=0;C<l;C+=u){var x=(k+C)/o;if(!(x<0||x>=r.outHeight||Math.floor(x)!==x))for(var S=0;S<h;S+=c){var A=(_+S)/s;if(!(A<0||A>=r.outWidth||Math.floor(A)!==A)){var I=l*h-1-i.get(m,x,A,g)===C*h+S?1:0;0!==I&&(w+=v.get(m,x,A,g)*I)}}}p.set(w,m,y,b,g)}return p.toTensor()}},{key:"avgPoolBackprop",value:function(e,t,n){gz([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,h=l-1-n.padInfo.left,f=c-1-n.padInfo.top,d=U_(t.shape,"float32"),p=1/(i*o),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var k=y-f,_=b-h,w=0,C=0;C<c;C+=s){var x=(k+C)/r;if(!(x<0||x>=n.outHeight||Math.floor(x)!==x))for(var S=0;S<l;S+=u){var A=(_+S)/a;A<0||A>=n.outWidth||Math.floor(A)!==A||(w+=v.get(m,x,A,g))}}d.set(w*p,m,y,b,g)}return d.toTensor()}},{key:"pool3d",value:function(e,t,n){gz(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),g=U_(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],k=t.outShape[2]*t.outShape[3]*t.outShape[4],_=t.outShape[3]*t.outShape[4],w=t.outShape[4],C=0;C<t.batchSize;++C)for(var x=C*b,S=C*e.strides[0],A=0;A<t.inChannels;++A)for(var I=0;I<t.outDepth;++I){for(var T=I*r-f,E=T;E<0;)E+=o;for(var R=Math.min(t.inDepth,c+T),N=x+I*k,O=0;O<t.outHeight;++O){for(var D=O*a-d,F=D;F<0;)F+=s;for(var M=Math.min(t.inHeight,l+D),P=N+O*_,z=0;z<t.outWidth;++z){for(var L=z*i-p,B=L;B<0;)B+=u;for(var V=Math.min(t.inWidth,h+L),W=P+z*w,U=v,j=0,H=0,G=E;G<R;G+=o){for(var q=S+G*e.strides[1],K=F;K<M;K+=s){for(var X=q+K*e.strides[2],Z=B;Z<V;Z+=u){var Y=m[X+Z*e.strides[3]+A];if("max"===n&&Y>U?U=Y:"avg"===n&&(j+=Y,H++),isNaN(U))break}if(isNaN(U))break}if(isNaN(U))break}y[W+A]="avg"===n?j/H:U}}}return g.toTensor()}},{key:"avgPool3d",value:function(e,t){return gz(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()}},{key:"avgPool3dBackprop",value:function(e,t,n){gz([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,h=n.dilationWidth,f=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=f-1-n.padInfo.front,m=p-1-n.padInfo.left,g=d-1-n.padInfo.top,y=U_(t.shape,"float32"),b=1/(o*s*u),k=this.bufferSync(e),_=0;_<n.batchSize;++_)for(var w=0;w<n.inChannels;++w)for(var C=0;C<n.inDepth;++C)for(var x=0;x<n.inHeight;++x)for(var S=0;S<n.inWidth;++S){for(var A=C-v,I=x-g,T=S-m,E=0,R=0;R<f;R+=c){var N=(A+R)/r;if(!(N<0||N>=n.outDepth||Math.floor(N)!==N))for(var O=0;O<d;O+=l){var D=(I+O)/a;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var F=0;F<p;F+=h){var M=(T+F)/i;M<0||M>=n.outWidth||Math.floor(M)!==M||(E+=k.get(_,N,D,M,w))}}}y.set(E*b,_,C,x,S,w)}return y.toTensor()}},{key:"maxPool3d",value:function(e,t){return gz(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()}},{key:"maxPool3dPositions",value:function(e,t){for(var n=U_(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,h=t.effectiveFilterWidth,f=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-f,k=b;k<0;)k+=o;for(var _=Math.min(t.inDepth,c+b),w=0;w<t.outHeight;++w){for(var C=w*a-d,x=C;x<0;)x+=s;for(var S=Math.min(t.inHeight,l+C),A=0;A<t.outWidth;++A){for(var I=A*i-p,T=I;T<0;)T+=u;for(var E=Math.min(t.inWidth,h+I),R=Number.NEGATIVE_INFINITY,N=-1,O=k;O<_;O+=o)for(var D=O-b,F=x;F<S;F+=s)for(var M=F-C,P=T;P<E;P+=u){var z=P-I,L=v.get(m,O,F,P,g);L>=R&&(R=L,N=D*l*h+M*l+z)}n.set(N,m,y,w,A,g)}}}return n.toTensor()}},{key:"maxPool3dBackprop",value:function(e,t,n,r){gz([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=h-1-r.padInfo.front,v=d-1-r.padInfo.left,m=f-1-r.padInfo.top,g=U_(t.shape,"float32"),y=this.bufferSync(a),b=this.bufferSync(e),k=0;k<r.batchSize;++k)for(var _=0;_<r.inChannels;++_)for(var w=0;w<r.inDepth;++w)for(var C=0;C<r.inHeight;++C)for(var x=0;x<r.inWidth;++x){for(var S=w-p,A=C-m,I=x-v,T=0,E=0;E<h;E+=u){var R=(S+E)/i;if(!(R<0||R>=r.outDepth||Math.floor(R)!==R))for(var N=0;N<f;N+=c){var O=(A+N)/o;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var D=0;D<d;D+=l){var F=(I+D)/s;if(!(F<0||F>=r.outWidth||Math.floor(F)!==F)){var M=h*f*d-1-y.get(k,R,O,F,_)===E*f*d+N*d+D?1:0;0!==M&&(T+=b.get(k,R,O,F,_)*M)}}}}g.set(T,k,w,C,x,_)}return g.toTensor()}},{key:"cast",value:function(e,t){return w.castTensor(e,t,this)}},{key:"reshape",value:function(e,t){return w.reshapeTensor(e,t)}},{key:"avgPool",value:function(e,t){return gz(e,"avgPool"),gz(e,"maxPool"),yz(this.readSync(e.dataId),0,e.dtype,e.strides,t,"avg").toTensor().toFloat()}},{key:"resizeBilinear",value:function(e,t,n,a){gz(e,"resizeBilinear");for(var i=_slicedToArray(e.shape,4),o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),h=new Float32Array(r.sizeFromShape([o,t,n,c])),f=[a&&t>1?s-1:s,a&&n>1?u-1:u],d=[a&&t>1?t-1:t,a&&n>1?n-1:n],p=0,v=f[0]/d[0],m=f[1]/d[1],g=0;g<o;g++)for(var y=0;y<t;y++)for(var b=v*y,k=Math.floor(b),_=b-k,w=Math.min(s-1,Math.ceil(b)),C=g*e.strides[0]+k*e.strides[1],x=g*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var A=m*S,I=Math.floor(A),T=A-I,E=Math.min(u-1,Math.ceil(A)),R=C+I*e.strides[2],N=x+I*e.strides[2],O=C+E*e.strides[2],D=x+E*e.strides[2],F=0;F<c;F++){var M=l[R+F],P=l[N+F],z=M+(l[O+F]-M)*T;h[p++]=z+(P+(l[D+F]-P)*T-z)*_}return S_(h,[o,t,n,c])}},{key:"resizeBilinearBackprop",value:function(e,t,n){gz([e,t],"resizeBilinearBackprop");for(var r=_slicedToArray(t.shape,4),a=r[0],i=r[1],o=r[2],s=r[3],u=_slicedToArray(e.shape,3),c=u[1],l=u[2],h=new Float32Array(a*i*o*s),f=[n&&c>1?i-1:i,n&&l>1?o-1:o],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=f[0]/d[0],v=f[1]/d[1],m=this.readSync(e.dataId),g=0,y=0;y<a;y++)for(var b=y*t.strides[0],k=0;k<c;k++)for(var _=k*p,w=Math.floor(_),C=Math.min(Math.ceil(_),i-1),x=b+w*t.strides[1],S=b+C*t.strides[1],A=_-w,I=1-A,T=0;T<l;T++)for(var E=T*v,R=Math.floor(E),N=Math.min(Math.ceil(E),o-1),O=E-R,D=1-O,F=x+R*t.strides[2],M=x+N*t.strides[2],P=S+R*t.strides[2],z=S+N*t.strides[2],L=I*D,B=I*O,V=A*D,W=A*O,U=0;U<s;U++){var j=m[g++];h[F+U]+=j*L,h[M+U]+=j*B,h[P+U]+=j*V,h[z+U]+=j*W}return N_(h,[a,o,i,s],t.dtype)}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){gz(e,"resizeNearestNeighbor");for(var a=_slicedToArray(e.shape,4),i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*u),h=[r&&t>1?o-1:o,r&&n>1?s-1:s],f=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=h[0]/f[0],p=h[1]/f[1],v=0,m=0;m<i;m++)for(var g=m*e.strides[0],y=0;y<t;y++)for(var b=d*y,k=g+Math.min(o-1,r?Math.round(b):Math.floor(b))*e.strides[1],_=0;_<n;_++)for(var w=p*_,C=k+Math.min(s-1,r?Math.round(w):Math.floor(w))*e.strides[2],x=0;x<u;x++)l[v++]=c[C+x];return S_(l,[i,t,n,u],e.dtype)}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){gz([e,t],"resizeNearestNeighborBackprop");for(var r=_slicedToArray(t.shape,4),a=r[0],i=r[1],o=r[2],s=r[3],u=_slicedToArray(e.shape,3),c=u[1],l=u[2],h=new Float32Array(a*i*o*s),f=this.readSync(e.dataId),d=[n&&c>1?i-1:i,n&&l>1?o-1:o],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,k=2*Math.ceil(y)+2,_=0;_<a;_++)for(var w=_*t.strides[0],C=0;C<i;C++)for(var x=w+C*t.strides[1],S=Math.floor(C*g),A=Math.floor(S-b/2),I=0;I<o;I++)for(var T=x+I*t.strides[2],E=Math.floor(I*y),R=Math.floor(E-k/2),N=0;N<s;N++){for(var O=0,D=0;D<b;D++){var F=D+A;if(!(F<0||F>=c)){var M=w+F*e.strides[1],P=F*v;if(C===Math.min(i-1,n?Math.round(P):Math.floor(P)))for(var z=0;z<k;z++){var L=z+R;if(!(L<0||L>=l)){var B=M+L*e.strides[2],V=L*m;I===Math.min(o-1,n?Math.round(V):Math.floor(V))&&(O+=f[B+N])}}}}h[T+N]=O}return N_(h,t.shape,t.dtype)}},{key:"batchNorm",value:function(e,t,n,r,a,i){gz([e,t,n,a,r],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=r?this.readSync(r.dataId):new Float32Array([0]),h=new Float32Array(o.length),f=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,b=0,k=0;k<o.length;++k)h[k]=l[m++]+(o[k]-s[g++])*c[y++]/Math.sqrt(u[b++]+i),m>=f&&(m=0),g>=v&&(g=0),y>=d&&(y=0),b>=p&&(b=0);return N_(h,e.shape)}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){gz(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),u=0;r<=a;r++){var c=s[r];u+=c*c}return u}for(var h=0;h<u;h++){var f=l(h),d=s[h]*Math.pow(n+r*f,-a);c[h]=d}return N_(c,e.shape)}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){gz(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),h=new Float32Array(e.size),f=e.size,d=0;d<f;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);g=i*g+a;for(var b=v;b<m;b++){var k=-2*i*o*c[b]*l[d]/g;d===b&&(k+=Math.pow(g,-o)),k*=u[d],h[b]+=k}}return N_(h,e.shape)}},{key:"multinomial",value:function(e,t,n,r){gz(e,"multinomial");for(var a=t?e:BT(e),i=a.shape[0],o=a.shape[1],s=P_([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var h=l*o,f=new Float32Array(o-1);f[0]=c[h];for(var d=1;d<f.length;++d)f[d]=f[d-1]+c[h+d];for(var p=YI.alea(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=f.length;for(var y=0;y<f.length;y++)if(g<f[y]){u[v+m]=y;break}}}return s}},{key:"oneHot",value:function(e,t,n,r){gz(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return E_(a,[e.size,t],"int32")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){gz(e,"nonMaxSuppression");var i=this.readSync(e.dataId),o=this.readSync(t.dataId);return kz(i,o,n,r,a)}},{key:"fft",value:function(e){return this.fftBatch(e,!1)}},{key:"ifft",value:function(e){return this.fftBatch(e,!0)}},{key:"fftBatch",value:function(e,t){for(var n=e.shape[0],r=e.shape[1],a=U_(e.shape,"float32"),i=U_(e.shape,"float32"),o=x_(e).as2D(n,r),s=C_(e).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),h=w_(c,l),f=this.readSync(this.fftImpl(h,t).dataId),d=0;d<r;d++){var p=w.getComplexWithIndex(f,d);a.values[u*r+d]=p.real,i.values[u*r+d]=p.imag}return w_(a.toTensor(),i.toTensor()).as2D(n,r)}},{key:"fftImpl",value:function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=w_(x_(a).div(I_(r)),C_(a).div(I_(r)))),a}var i=this.readSync(e.dataId),o=this.fourierTransformByMatmul(i,r,t),s=w.splitRealAndImagArrays(o);return w_(s.real,s.imag).as2D(e.shape[0],e.shape[1])}},{key:"isExponentOf2",value:function(e){return 0==(e&e-1)}},{key:"fftRadix2",value:function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=w.complexWithEvenIndex(r),o=w_(i.real,i.imag).as1D(),s=w.complexWithOddIndex(r),u=w_(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),u=this.fftRadix2(u,a,n);var c=w.exponents(t,n),l=w_(c.real,c.imag).mul(u),h=o.add(l),f=o.sub(l),d=x_(h).concat(x_(f)),p=C_(h).concat(C_(f));return w_(d,p).as1D()}},{key:"fourierTransformByMatmul",value:function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=w.exponent(a*s,t,n),c=w.getComplexWithIndex(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),w.assignToTypedArray(r,i,o,a)}return r}},{key:"depthToSpace",value:function(e,t,n){r.assert("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(n)})),r.assert(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)}));for(var a=e.shape[0],i=e.shape[1],o=e.shape[2],s=e.shape[3],u=i*t,c=o*t,l=s/(t*t),h=this.readSync(e.dataId),f=new Float32Array(a*u*c*l),d=0,p=0;p<a;++p)for(var v=0;v<u;++v)for(var m=Math.floor(v/t),g=v%t,y=0;y<c;++y)for(var b=Math.floor(y/t),k=(g*t+y%t)*l,_=0;_<l;++_)f[d++]=h[_+k+s*(b+o*(m+i*p))];return N_(f,[a,u,c,l])}},{key:"broadcastedBinaryOp",value:function(e,t,n,r){var a=w.assertAndGetBroadcastShape(e.shape,t.shape),i=U_(a,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=w.getBroadcastDims(e.shape,a),c=w.getBroadcastDims(t.shape,a),l=i.values;if(u.length+c.length===0)for(var h=0;h<l.length;++h)l[h]=r(o[h%o.length],s[h%s.length]);else for(var f=this.bufferSync(e),d=this.bufferSync(t),p=function(n){var a=i.indexToLoc(n),h=a.slice(-e.rank);u.forEach((function(e){return h[e]=0}));var p=f.locToIndex(h),v=a.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var m=d.locToIndex(v);l[n]=r(o[p],s[m])},v=0;v<l.length;++v)p(v);return i.toTensor()}},{key:"broadcastedBinaryComplexOp",value:function(e,t,n){var r=w.assertAndGetBroadcastShape(e.shape,t.shape),a=U_(r,"float32"),i=U_(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=w.getBroadcastDims(e.shape,r),c=w.getBroadcastDims(t.shape,r),l=a.values,h=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;f++){var d=f%o.length,p=f%s.length,v=n(o[2*d],o[2*d+1],s[2*p],s[2*p+1]);l[f]=v.real,h[f]=v.imag}else for(var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=a.indexToLoc(r),f=i.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var d=m.locToIndex(f),p=i.slice(-t.rank);c.forEach((function(e){return p[e]=0}));var v=g.locToIndex(p),y=n(o[2*d],o[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,h[r]=y.imag},b=0;b<l.length;b++)y(b);return this.complex(a.toTensor(),i.toTensor())}},{key:"split",value:function(e,t,n){return _z(e,t,n)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return _get(_getPrototypeOf(i.prototype),"epsilon",this).call(this)}},{key:"cropAndResize",value:function(e,t,n,r,a,i){for(var o=_slicedToArray(e.shape,4),s=o[0],u=o[1],c=o[2],l=o[3],h=t.shape[0],f=_slicedToArray(r,2),d=f[0],p=f[1],v=U_([h,d,p,l],"float32"),m=this.readSync(t.dataId),g=this.readSync(n.dataId),y=this.readSync(e.dataId),b=e.strides,k=v.strides,_=0;_<h;_++){var w=4*_,C=m[w],x=m[w+1],S=m[w+2],A=m[w+3],I=g[_];if(!(I>=s))for(var T=d>1?(S-C)*(u-1)/(d-1):0,E=p>1?(A-x)*(c-1)/(p-1):0,R=0;R<d;R++){var N=d>1?C*(u-1)+R*T:.5*(C+S)*(u-1);if(N<0||N>u-1)for(var O=0;O<p;O++)for(var D=0;D<l;D++)v.values[D+O*k[2]+R*k[1]+_*k[0]]=i;else if("bilinear"===a)for(var F=Math.floor(N),M=Math.ceil(N),P=N-F,z=0;z<p;z++){var L=p>1?x*(c-1)+z*E:.5*(x+A)*(c-1);if(L<0||L>c-1)for(var B=0;B<l;B++)v.values[B+z*k[2]+R*k[1]+_*k[0]]=i;else for(var V=Math.floor(L),W=Math.ceil(L),U=L-V,j=0;j<l;j++){var H=j+V*b[2]+F*b[1]+I*b[0],G=y[H],q=y[H=j+W*b[2]+F*b[1]+I*b[0]],K=y[H=j+V*b[2]+M*b[1]+I*b[0]],X=y[H=j+W*b[2]+M*b[1]+I*b[0]],Z=G+(q-G)*U;H=j+z*k[2]+R*k[1]+_*k[0],v.values[H]=Z+(K+(X-K)*U-Z)*P}}else for(var Y=0;Y<p;++Y){var $=p>1?x*(c-1)+Y*E:.5*(x+A)*(c-1);if($<0||$>c-1)for(var J=0;J<l;J++)v.values[J+Y*k[2]+R*k[1]+_*k[0]]=i;else for(var Q=Math.round($),ee=Math.round(N),te=0;te<l;te++)v.values[te+Y*k[2]+R*k[1]+_*k[0]]=y[te+Q*b[2]+ee*b[1]+I*b[0]]}}}return v.toTensor()}},{key:"sparseToDense",value:function(e,t,n,r){var a=w.calculateShapes(t,e,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,u=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,s,o,i,u,r,!1)}},{key:"gatherND",value:function(e,t){var n=t.shape,r=n[n.length-1],a=_slicedToArray(w.prepareAndValidate(e,t),4),i=a[0],o=a[1],s=a[2],u=a[3];if(0===o)return S_([],i,e.dtype);for(var c=new Cb([o,s],e.dtype),l=this.readSync(t.dataId),h=this.readSync(e.dataId),f=0;f<o;f++){for(var d=[],p=0,v=0;v<r;v++){var m=l[f*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: ".concat(d," does not index into ").concat(e.shape));for(var g=0;g<s;g++)c.values[f*s+g]=h[p*s+g]}return c.toTensor().reshape(i)}},{key:"scatterND",value:function(e,t,n){var r=w.calculateShapes(t,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=I_(0);return this.scatter(e,t,n,u,o,i,a,s,c,!0)}},{key:"fill",value:function(e,t,n){n=n||r.inferDtype(t);var a=r.getArrayFromDType(n,r.sizeFromShape(e));return a.fill(t),WA().makeTensor(a,e,n,this)}},{key:"onesLike",value:function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)}},{key:"zerosLike",value:function(e){var t=r.getArrayFromDType(e.dtype,r.sizeFromShape(e.shape));return this.makeOutput(t,e.shape,e.dtype)}},{key:"linspace",value:function(e,t,n){return w.linspaceImpl(e,t,n)}},{key:"scatter",value:function(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],h=this.readSync(e.dataId),f=this.readSync(t.dataId);if(0===r)return S_([],n,t.dtype);var d=new Cb(l,t.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<i;p++){for(var v=[],m=0,g=0;g<o;g++){var y=h[p*o+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var b=0;b<a;b++)c?d.values[m*a+b]+=f[p*a+b]:d.values[m*a+b]=0===t.rank?f[0]:f[p*a+b]}return d.toTensor().reshape(n)}}]),i}(OR);function Iz(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,a=n.backend,i=r.a,o=r.b,s=a;gz([i,o],e);var u=s.data.get(i.dataId).values,c=s.data.get(o.dataId).values,l=_slicedToArray(t(i.shape,o.shape,u,c,i.dtype),2),h=l[0],f=l[1];return{dataId:s.write(h,f,i.dtype),shape:f,dtype:i.dtype}}}}function Tz(e){return function(t,n,a,i,o){var s=w.assertAndGetBroadcastShape(t,n),u=s.length,c=r.computeStrides(s),l=r.sizeFromShape(s),h=r.getTypedArrayFromDType(o,l),f=t.length,d=n.length,p=r.computeStrides(t),v=r.computeStrides(n),m=w.getBroadcastDims(t,s),g=w.getBroadcastDims(n,s);if(m.length+g.length===0)for(var y=0;y<h.length;++y)h[y]=e(a[y%a.length],i[y%i.length]);else for(var b=function(t){var n=r.indexToLoc(t,u,c),o=n.slice(-f);m.forEach((function(e){return o[e]=0}));var s=r.locToIndex(o,f,p),l=n.slice(-d);g.forEach((function(e){return l[e]=0}));var y=r.locToIndex(l,d,v);h[t]=e(a[s],i[y])},k=0;k<h.length;++k)b(k);return[h,s]}}for(var Ez=Tz((function(e,t){return e/t})),Rz=Iz(mk,Ez),Nz={kernelName:Ok,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,a=e.backend,i=t.x,o=n.reductionIndices,s=a,u=i.shape,c=u.length,l=r.parseAxisParam(o,u),h=w.getAxesPermutation(l,c),f=s.data.get(i.dataId).values;if(null!=h){for(var d=new Array(c),p=0;p<d.length;p++)d[p]=u[h[p]];f=mz(f,u,i.dtype,h,d),l=w.getInnerMostAxes(l.length,c),u=d}gz(i,"max"),w.assertAxesAreInnerMostDims("max",l,c);var v=_slicedToArray(w.computeOutAndReduceShapes(u,l),2),m=v[0],g=v[1],y=vz(f,r.sizeFromShape(g),m,i.dtype);return{dataId:s.write(y,m,i.dtype),shape:m,dtype:i.dtype}}},Oz={kernelName:Lk,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,a=e.backend,i=t.x,o=n.filterSize,s=n.strides,u=n.pad,c=n.includeBatchInIndex,l=a;gz(i,"MaxPoolWithArgmax");var h=l.data.get(i.dataId).values,f=w.computePool2DInfo(i.shape,o,s,[1,1],u),d=_slicedToArray(function(e,t,n,a,i){var o=yz(e,0,n,r.computeStrides(t),i,"max"),s=bz(e,t,n,i,!0,a);return[o.values,s.values]}(h,i.shape,i.dtype,c,f),2),p=d[0],v=d[1],m=l.write(p,f.outShape,i.dtype),g=l.write(v,f.outShape,i.dtype);return[{dataId:m,shape:f.outShape,dtype:i.dtype},{dataId:g,shape:f.outShape,dtype:"int32"}]}},Dz=C.nonMaxSuppressionV5,Fz={kernelName:Hk,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n;gz(a,"NonMaxSuppressionWithScore");var h=l.data.get(a.dataId).values,f=l.data.get(i.dataId).values,d=Dz(h,f,o,s,u,c);return[d.selectedIndices,d.selectedScores]}},Mz={kernelName:a_,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;gz(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},Pz=Tz((function(e,t){var n=e-t;return n*n})),zz=0,Lz=[Fz,Mz,Iz(r_,Pz),Rz,{kernelName:s_,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm,o=r;gz(a,"transpose");for(var s=new Array(a.shape.length),u=0;u<s.length;u++)s[u]=a.shape[i[u]];var c=mz(o.data.get(a.dataId).values,a.shape,a.dtype,i,s);return{dataId:o.write(c,s,a.dtype),shape:s,dtype:a.dtype}}},Oz,Nz];zz<Lz.length;zz++){by(Lz[zz])}eI("cpu",(function(){return new Az}),1);var Bz,Vz,Wz,Uz={},jz={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Hz(e){e in Uz||(Uz[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Uz[e]}),!1),1===e?t.getContext("webgl",jz)||t.getContext("experimental-webgl",jz):t.getContext("webgl2",jz)}(e));var t=Uz[e];return t.isContextLost()?(delete Uz[e],Hz(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Uz[e])}function Gz(e,t){return[t,e]}function qz(e){var t=r.sizeFromShape(e),n=Math.ceil(t/4);return r.sizeToSquarishShape(n)}function Kz(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Xz(e,t){var n,r,a,i,o,s,u,c,l,h=e;return 2===cy().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,o=h.RED,s=4,u=1,c=h.HALF_FLOAT,l=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function Zz(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),r}function Yz(e){return!!(cy().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function $z(e,t,n){return oL(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Bz||(Bz={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Vz||(Vz={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Wz||(Wz={}));var Jz,Qz,eL=/ERROR: [0-9]+:([0-9]+):/g;function tL(e,t,n){if(Zz(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function nL(e,t,n,r,a,i,o,s){var u=e.getAttribLocation(n,r);return-1!==u&&(Zz(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,a)})),Zz(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,o,s)})),Zz(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function rL(e,t,n,r){Zz(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),Zz(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function aL(e,t,n){Zz(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),Zz(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function iL(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function oL(e,t,n,r){var a=Zz(e,t,(function(){return n()}));if(null==a)throw new Error(r);return a}function sL(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return r.sizeFromShape(e.slice(0,e.length-t))}function uL(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function cL(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[sL(e)].concat(_toConsumableArray(uL(e)))),t}function lL(e){return e%2==0}function hL(e,t){if(e=e.slice(-2),t=t.slice(-2),r.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],a=t.slice(-1)[0];if(n===a)return!0;if(lL(n)&&lL(a)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&lL(e[0])&&lL(t[0])}function fL(e,t){return null!=e.getExtension(t)}function dL(e){try{if(null!=Hz(e))return!0}catch(t){return!1}return!1}function pL(e){var t=Xz(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}var vL=cy();vL.registerFlag("HAS_WEBGL",(function(){return vL.getNumber("WEBGL_VERSION")>0})),vL.registerFlag("WEBGL_VERSION",(function(){return dL(2)?2:dL(1)?1:0})),vL.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===vL.get("WEBGL_VERSION")})),vL.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),vL.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),vL.registerFlag("WEBGL_PACK",(function(){return vL.getBool("HAS_WEBGL")})),vL.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_CLIP",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),vL.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_PACK_REDUCE",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_CONV_IM2COL",(function(){return vL.getBool("WEBGL_PACK")})),vL.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==Jz){var t=Hz(e);Jz=t.getParameter(t.MAX_TEXTURE_SIZE)}return Jz}(vL.getNumber("WEBGL_VERSION"))})),vL.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==Qz){var t=Hz(e);Qz=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Qz)}(vL.getNumber("WEBGL_VERSION"))})),vL.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=vL.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=Hz(e);return fL(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:fL(t,"EXT_disjoint_timer_query")?1:0}(e)})),vL.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return vL.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!i.isMobile()})),vL.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=Hz(e);if(1===e){if(!fL(t,"OES_texture_float"))return!1}else if(!fL(t,"EXT_color_buffer_float"))return!1;return pL(t)}(vL.getNumber("WEBGL_VERSION"))})),vL.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!vL.getBool("WEBGL_FORCE_F16_TEXTURES")&&vL.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),vL.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return function(e){if(0===e)return!1;var t=Hz(e);if(1!==e){if(fL(t,"EXT_color_buffer_float"))return pL(t);if(fL(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=Xz(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!fL(t,"OES_texture_float")&&!!fL(t,"WEBGL_color_buffer_float")&&pL(t)}(vL.getNumber("WEBGL_VERSION"))})),vL.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=vL.getNumber("WEBGL_VERSION"))&&null!=Hz(e).fenceSync;var e})),vL.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return vL.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0}));var mL=function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},gL=function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},yL=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=Math.ceil(t.inSize/a);r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));",";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat("max"===n?">":"<"," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")};function bL(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function kL(e,t){return 1===t?[e]:bL(e,t)}function _L(){var e,t,n,r,a,i,o,s,u,c;return 2===cy().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function wL(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",a=r.computeStrides(t);return a.map((function(t,r){return"".concat("int ".concat(e[r]," = ").concat(n," / ").concat(t),"; ",r===a.length-1?"int ".concat(e[r+1]," = ").concat(n," - ").concat(e[r]," * ").concat(t):"index -= ".concat(e[r]," * ").concat(t),";")})).join("")}function CL(e){var t=r.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}var xL="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",SL=w.getBroadcastDims,AL="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",IL="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",TL="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",EL="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function RL(e){return"offset".concat(e)}function NL(e){var t=e.name,n=r.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function OL(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function DL(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function FL(e,t){return t.map((function(t){return e[t]})).join(", ")}var ML=function e(t,n,a,i){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,r.assert(t.length>2,(function(){return"Packed arg".concat(a.charAt(0).toUpperCase()+a.slice(1)," supports only inputs with rank above 2.")}));var o=Math.ceil(t[t.length-1]/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),i||this.variableNames.push("bestIndicesA");var s,u,c=this.outputShape,l=c.length,h=OL(l),f=kL("coords",l);if(1===o){var d=OL(u=l+1);s="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[l-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(f.join(),", 0);\n        ++").concat(f[l-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[l-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(f.join(),", 0);\n        --").concat(f[l-2],";")}else u=l,s="\n        ".concat(h," sourceLocR = coords;\n        ++").concat(f[l-1],";\n        ").concat(h," sourceLocG = coords;\n        ++").concat(f[l-2],";\n        ").concat(h," sourceLocA = coords;\n        --").concat(f[l-1],";\n        ").concat(h," sourceLocB = coords;\n        --").concat(f[l-2],";");var p=["x","y","z","w","u","v"].slice(0,u),v="."+p[u-1],m=p.map((function(e){return"int "+e})),g=kL("sourceLocR",u-1).concat("inIdx.r"),y=kL("sourceLocG",u-1).concat("inIdx.g"),b=kL("sourceLocB",u-1).concat("inIdx.b"),k=kL("sourceLocA",u-1).concat("inIdx.a"),_="max"===a?"greaterThan":"lessThan",w=i?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(k.join(),")));"),C="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(k.join(),") : 0.)"),x=i?"":"\n      float getBestIndicesAChannel(".concat(m.join(),") {\n        return getChannel(getBestIndicesA(").concat(p.join(),"),\n                                          vec2(").concat(p.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(m.join(),") {\n        return getChannel(getA(").concat(p.join(),"),\n                               vec2(").concat(p.slice(-2).join(),"));\n      }\n      ").concat(x,"\n      void main() {\n        ").concat(h," coords = getOutputCoords();\n        bool hasNextCol = ").concat(f[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(f[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(s,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(v,", sourceLocG").concat(v,",\n          sourceLocB").concat(v,", sourceLocA").concat(v,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(w,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(_,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")},PL=function e(t){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(t.filterHeight*t.filterWidth),");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n            wR += ").concat(t.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,";\n            wC+= ").concat(t.dilationWidth,") {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},zL=function e(t){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.effectiveFilterDepth,r=t.effectiveFilterHeight,a=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n      const float avgMultiplier = float(").concat(1/(t.filterDepth*t.filterHeight*t.filterWidth),");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n            wD += ").concat(t.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(t.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(a,";\n                wC += ").concat(t.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},LL=function e(t,n,r,a,i,o){_classCallCheck(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],w.assertAndGetBroadcastShape(t,n),w.assertAndGetBroadcastShape(t,r);var s="0.0";null!=a&&(w.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="1.0";null!=i&&(w.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(s,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},BL=function e(t,n,r,a,i,o){_classCallCheck(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],w.assertAndGetBroadcastShape(t,n),w.assertAndGetBroadcastShape(t,r);var s="vec4(0.0)";null!=a&&(w.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),s="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(w.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(s,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},VL=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=w.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},WL="return a + b;",UL="return a - b;",jL="return a * b;",HL="return (a < 0.) ? b * a : a;",GL=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A","B"],this.outputShape=w.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},qL="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",KL=function e(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=w.assertAndGetBroadcastShape(n,a);var o=this.outputShape.length,s="";if(i)if(0===o||1===r.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(s="\n          ".concat(OL(o)," coords = getOutputCoords();\n        "),1===o)s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=kL("coords",o);s+="\n            bool nextRowOutOfBounds =\n              (".concat(u[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")},XL=function(){function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),ZL=function(){function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),YL=function e(t){_classCallCheck(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},$L=function e(t){_classCallCheck(this,e),this.outputShape=[],this.outputShape=w.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++)a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(n[i-1],"));"));a.push("else setOutput(getT".concat(n.length,"(yR, yC-").concat(n[n.length-1],"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")},JL=function e(t,n){_classCallCheck(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=w.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=OL(a),o=kL("coords",a),s=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var c=1;c<u.length;c++)u[c]=u[c-1]+t[c][n];for(var l=s[n],h=s.slice(-2),f=s.join(),d="if (".concat(l," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(f,"), vec2(").concat(h.join(),"));\n        }"),p=1;p<u.length;p++){var v=u[p-1];d+="\n        if (".concat(l," < ").concat(u[p],"  && ").concat(l," >= ").concat(u[p-1],") {\n          return getChannel(\n            getT").concat(p,"(").concat(QL(s,l,v),"),\n            vec2(").concat(QL(h,l,v),"));\n        }")}var m=u[u.length-1];d+="\n        return getChannel(\n          getT".concat(u.length,"(").concat(QL(s,l,m),"),\n          vec2(").concat(QL(h,l,m),"));"),this.userCode="\n      float getValue(".concat(s.map((function(e){return"int "+e})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")};function QL(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}var eB=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat("channelsLast"===t.dataFormat,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},tB=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a="channelsLast"===t.dataFormat;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(a?3:1,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(a?1:2,"], coords[").concat(a?2:3,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(a,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},nB=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(t.strideDepth," - ").concat(t.padInfo.front,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},rB=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(t.strideDepth,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},aB=function e(t){_classCallCheck(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(t.outChannels/t.inChannels," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(t.strideHeight," - ").concat(t.padInfo.top,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(t.strideWidth," - ").concat(t.padInfo.left,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},iB=function e(t){_classCallCheck(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(a,"; dm++) {\n              int d2 = d1 * ").concat(a," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},oB=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterHeight,f=t.filterWidth,d=4*Math.floor(t.inChannels/4),p=t.inChannels%4,v="channelsLast"===t.dataFormat,m=v?1:2,g=v?2:3,y=v?3:1,b="",k="";r&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),k="result = activation(result);");var _=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(g,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(f,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(v,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===p,") {\n\n              if (").concat(v,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===p,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===p,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(_,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")},sB=function e(t){_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,u=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,h=t.filterDepth,f=t.filterHeight,d=t.filterWidth,p=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(h,"; wF++) {\n          int xF = xFCorner + wF * ").concat(u,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(p,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(p,") *\n                  getW(wF, wR, wC, ").concat(p,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(p,"),\n                  getX(batch, xF, xR, xC, ").concat(p," + 1),\n                  getX(batch, xF, xR, xC, ").concat(p," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(p,", d2),\n                  getW(wF, wR, wC, ").concat(p," + 1, d2),\n                  getW(wF, wR, wC, ").concat(p," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},uB=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,o=t.inWidth,s=t.padInfo.top,u=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,h=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,v=t.outChannels/t.inChannels,m="",g="";r&&(m=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),g="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(m,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(s,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(v,";\n        int q = d2 - d1 * ").concat(v,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(h,";\n\n          if (xR < 0 || xR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(o,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")},cB=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];_classCallCheck(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,s=t.inWidth,u=t.padInfo.top,c=t.padInfo.left,l=t.strideHeight,h=t.strideWidth,f=t.dilationHeight,d=t.dilationWidth,p=t.filterHeight,v=t.filterWidth,m=v,g="int xR; int xC; int xCOffset;",y=0;y<p;y++)for(var b=0;b<v;b++)g+="\n          vec4 xTexelR".concat(y,"C").concat(2*b," = vec4(0.);\n          vec4 wR").concat(y,"C").concat(b," = vec4(0.);\n          vec4 xR").concat(y,"C").concat(b," = vec4(0.);");for(var k=0;k<p;k++)for(var _=0;_<m;_++){var w=2*_;if(g+="\n          xR = xRCorner + ".concat(k*f,";\n          xC = xCCorner + ").concat(w*d,";\n        "),1===h){if(w<v&&(g+=c%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(s,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(k,"C").concat(w," = vec4(previous.zw, xTexelR").concat(k,"C").concat(w,".xy);\n                } else {\n                  xR").concat(k,"C").concat(w," = vec4(0, 0, xTexelR").concat(k,"C").concat(w,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = xTexelR").concat(k,"C").concat(w,";\n              "),w+1<v)){var C=c%2==0?r.nearestLargerEven(d):d;d%2==0&&c%2==1||d%2!=0&&c%2!=1?(g+="\n                  xCOffset = xC + ".concat(c%2," + ").concat(C,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),d>1&&(g+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(s,") {\n                      xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                    }\n                  ")),g+="\n                  xR".concat(k,"C").concat(w+1," = vec4(\n                    xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".xy);\n                ")):g+="\n                  xCOffset = xC + ".concat(C,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(k,"C").concat(w+1," = xTexelR").concat(k,"C").concat(w+2,";\n                ")}}else w<v&&(g+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),c%2==1?(g+="\n                xCOffset = xC + 1 - ".concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = vec4(\n                  xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".zw);\n              "),w+1<v&&(g+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(h,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(k,"C").concat(w+1," = vec4(xTexelR").concat(k,"C").concat(w+2,".xy, final.xy);\n                "))):(g+="\n                if(xC >= 0 && xC < ".concat(s,") {\n                  xTexelR").concat(k,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(h,";\n                if(xCOffset >= 0 && xCOffset < ").concat(s,") {\n                  xTexelR").concat(k,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(w," = vec4(\n                  xTexelR").concat(k,"C").concat(w,".xy, xTexelR").concat(k,"C").concat(w+2,".xy);\n              "),w+1<v&&(g+="\n                  xR".concat(k,"C").concat(w+1," = vec4(\n                    xTexelR").concat(k,"C").concat(w,".zw, xTexelR").concat(k,"C").concat(w+2,".zw);\n                "))),g+="}");w<v&&(g+="\n            vec4 wTexelR".concat(k,"C").concat(w," = getW(").concat(k,", ").concat(w,", d1, q);\n            wR").concat(k,"C").concat(w," = vec4(wTexelR").concat(k,"C").concat(w,".xz, wTexelR").concat(k,"C").concat(w,".xz);\n          "),w+1<v&&(g+="\n              vec4 wTexelR".concat(k,"C").concat(w+1," = getW(").concat(k,", ").concat(w+1,", d1, q);\n              wR").concat(k,"C").concat(w+1," =\n                vec4(wTexelR").concat(k,"C").concat(w+1,".xz, wTexelR").concat(k,"C").concat(w+1,".xz);")))}for(var x=0;x<p;x++)for(var S=0;S<v;S++)g+="dotProd += xR".concat(x,"C").concat(S," * wR").concat(x,"C").concat(S,";");var A="",I="";a&&(A=i?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(a,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(a,"\n        }"),I="result = activation(result);");var T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(A,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(h,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(c,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(g,"\n\n        vec4 result = dotProd;\n        ").concat(T,"\n        ").concat(I,"\n        setOutput(result);\n      }\n    ")},lB=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=_slicedToArray(t,4),s=o[0],u=o[1],c=o[2],l=o[3],h=_slicedToArray(n,1)[0],f=_slicedToArray(r,2),d=f[0],p=f[1];this.outputShape=[h,d,p,l];var v="bilinear"===a?1:0,m="".concat(u-1,".0"),g="".concat(c-1,".0"),y=_slicedToArray(d>1?["".concat((u-1)/(d-1)),"(y2-y1) * height_ratio","y1*".concat(m," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(m)],3),b=y[0],k=y[1],_=y[2],w=_slicedToArray(p>1?["".concat((c-1)/(p-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],3),C=w[0],x=w[1],S=w[2];this.userCode="\n      const float height_ratio = float(".concat(b,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(s,") {\n          return;\n        }\n\n        float height_scale = ").concat(k,";\n        float width_scale = ").concat(x,";\n\n        float in_y = ").concat(_,";\n        if( in_y < 0.0 || in_y > ").concat(m," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(S,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(v," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},hB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=t[t.length-1],o=r?"<":">";this.userCode="\n      int getIndex(int i) {\n        ".concat(r?"return ".concat(i," -i - 1;"):"return i;","\n      }\n\n      void main() {\n        ").concat(OL(a)," coords = getOutputCoords();\n        int end = ").concat(fB(a,"coords"),";\n        float val = 0.0;\n        for (int i = ").concat(i," - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx ").concat(o," end) {\n            continue;\n          }\n          if (idx == end && ").concat(n,") {\n            continue;\n          }\n          ").concat(fB(a,"coords")," = idx;\n          val += getX(").concat(function(e,t){if(1===e)return"coords";if(2===e)return"coords.x, coords.y";if(3===e)return"coords.x, coords.y, coords.z";if(4===e)return"coords.x, coords.y, coords.z, coords.w";throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}(a),");\n        }\n        setOutput(val);\n      }\n    ")};function fB(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var dB=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Bz.DENSE;var n=qz(t),r=_L();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(wL(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},pB=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Bz.DENSE;var n=qz(t),r=_L();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(wL(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")},vB=function(){function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return _createClass(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}(),mB=function e(t){_classCallCheck(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},gB=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.outTexUsage=Vz.DOWNLOAD;var n=_L();this.outputShape=t,this.userCode="\n      ".concat(xL,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},yB=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Vz.DOWNLOAD;var n=_L();this.outputShape=t,this.userCode="\n      ".concat(xL,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},bB=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.variableNames=["A"];var a=_L(),i=_slicedToArray(n,2),o=i[0],s=i[1];this.outputShape=t;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(CL(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / ").concat(s,";\n        int c = imod(flatIndex, ").concat(s,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")},kB=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=_L(),i=_slicedToArray(n,2),o=i[0],s=i[1];this.outputShape=t;var u="",c="result";r&&(c="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var h=0;h<=1;h++){var f=2*l+h;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(h," < ").concat(t[2],") {\n            localCoords[2] += ").concat(h,";\n            if(localCoords[1] + ").concat(l," < ").concat(t[1],") {\n              localCoords[1] += ").concat(l,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(s,";\n              c = imod(flatIndex, ").concat(s,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(f,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(f,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(f,"] = values[2];\n              } else {\n                result[").concat(f,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(CL(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(a.output," = ").concat(c,";\n      }\n    ")},_B=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI);this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(t,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(r?"".concat(a,".0"):"1.0",";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")},wB=function(){function e(t,n){_classCallCheck(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),CB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A","indices"];var a=t.slice();a[r]=n,this.outputShape=a,this.rank=a.length;var i=OL(this.rank),o=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank ".concat(n," is not yet supported"));if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)a.push(i===t?"int(getIndices(".concat(r[i],"))"):"".concat(r[i]));return a.join()}(t,r);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")},xB=function e(t,n,r){_classCallCheck(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=OL(n.length),i=OL(r.length);this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(this.sliceDim>1?"strides[j]":"strides",";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};function SB(e,t,n,r,a,i,o){!function(e,t){var n=cy().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error("Requested texture size "+"[".concat(e,"x").concat(t,"]")+" is invalid.");if(e>n||t>n)throw new Error("Requested texture size "+"[".concat(e,"x").concat(t,"]")+" greater than WebGL maximum on this browser / GPU "+"[".concat(n,"x").concat(n,"]")+".")}(n,r);var s=function(e,t){return oL(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e,t),u=e.TEXTURE_2D;return Zz(e,t,(function(){return e.bindTexture(u,s)})),Zz(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),Zz(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),Zz(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),Zz(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),Zz(e,t,(function(){return e.texImage2D(u,0,a,n,r,0,i,o,null)})),Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}var AB=function(){function e(t){_classCallCheck(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=cy().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){Uz[e]=t}(n,t)):this.gl=Hz(n);var r="WEBGL_color_buffer_float";if(1===cy().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=$z(this.gl,this.debug,"OES_texture_float"),fL(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=$z(this.gl,this.debug,"OES_texture_half_float");else if(cy().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),fL(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=$z(this.gl,this.debug,"EXT_color_buffer_half_float");else if(cy().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",fL(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!fL(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=function(e,t){return function(e,t,n){var r=oL(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Zz(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),Zz(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl,this.debug),this.indexBuffer=function(e,t){return function(e,t,n){var r=oL(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return Zz(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),Zz(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}(e,t,new Uint16Array([0,1,2,2,1,3]))}(this.gl,this.debug),this.framebuffer=function(e,t){return oL(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl,this.debug),this.textureConfig=Xz(this.gl,this.textureHalfFloatExtension)}var t;return _createClass(e,[{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;Zz(t,this.debug,(function(){return t.finish()})),Zz(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),Zz(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),Zz(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),Zz(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),Zz(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r,a){var i=_slicedToArray(Gz(n,r),2);return SB(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}(this.gl,this.debug,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r,a){var i=_slicedToArray(Gz(n,r),2);return SB(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}(this.gl,this.debug,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r,a){var i=_slicedToArray(Gz(n,r),2);return SB(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}(this.gl,this.debug,e,t)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n,r){Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?Zz(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):Zz(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,this.debug,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i,o){var s,u,c;Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),u=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),Zz(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,u,s)})),Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,this.debug,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r,a){var i=_slicedToArray(Kz(n,r),2);return SB(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}(this.gl,this.debug,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r,a){var i=_slicedToArray(Kz(n,r),2);return SB(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}(this.gl,this.debug,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(aL(this.gl,this.debug,this.framebuffer),this.outputTexture=null),Zz(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r,a){var i=_slicedToArray(Gz(n,r),2),o=i[0],s=i[1],u=new Uint8Array(n*r*4);return Zz(e,t,(function(){return e.readPixels(0,0,o,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,r.debug,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return function(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=_slicedToArray(Kz(e,t),2);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}(this.gl,e,0,0,0,a,i)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r,a){var i=e.createBuffer();Zz(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var o=16*n*r;return Zz(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)})),Zz(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),Zz(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}(this.gl,this.debug,t,n);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(cy().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=new Float32Array(n*r*4);return Zz(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)})),a}(r.gl,r.debug,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=function(e,t,n){var a=oL(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(Zz(e,t,(function(){return e.shaderSource(a,n)})),Zz(e,t,(function(){return e.compileShader(a)})),!1===e.getShaderParameter(a,e.COMPILE_STATUS))throw function(e,t){var n=eL.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var a=+n[1],i=e.split("\n"),o=i.length.toString().length+2,s=i.map((function(e,t){return r.rightPad((t+1).toString(),o)+e})),u=0,c=0;c<s.length;c++)u=Math.max(s[c].length,u);var l=s.slice(0,a-1),h=s.slice(a-1,a),f=s.slice(a);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(r.rightPad(h[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(a)),new Error("Failed to compile fragment shader.");return a}(t,this.debug,e),a=function(e,t){var n=_L();return function(e,t,n){var r=oL(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(Zz(e,t,(function(){return e.shaderSource(r,n)})),Zz(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}(e,t,"".concat(n.version,"\n    precision highp float;\n    ").concat(n.attribute," vec3 clipSpacePos;\n    ").concat(n.attribute," vec2 uv;\n    ").concat(n.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}(t,this.debug),i=function(e,t){return oL(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t,this.debug);return Zz(t,this.debug,(function(){return t.attachShader(i,a)})),Zz(t,this.debug,(function(){return t.attachShader(i,n)})),function(e,t,n){if(Zz(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}(t,this.debug,i),this.debug&&tL(t,this.debug,i),this.vertexAttrsAreBound||(this.setProgram(i),this.vertexAttrsAreBound=function(e,t,n,r){return Zz(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),nL(e,t,n,"clipSpacePos",r,3,20,0)&&nL(e,t,n,"uv",r,2,20,12)}(t,this.debug,this.program,this.vertexBuffer)),i}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&Zz(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&tL(this.gl,this.debug,this.program),Zz(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?function(e,t,n,r){return oL(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}(this.gl,this.debug,e,t):function(e,t,n){return e.getUniformLocation(t,n)}(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),Zz(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),function(e,t,n,r,a,i){Zz(e,t,(function(){return function(e,t,n,r){(function(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in ".concat("[gl.TEXTURE0, gl.TEXTURE".concat(n,"]"),"."))})(e,r),Zz(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),Zz(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}(e,t,r,i)})),Zz(e,t,(function(){return e.uniform1i(a,i)}))}(this.gl,this.debug,0,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=_slicedToArray(Kz(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&tL(this.gl,this.debug,this.program),iL(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),Zz(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),Zz(this.gl,this.debug,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=$z(this.gl,this.debug,2===cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||r.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),rL(this.gl,this.debug,e,this.framebuffer),this.debug&&iL(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(rL(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&iL(this.gl)):aL(this.gl,this.debug,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;rL(r,this.debug,e,this.framebuffer),this.debug&&iL(r),this.outputTexture=e,Zz(r,this.debug,(function(){return r.viewport(0,0,t,n)})),Zz(r,this.debug,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),Zz(this.gl,this.debug,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}},{key:"debug",get:function(){return cy().getBool("DEBUG")}}]),e}();function IB(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var a=e.logicalShape,i=t[n],o=i.shape;if(!r.arraysEqual(a,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(a," and ").concat(o," must match"));if(!e.isUniform||!i.isUniform){var s=e.texShape,u=i.isUniform?null:i.texData.texShape;if(!r.arraysEqual(s,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(u," must match"))}}))}var TB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,s=r.strideHeight,u=r.padInfo,c=r.outWidth,l=r.dilationWidth,h=r.dilationHeight,f=r.dataFormat,d=u.left,p=u.top,v=i*a,m=_L(),g="channelsLast"===f,y=g?0:1,b=g?1:2,k="",_=0;_<=1;_++)for(var w=0;w<=1;w++)k+="\n          blockIndex = rc.y + ".concat(w,";\n          pos = rc.x + ").concat(_,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(s," - ").concat(p,";\n            d0 = offsetY + ").concat(h," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(o,". - ").concat(d,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(v,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*_+w,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*_+w,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(k,"\n\n        ").concat(m.output," = result;\n      }\n    ")},EB=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(u,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},RB=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},NB=function e(t,n,r,a,i){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,u=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(c,")"):1===i?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(u,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},OB=function e(t){_classCallCheck(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.effectiveFilterHeight,r=t.effectiveFilterWidth;this.userCode="\n      const ivec2 pads = ivec2(".concat(n-1-t.padInfo.top,", ").concat(r-1-t.padInfo.left,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,";\n          wR += ").concat(t.dilationHeight,") {\n          float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(n*r-1," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(r," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},DB=function e(t){_classCallCheck(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.effectiveFilterDepth,r=t.effectiveFilterHeight,a=t.effectiveFilterWidth;this.userCode="\n      const ivec3 pads = ivec3(".concat(n-1-t.padInfo.front,", ").concat(r-1-t.padInfo.top,", ").concat(a-1-t.padInfo.left,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(n,";\n           wD += ").concat(t.dilationDepth,") {\n          float dyD = float(dyDCorner + wD) / ").concat(t.strideDepth,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(r,";\n              wR += ").concat(t.dilationHeight,") {\n            float dyR = float(dyRCorner + wR) / ").concat(t.strideHeight,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(a,";\n                wC += ").concat(t.dilationWidth,") {\n              float dyC = float(dyCCorner + wC) / ").concat(t.strideWidth,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(n*r*a-1," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(r," * ").concat(a," +\n                  wR * ").concat(a," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},FB=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];_classCallCheck(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var u=Math.ceil((r?t[1]:t[2])/2),c=r?"i * 2, rc.y":"rc.y, i * 2",l=a?"rc.z, i * 2":"i * 2, rc.z",h=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";o&&(d=s?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),p="result = activation(result);");var v=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(d,"\n\n      const float sharedDimension = ").concat(u,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(u,"; i++) {\n          vec4 a = getMatrixA(rc.x, ").concat(c,");\n          vec4 b = getMatrixB(rc.x, ").concat(l,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(h[0]," * ").concat(f[0],");\n          result += (").concat(h[1]," * ").concat(f[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(p,"\n\n        setOutput(result);\n      }\n    ")},MB=function(){function e(t,n,r){_classCallCheck(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),PB=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},zB=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=kL("rc",n),a=OL(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),s=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0"):"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}},LB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=OL(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(u,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")},BB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=OL(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),u=kL("rc",a),c=kL("source",a),l="".concat(u[a-1]," < ").concat(this.outputShape[a-1]),h=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),f=["".concat(i," rc = outputLoc;"),"".concat(u[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(u[a-2]," += 1;\n       if(").concat(u[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(u[a-1]," += 1;\n         if(").concat(l,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",v=0,m=1===a?2:4;v<m;v++)p+="\n        ".concat(f[v],"\n        if (").concat(d,") {\n          result[").concat(v,"] = float(").concat(r,");\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(c.join(),"), ").concat(h,");\n        }\n      ");p+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},VB=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,u=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,h=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.top,p=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,m="0.0";if(v||(m="-1.0 / 1e-20"),r)this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(h,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?"((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"):"(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"):"wR * ".concat(f," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var g="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(g="avgValue / count");var y=4*Math.floor(o/4),b=o%4,k="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(p,");\n      const float initializationValue = ").concat(m,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(m,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(y,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(k,"\n          }\n\n          int xC = xCCorner + ").concat(y,";\n          if (").concat(1===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(2===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(k,"\n          } else if (").concat(3===b,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(k,"\n          }\n        }\n        setOutput(").concat(g,");\n      }\n    ")}},WB=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(_classCallCheck(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,u=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,h=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,v=t.effectiveFilterWidth,m=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,k="0.0";if(b||(k="-1.0 / 1e-20"),r)this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(p,";\n                wR += ").concat(h,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(f,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(p," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ");else{var _="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(_="avgValue / count");var w=4*Math.floor(o/4),C=o%4,x="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(u,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(k,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(k,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,";\n            wR += ").concat(h,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(w,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(f,", ch)\n              );\n\n              ").concat(x,"\n            }\n\n            int xC = xCCorner + ").concat(w,";\n            if (").concat(1===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(2===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(x,"\n            } else if (").concat(3===C,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                initializationValue\n              );\n\n              ").concat(x,"\n            }\n          }\n          setOutput(").concat(_,");\n        }\n      }\n    ")}},UB=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=Math.ceil(i/r);this.outputShape=[a,o];var s="0.0",u="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",u="min"):"max"===n&&(s="-1.0 / 1e-20",u="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),h=r%4,f="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(u,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===n?(s="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(s="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(p,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===h,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")},jB=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r,a="",i=0;i<4;i++){var o="thisRC = rc;";i%2==1&&(o+="thisRC.z += 1;"),i>1&&(o+="thisRC.y += 1;"),a+="\n        ".concat(o,"\n        ").concat(i>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(i,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(i>0?"}":"","\n      ")}this.userCode="\n      ".concat((r=n,"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(wL(["r","c","d"],r),"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(CL(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(a,"\n\n        setOutput(result);\n      }\n    ")},HB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=_slicedToArray(n.shape,3),i=a[1],o=a[2],s=_slicedToArray(t.shape,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],f=l[0]/h[0],d=l[1]/h[1],p=1/f,v=1/d,m=2*Math.ceil(p)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(f,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},GB=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=[];var i=_slicedToArray(t,4),o=i[0],s=i[1],u=i[2],c=i[3];this.outputShape=[o,n,r,c];var l=[a&&n>1?s-1:s,a&&r>1?u-1:u],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/h[0],",\n          ").concat(l[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},qB=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=_slicedToArray(t,4),o=i[0],s=i[1],u=i[2],c=i[3];this.outputShape=[o,n,r,c];var l=[a&&n>1?s-1:s,a&&r>1?u-1:u],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/h[0],",\n          ").concat(l[1]/h[1],",\n          ").concat(l[1]/h[1],");\n      const vec3 inputShapeRC = vec3(").concat(s,".0, ").concat(u,".0,\n                                     ").concat(u,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")},KB=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=_slicedToArray(n.shape,3),i=a[1],o=a[2],s=_slicedToArray(t.shape,3),u=s[1],c=s[2],l=[r&&u>1?i-1:i,r&&c>1?o-1:o],h=[r&&u>1?u-1:u,r&&c>1?c-1:c],f=l[0]/h[0],d=l[1]/h[1],p=1/f,v=1/d,m=2*Math.ceil(p)+2,g=2*Math.ceil(v)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(f,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(p,");\n        const float invWidthScale = float(").concat(v,");\n\n        const int winHeight = int(").concat(m,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(h[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(h[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")},XB=function e(t,n,r,a){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=[];var i=_slicedToArray(t,4),o=i[0],s=i[1],u=i[2],c=i[3];this.outputShape=[o,n,r,c];var l=[a&&n>1?s-1:s,a&&r>1?u-1:u],h=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/h[0],",\n          ").concat(l[1]/h[1],");\n      const vec2 inputShapeRC = vec2(").concat(s,".0, ").concat(u,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(a?"0.5":"0.0",")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")},ZB=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=OL(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},YB=function e(t,n){_classCallCheck(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=kL("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=OL(r);function u(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)}));return"getChannel(getX(".concat(r.join(","),"), vec2(").concat(r.slice(-2).join(","),"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return u(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",u(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",u(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")},$B=function e(t,n,r,a,i,o){!(arguments.length>6&&void 0!==arguments[6])||arguments[6];_classCallCheck(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=OL(i.length),u=OL(o.length),c="";1===r?c="i":2===r&&(c="i, j");var l="";1===a?l="i":2===a&&(l="i, coords[1]"),this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(u," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(","getIndices(".concat(c,")"),");\n              flattenedIndex += index * ").concat(n>1?"strides[j]":"strides",";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ","getUpdates(".concat(l,")"),";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")},JB=function e(t,n){_classCallCheck(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var u=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",h="";i%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ".concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(f,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(u,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(u,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},QB=function e(t,n,r){var a,i;if(_classCallCheck(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],u=[],c=0;c<n.length;c++)u.push("".concat(o[c])),c<t&&s.push("".concat(o[c]));a=s.join(),i=u.join()}var l=OL(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")},eV=function(){function e(t){_classCallCheck(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=OL(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return tV.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank);n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(t.map((function(e,t){return"sourceLoc.".concat(tV[t]," = start[").concat(t,"] + coords.").concat(tV[t],";")})).join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),tV=["x","y","z","w","u","v"],nV=function(){function e(t){_classCallCheck(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=OL(this.rank),r=kL("coords",this.rank),a=kL("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),u=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(u,"\n        setOutput(result);\n      }\n    ")}return _createClass(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),rV=function e(t,n,r){_classCallCheck(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=OL(r.length),o=OL(r.length),s="";if(1===a)s="coords * strides + begin";else{var u=0;s=r.map((function(e,t){return u++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(u-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")},aV=function(){function e(t){_classCallCheck(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return _createClass(e,[{key:"acquireTexture",value:function(e,t,n){var r,a=iV(t,n),i=oV(e,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===Wz.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===Wz.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===Wz.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===Wz.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===Wz.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=oV(t,iV(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}}},{key:"log",value:function(){this.logEnabled&&console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(this.numFreeTextures+this.numUsedTextures,")"))}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}}}]),e}();function iV(e,t){if(e===Vz.UPLOAD)return Wz.PACKED_2X2_FLOAT32;if(e===Vz.RENDER||null==e)return function(e){return cy().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Wz.PACKED_2X2_FLOAT32:Wz.UNPACKED_FLOAT32:e?Wz.PACKED_2X2_FLOAT16:Wz.UNPACKED_FLOAT16}(t);if(e===Vz.DOWNLOAD||e===Vz.PIXELS)return Wz.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function oV(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var sV=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=OL(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")},uV=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},cV="return abs(x);",lV="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",hV="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",fV="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(w.SELU_SCALEALPHA,";\n  float scale = ").concat(w.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n"),dV="return -x;",pV="return ceil(x);",vV="return floor(x);",mV="return exp(x);",gV="return exp(x) - 1.0;",yV='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(w.ERF_P,";\n  float a1 = ").concat(w.ERF_A1,";\n  float a2 = ").concat(w.ERF_A2,";\n  float a3 = ").concat(w.ERF_A3,";\n  float a4 = ").concat(w.ERF_A4,";\n  float a5 = ").concat(w.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),bV="return x;",kV="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",_V="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",wV="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",CV=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},xV=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=kL("rc",n),a=OL(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")},SV=w.segment_util,AV=C.split,IV=C.tile,TV=C.topkImpl,EV=C.whereImpl,RV={};function NV(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return"return x;";if("relu"===e)return t?kV:lV;if("elu"===e)return t?wV:"return (x >= 0.0) ? x : (exp(x) - 1.0);";if("relu6"===e)return t?_V:hV;if("prelu"===e)return t?qL:HL;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var OV,DV=function(e){_inherits(s,e);var t,n,a,i=_createSuper(s);function s(e){var t,n;if(_classCallCheck(this,s),(t=i.call(this)).pendingRead=new WeakMap,t.pendingDisposal=new WeakSet,t.dataRefCount=new WeakMap,t.numBytesInGPU=0,t.uploadWaitMs=0,t.downloadWaitMs=0,t.warnedAboutMemory=!1,t.pendingDeletes=0,t.disposed=!1,!cy().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var r=Hz(cy().getNumber("WEBGL_VERSION"));t.binaryCache=(n=cy().getNumber("WEBGL_VERSION"))in RV?RV[n]:(RV[n]={},RV[n]),t.gpgpu=new AB(r),t.canvas=r.canvas,t.gpgpuCreatedLocally=!0}else t.gpgpu=e,t.binaryCache={},t.gpgpuCreatedLocally=!1,t.canvas=e.gl.canvas;return t.textureManager=new aV(t.gpgpu),t.numMBBeforeWarning=null==cy().global.screen?1024:cy().global.screen.height*cy().global.screen.width*window.devicePixelRatio*600/1024/1024,t.texData=new NR(_assertThisInitialized(t),WA()),_possibleConstructorReturn(t)}return _createClass(s,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if(cy().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Vz.UPLOAD}),r}},{key:"move",value:function(e,t,n,r){if(cy().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Vz.UPLOAD})}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,a=t.dtype,i=t.complexTensors,o=t.slice,s=t.shape,u=t.isPacked;if(null!=o){var c;c=u?new CV(s,bV):new uV(s,bV);var l=this.runWebGLProgram(c,[{dataId:e,shape:s,dtype:a}],a),h=this.readSync(l.dataId);return this.disposeData(l.dataId),h}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===a)return n;var f,d,p=null!=this.activeTimers;if(p&&(f=r.now()),"complex64"===a){var v=i.real.dataSync(),m=i.imag.dataSync();d=w.mergeRealAndImagArrays(v,m)}else d=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=r.now()-f),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:(a=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,a,i,o,s,u,c,l,h,f,d,p,v,m,g,y,b,k,_,C;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(a=this.texData.get(t),i=a.values,o=a.shape,s=a.slice,u=a.dtype,c=a.complexTensors,l=a.isPacked,null==s){e.next=8;break}return h=l?new CV(o,bV):new uV(o,bV),f=this.runWebGLProgram(h,[{dataId:t,shape:o,dtype:u}],u),d=this.read(f.dataId),e.abrupt("return",(this.disposeData(f.dataId),d));case 8:if(null==i){e.next=10;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 10:if(cy().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==cy().getNumber("WEBGL_VERSION")){e.next=12;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 12:if(m=null,"complex64"!==u&&cy().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(t),y=this.texData.get(p.dataId),m=(g=this.gpgpu).createBufferFromTexture.apply(g,[y.texture].concat(_toConsumableArray(qz(o))))),this.pendingRead.set(t,[]),e.t0="complex64"!==u,!e.t0){e.next=19;break}return e.next=19,this.gpgpu.createAndWaitForFence();case 19:if("complex64"!==u){e.next=26;break}return e.next=22,Promise.all([c.real.data(),c.imag.data()]);case 22:b=e.sent,v=w.mergeRealAndImagArrays(b[0],b[1]),e.next=27;break;case 26:null==m?v=this.getValuesFromTexture(t):(k=r.sizeFromShape(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(m,k));case 27:return null!=p&&this.disposeData(p.dataId),_=this.convertAndCacheOnCPU(t,v),C=this.pendingRead.get(t),e.abrupt("return",(this.pendingRead.delete(t),C.forEach((function(e){return e(_)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),_));case 30:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Yz(n)){if(cy().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,a=t.dtype,i=t.isPacked,o=r.sizeFromShape(n);if(cy().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s,u=this.decode(e),c=this.texData.get(u.dataId),l=(s=this.gpgpu).downloadMatrixFromPackedTexture.apply(s,[c.texture].concat(_toConsumableArray(qz(n)))).subarray(0,o);return this.disposeData(u.dataId),l}var h=cy().getBool("WEBGL_PACK")&&!0===i,f=h?cL(n):n,d=h?new yB(f):new gB(f),p=this.runWebGLProgram(d,[{shape:f,dtype:a,dataId:e}],"float32"),v=this.texData.get(p.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,o);return this.disposeData(p.dataId),m}},{key:"time",value:(n=_asyncToGenerator(regeneratorRuntime.mark((function e(t){var n,a,i,o,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,a=[],i=!1,null==this.programTimersStack?(this.programTimersStack=a,i=!0):this.activeTimers.push(a),this.activeTimers=a,t(),o=r.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),s=r.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,i&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=13;break}return e.next=9,Promise.all(o);case 9:c=e.sent,u.kernelMs=r.sum(c),u.getExtraProfileInfo=function(){return c.map((function(e,t){return{name:s[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=14;break;case 13:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 14:return e.abrupt("return",(this.uploadWaitMs=0,this.downloadWaitMs=0,u));case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}}},{key:"startTimer",value:function(){return cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:r.now(),endMs:null}}},{key:"endTimer",value:function(e){return cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=r.now(),e)}},{key:"getQueryTime",value:(t=_asyncToGenerator(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",cy().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.waitForQueryAndGetTime(t):t.endMs-t.startMs);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"disposeData",value:function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return cy().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=WA().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128;return null!=this.getCPUBackend()&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&r.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"complex",value:function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:WA().keep(e.clone()),imag:WA().keep(t.clone())},n}},{key:"real",value:function(e){return this.texData.get(e.dataId).complexTensors.real.clone()}},{key:"imag",value:function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===r.sizeFromShape(n))return S_([],n,e.dtype);var a=this.texData.get(e.dataId).isPacked,i=o.isSliceContinous(e.shape,t,n);if(a||!i){var s=cy().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nV(n):new eV(n),u=s.getCustomSetupFunc(t);return this.compileAndRun(s,[e],null,u)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)}},{key:"shallowSlice",value:function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var s=o.computeFlatOffset(t,e.strides);r.slice&&(s+=r.slice.flatOffset),i.slice={flatOffset:s,origDataId:r.slice&&r.slice.origDataId||e.dataId};var u=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,u+1),a}},{key:"stridedSlice",value:function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=o.computeOutShape(t,n,r);if(a.some((function(e){return 0===e})))return S_([],a);var i=new rV(t,r,a);return this.compileAndRun(i,[e])}},{key:"reverse",value:function(e,t){var n=cy().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new YB(e.shape,t):new ZB(e.shape,t);return this.compileAndRun(n,[e])}},{key:"concat",value:function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return x_(e)})),a=e.map((function(e){return C_(e)}));return w_(this.concat(n,t),this.concat(a,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>cy().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(e.length/2),o=this.concat(e.slice(0,i),t),s=this.concat(e.slice(i),t);return this.concat([o,s],t)}if(cy().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var u=new JL(e.map((function(e){return e.shape})),t);return this.compileAndRun(u,e)}var c=w.computeOutShape(e.map((function(e){return e.shape})),t),l=e.map((function(e){return e.as2D(-1,r.sizeFromShape(e.shape.slice(t)))})),h=new $L(l.map((function(e){return e.shape})));return this.compileAndRun(h,l).reshape(c)}},{key:"neg",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,dV,e.dtype);var t=new uV(e.shape,dV);return this.compileAndRun(t,[e])}},{key:"batchMatMul",value:function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=_slicedToArray(e.shape,2)[0];if((1===a||1===i)&&o>1e3){n&&(e=BC(e,[0,2,1])),r&&(t=BC(t,[0,2,1]));var u=1===i?e:e.as3D(s,o,1),c=1===i?2:1,l=1===i?t.as3D(s,1,o):t;return this.multiply(u,l).sum(c,!0)}var h=Fb(e.dtype,t.dtype),f=new FB(e.shape,[s,a,i],n,r);return this.compileAndRun(f,[e,t],h)}},{key:"fusedBatchMatMul",value:function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],l=_slicedToArray(t.shape,2)[0],h=Fb(t.dtype,n.dtype),f=null!=i,d=null!=s,p=o?NV(o,!0):null,v=new FB(t.shape,[l,u,c],r,a,f,p,d),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,h)}},{key:"multiply",value:function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new VL("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new VL("return areal * bimag + aimag * breal;",e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(a,o),u=this.compileAndRun(i,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,jL,e.dtype);var l=new GL(jL,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)}},{key:"batchNorm",value:function(e,t,n,r,a,i){var o=[e,t,n],s=null;null!=r&&(s=r.shape,o.push(r));var u=null;if(null!=a&&(u=a.shape,o.push(a)),cy().getBool("WEBGL_PACK_NORMALIZATION")){var c=new BL(e.shape,t.shape,n.shape,s,u,i);return this.compileAndRun(c,o)}var l=new LL(e.shape,t.shape,n.shape,s,u,i);return this.compileAndRun(l,o)}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){var i=cy().getBool("WEBGL_PACK_NORMALIZATION")?new NB(e.shape,t,n,r,a):new EB(e.shape,t,n,r,a);return this.compileAndRun(i,[e])}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){var s=new RB(t.shape,r,a,i,o);return this.compileAndRun(s,[t,n,e])}},{key:"tile",value:function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return r.decodeString(e)})),a=U_(e.shape,e.dtype,n);return IV(a,t)}var i=new sV(e.shape,t);return this.compileAndRun(i,[e])}},{key:"pad",value:function(e,t,n){var r=cy().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new BB(e.shape,t,n):new LB(e.shape,t,n);return this.compileAndRun(r,[e])}},{key:"gather",value:function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new CB(e.shape,t.size,n);return this.compileAndRun(r,[e,t])}},{key:"batchToSpaceND",value:function(e,t,n){r.assert(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var a=t.reduce((function(e,t){return e*t})),i=w.getReshaped(e.shape,t,a),o=w.getPermuted(i.length,t.length),s=w.getReshapedPermuted(e.shape,t,a),u=w.getSliceBeginCoords(n,t.length),c=w.getSliceSize(s,n,t.length);return BC(e.reshape(i),o).reshape(s).slice(u,c)}},{key:"spaceToBatchND",value:function(e,t,n){r.assert(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var a=t.reduce((function(e,t){return e*t})),i=[[0,0]];i.push.apply(i,_toConsumableArray(n));for(var o=1+t.length;o<e.shape.length;++o)i.push([0,0]);var s=e.pad(i),u=w.getReshaped(s.shape,t,a,!1),c=w.getPermuted(u.length,t.length,!1),l=w.getReshapedPermuted(s.shape,t,a,!1);return BC(s.reshape(u),c).reshape(l)}},{key:"reduce",value:function(e,t,n){var r=e.shape[0],a=e.shape[1],i=w.computeOptimalWindowSize(a),o=new UB({windowSize:i,inSize:a,batchSize:r},t),s=this.compileAndRun(o,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)}},{key:"argReduce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=w.computeOptimalWindowSize(a),o=new yL({windowSize:i,inSize:a,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)}},{key:"argReducePacked",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!=n?n.shape:e.shape,a=w.computeOptimalWindowSize(r[r.length-1]),i=new ML(r,a,t,null==n),o=this.compileAndRun(i,null==n?[e]:[e,n],"int32");return o.rank===e.rank?this.argReducePacked(e,t,o):o}},{key:"sum",value:function(e,t){w.assertAxesAreInnerMostDims("sum",t,e.rank);var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=r.sizeFromShape(i),s=e.as2D(-1,o),u=Mb(e.dtype);return this.reduce(s,"sum",u).reshape(a)}},{key:"prod",value:function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=r.sizeFromShape(i),s=e.as2D(-1,o),u=Mb(e.dtype);return this.reduce(s,"prod",u).reshape(a)}},{key:"unsortedSegmentSum",value:function(e,t,n){var a=0,i=w.getAxesPermutation([a],e.rank),o=e;null!=i&&(o=BC(e,i),a=w.getInnerMostAxes(1,e.rank)[0]);var s=SV.computeOutShape(o.shape,a,n),u=r.sizeFromShape([o.shape[a]]),c=o.as2D(-1,u),l=Mb(e.dtype),h=this.segOpCompute(c,"unsortedSegmentSum",t,l,n).reshape(s);return null!=i&&(h=BC(h,w.getUndoAxesPermutation(i))),h}},{key:"segOpCompute",value:function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],s=SV.segOpComputeOptimalWindowSize(o,a),u=new JB({windowSize:s,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(u,[e,n],r);return c.shape[1]===a?c:(n=L_(0,a).tile([o/s]),this.segOpCompute(c,t,n,r,a))}},{key:"argMinMaxReduce",value:function(e,t,n){var a=[t];if(w.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),a,e.rank),!cy().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var i=_slicedToArray(w.computeOutAndReduceShapes(e.shape,a),2),o=i[0],s=i[1],u=r.sizeFromShape(s),c=e.as2D(-1,u);return this.argReduce(c,n).reshape(o)}return this.argReducePacked(e,n)}},{key:"argMin",value:function(e,t){return this.argMinMaxReduce(e,t,"min")}},{key:"argMax",value:function(e,t){return this.argMinMaxReduce(e,t,"max")}},{key:"cumsum",value:function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(e.rank-1," ")+"but got axis=".concat(t));var a=new hB(e.shape,n,r);return this.compileAndRun(a,[e])}},{key:"equal",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new GL("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"notEqual",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new GL("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"less",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new GL("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"lessEqual",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new GL("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greater",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new GL("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greaterEqual",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new GL("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalNot",value:function(e){var t=new uV(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])}},{key:"logicalAnd",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new GL("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalOr",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new GL("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"select",value:function(e,t,n){var r=new QB(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],Fb(t.dtype,n.dtype))}},{key:"where",value:function(e){w.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return EV(e.shape,t)}},{key:"topk",value:function(e,t,n){var r=e.dataSync();return TV(r,e.shape,e.dtype,t,n)}},{key:"min",value:function(e,t){w.assertAxesAreInnerMostDims("min",t,e.rank);var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=r.sizeFromShape(i),s=e.as2D(-1,o);return this.reduce(s,"min",s.dtype).reshape(a)}},{key:"minimum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new GL("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"mod",value:function(e,t){var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new GL("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"maximum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new GL("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"all",value:function(e,t){w.assertAxesAreInnerMostDims("all",t,e.rank);var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=r.sizeFromShape(i),s=e.as2D(-1,o);return this.reduce(s,"all",s.dtype).reshape(a)}},{key:"any",value:function(e,t){w.assertAxesAreInnerMostDims("any",t,e.rank);var n=_slicedToArray(w.computeOutAndReduceShapes(e.shape,t),2),a=n[0],i=n[1],o=r.sizeFromShape(i),s=e.as2D(-1,o);return this.reduce(s,"any",s.dtype).reshape(a)}},{key:"floorDiv",value:function(e,t){if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new GL("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")}},{key:"add",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,WL);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=Fb(e.dtype,t.dtype);if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,WL,n);var r=new GL(WL,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new CV(e.shape,t);return this.compileAndRun(r,[e],n)}},{key:"packedBinaryOp",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=new KL(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)}},{key:"complexSeparableBinaryOp",value:function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=_slicedToArray(a,2),o=i[0],s=i[1],u=r.makeComplexComponentTensorInfo(e,o),c=r.makeComplexComponentTensorInfo(t,s),l=new GL(n,e.shape,t.shape);return r.compileAndRun(l,[u,c],Fb(o.dtype,s.dtype))})),s=_slicedToArray(o,2),u=s[0],c=s[1],l=this.complex(u,c);return u.dispose(),c.dispose(),l}},{key:"makeComplexComponentTensorInfo",value:function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}},{key:"addN",value:function(e){if(1===e.length)return e[0];if(e.length>cy().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map((function(e){return e.dtype})).reduce((function(e,t){return Fb(e,t)})),i=e.map((function(e){return e.shape})),o=cy().getBool("WEBGL_PACK")?new gL(e[0].shape,i):new mL(e[0].shape,i);return this.compileAndRun(o,e,a)}},{key:"subtract",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,UL);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=Fb(e.dtype,t.dtype);if(cy().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,UL,e.dtype);var r=new GL(UL,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"pow",value:function(e,t){var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new GL("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=Fb(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)}},{key:"ceil",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pV,e.dtype);var t=new uV(e.shape,pV);return this.compileAndRun(t,[e])}},{key:"floor",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,vV,e.dtype);var t=new uV(e.shape,vV);return this.compileAndRun(t,[e])}},{key:"sign",value:function(e){var t=new uV(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])}},{key:"isNaN",value:function(e){var t=new uV(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isInf",value:function(e){var t=new uV(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isFinite",value:function(e){var t=new uV(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"round",value:function(e){var t=new uV(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])}},{key:"exp",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,mV,e.dtype);var t=new uV(e.shape,mV);return this.compileAndRun(t,[e])}},{key:"expm1",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,gV,e.dtype);var t=new uV(e.shape,gV);return this.compileAndRun(t,[e])}},{key:"softmax",value:function(e,t){var n=r.parseAxisParam([t],e.shape),a=FI(e,n),i=w.expandShapeToKeepDim(a.shape,n),o=this.subtract(e,a.reshape(i)),s=this.exp(o),u=this.sum(s,n).reshape(i);return J_(s,u)}},{key:"log",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new uV(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])}},{key:"log1p",value:function(e){var t=new uV(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])}},{key:"sqrt",value:function(e){var t=new uV(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])}},{key:"rsqrt",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new uV(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])}},{key:"reciprocal",value:function(e){var t=new uV(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])}},{key:"relu",value:function(e){var t;return t=cy().getBool("WEBGL_PACK")?new CV(e.shape,kV):new uV(e.shape,lV),this.compileAndRun(t,[e])}},{key:"relu6",value:function(e){var t;return t=cy().getBool("WEBGL_PACK")?new CV(e.shape,_V):new uV(e.shape,hV),this.compileAndRun(t,[e])}},{key:"prelu",value:function(e,t){var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL(qL,e.shape,t.shape):new GL(HL,e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"elu",value:function(e){if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,wV,e.dtype);var t=new uV(e.shape,"return (x >= 0.0) ? x : (exp(x) - 1.0);");return this.compileAndRun(t,[e])}},{key:"eluDer",value:function(e,t){var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new GL("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"selu",value:function(e){var t=new uV(e.shape,fV);return this.compileAndRun(t,[e])}},{key:"int",value:function(e){var t=new uV(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")}},{key:"clip",value:function(e,t,n){var r,a=(r=cy().getBool("WEBGL_PACK_CLIP")?new ZL(e.shape):new XL(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(cy().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cV,e.dtype);var t=new uV(e.shape,cV);return this.compileAndRun(t,[e])}},{key:"complexAbs",value:function(e){var t=this.texData.get(e.dataId),n=new YL(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)}},{key:"sigmoid",value:function(e){var t=new uV(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])}},{key:"softplus",value:function(e){var t=new uV(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])}},{key:"sin",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])}},{key:"cos",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])}},{key:"tan",value:function(e){var t=new uV(e.shape,"return tan(x);");return this.compileAndRun(t,[e])}},{key:"asin",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(t,[e])}},{key:"acos",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(t,[e])}},{key:"atan",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])}},{key:"atan2",value:function(e,t){var n=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new GL("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"sinh",value:function(e){var t=new uV(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"cosh",value:function(e){var t=new uV(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"tanh",value:function(e){var t=new uV(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])}},{key:"asinh",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])}},{key:"acosh",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(t,[e])}},{key:"atanh",value:function(e){var t=new uV(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(t,[e])}},{key:"erf",value:function(e){var t=new uV(e.shape,yV);return this.compileAndRun(t,[e])}},{key:"step",value:function(e,t){var n=new uV(e.shape,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return"if (isnan(x)) return x;"+"\n    return x > 0.0 ? 1.0 : float(".concat(e,");\n  ")}(t));return this.compileAndRun(n,[e])}},{key:"conv2dByMatMul",value:function(e,t,n,a,i,o){var s=e.shape,u=this.texData.get(e.dataId),c="channelsLast"===n.dataFormat,l=s[2]%2!=0&&!!u.isPacked;if((1==s[0]*s[1]*s[2]||1===n.outChannels)&&n.inChannels>1e3||!cy().getBool("WEBGL_LAZILY_UNPACK")||!cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!l){var h=this.reshape(e,[1,c?s[0]*s[1]*s[2]:s[0]*s[2]*s[3],n.inChannels]),f=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:h,b:f,transposeA:!1,transposeB:!1,bias:a,activation:i,preluActivationWeights:o}),n.outShape)}var d={dataId:e.dataId,shape:[1,c?s[0]*s[1]*(s[2]+1):s[0]*s[2]*(s[3]+1),n.inChannels],dtype:e.dtype},p=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,r.assert(hL(u.shape,d.shape),(function(){return"packed reshape ".concat(u.shape," to ").concat(d.shape," isn't free")}));var v=this.reshape(t,[1,n.inChannels,n.outChannels]),m=this.fusedBatchMatMul({a:d,b:v,transposeA:!1,transposeB:!1,bias:a,activation:i,preluActivationWeights:o}),g=this.texData.get(m.dataId);return r.assert(g.isPacked,(function(){return"batchMatMul result is expected to be packed"})),u.shape=p,g.shape=n.outShape,WA().makeTensorFromDataId(m.dataId,n.outShape,m.dtype)}},{key:"conv2dWithIm2Row",value:function(e,t,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,h="channelsLast"===n.dataFormat,f=o*s*u,d=l*c,p=[f,d],v=e.squeeze([0]),m=t.reshape([1,f,-1]),g=new TB(p,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,p[0],p[1]]),b=null!=r,k=null!=i,_=a?NV(a,!0):null,w=new FB(y.shape,[1,d,n.outChannels],!0,!1,b,_,k),C=[y,m];return r&&C.push(r),k&&C.push(i),this.compileAndRun(w,C).reshape(h?[1,l,c,n.outChannels]:[1,n.outChannels,l,c])}},{key:"fusedConv2d",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(cy().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var s=null!=a,u=null!=o,c=i?NV(i,!1):null,l=new oB(r,s,c,u),h=[t,n];return a&&h.push(a),o&&h.push(o),this.compileAndRun(l,h)}},{key:"conv2d",value:function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(cy().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new oB(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerInput",value:function(e,t,n){var r=new tB(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerFilter",value:function(e,t,n){var r=new eB(n);return this.compileAndRun(r,[e,t])}},{key:"fusedDepthwiseConv2D",value:function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=cy().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?NV(o,u):null,l=[n,r],h=null!=i,f=null!=s;return h&&l.push(i),f&&l.push(s),u?(t=new cB(a,h,c,f),this.compileAndRun(t,l)):(t=new uB(a,h,c,f),this.compileAndRun(t,l))}},{key:"depthwiseConv2D",value:function(e,t,n){var r;return cy().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new cB(n),this.compileAndRun(r,[e,t])):(r=new uB(n),this.compileAndRun(r,[e,t]))}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){var r=new iB(n);return this.compileAndRun(r,[e,t])}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){var r=new aB(n);return this.compileAndRun(r,[e,t])}},{key:"conv3d",value:function(e,t,n){var r=new sB(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerInput",value:function(e,t,n){var r=new rB(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerFilter",value:function(e,t,n){var r=new nB(n);return this.compileAndRun(r,[e,t])}},{key:"maxPool",value:function(e,t){var n=new VB(t,"max",!1);return this.compileAndRun(n,[e])}},{key:"avgPool",value:function(e,t){var n=new VB(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPoolBackprop",value:function(e,t,n,r){var a=new VB(r,"max",!0),i=this.compileAndRun(a,[t]),o=new OB(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s}},{key:"avgPoolBackprop",value:function(e,t,n){var r=new PL(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"cast",value:function(e,t){return w.castTensor(e,t,this)}},{key:"unstack",value:function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;for(var u=new Array(n),c=0;c<u.length;c++)o[t]=c,u[c]=this.slice(e,o,s).reshape(r);return u}},{key:"avgPool3d",value:function(e,t){var n=new WB(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"avgPool3dBackprop",value:function(e,t,n){var r=new zL(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"maxPool3d",value:function(e,t){var n=new WB(t,"max",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){var a=new WB(r,"max",!0),i=this.compileAndRun(a,[t]),o=new DB(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s}},{key:"reshape",value:function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!hL(e.shape,t)&&(null===n.texture||!hL(n.shape,t))){var r=this.packedReshape(e,t);return WA().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return w.reshapeTensor(e,t)}},{key:"resizeBilinear",value:function(e,t,n,r){var a=cy().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qB(e.shape,t,n,r):new GB(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")}},{key:"resizeBilinearBackprop",value:function(e,t,n){var r=new HB(e,t,n);return this.compileAndRun(r,[e])}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){var a=new XB(e.shape,t,n,r);return this.compileAndRun(a,[e])}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){var r=new KB(e,t,n);return this.compileAndRun(r,[e])}},{key:"multinomial",value:function(e,t,n,r){var a=t?e:BT(e),i=new MB(a.shape[0],a.shape[1],n),o=i.getCustomSetupFunc(r);return this.compileAndRun(i,[a],"int32",o)}},{key:"oneHot",value:function(e,t,n,r){var a=new PB(e.size,t,n,r);return this.compileAndRun(a,[e])}},{key:"diag",value:function(e){var t=new mB(e.size);return this.compileAndRun(t,[e])}},{key:"cropAndResize",value:function(e,t,n,r,a,i){var o=new lB(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")}},{key:"depthToSpace",value:function(e,t,n){r.assert(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)}));var a=e.shape[0],i=("NHWC"===n?e.shape[1]:e.shape[2])*t,o=("NHWC"===n?e.shape[2]:e.shape[3])*t,s=("NHWC"===n?e.shape[3]:e.shape[1])/(t*t),u=new vB("NHWC"===n?[a,i,o,s]:[a,s,i,o],t,n);return this.compileAndRun(u,[e])}},{key:"split",value:function(e,t,n){return AV(e,t,n)}},{key:"scatterND",value:function(e,t,n){var r=w.calculateShapes(t,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=e.reshape([i,a]),h=t.reshape([i,o]);if(0===u)return w.reshapeTensor(S_([]),n);var f=I_(0),d=new $B(i,a,l.rank,h.rank,s,c);return this.compileAndRun(d,[h,l,f]).reshape(n)}},{key:"sparseToDense",value:function(e,t,n,r){var a=w.calculateShapes(t,e,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,u=a.outputSize,c=new $B(o,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)}},{key:"fft",value:function(e){return this.fftImpl(e,!1)}},{key:"ifft",value:function(e){return this.fftImpl(e,!0)}},{key:"fftImpl",value:function(e,t){var n=this.texData.get(e.dataId),r=new _B("return real * expR - imag * expI;",e.shape,t),a=new _B("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),u=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),u}},{key:"gatherND",value:function(e,t){var n=t.shape,r=n[n.length-1],a=_slicedToArray(w.prepareAndValidate(e,t),4),i=a[0],o=a[1],s=a[2],u=a[3],c=t.reshape([o,r]),l=e.reshape([e.size/s,s]),h=new xB(r,u,[o,s]);return this.compileAndRun(h,[l,c]).reshape(i)}},{key:"fill",value:function(e,t,n){if("string"===(n=n||r.inferDtype(t))){var a=r.getArrayFromDType(n,r.sizeFromShape(e));return a.fill(t),WA().makeTensor(a,e,n,this)}var i=new wB(e,t),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[],n,o)}},{key:"onesLike",value:function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)}},{key:"zerosLike",value:function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)}},{key:"linspace",value:function(e,t,n){return w.linspaceImpl(e,t,n)}},{key:"makeTensorInfo",value:function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t){var n=this.makeTensorInfo(e,t).dataId;return WA().makeTensorFromDataId(n,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new xV(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new zB(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[sL(e.shape)].concat(_toConsumableArray(uL(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[sL(t)].concat(_toConsumableArray(uL(t))),i=new jB(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=cL(a);return t=r?new pB(o):new dB(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,a){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(s.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Bz.DENSE){var c=qz(e.outputShape);u.texShape=c.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===r.sizeFromShape(s.shape))return u.values=r.getTypedArrayFromDType(s.dtype,0),s;var l=[],h=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&r.sizeFromShape(t.shape)<=cy().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),l.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!hL(n.shape,t.shape)){var a=t,o=t.shape;t.shape=n.shape,t=i.packedReshape(t,o),l.push(t),n=i.texData.get(t.dataId),a.shape=o}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(s.dataId);var f,d={shape:s.shape,texData:u,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(e){r+="".concat(e.shape,"_").concat(e.isUniform?"uniform":e.texData.texShape,"_").concat(null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0)}));var a=e.constructor.name;return a+="_"+r+"_"+e.userCode}(e,h,d),v=this.getAndSaveBinary(p,(function(){return function(e,t,n,a){var i=t.userCode,o=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),s=o.map((function(e){return e.shapeInfo})),u={logicalShape:a.shape,texShape:a.texData.texShape,isUniform:!1,isPacked:a.texData.isPacked,flatOffset:null},c=function(e,t,n,a){var i=[];e.forEach((function(e){var t=r.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?i.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(i.push("uniform sampler2D ".concat(e.name,";")),i.push("uniform int offset".concat(e.name,";")))}));var o,s,u=i.join("\n"),c=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a="";return a+=n?function e(t){switch(t.shapeInfo.logicalShape.length){case 0:return n=t.name,"\n    vec4 ".concat("get"+n.charAt(0).toUpperCase()+n.slice(1),"() {\n      return ").concat(_L().texture2D,"(").concat(n,", halfCR);\n    }\n  ");case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=_L();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(t);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,a="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,o=i[0],s=i[1],u=_L();if(null!=i&&r.arraysEqual(t,i))return"\n      vec4 ".concat(a,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");var c=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return"\n    vec4 ".concat(a,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(Math.ceil(t[1]/2),", ").concat(c[0],", ").concat(c[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,r=t.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=t.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];if(1===n[0]){var s=DL(t,n.slice(1));return"\n        ".concat(e(s),"\n        vec4 ").concat(a,"(int b, int row, int col) {\n          return ").concat(a,"(").concat(FL(["b","row","col"],[1,2]),");\n        }\n      ")}var u=o[0],c=o[1],l=Math.ceil(n[2]/2);return"\n    vec4 ".concat(a,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(c,", ").concat(l*Math.ceil(n[1]/2),", ").concat(l,", b, row, col);\n      return ").concat(_L().texture2D,"(").concat(r,", uv);\n    }\n  ")}(t);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),h="int b, int row, int col",f="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),d=2;d<n-1;d++)h="int b".concat(d,", ")+h,l*=t[n-d-1],f="b".concat(d," * ").concat(l," + ")+f;return"\n    vec4 ".concat(a,"(").concat(h,") {\n      int index = ").concat(f,";\n      int texR = index / ").concat(u,";\n      int texC = index - texR * ").concat(u,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(u,", ").concat(s,");\n      return ").concat(_L().texture2D,"(").concat(r,", uv);\n    }\n  ")}(t)}var n}(e):function e(t){var n=t.shapeInfo.logicalShape;switch(n.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=_slicedToArray(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=_slicedToArray(e.shapeInfo.texShape,2),s=o[0],u=o[1];return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(s,", ").concat(u,", ").concat(RL(t),");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(t);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(NL(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=RL(t);return 1===i?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):1===a?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(t);case 2:return function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=t.shapeInfo.texShape;if(null!=o&&r.arraysEqual(n,o))return"\n    float ".concat(i,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o[1],".0, ").concat(o[0],".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ");var s=r.squeezeShape(n),u=s.newShape,c=s.keptDims;if(u.length<n.length){var l=DL(t,u);return"\n      ".concat(e(l),"\n      float ").concat(i,"(int row, int col) {\n        return ").concat(i,"(").concat(FL(["row","col"],c),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(n[1],", 1)));\n        ").concat(NL(t),"\n      }\n    ");var h=o[0],f=o[1],d=RL(a);return 1===f?"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(h,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):1===h?"\n    float ".concat(i,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(d,"), vec3(").concat(n[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(f,".0, 0.5);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):"\n  float ".concat(i,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(n[1]," + col + ").concat(d,";\n    vec2 uv = uvFromFlat(").concat(h,", ").concat(f,", index);\n    return sampleTexture(").concat(a,", uv);\n  }\n")}(t);case 3:return function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[1]*n[2],s=n[2],u=r.squeezeShape(n),c=u.newShape,l=u.keptDims;if(c.length<n.length){var h=DL(t,c);return"\n        ".concat(e(h),"\n        float ").concat(i,"(int row, int col, int depth) {\n          return ").concat(i,"(").concat(FL(["row","col","depth"],l),");\n        }\n      ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(o,", ").concat(s,", 1)));\n        ").concat(NL(t),"\n      }\n    ");var f=t.shapeInfo.texShape,d=f[0],p=f[1],v=t.shapeInfo.flatOffset;return p===o&&null==v?"\n        float ".concat(i,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(s,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(p,".0, ").concat(d,".0);\n          return sampleTexture(").concat(a,", uv);\n        }\n      "):p===s&&null==v?"\n    float ".concat(i,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(n[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(p,".0, ").concat(d,".0);\n      return sampleTexture(").concat(a,", uv);\n    }\n  "):"\n      float ".concat(i,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(o," + col * ").concat(s," + depth + ").concat(RL(a),";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(p,", index);\n        return sampleTexture(").concat(a,", uv);\n      }\n  ")}(t);case 4:return function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[3],s=n[2]*o,u=n[1]*s,c=r.squeezeShape(n),l=c.newShape,h=c.keptDims;if(l.length<n.length){var f=DL(t,l);return"\n      ".concat(e(f),"\n      float ").concat(i,"(int row, int col, int depth, int depth2) {\n        return ").concat(i,"(").concat(FL(["row","col","depth","depth2"],h),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(u,", ").concat(s,", ").concat(o,", 1)));\n        ").concat(NL(t),"\n      }\n    ");var d=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,v=p[0],m=p[1];return m===u&&null==d?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):m===o&&null==d?"\n      float ".concat(i,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(n[1]*n[2],", ").concat(n[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(s," +\n          depth * ").concat(o," + depth2;\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index + ").concat(RL(a),");\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(t);case 5:return function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=n[4],s=n[3]*o,u=n[2]*s,c=n[1]*u,l=r.squeezeShape(n),h=l.newShape,f=l.keptDims;if(h.length<n.length){var d=DL(t,h);return"\n      ".concat(e(d),"\n      float ").concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(i,"(").concat(FL(["row","col","depth","depth2","depth3"],f),");\n      }\n    ")}if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(u,", ").concat(s,", ").concat(o,")) +\n          depth3;\n        ").concat(NL(t),"\n      }\n    ");var p=t.shapeInfo.flatOffset,v=t.shapeInfo.texShape,m=v[0],g=v[1];return g===c&&null==p?"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(u,", ").concat(s,", ").concat(o,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):g===o&&null==p?"\n      float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3],",\n               ").concat(n[2]*n[3],", ").concat(n[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(m,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(u," + depth * ").concat(s," +\n          depth2 * ").concat(o," + depth3 + ").concat(RL(a),";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(g,", index);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(t);case 6:return function(t){var n=t.shapeInfo.logicalShape,a=t.name,i="get"+a.charAt(0).toUpperCase()+a.slice(1),o=r.squeezeShape(n),s=o.newShape,u=o.keptDims;if(s.length<n.length){var c=DL(t,s);return"\n      ".concat(e(c),"\n      float ").concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(i,"(").concat(FL(["row","col","depth","depth2","depth3","depth4"],u),");\n      }\n    ")}var l=n[5],h=n[4]*l,f=n[3]*h,d=n[2]*f,p=n[1]*d;if(t.shapeInfo.isUniform)return"\n      float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(d,", ").concat(f,", ").concat(h,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(l,", 1)));\n        ").concat(NL(t),"\n      }\n    ");var v=t.shapeInfo.flatOffset,m=t.shapeInfo.texShape,g=m[0],y=m[1];return y===p&&null==v?"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(d,", ").concat(f,", ").concat(h,", ").concat(l,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(y,".0, ").concat(g,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):y===l&&null==v?"\n      float ".concat(i,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(n[1]*n[2]*n[3]*n[4],",\n               ").concat(n[2]*n[3]*n[4],",\n               ").concat(n[3]*n[4],",\n               ").concat(n[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(y,".0, ").concat(g,".0);\n        return sampleTexture(").concat(a,", uv);\n      }\n    "):"\n    float ".concat(i,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(d," + depth * ").concat(f," +\n          depth2 * ").concat(h," + depth3 * ").concat(l," + depth4 + ").concat(RL(a),";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(y,", index);\n      return sampleTexture(").concat(a,", uv);\n    }\n  ")}(t);default:throw new Error("".concat(n.length,"-D input sampling")+" is not yet supported")}}(e),e.shapeInfo.logicalShape.length<=t.logicalShape.length&&(a+=n?function(e,t){var n,a=e.name,i=a.charAt(0).toUpperCase()+a.slice(1),o="get"+i+"AtOutCoords",s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,c=SL(e.shapeInfo.logicalShape,t.logicalShape),l=OL(u),h=u-s,f=["x","y","z","w","u","v"];n=0===s?"":u<2&&c.length>=1?"coords = 0;":c.map((function(e){return"coords.".concat(f[e+h]," = 0;")})).join("\n");var d;d=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+h])})).join(", ");var p="return outputValue;",v=1===r.sizeFromShape(e.shapeInfo.logicalShape),m=1===r.sizeFromShape(t.logicalShape);if(1!==s||v||m){if(v&&!m)p=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(c.length){var g=s-2,y=s-1;c.indexOf(g)>-1&&c.indexOf(y)>-1?p="return vec4(outputValue.x);":c.indexOf(g)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":c.indexOf(y)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(i,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}(e,t):function(e,t){var n=e.name,a=n.charAt(0).toUpperCase()+n.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&o===s&&null==e.shapeInfo.flatOffset&&r.arraysEqual(e.shapeInfo.texShape,t.texShape))return"\n      float ".concat(i,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var u,c=OL(s),l=SL(e.shapeInfo.logicalShape,t.logicalShape),h=s-o,f=["x","y","z","w","u","v"];u=0===o?"":s<2&&l.length>=1?"coords = 0;":l.map((function(e){return"coords.".concat(f[e+h]," = 0;")})).join("\n");var d;return d=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+h])})).join(", "),"\n    float ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(u,"\n      return get").concat(a,"(").concat(d,");\n    }\n  ")}(e,t)),a}(e,t,a)})).join("\n"),l=t.texShape,h=_L(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(h),d=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(AL,"\n    ").concat(IL,"\n    ").concat(TL,"\n  ")}(h);return t.isPacked?(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return n=t,1===(a=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(a[1],".0);\n      }\n    "):1===a[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(a[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(a[0],", ").concat(a[1],"));\n      return 2 * (resTexRC.x * ").concat(a[1]," + resTexRC.y);\n    }\n  ");case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(r.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var a=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(a,");\n      int c = imod(index, ").concat(a,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)i*=e[e.length-u-1],o="\n      int b".concat(u," = index / ").concat(i,";\n      index -= b").concat(u," * ").concat(i,";\n    ")+o,s="b".concat(u,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}var n,a}(t.logicalShape,l),s=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(h)):(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=t)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):1===n[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return resTexRC.x * ").concat(n[1]," + resTexRC.y;\n    }\n  ");case 2:return function(e,t){return r.arraysEqual(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=wL(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=wL(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=wL(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=wL(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}var n}(t.logicalShape,l),s=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(h)),a&&(d+=EL),[d,f,s,u,o,c,n].join("\n")}(o,u,i,t.packedInputs),l=e.createProgram(c),h=null,f=e.getUniformLocation(l,"NAN",!1);1===cy().getNumber("WEBGL_VERSION")&&(h=e.getUniformLocation(l,"INFINITY",!1));for(var d={},p=0;p<t.variableNames.length;p++){var v=t.variableNames[p];d[v]=e.getUniformLocation(l,v,!1),d["offset".concat(v)]=e.getUniformLocation(l,"offset".concat(v),!1)}return{program:t,source:c,webGLProgram:l,uniformLocations:d,inShapeInfos:s,outShapeInfo:u,infLoc:h,nanLoc:f}}(i.gpgpu,e,h,d)})),m=null!=this.activeTimers;if(m&&(f=this.startTimer()),function(e,t,n,a,i){IB(t.inShapeInfos,n),IB([t.outShapeInfo],[a]);var o=a.texData.texture,s=a.texData.texShape;a.texData.isPacked?e.setOutputPackedMatrixTexture(o,s[0],s[1]):e.setOutputMatrixTexture(o,s[0],s[1]),e.setProgram(t.webGLProgram),1===cy().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,a){var i=t.program.variableNames[a],o=t.uniformLocations[i],s=t.uniformLocations["offset".concat(i)];if(null!=o)if(n.isUniform)if(r.sizeFromShape(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{var u=n.uniformValues;u instanceof Float32Array||(u=new Float32Array(u)),e.gl.uniform1fv(o,u)}else null!=n.texData.slice&&null!=s&&e.gl.uniform1i(s,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,o,a)})),null!=i&&i(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,v,h,d,a),l.forEach((function(e){return i.disposeData(e.dataId)})),m&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!cy().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===o){var g=this.unpackTensor(s);return this.disposeData(s.dataId),g}return s}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=this.runWebGLProgram(e,t,n=n||t[0].dtype,r,a);return WA().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;this.disposed||(cy().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=HA((function(){if(!cy().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=cy().getBool("DEBUG");cy().set("DEBUG",!1);var n=e.abs(I_(1e-8)).dataSync()[0];if(cy().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,a=t.dtype,i=t.values,o=t.texture,s=t.usage,u=t.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=r.now());var h=t.texShape;if(null==h&&(h=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=cy().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?r.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=r.squeezeShape(e);e=a.newShape}var i=r.sizeFromShape(e);if(e.length<=1&&i<=n)return[1,i];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var o,s=sL(e),u=2,c=2;return e.length&&(u=(o=_slicedToArray(uL(e),2))[0],c=o[1]),i=s*(u/2)*(c/2),r.sizeToSquarishShape(i).map((function(e){return 2*e}))}return r.sizeToSquarishShape(i)}(n,u),t.texShape=h),null!=i){var f,d,p=cL(n),v=h[1],m=h[0],g=i instanceof Uint8Array;u?(v=(f=_slicedToArray(Kz(h[0],h[1]),2))[0],m=f[1],d=new kB(p,[m,v],g)):d=new bB(p,[m,v],g);var y=this.makeTensorInfo([m,v],a);this.texData.get(y.dataId).usage=g?Vz.PIXELS:Vz.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),v,m,i);var b=this.runWebGLProgram(d,[y],a,null,!0),k=this.texData.get(b.dataId);t.texture=k.texture,t.texShape=k.texShape,t.isPacked=k.isPacked,t.usage=k.usage,this.disposeData(y.dataId),this.texData.delete(b.dataId),t.values=null,l&&(this.uploadWaitMs+=r.now()-c)}else{var _=this.acquireTexture(h,s,a,u);t.texture=_}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*r.bytesPerElement(t)}}]),s}(OR),FV={kernelName:mk,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return function(e,t,n){var r=new GL("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new KL("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",e.shape,t.shape,!0)),n.runWebGLProgram(r,[e,t],"float32")}(t.a,t.b,n)}},MV=function e(t){_classCallCheck(this,e),this.variableNames=["A"];var n=_L(),r=_slicedToArray(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},PV=function e(t){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=_L(),r=_slicedToArray(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},zV={kernelName:u_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,u=_slicedToArray(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=u[0],l=u[1],h=[l,c],f=[l,c,i];(s||o)&&(null==OV&&(OV=document.createElement("canvas").getContext("2d")),OV.canvas.width=c,OV.canvas.height=l,OV.drawImage(a,0,0,c,l),a=OV.canvas);var d=n.makeTensorInfo(h,"int32");n.texData.get(d.dataId).usage=Vz.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);var p=cy().getBool("WEBGL_PACK")?new PV(f):new MV(f),v=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),v}},LV=W.maxImpl,BV=W.transposeImpl;function VV(e,t,n){var r=n.texData.get(e.dataId);return!r.isPacked||hL(e.shape,t)||null!==r.texture&&hL(r.shape,t)?{dataId:e.dataId,shape:t,dtype:e.dtype}:function(e,t,n){var r=[sL(e.shape)].concat(_toConsumableArray(uL(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[sL(t)].concat(_toConsumableArray(uL(t))),o=new jB(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(e,t,n)}var WV=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=OL(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")},UV=function e(t,n){_classCallCheck(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=OL(this.rank),o=bL("rc",this.rank),s=new Array(this.rank),u=0;u<n.length;u++)s[n[u]]=o[u];var c="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),h="getChannel(getA(".concat(s.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(h,";\n      if(").concat(l,") {\n        result[1] = ").concat(h,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(h,";\n        if(").concat(l,") {\n          result[3] = ").concat(h,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function jV(e,t,n){var r=cy().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UV(e.shape,t):new WV(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}for(var HV={kernelName:jk,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;w.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=n,l=c.readSync(a.dataId),h=c.readSync(i.dataId);return C.nonMaxSuppressionV3(l,h,o,s,u)}},GV=C.nonMaxSuppressionV5,qV=0,KV=[{kernelName:Ok,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,a=e.backend,i=t.x,o=n.reductionIndices,s=a,u=i.shape.length,c=r.parseAxisParam(o,i.shape),l=w.getAxesPermutation(c,u),h=null!=l,f=s.shouldExecuteOnCPU([i]),d=i;if(h){if(f){for(var p=s.texData.get(d.dataId).values,v=new Array(u),m=0;m<v.length;m++)v[m]=i.shape[l[m]];var g=BV(p,i.shape,i.dtype,l,v);d=s.makeTensorInfo(v,i.dtype),s.texData.get(d.dataId).values=g}else d=jV(i,l,s);c=w.getInnerMostAxes(c.length,u)}w.assertAxesAreInnerMostDims("max",c,u);var y,b=_slicedToArray(w.computeOutAndReduceShapes(d.shape,c),2),k=b[0],_=b[1];if(f){var C=s.texData.get(d.dataId),x=LV(C.values,r.sizeFromShape(_),k,i.dtype);y=s.makeTensorInfo(k,i.dtype),s.texData.get(y.dataId).values=x}else y=function(e,t,n,a){var i=r.sizeFromShape(t),o=VV(e,[r.sizeFromShape(e.shape)/i,i],a),s=function e(t,n,r,a){var i=_slicedToArray(t.shape,2),o=i[0],s=i[1],u=w.computeOptimalWindowSize(s),c=new UB({windowSize:u,inSize:s,batchSize:o},r),l=a.runWebGLProgram(c,[t],n);return 1===l.shape[1]?l:e(l,n,r,a)}(o,e.dtype,"max",a);return o.dataId!==e.dataId&&a.disposeData(o.dataId),VV(s,n,a)}(d,_,k,s);return h&&s.disposeData(d.dataId),y}},zV,FV,HV,{kernelName:Hk,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;w.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,i=t.scores,o=r.maxOutputSize,s=r.iouThreshold,u=r.scoreThreshold,c=r.softNmsSigma,l=n,h=l.readSync(a.dataId),f=l.readSync(i.dataId),d=GV(h,f,o,s,u,c);return[d.selectedIndices,d.selectedScores]}},{kernelName:a_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new uV(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:r_,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.a,a=t.b,i=n,o=cy().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new KL("return (a - b) * (a - b);",r.shape,a.shape):new GL("return (a - b) * (a - b);",r.shape,a.shape);return i.compileAndRun(o,[r,a])}},{kernelName:s_,backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,a=e.backend,i=n.x,o=r.perm,s=a,u=new Array(i.shape.length),c=0;c<u.length;c++)u[c]=i.shape[o[c]];if(s.shouldExecuteOnCPU([i])){var l=s.texData.get(i.dataId),h=BV(l.values,i.shape,i.dtype,o,u);t=s.makeTensorInfo(u,i.dtype),s.texData.get(t.dataId).values=h}else t=jV(i,o,s);return t}},{kernelName:Lk,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,a=e.backend,i=t.x,o=n.filterSize,s=n.strides,u=n.pad,c=n.includeBatchInIndex,l=a;r.assert(4===i.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(i.shape.length,".")}));var h=[1,1];r.assert(w.eitherStridesOrDilationsAreOne(s,h),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(h,"'")}));var f=w.computePool2DInfo(i.shape,o,s,h,u),d=_slicedToArray(function(e,t,n,r){var a=new VB(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new VB(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(i,c,f,l),2);return[d[0],d[1]]}}];qV<KV.length;qV++){by(KV[qV])}function XV(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}i.isBrowser()&&eI("webgl",(function(){return new DV}),2);var ZV,YV,$V,JV,QV,eW,tW,nW,rW,aW,iW=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e,r)).scheduler=e,a.work=r,a}return _createClass(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>0?_get(_getPrototypeOf(n.prototype),"schedule",this).call(this,e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}},{key:"execute",value:function(e,t){return t>0||this.closed?_get(_getPrototypeOf(n.prototype),"execute",this).call(this,e,t):this._execute(e,t)}},{key:"requestAsyncId",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return null!==r&&r>0||null===r&&this.delay>0?_get(_getPrototypeOf(n.prototype),"requestAsyncId",this).call(this,e,t,r):e.flush(this)}}]),n}(xf),oW=new(function(e){_inherits(n,e);var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return n}(Af))(iW),sW=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return _classCallCheck(this,n),(a=t.call(this,e)).scheduler=r,a.delay=i,a}return _createClass(n,[{key:"scheduleMessage",value:function(e){this.destination.add(this.scheduler.schedule(n.dispatch,this.delay,new uW(e,this.destination)))}},{key:"_next",value:function(e){this.scheduleMessage(id.createNext(e))}},{key:"_error",value:function(e){this.scheduleMessage(id.createError(e)),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleMessage(id.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){var t=e.notification,n=e.destination;t.observe(n),this.unsubscribe()}}]),n}(ee),uW=function e(t,n){_classCallCheck(this,e),this.notification=t,this.destination=n},cW=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,i=arguments.length>2?arguments[2]:void 0;return _classCallCheck(this,n),(e=t.call(this)).scheduler=i,e._events=[],e._infiniteTimeWindow=!1,e._bufferSize=r<1?1:r,e._windowTime=a<1?1:a,a===Number.POSITIVE_INFINITY?(e._infiniteTimeWindow=!0,e.next=e.nextInfiniteTimeWindow):e.next=e.nextTimeWindow,e}return _createClass(n,[{key:"nextInfiniteTimeWindow",value:function(e){var t=this._events;t.push(e),t.length>this._bufferSize&&t.shift(),_get(_getPrototypeOf(n.prototype),"next",this).call(this,e)}},{key:"nextTimeWindow",value:function(e){this._events.push(new lW(this._getNow(),e)),this._trimBufferThenGetEvents(),_get(_getPrototypeOf(n.prototype),"next",this).call(this,e)}},{key:"_subscribe",value:function(e){var t,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),a=this.scheduler,i=r.length;if(this.closed)throw new le;if(this.isStopped||this.hasError?t=$.EMPTY:(this.observers.push(e),t=new he(this,e)),a&&e.add(e=new sW(e,a)),n)for(var o=0;o<i&&!e.closed;o++)e.next(r[o]);else for(var s=0;s<i&&!e.closed;s++)e.next(r[s].value);return this.hasError?e.error(this.thrownError):this.isStopped&&e.complete(),t}},{key:"_getNow",value:function(){return(this.scheduler||oW).now()}},{key:"_trimBufferThenGetEvents",value:function(){for(var e=this._getNow(),t=this._bufferSize,n=this._windowTime,r=this._events,a=r.length,i=0;i<a&&!(e-r[i].time<n);)i++;return a>t&&(i=Math.max(i,a-t)),i>0&&r.splice(0,i),r}}]),n}(de),lW=function e(t,n){_classCallCheck(this,e),this.time=t,this.value=n},hW=function(){function e(t){_classCallCheck(this,e),this.notifier=t}return _createClass(e,[{key:"call",value:function(e,t){var n=new fW(e),r=t.subscribe(n);return r.add(we(n,this.notifier)),r}}]),e}(),fW=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).hasValue=!1,e}return _createClass(n,[{key:"_next",value:function(e){this.value=e,this.hasValue=!0}},{key:"notifyNext",value:function(e,t,n,r,a){this.emitValue()}},{key:"notifyComplete",value:function(){this.emitValue()}},{key:"emitValue",value:function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))}}]),n}(Ce),dW=function(){function e(t){_classCallCheck(this,e),this.total=t}return _createClass(e,[{key:"call",value:function(e,t){return t.subscribe(new pW(e,this.total))}}]),e}(),pW=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,r){var a;return _classCallCheck(this,n),(a=t.call(this,e)).total=r,a.count=0,a}return _createClass(n,[{key:"_next",value:function(e){++this.count>this.total&&this.destination.next(e)}}]),n}(ee),vW=["*"],mW=((JV=function e(){_classCallCheck(this,e)}).\u0275prov=Je({token:JV,factory:JV.\u0275fac=function(e){return new(e||JV)}}),JV),gW=(($V=function(){function e(t,n){var r=this;_classCallCheck(this,e),this._loader=t,this._zone=n,this._map=new Promise((function(e){r._mapResolver=e}))}return _createClass(e,[{key:"createMap",value:function(e,t){var n=this;return this._zone.runOutsideAngular((function(){return n._loader.load().then((function(){var r=new google.maps.Map(e,t);n._mapResolver(r)}))}))}},{key:"setMapOptions",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){t._map.then((function(t){t.setOptions(e)}))}))}},{key:"createMarker",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this._zone.runOutsideAngular((function(){return e._map.then((function(e){return n&&(t.map=e),new google.maps.Marker(t)}))}))}},{key:"createInfoWindow",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(){return new google.maps.InfoWindow(e)}))}))}},{key:"createCircle",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){return e.map=t,new google.maps.Circle(e)}))}))}},{key:"createRectangle",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){return e.map=t,new google.maps.Rectangle(e)}))}))}},{key:"createPolyline",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t.getNativeMap().then((function(t){var n=new google.maps.Polyline(e);return n.setMap(t),n}))}))}},{key:"createPolygon",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t.getNativeMap().then((function(t){var n=new google.maps.Polygon(e);return n.setMap(t),n}))}))}},{key:"createDataLayer",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){var n=new google.maps.Data(e);return n.setMap(t),n}))}))}},{key:"createTransitLayer",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){var t=new google.maps.TransitLayer;return t.setMap(e),t}))}))}},{key:"createBicyclingLayer",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){var t=new google.maps.BicyclingLayer;return t.setMap(e),t}))}))}},{key:"containsLocation",value:function(e,t){return this._map.then((function(){return google.maps.geometry.poly.containsLocation(e,t)}))}},{key:"subscribeToMapEvent",value:function(e){var t=arguments,n=this;return new se((function(r){n._map.then((function(a){return a.addListener(e,(function(){return n._zone.run((function(){return r.next(t[0])}))}))}))}))}},{key:"clearInstanceListeners",value:function(){var e=this;return this._zone.runOutsideAngular((function(){e._map.then((function(e){google.maps.event.clearInstanceListeners(e)}))}))}},{key:"setCenter",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){return t.setCenter(e)}))}))}},{key:"getZoom",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){return e.getZoom()}))}))}},{key:"getBounds",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){return e.getBounds()}))}))}},{key:"getMapTypeId",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){return e.getMapTypeId()}))}))}},{key:"setZoom",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){return t.setZoom(e)}))}))}},{key:"getCenter",value:function(){var e=this;return this._zone.runOutsideAngular((function(){return e._map.then((function(e){return e.getCenter()}))}))}},{key:"panTo",value:function(e){var t=this;return this._zone.runOutsideAngular((function(){return t._map.then((function(t){return t.panTo(e)}))}))}},{key:"panBy",value:function(e,t){var n=this;return this._zone.runOutsideAngular((function(){return n._map.then((function(n){return n.panBy(e,t)}))}))}},{key:"fitBounds",value:function(e,t){var n=this;return this._zone.runOutsideAngular((function(){return n._map.then((function(n){return n.fitBounds(e,t)}))}))}},{key:"panToBounds",value:function(e,t){var n=this;return this._zone.runOutsideAngular((function(){return n._map.then((function(n){return n.panToBounds(e,t)}))}))}},{key:"getNativeMap",value:function(){return this._map}},{key:"triggerMapEvent",value:function(e){return this._map.then((function(t){return google.maps.event.trigger(t,e)}))}}]),e}()).\u0275fac=function(e){return new(e||$V)(Pt(mW),Pt(ec))},$V.\u0275prov=Je({token:$V,factory:$V.\u0275fac}),$V),yW=((YV=function(){function e(t,n){_classCallCheck(this,e),this._apiWrapper=t,this._zone=n,this._circles=new Map}return _createClass(e,[{key:"addCircle",value:function(e){var t=this;this._apiWrapper.getNativeMap().then((function(){return t._circles.set(e,t._apiWrapper.createCircle({center:{lat:e.latitude,lng:e.longitude},clickable:e.clickable,draggable:e.draggable,editable:e.editable,fillColor:e.fillColor,fillOpacity:e.fillOpacity,radius:e.radius,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokePosition:google.maps.StrokePosition[e.strokePosition],strokeWeight:e.strokeWeight,visible:e.visible,zIndex:e.zIndex}))}))}},{key:"removeCircle",value:function(e){var t=this;return this._circles.get(e).then((function(n){n.setMap(null),t._circles.delete(e)}))}},{key:"setOptions",value:function(e,t){return XV(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._circles.get(e).then((function(e){t.strokePosition=google.maps.StrokePosition[t.strokePosition],e.setOptions(t)})));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"getBounds",value:function(e){return this._circles.get(e).then((function(e){return e.getBounds()}))}},{key:"getCenter",value:function(e){return this._circles.get(e).then((function(e){return e.getCenter()}))}},{key:"getRadius",value:function(e){return this._circles.get(e).then((function(e){return e.getRadius()}))}},{key:"setCenter",value:function(e){return this._circles.get(e).then((function(t){return t.setCenter({lat:e.latitude,lng:e.longitude})}))}},{key:"setEditable",value:function(e){return this._circles.get(e).then((function(t){return t.setEditable(e.editable)}))}},{key:"setDraggable",value:function(e){return this._circles.get(e).then((function(t){return t.setDraggable(e.draggable)}))}},{key:"setVisible",value:function(e){return this._circles.get(e).then((function(t){return t.setVisible(e.visible)}))}},{key:"setRadius",value:function(e){return this._circles.get(e).then((function(t){return t.setRadius(e.radius)}))}},{key:"getNativeCircle",value:function(e){return this._circles.get(e)}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){var a=null;return n._circles.get(t).then((function(t){a=t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))})),function(){null!==a&&a.remove()}}))}}]),e}()).\u0275fac=function(e){return new(e||YV)(Pt(gW),Pt(ec))},YV.\u0275prov=Je({token:YV,factory:YV.\u0275fac}),YV),bW=((ZV=function(){function e(t,n){_classCallCheck(this,e),this._wrapper=t,this._zone=n,this._layers=new Map}return _createClass(e,[{key:"addDataLayer",value:function(e){var t=this,n=this._wrapper.createDataLayer({style:e.style}).then((function(n){return e.geoJson&&t.getDataFeatures(n,e.geoJson).then((function(e){return n.features=e})),n}));this._layers.set(e,n)}},{key:"deleteDataLayer",value:function(e){var t=this;this._layers.get(e).then((function(n){n.setMap(null),t._layers.delete(e)}))}},{key:"updateGeoJson",value:function(e,t){var n=this;this._layers.get(e).then((function(e){e.forEach((function(t){e.remove(t);var n=e.features.indexOf(t,0);n>-1&&e.features.splice(n,1)})),n.getDataFeatures(e,t).then((function(t){return e.features=t}))}))}},{key:"setDataOptions",value:function(e,t){this._layers.get(e).then((function(e){e.setControlPosition(t.controlPosition),e.setControls(t.controls),e.setDrawingMode(t.drawingMode),e.setStyle(t.style)}))}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._layers.get(t).then((function(t){t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}},{key:"getDataFeatures",value:function(e,t){return new Promise((function(n,r){if("object"==typeof t)try{n(e.addGeoJson(t))}catch(a){r(a)}else"string"==typeof t?e.loadGeoJson(t,null,n):r("Impossible to extract features from geoJson: wrong argument type")}))}}]),e}()).\u0275fac=function(e){return new(e||ZV)(Pt(gW),Pt(ec))},ZV.\u0275prov=Je({token:ZV,factory:ZV.\u0275fac}),ZV),kW=function e(){_classCallCheck(this,e)},_W=((QV=function(){function e(t){var n,r,a=this;_classCallCheck(this,e),this._boundsChangeSampleTime$=new kf(200),this._includeInBounds$=new kf(new Map),this.bounds$=Te(t.load()).pipe(Ee((function(){return a._includeInBounds$})),(n=this._boundsChangeSampleTime$.pipe(zf((function(e){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=-1;return Tf(t)?r=Number(t)<1?1:Number(t):ve(t)&&(n=t),ve(n)||(n=If),new se((function(t){var a=Tf(e)?e:+e-n.now();return n.schedule(Ef,a,{index:0,period:r,subscriber:t})}))}(0,e)}))),function(e){return e.lift(new hW(n))}),xe((function(e){return a._generateBounds(e)})),(r={bufferSize:1,windowTime:void 0,refCount:!1,scheduler:void 0},function(e){return e.lift(function(e){var t,n,r=e.bufferSize,a=void 0===r?Number.POSITIVE_INFINITY:r,i=e.windowTime,o=void 0===i?Number.POSITIVE_INFINITY:i,s=e.refCount,u=e.scheduler,c=0,l=!1,h=!1;return function(e){c++,t&&!l||(l=!1,t=new cW(a,o,u),n=e.subscribe({next:function(e){t.next(e)},error:function(e){l=!0,t.error(e)},complete:function(){h=!0,n=void 0,t.complete()}}));var r=t.subscribe(this);this.add((function(){c--,r.unsubscribe(),n&&!h&&s&&0===c&&(n.unsubscribe(),n=void 0,t=void 0)}))}}(r))}))}return _createClass(e,[{key:"_generateBounds",value:function(e){var t=new google.maps.LatLngBounds;return e.forEach((function(e){return t.extend(e)})),t}},{key:"addToBounds",value:function(e){var t=this._createIdentifier(e);if(!this._includeInBounds$.value.has(t)){var n=this._includeInBounds$.value;n.set(t,e),this._includeInBounds$.next(n)}}},{key:"removeFromBounds",value:function(e){var t=this._includeInBounds$.value;t.delete(this._createIdentifier(e)),this._includeInBounds$.next(t)}},{key:"changeFitBoundsChangeSampleTime",value:function(e){this._boundsChangeSampleTime$.next(e)}},{key:"getBounds$",value:function(){return this.bounds$}},{key:"_createIdentifier",value:function(e){return"".concat(e.lat,"+").concat(e.lng)}}]),e}()).\u0275fac=function(e){return new(e||QV)(Pt(mW))},QV.\u0275prov=Je({token:QV,factory:QV.\u0275fac}),QV),wW=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getNativeWindow",value:function(){return window}}]),e}(),CW=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"getNativeDocument",value:function(){return document}}]),e}(),xW=[wW,CW],SW=function(e){return e[e.HTTP=1]="HTTP",e[e.HTTPS=2]="HTTPS",e[e.AUTO=3]="AUTO",e}({}),AW=new It("angular-google-maps LAZY_MAPS_API_CONFIG"),IW=((aW=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;return _classCallCheck(this,n),(e=t.call(this)).localeId=o,e._SCRIPT_ID="agmGoogleMapsApiScript",e.callbackName="agmLazyMapsAPILoader",e._config=r||{},e._windowRef=a,e._documentRef=i,e}return _createClass(n,[{key:"load",value:function(){var e=this._windowRef.getNativeWindow();if(e.google&&e.google.maps)return Promise.resolve();if(this._scriptLoadingPromise)return this._scriptLoadingPromise;var t=this._documentRef.getNativeDocument().getElementById(this._SCRIPT_ID);if(t)return this._assignScriptLoadingPromise(t),this._scriptLoadingPromise;var n=this._documentRef.getNativeDocument().createElement("script");return n.type="text/javascript",n.async=!0,n.defer=!0,n.id=this._SCRIPT_ID,n.src=this._getScriptSrc(this.callbackName),this._assignScriptLoadingPromise(n),this._documentRef.getNativeDocument().body.appendChild(n),this._scriptLoadingPromise}},{key:"_assignScriptLoadingPromise",value:function(e){var t=this;this._scriptLoadingPromise=new Promise((function(n,r){t._windowRef.getNativeWindow()[t.callbackName]=function(){n()},e.onerror=function(e){r(e)}}))}},{key:"_getScriptSrc",value:function(e){var t;switch(this._config&&this._config.protocol||SW.HTTPS){case SW.AUTO:t="";break;case SW.HTTP:t="http:";break;case SW.HTTPS:t="https:"}var n={v:this._config.apiVersion||"quarterly",callback:e,key:this._config.apiKey,client:this._config.clientId,channel:this._config.channel,libraries:this._config.libraries,region:this._config.region,language:this._config.language||("en-US"!==this.localeId?this.localeId:null)};return"".concat(t,"//").concat(this._config.hostAndPath||"maps.googleapis.com/maps/api/js","?").concat(Object.keys(n).filter((function(e){return null!=n[e]})).filter((function(e){return!Array.isArray(n[e])||Array.isArray(n[e])&&n[e].length>0})).map((function(e){var t=n[e];return Array.isArray(t)?{key:e,value:t.join(",")}:{key:e,value:n[e]}})).map((function(e){return"".concat(e.key,"=").concat(e.value)})).join("&"))}}]),n}(mW)).\u0275fac=function(e){return new(e||aW)(Pt(AW,8),Pt(wW),Pt(CW),Pt(Wu))},aW.\u0275prov=Je({token:aW,factory:aW.\u0275fac}),aW),TW=((rW=function(){function e(t,n){_classCallCheck(this,e),this._mapsWrapper=t,this._zone=n,this._markers=new Map}return _createClass(e,[{key:"convertAnimation",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",null===e?null:this._mapsWrapper.getNativeMap().then((function(){return google.maps.Animation[e]})));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"deleteMarker",value:function(e){var t=this,n=this._markers.get(e);return null==n?Promise.resolve():n.then((function(n){return t._zone.run((function(){n.setMap(null),t._markers.delete(e)}))}))}},{key:"updateMarkerPosition",value:function(e){return this._markers.get(e).then((function(t){return t.setPosition({lat:e.latitude,lng:e.longitude})}))}},{key:"updateTitle",value:function(e){return this._markers.get(e).then((function(t){return t.setTitle(e.title)}))}},{key:"updateLabel",value:function(e){return this._markers.get(e).then((function(t){t.setLabel(e.label)}))}},{key:"updateDraggable",value:function(e){return this._markers.get(e).then((function(t){return t.setDraggable(e.draggable)}))}},{key:"updateIcon",value:function(e){return this._markers.get(e).then((function(t){return t.setIcon(e.iconUrl)}))}},{key:"updateOpacity",value:function(e){return this._markers.get(e).then((function(t){return t.setOpacity(e.opacity)}))}},{key:"updateVisible",value:function(e){return this._markers.get(e).then((function(t){return t.setVisible(e.visible)}))}},{key:"updateZIndex",value:function(e){return this._markers.get(e).then((function(t){return t.setZIndex(e.zIndex)}))}},{key:"updateClickable",value:function(e){return this._markers.get(e).then((function(t){return t.setClickable(e.clickable)}))}},{key:"updateAnimation",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._markers.get(e);case 2:return t.t0=t.sent,t.next=5,this.convertAnimation(e.animation);case 5:t.t1=t.sent,t.t0.setAnimation.call(t.t0,t.t1);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"addMarker",value:function(e){var t=this,n=new Promise((function(n){return XV(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=this._mapsWrapper,t.t1={lat:e.latitude,lng:e.longitude},t.t2=e.label,t.t3=e.draggable,t.t4=e.iconUrl,t.t5=e.opacity,t.t6=e.visible,t.t7=e.zIndex,t.t8=e.title,t.t9=e.clickable,t.next=12,this.convertAnimation(e.animation);case 12:return t.t10=t.sent,t.t11={position:t.t1,label:t.t2,draggable:t.t3,icon:t.t4,opacity:t.t5,visible:t.t6,zIndex:t.t7,title:t.t8,clickable:t.t9,animation:t.t10},t.abrupt("return",t.t0.createMarker.call(t.t0,t.t11).then(n));case 15:case"end":return t.stop()}}),t,this)})))}));this._markers.set(e,n)}},{key:"getNativeMarker",value:function(e){return this._markers.get(e)}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._markers.get(t).then((function(t){return t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}}]),e}()).\u0275fac=function(e){return new(e||rW)(Pt(gW),Pt(ec))},rW.\u0275prov=Je({token:rW,factory:rW.\u0275fac}),rW),EW=((nW=function(){function e(t,n,r){_classCallCheck(this,e),this._mapsWrapper=t,this._zone=n,this._markerManager=r,this._infoWindows=new Map}return _createClass(e,[{key:"deleteInfoWindow",value:function(e){var t=this,n=this._infoWindows.get(e);return null==n?Promise.resolve():n.then((function(n){return t._zone.run((function(){n.close(),t._infoWindows.delete(e)}))}))}},{key:"setPosition",value:function(e){return this._infoWindows.get(e).then((function(t){return t.setPosition({lat:e.latitude,lng:e.longitude})}))}},{key:"setZIndex",value:function(e){return this._infoWindows.get(e).then((function(t){return t.setZIndex(e.zIndex)}))}},{key:"open",value:function(e){var t=this;return this._infoWindows.get(e).then((function(n){return null!=e.hostMarker?t._markerManager.getNativeMarker(e.hostMarker).then((function(e){return t._mapsWrapper.getNativeMap().then((function(t){return n.open(t,e)}))})):t._mapsWrapper.getNativeMap().then((function(e){return n.open(e)}))}))}},{key:"close",value:function(e){return this._infoWindows.get(e).then((function(e){return e.close()}))}},{key:"setOptions",value:function(e,t){return this._infoWindows.get(e).then((function(e){return e.setOptions(t)}))}},{key:"addInfoWindow",value:function(e){var t={content:e.content,maxWidth:e.maxWidth,zIndex:e.zIndex,disableAutoPan:e.disableAutoPan};"number"==typeof e.latitude&&"number"==typeof e.longitude&&(t.position={lat:e.latitude,lng:e.longitude});var n=this._mapsWrapper.createInfoWindow(t);this._infoWindows.set(e,n)}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._infoWindows.get(t).then((function(t){t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}}]),e}()).\u0275fac=function(e){return new(e||nW)(Pt(gW),Pt(ec),Pt(TW))},nW.\u0275prov=Je({token:nW,factory:nW.\u0275fac}),nW),RW=((tW=function(){function e(t,n){_classCallCheck(this,e),this._wrapper=t,this._zone=n,this._layers=new Map}return _createClass(e,[{key:"addKmlLayer",value:function(e){var t=this._wrapper.getNativeMap().then((function(t){return new google.maps.KmlLayer({clickable:e.clickable,map:t,preserveViewport:e.preserveViewport,screenOverlays:e.screenOverlays,suppressInfoWindows:e.suppressInfoWindows,url:e.url,zIndex:e.zIndex})}));this._layers.set(e,t)}},{key:"setOptions",value:function(e,t){this._layers.get(e).then((function(e){return e.setOptions(t)}))}},{key:"deleteKmlLayer",value:function(e){var t=this;this._layers.get(e).then((function(n){n.setMap(null),t._layers.delete(e)}))}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._layers.get(t).then((function(t){t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}}]),e}()).\u0275fac=function(e){return new(e||tW)(Pt(gW),Pt(ec))},tW.\u0275prov=Je({token:tW,factory:tW.\u0275fac}),tW),NW=((eW=function(){function e(t){_classCallCheck(this,e),this._wrapper=t,this._layers=new Map}return _createClass(e,[{key:"addTransitLayer",value:function(e){var t=this._wrapper.createTransitLayer();this._layers.set(e,t)}},{key:"addBicyclingLayer",value:function(e){var t=this._wrapper.createBicyclingLayer();this._layers.set(e,t)}},{key:"deleteLayer",value:function(e){var t=this;return this._layers.get(e).then((function(n){n.setMap(null),t._layers.delete(e)}))}}]),e}()).\u0275fac=function(e){return new(e||eW)(Pt(gW))},eW.\u0275prov=Je({token:eW,factory:eW.\u0275fac}),eW);function OW(e){var t=["insert_at","remove_at","set_at"];return function e(t,n,r){return r?e(t,n).pipe(xe((function(e){return K(e)?r.apply(void 0,_toConsumableArray(e)):r(e)}))):new se((function(e){var r,a=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.next(1===n.length?n[0]:n)};try{r=t(a)}catch(AU){return void e.error(AU)}if(U(n))return function(){return n(a,r)}}))}((function(n){return t.map((function(t){return e.addListener(t,(function(r,a){return n.apply(e,[{newArr:e.getArray(),eventName:t,index:r,previous:a}])}))}))}),(function(e,t){return t.forEach((function(e){return e.remove()}))}))}var DW,FW,MW,PW,zW,LW,BW,VW,WW=((VW=function(){function e(t,n){_classCallCheck(this,e),this._mapsWrapper=t,this._zone=n,this._polygons=new Map}return _createClass(e,[{key:"addPolygon",value:function(e){var t=this._mapsWrapper.createPolygon({clickable:e.clickable,draggable:e.draggable,editable:e.editable,fillColor:e.fillColor,fillOpacity:e.fillOpacity,geodesic:e.geodesic,paths:e.paths,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight,visible:e.visible,zIndex:e.zIndex});this._polygons.set(e,t)}},{key:"updatePolygon",value:function(e){var t=this,n=this._polygons.get(e);return null==n?Promise.resolve():n.then((function(n){return t._zone.run((function(){n.setPaths(e.paths)}))}))}},{key:"setPolygonOptions",value:function(e,t){return this._polygons.get(e).then((function(e){e.setOptions(t)}))}},{key:"deletePolygon",value:function(e){var t=this,n=this._polygons.get(e);return null==n?Promise.resolve():n.then((function(n){return t._zone.run((function(){n.setMap(null),t._polygons.delete(e)}))}))}},{key:"getPath",value:function(e){return this._polygons.get(e).then((function(e){return e.getPath().getArray()}))}},{key:"getPaths",value:function(e){return this._polygons.get(e).then((function(e){return e.getPaths().getArray().map((function(e){return e.getArray()}))}))}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._polygons.get(t).then((function(t){t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}},{key:"createPathEventObservable",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._polygons.get(e);case 2:return n=t.sent.getPaths(),t.abrupt("return",OW(n).pipe(Pf({newArr:n.getArray()}),zf((function(e){return Me.apply(void 0,_toConsumableArray(e.newArr.map((function(t,n){return OW(t).pipe(xe((function(t){return{parentMVEvent:e,chMVCEvent:t,pathIndex:n}})))})))).pipe(Pf({parentMVEvent:e,chMVCEvent:null,pathIndex:null}))})),(function(e){return e.lift(new dW(1))}),xe((function(e){var t,n=e.parentMVEvent,r=e.chMVCEvent,a=e.pathIndex;return r?(t={newArr:n.newArr.map((function(e){return e.getArray().map((function(e){return e.toJSON()}))})),pathIndex:a,eventName:r.eventName,index:r.index},r.previous&&(t.previous=r.previous)):(t={newArr:n.newArr.map((function(e){return e.getArray().map((function(e){return e.toJSON()}))})),eventName:n.eventName,index:n.index},n.previous&&(t.previous=n.previous.getArray())),t}))));case 4:case"end":return t.stop()}}),t,this)})))}}]),e}()).\u0275fac=function(e){return new(e||VW)(Pt(gW),Pt(ec))},VW.\u0275prov=Je({token:VW,factory:VW.\u0275fac}),VW),UW=((BW=function(){function e(t,n){_classCallCheck(this,e),this._mapsWrapper=t,this._zone=n,this._polylines=new Map}return _createClass(e,[{key:"addPolyline",value:function(t){var n=this,r=this._mapsWrapper.getNativeMap().then((function(){return[e._convertPoints(t),e._convertIcons(t)]})).then((function(e){var r=_slicedToArray(e,2),a=r[0],i=r[1];return n._mapsWrapper.createPolyline({clickable:t.clickable,draggable:t.draggable,editable:t.editable,geodesic:t.geodesic,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight,visible:t.visible,zIndex:t.zIndex,path:a,icons:i})}));this._polylines.set(t,r)}},{key:"updatePolylinePoints",value:function(t){var n=this,r=e._convertPoints(t),a=this._polylines.get(t);return null==a?Promise.resolve():a.then((function(e){return n._zone.run((function(){return e.setPath(r)}))}))}},{key:"updateIconSequences",value:function(t){return XV(this,void 0,void 0,regeneratorRuntime.mark((function n(){var r,a,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this._mapsWrapper.getNativeMap();case 2:if(r=e._convertIcons(t),null==(a=this._polylines.get(t))){n.next=5;break}return n.abrupt("return",a.then((function(e){return i._zone.run((function(){return e.setOptions({icons:r})}))})));case 5:case"end":return n.stop()}}),n,this)})))}},{key:"setPolylineOptions",value:function(e,t){return this._polylines.get(e).then((function(e){e.setOptions(t)}))}},{key:"deletePolyline",value:function(e){var t=this,n=this._polylines.get(e);return null==n?Promise.resolve():n.then((function(n){return t._zone.run((function(){n.setMap(null),t._polylines.delete(e)}))}))}},{key:"getMVCPath",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._polylines.get(e);case 2:return t.abrupt("return",t.sent.getPath());case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getPath",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getMVCPath(e);case 2:return t.abrupt("return",t.sent.getArray());case 3:case"end":return t.stop()}}),t,this)})))}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){n._polylines.get(t).then((function(t){t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))}))}))}},{key:"createPathEventObservable",value:function(e){return XV(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=OW,t.next=3,this.getMVCPath(e);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t,this)})))}}],[{key:"_convertPoints",value:function(e){return e._getPoints().map((function(e){return{lat:e.latitude,lng:e.longitude}}))}},{key:"_convertPath",value:function(e){var t=google.maps.SymbolPath[e];return"number"==typeof t?t:e}},{key:"_convertIcons",value:function(t){var n=t._getIcons().map((function(t){return{fixedRotation:t.fixedRotation,offset:t.offset,repeat:t.repeat,icon:{anchor:new google.maps.Point(t.anchorX,t.anchorY),fillColor:t.fillColor,fillOpacity:t.fillOpacity,path:e._convertPath(t.path),rotation:t.rotation,scale:t.scale,strokeColor:t.strokeColor,strokeOpacity:t.strokeOpacity,strokeWeight:t.strokeWeight}}}));return n.forEach((function(e){Object.entries(e).forEach((function(t){var n=_slicedToArray(t,2),r=n[0];void 0===n[1]&&delete e[r]})),void 0!==e.icon.anchor.x&&void 0!==e.icon.anchor.y||delete e.icon.anchor})),n}}]),e}()).\u0275fac=function(e){return new(e||BW)(Pt(gW),Pt(ec))},BW.\u0275prov=Je({token:BW,factory:BW.\u0275fac}),BW),jW=((LW=function(){function e(t,n){_classCallCheck(this,e),this._apiWrapper=t,this._zone=n,this._rectangles=new Map}return _createClass(e,[{key:"addRectangle",value:function(e){var t=this;this._apiWrapper.getNativeMap().then((function(){return t._rectangles.set(e,t._apiWrapper.createRectangle({bounds:{north:e.north,east:e.east,south:e.south,west:e.west},clickable:e.clickable,draggable:e.draggable,editable:e.editable,fillColor:e.fillColor,fillOpacity:e.fillOpacity,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokePosition:google.maps.StrokePosition[e.strokePosition],strokeWeight:e.strokeWeight,visible:e.visible,zIndex:e.zIndex}))}))}},{key:"removeRectangle",value:function(e){var t=this;return this._rectangles.get(e).then((function(n){n.setMap(null),t._rectangles.delete(e)}))}},{key:"setOptions",value:function(e,t){return this._rectangles.get(e).then((function(e){t.strokePosition=google.maps.StrokePosition[t.strokePosition],e.setOptions(t)}))}},{key:"getBounds",value:function(e){return this._rectangles.get(e).then((function(e){return e.getBounds()}))}},{key:"setBounds",value:function(e){return this._rectangles.get(e).then((function(t){return t.setBounds({north:e.north,east:e.east,south:e.south,west:e.west})}))}},{key:"setEditable",value:function(e){return this._rectangles.get(e).then((function(t){return t.setEditable(e.editable)}))}},{key:"setDraggable",value:function(e){return this._rectangles.get(e).then((function(t){return t.setDraggable(e.draggable)}))}},{key:"setVisible",value:function(e){return this._rectangles.get(e).then((function(t){return t.setVisible(e.visible)}))}},{key:"createEventObservable",value:function(e,t){var n=this;return new se((function(r){var a=null;return n._rectangles.get(t).then((function(t){a=t.addListener(e,(function(e){return n._zone.run((function(){return r.next(e)}))}))})),function(){null!==a&&a.remove()}}))}}]),e}()).\u0275fac=function(e){return new(e||LW)(Pt(gW),Pt(ec))},LW.\u0275prov=Je({token:LW,factory:LW.\u0275fac}),LW),HW=0,GW=((zW=function(){function e(t,n){_classCallCheck(this,e),this._infoWindowManager=t,this._el=n,this.isOpen=!1,this.infoWindowClose=new du,this._infoWindowAddedToManager=!1,this._id=(HW++).toString()}return _createClass(e,[{key:"ngOnInit",value:function(){this.content=this._el.nativeElement.querySelector(".agm-info-window-content"),this._infoWindowManager.addInfoWindow(this),this._infoWindowAddedToManager=!0,this._updateOpenState(),this._registerEventListeners()}},{key:"ngOnChanges",value:function(e){this._infoWindowAddedToManager&&((e.latitude||e.longitude)&&"number"==typeof this.latitude&&"number"==typeof this.longitude&&this._infoWindowManager.setPosition(this),e.zIndex&&this._infoWindowManager.setZIndex(this),e.isOpen&&this._updateOpenState(),this._setInfoWindowOptions(e))}},{key:"_registerEventListeners",value:function(){var e=this;this._infoWindowManager.createEventObservable("closeclick",this).subscribe((function(){e.isOpen=!1,e.infoWindowClose.emit()}))}},{key:"_updateOpenState",value:function(){this.isOpen?this.open():this.close()}},{key:"_setInfoWindowOptions",value:function(t){var n={};Object.keys(t).filter((function(t){return-1!==e._infoWindowOptionsInputs.indexOf(t)})).forEach((function(e){n[e]=t[e].currentValue})),this._infoWindowManager.setOptions(this,n)}},{key:"open",value:function(){return this._infoWindowManager.open(this)}},{key:"close",value:function(){var e=this;return this._infoWindowManager.close(this).then((function(){e.infoWindowClose.emit()}))}},{key:"id",value:function(){return this._id}},{key:"toString",value:function(){return"AgmInfoWindow-"+this._id.toString()}},{key:"ngOnDestroy",value:function(){this._infoWindowManager.deleteInfoWindow(this)}}]),e}()).\u0275fac=function(e){return new(e||zW)(go(EW),go(_s))},zW.\u0275cmp=en({type:zW,selectors:[["agm-info-window"]],inputs:{isOpen:"isOpen",latitude:"latitude",longitude:"longitude",disableAutoPan:"disableAutoPan",zIndex:"zIndex",maxWidth:"maxWidth"},outputs:{infoWindowClose:"infoWindowClose"},features:[ss],ngContentSelectors:vW,decls:2,vars:0,consts:[[1,"agm-info-window-content"]],template:function(e,t){1&e&&(Ro(),_o(0,"div",0),No(1),wo())},encapsulation:2}),zW._infoWindowOptionsInputs=["disableAutoPan","maxWidth"],zW),qW=((PW=function e(){_classCallCheck(this,e)}).\u0275fac=function(e){return new(e||PW)},PW.\u0275dir=sn({type:PW,inputs:{position:"position"}}),PW),KW=((MW=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this._elem=t,this._mapsWrapper=n,this._platformId=r,this._fitBoundsService=a,this._zone=i,this.longitude=0,this.latitude=0,this.zoom=8,this.draggable=!0,this.disableDoubleClickZoom=!1,this.disableDefaultUI=!1,this.scrollwheel=!0,this.keyboardShortcuts=!0,this.styles=[],this.usePanning=!1,this.fitBounds=!1,this.mapTypeId="ROADMAP",this.clickableIcons=!0,this.showDefaultInfoWindow=!0,this.gestureHandling="auto",this.tilt=0,this._observableSubscriptions=[],this.mapClick=new du,this.mapRightClick=new du,this.mapDblClick=new du,this.centerChange=new du,this.boundsChange=new du,this.mapTypeIdChange=new du,this.idle=new du,this.zoomChange=new du,this.mapReady=new du,this.tilesLoaded=new du}return _createClass(e,[{key:"ngAfterContentInit",value:function(){if("server"!==this._platformId){var e=this._elem.nativeElement.querySelector(".agm-map-container-inner");this._initMapInstance(e)}}},{key:"_initMapInstance",value:function(e){var t=this;this._mapsWrapper.createMap(e,{center:{lat:this.latitude||0,lng:this.longitude||0},zoom:this.zoom,minZoom:this.minZoom,maxZoom:this.maxZoom,controlSize:this.controlSize,disableDefaultUI:this.disableDefaultUI,disableDoubleClickZoom:this.disableDoubleClickZoom,scrollwheel:this.scrollwheel,backgroundColor:this.backgroundColor,draggable:this.draggable,draggableCursor:this.draggableCursor,draggingCursor:this.draggingCursor,keyboardShortcuts:this.keyboardShortcuts,styles:this.styles,mapTypeId:this.mapTypeId.toLocaleLowerCase(),clickableIcons:this.clickableIcons,gestureHandling:this.gestureHandling,tilt:this.tilt,restriction:this.restriction}).then((function(){return t._mapsWrapper.getNativeMap()})).then((function(e){return t.mapReady.emit(e)})),this._handleMapCenterChange(),this._handleMapZoomChange(),this._handleMapMouseEvents(),this._handleBoundsChange(),this._handleMapTypeIdChange(),this._handleTilesLoadedEvent(),this._handleIdleEvent(),this._handleControlChange()}},{key:"ngOnDestroy",value:function(){this._observableSubscriptions.forEach((function(e){return e.unsubscribe()})),this._mapsWrapper.clearInstanceListeners(),this._fitBoundsSubscription&&this._fitBoundsSubscription.unsubscribe()}},{key:"ngOnChanges",value:function(e){this._updateMapOptionsChanges(e),this._updatePosition(e)}},{key:"_updateMapOptionsChanges",value:function(t){var n={};Object.keys(t).filter((function(t){return-1!==e._mapOptionsAttributes.indexOf(t)})).forEach((function(e){n[e]=t[e].currentValue})),this._mapsWrapper.setMapOptions(n)}},{key:"triggerResize",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n){setTimeout((function(){return e._mapsWrapper.triggerMapEvent("resize").then((function(){t&&(null!=e.fitBounds?e._fitBounds():e._setCenter()),n()}))}))}))}},{key:"_updatePosition",value:function(e){(null!=e.latitude||null!=e.longitude||e.fitBounds)&&("fitBounds"in e?this._fitBounds():"number"==typeof this.latitude&&"number"==typeof this.longitude&&this._setCenter())}},{key:"_setCenter",value:function(){var e={lat:this.latitude,lng:this.longitude};this.usePanning?this._mapsWrapper.panTo(e):this._mapsWrapper.setCenter(e)}},{key:"_fitBounds",value:function(){switch(this.fitBounds){case!0:this._subscribeToFitBoundsUpdates();break;case!1:this._fitBoundsSubscription&&this._fitBoundsSubscription.unsubscribe();break;default:this._fitBoundsSubscription&&this._fitBoundsSubscription.unsubscribe(),this._updateBounds(this.fitBounds,this.fitBoundsPadding)}}},{key:"_subscribeToFitBoundsUpdates",value:function(){var e=this;this._zone.runOutsideAngular((function(){e._fitBoundsSubscription=e._fitBoundsService.getBounds$().subscribe((function(t){e._zone.run((function(){return e._updateBounds(t,e.fitBoundsPadding)}))}))}))}},{key:"_updateBounds",value:function(e,t){if(e){if(this._isLatLngBoundsLiteral(e)&&"undefined"!=typeof google&&google&&google.maps&&google.maps.LatLngBounds){var n=new google.maps.LatLngBounds;n.union(e),e=n}this.usePanning?this._mapsWrapper.panToBounds(e,t):this._mapsWrapper.fitBounds(e,t)}}},{key:"_isLatLngBoundsLiteral",value:function(e){return null!=e&&void 0===e.extend}},{key:"_handleMapCenterChange",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("center_changed").subscribe((function(){e._mapsWrapper.getCenter().then((function(t){e.latitude=t.lat(),e.longitude=t.lng(),e.centerChange.emit({lat:e.latitude,lng:e.longitude})}))}));this._observableSubscriptions.push(t)}},{key:"_handleBoundsChange",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("bounds_changed").subscribe((function(){e._mapsWrapper.getBounds().then((function(t){e.boundsChange.emit(t)}))}));this._observableSubscriptions.push(t)}},{key:"_handleMapTypeIdChange",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("maptypeid_changed").subscribe((function(){e._mapsWrapper.getMapTypeId().then((function(t){e.mapTypeIdChange.emit(t)}))}));this._observableSubscriptions.push(t)}},{key:"_handleMapZoomChange",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("zoom_changed").subscribe((function(){e._mapsWrapper.getZoom().then((function(t){e.zoom=t,e.zoomChange.emit(t)}))}));this._observableSubscriptions.push(t)}},{key:"_handleIdleEvent",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("idle").subscribe((function(){e.idle.emit(void 0)}));this._observableSubscriptions.push(t)}},{key:"_handleTilesLoadedEvent",value:function(){var e=this,t=this._mapsWrapper.subscribeToMapEvent("tilesloaded").subscribe((function(){return e.tilesLoaded.emit(void 0)}));this._observableSubscriptions.push(t)}},{key:"_handleMapMouseEvents",value:function(){var e=this;[{name:"click",emitter:this.mapClick},{name:"rightclick",emitter:this.mapRightClick},{name:"dblclick",emitter:this.mapDblClick}].forEach((function(t){var n=e._mapsWrapper.subscribeToMapEvent(t.name).subscribe((function(n){var r=_slicedToArray(n,1)[0];r.placeId&&!e.showDefaultInfoWindow&&r.stop(),t.emitter.emit(r)}));e._observableSubscriptions.push(n)}))}},{key:"_handleControlChange",value:function(){var e=this;this._setControls(),this.mapControls.changes.subscribe((function(){return e._setControls()}))}},{key:"_setControls",value:function(){var e=this,t={fullscreenControl:!this.disableDefaultUI,mapTypeControl:!1,panControl:!1,rotateControl:!1,scaleControl:!1,streetViewControl:!this.disableDefaultUI,zoomControl:!this.disableDefaultUI};this._mapsWrapper.getNativeMap().then((function(){e.mapControls.forEach((function(e){return Object.assign(t,e.getOptions())})),e._mapsWrapper.setMapOptions(t)}))}}]),e}()).\u0275fac=function(e){return new(e||MW)(go(_s),go(gW),go(Lu),go(_W),go(ec))},MW.\u0275cmp=en({type:MW,selectors:[["agm-map"]],contentQueries:function(e,t,n){var r;1&e&&Iu(n,qW,!1),2&e&&xu(r=Tu())&&(t.mapControls=r)},inputs:{longitude:"longitude",latitude:"latitude",zoom:"zoom",draggable:["mapDraggable","draggable"],disableDoubleClickZoom:"disableDoubleClickZoom",disableDefaultUI:"disableDefaultUI",scrollwheel:"scrollwheel",keyboardShortcuts:"keyboardShortcuts",styles:"styles",usePanning:"usePanning",fitBounds:"fitBounds",mapTypeId:"mapTypeId",clickableIcons:"clickableIcons",showDefaultInfoWindow:"showDefaultInfoWindow",gestureHandling:"gestureHandling",tilt:"tilt",minZoom:"minZoom",maxZoom:"maxZoom",controlSize:"controlSize",backgroundColor:"backgroundColor",draggableCursor:"draggableCursor",draggingCursor:"draggingCursor",fitBoundsPadding:"fitBoundsPadding",restriction:"restriction"},outputs:{mapClick:"mapClick",mapRightClick:"mapRightClick",mapDblClick:"mapDblClick",centerChange:"centerChange",boundsChange:"boundsChange",mapTypeIdChange:"mapTypeIdChange",idle:"idle",zoomChange:"zoomChange",mapReady:"mapReady",tilesLoaded:"tilesLoaded"},features:[gs([yW,bW,bW,_W,gW,EW,RW,NW,TW,WW,UW,jW]),ss],ngContentSelectors:vW,decls:3,vars:0,consts:[[1,"agm-map-container-inner","sebm-google-map-container-inner"],[1,"agm-map-content"]],template:function(e,t){1&e&&(Ro(),Co(0,"div",0),_o(1,"div",1),No(2),wo())},styles:[".agm-map-container-inner[_ngcontent-%COMP%] {\n      width: inherit;\n      height: inherit;\n    }\n    .agm-map-content[_ngcontent-%COMP%] {\n      display:none;\n    }"]}),MW._mapOptionsAttributes=["disableDoubleClickZoom","scrollwheel","draggable","draggableCursor","draggingCursor","keyboardShortcuts","styles","zoom","minZoom","maxZoom","mapTypeId","clickableIcons","gestureHandling","tilt","restriction"],MW),XW=0,ZW=((FW=function(){function e(t){_classCallCheck(this,e),this._markerManager=t,this.draggable=!1,this.visible=!0,this.openInfoWindow=!0,this.opacity=1,this.zIndex=1,this.clickable=!0,this.animationChange=new du,this.markerClick=new du,this.markerDblClick=new du,this.markerRightClick=new du,this.dragStart=new du,this.drag=new du,this.dragEnd=new du,this.mouseOver=new du,this.mouseOut=new du,this.infoWindow=new vu,this._markerAddedToManger=!1,this._observableSubscriptions=[],this._fitBoundsDetails$=new cW(1),this._id=(XW++).toString()}return _createClass(e,[{key:"ngAfterContentInit",value:function(){var e=this;this.handleInfoWindowUpdate(),this.infoWindow.changes.subscribe((function(){return e.handleInfoWindowUpdate()}))}},{key:"handleInfoWindowUpdate",value:function(){var e=this;if(this.infoWindow.length>1)throw new Error("Expected no more than one info window.");this.infoWindow.forEach((function(t){t.hostMarker=e}))}},{key:"ngOnChanges",value:function(e){if("string"==typeof this.latitude&&(this.latitude=Number(this.latitude)),"string"==typeof this.longitude&&(this.longitude=Number(this.longitude)),"number"==typeof this.latitude&&"number"==typeof this.longitude){if(!this._markerAddedToManger)return this._markerManager.addMarker(this),this._updateFitBoundsDetails(),this._markerAddedToManger=!0,void this._addEventListeners();(e.latitude||e.longitude)&&(this._markerManager.updateMarkerPosition(this),this._updateFitBoundsDetails()),e.title&&this._markerManager.updateTitle(this),e.label&&this._markerManager.updateLabel(this),e.draggable&&this._markerManager.updateDraggable(this),e.iconUrl&&this._markerManager.updateIcon(this),e.opacity&&this._markerManager.updateOpacity(this),e.visible&&this._markerManager.updateVisible(this),e.zIndex&&this._markerManager.updateZIndex(this),e.clickable&&this._markerManager.updateClickable(this),e.animation&&this._markerManager.updateAnimation(this)}}},{key:"getFitBoundsDetails$",value:function(){return this._fitBoundsDetails$.asObservable()}},{key:"_updateFitBoundsDetails",value:function(){this._fitBoundsDetails$.next({latLng:{lat:this.latitude,lng:this.longitude}})}},{key:"_addEventListeners",value:function(){var e=this,t=this._markerManager.createEventObservable("click",this).subscribe((function(){e.openInfoWindow&&e.infoWindow.forEach((function(e){return e.open()})),e.markerClick.emit(e)}));this._observableSubscriptions.push(t);var n=this._markerManager.createEventObservable("dblclick",this).subscribe((function(){e.markerDblClick.emit(null)}));this._observableSubscriptions.push(n);var r=this._markerManager.createEventObservable("rightclick",this).subscribe((function(){e.markerRightClick.emit(null)}));this._observableSubscriptions.push(r);var a=this._markerManager.createEventObservable("dragstart",this).subscribe((function(t){return e.dragStart.emit(t)}));this._observableSubscriptions.push(a);var i=this._markerManager.createEventObservable("drag",this).subscribe((function(t){return e.drag.emit(t)}));this._observableSubscriptions.push(i);var o=this._markerManager.createEventObservable("dragend",this).subscribe((function(t){return e.dragEnd.emit(t)}));this._observableSubscriptions.push(o);var s=this._markerManager.createEventObservable("mouseover",this).subscribe((function(t){return e.mouseOver.emit(t)}));this._observableSubscriptions.push(s);var u=this._markerManager.createEventObservable("mouseout",this).subscribe((function(t){return e.mouseOut.emit(t)}));this._observableSubscriptions.push(u);var c=this._markerManager.createEventObservable("animation_changed",this).subscribe((function(){e.animationChange.emit(e.animation)}));this._observableSubscriptions.push(c)}},{key:"id",value:function(){return this._id}},{key:"toString",value:function(){return"AgmMarker-"+this._id.toString()}},{key:"ngOnDestroy",value:function(){this._markerManager.deleteMarker(this),this._observableSubscriptions.forEach((function(e){return e.unsubscribe()}))}}]),e}()).\u0275fac=function(e){return new(e||FW)(go(TW))},FW.\u0275dir=sn({type:FW,selectors:[["agm-marker"]],contentQueries:function(e,t,n){var r;1&e&&Iu(n,GW,!1),2&e&&xu(r=Tu())&&(t.infoWindow=r)},inputs:{draggable:["markerDraggable","draggable"],visible:"visible",openInfoWindow:"openInfoWindow",opacity:"opacity",zIndex:"zIndex",clickable:["markerClickable","clickable"],latitude:"latitude",longitude:"longitude",title:"title",label:"label",iconUrl:"iconUrl",animation:"animation"},outputs:{animationChange:"animationChange",markerClick:"markerClick",markerDblClick:"markerDblClick",markerRightClick:"markerRightClick",dragStart:"dragStart",drag:"drag",dragEnd:"dragEnd",mouseOver:"mouseOver",mouseOut:"mouseOut"},features:[gs([{provide:kW,useExisting:ht((function(){return FW}))}]),ss]}),FW),YW=((DW=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"forRoot",value:function(t){return{ngModule:e,providers:[].concat(xW,[{provide:mW,useClass:IW},{provide:AW,useValue:t}])}}}]),e}()).\u0275mod=an({type:DW}),DW.\u0275inj=Qe({factory:function(e){return new(e||DW)}}),DW),$W=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(t){i(t)}}function s(e){try{u(r.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))},JW=["video"];function QW(e,t){if(1&e){var n=kn();_o(0,"agm-marker",51),Ao("mouseOver",(function(){return wn(n),mo(2).open()}))("mouseOut",(function(){return wn(n),mo(2).close()})),_o(1,"agm-info-window",null,52),_o(3,"h6",53),Yo(4),wo(),_o(5,"h6"),Yo(6),wo(),_o(7,"h6"),Yo(8),wo(),wo(),wo()}if(2&e){var r=t.$implicit;bo("latitude",r.latitude)("longitude",r.longitude),la(4),$o(r.place),la(2),Jo("Longitude: ",r.longitude,""),la(2),Jo("Latitude: ",r.latitude,"")}}function eU(e,t){1&e&&(_o(0,"div"),Co(1,"img",54),wo())}function tU(e,t){if(1&e&&(_o(0,"div",55),Yo(1),wo()),2&e){var n=t.$implicit;la(1),Qo(" ",n.className," - ",n.probability," ")}}var nU,rU,aU=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:iy},{path:"user-profile",component:ny},{path:"signup",component:ay},{path:"login",component:sy},{path:"dashboard",component:(nU=function(){function e(){_classCallCheck(this,e),this.loading=!0,this.markers=[{place:"Monetfiascone",latitude:42.495601,longitude:12.011178},{place:"L'Aquila",latitude:42.348146,longitude:13.494945},{place:"Rieti",latitude:42.448641,longitude:12.932325}]}return _createClass(e,[{key:"placeMarker",value:function(e){this.markers.push({place:this.place,latitude:e.coords.lat,longitude:e.coords.lng})}},{key:"ngOnInit",value:function(){return $W(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("loading mobilenet model..."),e.next=3,function(e){return void 0===e&&(e={version:1,alpha:1}),ON(this,void 0,void 0,(function(){var t,n,r,a,i,o,s;return DN(this,(function(u){switch(u.label){case 0:if(null==x)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");if(r=e.version.toFixed(2),a=e.alpha?e.alpha.toFixed(2):"",i=-1,o=1,null==e.modelUrl){if(!(r in zN))throw new Error("Invalid version of MobileNet. Valid versions are: "+Object.keys(zN));if(!(a in zN[r]))throw new Error("MobileNet constructed with invalid alpha "+e.alpha+". Valid multipliers for this version are: "+Object.keys(zN[r])+".");i=(t=zN[r][a].inputRange)[0],o=t[1]}return null!=e.inputRange&&(i=(n=e.inputRange)[0],o=n[1]),[4,(s=new LN(r,a,e.modelUrl,i,o)).load()];case 1:return u.sent(),[2,s]}}))}))}();case 3:this.model=e.sent,console.log("Sucessfully loaded model"),this.loading=!1,setInterval((function(){return $W(t,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.model.classify(this.video.nativeElement);case 2:return this.predictions=e.sent,e.next=5,tR();case 5:case"end":return e.stop()}}),e,this)})))}),3e3);case 7:case"end":return e.stop()}}),e,this)})))}},{key:"onChooseLocation",value:function(e){console.log(e)}},{key:"ngAfterViewInit",value:function(){return $W(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.video.nativeElement,navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then((function(e){t.srcObject=e})).catch((function(e){console.log("Something went wrong!")}));case 2:case"end":return e.stop()}}),e,this)})))}}]),e}(),nU.\u0275fac=function(e){return new(e||nU)},nU.\u0275cmp=en({type:nU,selectors:[["app-dashboard"]],viewQuery:function(e,t){var n;1&e&&Su(JW,!0),2&e&&xu(n=Tu())&&(t.video=n.first)},decls:175,vars:6,consts:[[1,"wrapper",2,"background-color","rgb(51, 45, 56)"],["data-parallax","true",1,"page-header","page-header-xs",2,"background-image","url('./assets/img/photo-1512767811219-ed2f11ce5d0d.jfif')"],[1,"filter"],[1,"container"],[1,"motto","text-center"],[1,"presentation-title"],[2,"padding","1cm"],[1,"row"],[1,"col-lg-3","col-md-5","col-sm-6"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(198, 163, 238)"],[1,"card-body"],[1,"media-body","text-center"],[1,"success",2,"font-size","40px"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(163, 195, 238)"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(180, 238, 163)"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(238, 214, 163)"],[1,"col-md-4"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-category"],[2,"height","400px",3,"latitude","longitude","mapTypeId","mapClick"],[3,"latitude","longitude","mouseOver","mouseOut",4,"ngFor","ngForOf"],[1,"card-footer"],[1,"stats"],[1,"fa","fa-history"],[1,"d-flex","justify-content-center","align-items-center","flex-column"],["autoplay","","playsinline","","muted","","id","webcam","width","780","height","300"],["video",""],[4,"ngIf"],[1,"list-group"],["class","list-group-item",4,"ngFor","ngForOf"],[1,"card-stats"],[1,"fa","fa-check"],[1,"scrollable",2,"overflow-y","auto","max-height","9cm"],[1,"card",2,"padding-left","20px","padding-top","10px","background-color","rgb(225, 221, 231)"],[1,"fa","fa-circle","text-danger"],[1,"nc-icon","nc-single-02"],[1,"card",2,"padding-left","20px","padding-top","10px","background-color","rgb(231, 227, 221)"],[1,"fa","fa-circle","text-warning"],[1,"card",2,"padding-left","20px","padding-top","10px","background-color","rgb(201, 201, 196)"],[1,"fa","fa-circle","text-gray"],[1,"legend"],[1,"col-lg-4","col-md-5","col-sm-6"],["href","https://console.echoar.xyz/samples/webar-chrome/sweet-leaf-9977_1596406320011/index_sweet-leaf-9977_1596406320011.html"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(218, 151, 151)"],[1,"success",2,"font-size","30px"],["href","https://console.echoar.xyz/samples/webar-chrome/sweet-leaf-9977_1596406321280/index_sweet-leaf-9977_1596406321280.html"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(238, 227, 163)"],["href","https://console.echoar.xyz/samples/webar-chrome/sweet-leaf-9977_1596406318327/index_sweet-leaf-9977_1596406318327.html"],[1,"card","card-stats",2,"height","4cm","background-color","rgb(163, 202, 238)"],[3,"latitude","longitude","mouseOver","mouseOut"],["window",""],[2,"text-align","center"],["src","./assets/loading.gif"],[1,"list-group-item"]],template:function(e,t){1&e&&(_o(0,"div",0),_o(1,"div",1),Co(2,"div",2),_o(3,"div",3),_o(4,"div",4),_o(5,"h2",5),Yo(6,"Welcome General"),wo(),wo(),wo(),wo(),_o(7,"div",6),_o(8,"div",7),_o(9,"div",8),_o(10,"div",9),_o(11,"div",10),_o(12,"div",11),_o(13,"h3",12),Yo(14,"156"),wo(),_o(15,"span"),Yo(16,"New Attacks in the last 3 months"),wo(),wo(),wo(),wo(),wo(),_o(17,"div",8),_o(18,"div",13),_o(19,"div",10),_o(20,"div",11),_o(21,"h3",12),Yo(22,"8"),wo(),_o(23,"span"),Yo(24,"Cohorts ready for deployment"),wo(),wo(),wo(),wo(),wo(),_o(25,"div",8),_o(26,"div",14),_o(27,"div",10),_o(28,"div",11),_o(29,"h3",12),Yo(30,"83"),wo(),_o(31,"span"),Yo(32,"Bases recently fortified"),wo(),wo(),wo(),wo(),wo(),_o(33,"div",8),_o(34,"div",15),_o(35,"div",10),_o(36,"div",11),_o(37,"h3",12),Yo(38,"14"),wo(),_o(39,"span"),Yo(40,"Potential Vulnerabilities"),wo(),wo(),wo(),wo(),wo(),wo(),_o(41,"div",7),_o(42,"div",16),_o(43,"div",17),_o(44,"div",18),_o(45,"h5",19),_o(46,"b"),Yo(47,"Battle Map"),wo(),wo(),_o(48,"p",20),Yo(49,"Recent Military Entanglements"),wo(),wo(),_o(50,"div",10),_o(51,"agm-map",21),Ao("mapClick",(function(e){return t.onChooseLocation(e)})),vo(52,QW,9,5,"agm-marker",22),wo(),wo(),_o(53,"div",23),Co(54,"hr"),_o(55,"div",24),Co(56,"i",25),Yo(57," Updated 3 minutes ago "),wo(),wo(),wo(),wo(),_o(58,"div",16),_o(59,"div",17),_o(60,"div",18),_o(61,"h5",19),_o(62,"b"),Yo(63,"Live Surveilance Feed"),wo(),wo(),_o(64,"p",20),Yo(65,"Nearest Base To You"),wo(),wo(),_o(66,"div",10),_o(67,"div",26),Co(68,"video",27,28),vo(70,eU,2,0,"div",29),Co(71,"br"),_o(72,"div",30),vo(73,tU,2,2,"div",31),wo(),wo(),_o(74,"div",23),Co(75,"hr"),_o(76,"div",32),Co(77,"i",33),Yo(78," Data information certified "),wo(),wo(),wo(),wo(),wo(),_o(79,"div",16),_o(80,"div",17),_o(81,"div",18),_o(82,"h5",19),_o(83,"b"),Yo(84,"Empire Updates"),wo(),wo(),wo(),_o(85,"div",10),_o(86,"div",34),_o(87,"div",35),_o(88,"h6",19),_o(89,"b"),Co(90,"i",36),Yo(91,"\xa0 "),Co(92,"i",37),Yo(93," Citizen:"),wo(),wo(),_o(94,"p"),Yo(95,"Robbers spotted in Gaul outskirts"),wo(),wo(),_o(96,"div",35),_o(97,"h6",19),_o(98,"b"),Co(99,"i",36),Yo(100,"\xa0 "),Co(101,"i",37),Yo(102," 5th Cohort:"),wo(),wo(),_o(103,"p"),Yo(104,"Potential Invading Army in the distance"),wo(),wo(),_o(105,"div",38),_o(106,"h6",19),_o(107,"b"),Co(108,"i",39),Yo(109,"\xa0 "),Co(110,"i",37),Yo(111," Praetor:"),wo(),wo(),_o(112,"p"),Yo(113,"Please provide status of the legion"),wo(),wo(),_o(114,"div",40),_o(115,"h6",19),_o(116,"b"),Co(117,"i",41),Yo(118,"\xa0 "),Co(119,"i",37),Yo(120," Senator:"),wo(),wo(),_o(121,"p"),Yo(122,"Next meeting will discuss rebellion in Athens"),wo(),wo(),_o(123,"div",40),_o(124,"h6",19),_o(125,"b"),Co(126,"i",41),Yo(127,"\xa0 "),Co(128,"i",37),Yo(129," Centurion:"),wo(),wo(),_o(130,"p"),Yo(131,"1st Cohort is armed and ready for deployment"),wo(),wo(),wo(),wo(),Co(132,"hr"),_o(133,"div",23),_o(134,"div",42),Co(135,"i",36),Yo(136," Opened "),Co(137,"i",39),Yo(138," Read "),Co(139,"i",41),Yo(140," Unopened "),wo(),wo(),wo(),_o(141,"div",17),_o(142,"div",18),_o(143,"h5",19),_o(144,"b"),Yo(145,"Weapons Expo"),wo(),wo(),wo(),_o(146,"div",10),_o(147,"div",7),_o(148,"div",43),_o(149,"a",44),_o(150,"div",45),_o(151,"div",10),_o(152,"div",11),_o(153,"h3",46),Yo(154,"Spear"),wo(),_o(155,"span"),Yo(156,"Count: 2780"),wo(),wo(),wo(),wo(),wo(),wo(),_o(157,"div",43),_o(158,"a",47),_o(159,"div",48),_o(160,"div",10),_o(161,"div",11),_o(162,"h3",46),Yo(163,"Sword"),wo(),_o(164,"span"),Yo(165,"Count: 4109"),wo(),wo(),wo(),wo(),wo(),wo(),_o(166,"div",43),_o(167,"a",49),_o(168,"div",50),_o(169,"div",10),_o(170,"div",11),_o(171,"h3",46),Yo(172,"Shield"),wo(),_o(173,"span"),Yo(174,"Count: 3785"),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo(),wo()),2&e&&(la(51),bo("latitude",41.902782)("longitude",12.496366)("mapTypeId","terrain"),la(1),bo("ngForOf",t.markers),la(18),bo("ngIf",t.loading),la(3),bo("ngForOf",t.predictions))},directives:[KW,zl,Bl,ZW,GW],styles:[""]}),nU)}],iU=((rU=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:rU}),rU.\u0275inj=Qe({factory:function(e){return new(e||rU)},imports:[[$l,Rh,Ug.forRoot(aU,{useHash:!0,anchorScrolling:"enabled"})]]}),rU);function oU(e,t){1&e&&(_o(0,"a",10),Co(1,"i",11),Yo(2," \xa0SPQR"),wo())}function sU(e,t){1&e&&(_o(0,"a",12),Co(1,"i",11),Yo(2," \xa0SPQR"),wo())}function uU(e,t){1&e&&(_o(0,"li",13),_o(1,"a",14),Co(2,"i",15),Yo(3," About"),wo(),wo())}function cU(e,t){1&e&&(_o(0,"a",19),Yo(1,"Sign Up"),wo())}function lU(e,t){1&e&&(_o(0,"a",20),Yo(1,"Sign Up"),wo())}function hU(e,t){1&e&&(_o(0,"a",21),Yo(1,"Sign Up"),wo())}function fU(e,t){if(1&e&&(_o(0,"li",13),vo(1,cU,2,0,"a",16),vo(2,lU,2,0,"a",17),vo(3,hU,2,0,"a",18),wo()),2&e){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(yn.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,yn.lFrame.contextLView))[8]}(e)}();la(1),bo("ngIf",n.isHome()),la(1),bo("ngIf",n.isSignup()),la(1),bo("ngIf",n.isLogin())}}function dU(e,t){1&e&&(_o(0,"li",13),_o(1,"a",22),Co(2,"i",23),wo(),wo())}function pU(e,t){1&e&&(_o(0,"li",13),_o(1,"div",24),_o(2,"a",25),Co(3,"i",26),wo(),_o(4,"div",27),_o(5,"a",28),Yo(6,"Notifications"),wo(),_o(7,"a",29),Yo(8,"Viking attack in weste..."),wo(),_o(9,"a",29),Yo(10,"Worker rebellion quell..."),wo(),_o(11,"a",29),Yo(12,"Potential Persian atta..."),wo(),wo(),wo(),wo())}se.prototype.filter=function(e,t){return jf(e,t)(this)};var vU,mU,gU=((mU=function(){function e(t,n){_classCallCheck(this,e),this.location=t,this.element=n,this.sidebarVisible=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.toggleButton=this.element.nativeElement.getElementsByClassName("navbar-toggler")[0]}},{key:"sidebarOpen",value:function(){var e=this.toggleButton,t=document.getElementsByTagName("html")[0];setTimeout((function(){e.classList.add("toggled")}),500),t.classList.add("nav-open"),this.sidebarVisible=!0}},{key:"sidebarClose",value:function(){var e=document.getElementsByTagName("html")[0];this.toggleButton.classList.remove("toggled"),this.sidebarVisible=!1,e.classList.remove("nav-open")}},{key:"sidebarToggle",value:function(){!1===this.sidebarVisible?this.sidebarOpen():this.sidebarClose()}},{key:"isHome",value:function(){var e=this.location.prepareExternalUrl(this.location.path());return"#"===e.charAt(0)&&(e=e.slice(1)),"/home"===e}},{key:"isLogin",value:function(){var e=this.location.prepareExternalUrl(this.location.path());return"#"===e.charAt(0)&&(e=e.slice(1)),"/login"===e}},{key:"isSignup",value:function(){var e=this.location.prepareExternalUrl(this.location.path());return"#"===e.charAt(0)&&(e=e.slice(1)),"/signup"===e}},{key:"preLogin",value:function(){return!!(this.isSignup()||this.isHome()||this.isLogin())}},{key:"isDashboard",value:function(){var e=this.location.prepareExternalUrl(this.location.path());return"#"===e.charAt(0)&&(e=e.slice(1)),"/dashboard"===e}}]),e}()).\u0275fac=function(e){return new(e||mU)(go(Qc),go(_s))},mU.\u0275cmp=en({type:mU,selectors:[["app-navbar"]],decls:15,vars:6,consts:[["color-on-scroll","500",1,"navbar","navbar-expand-lg","fixed-top","navbar-transparent"],[1,"container"],[1,"navbar-translate"],["class","navbar-brand","href","#/home",4,"ngIf"],["class","navbar-brand","href","#/dashboard",4,"ngIf"],["type","button","data-toggle","collapse","data-target","#navbarToggler","aria-controls","navbarTogglerDemo02","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler","navbar-burger",3,"click"],[1,"navbar-toggler-bar"],["id","navbarToggler",1,"navbar-collapse"],[1,"navbar-nav","ml-auto"],["class","nav-item",4,"ngIf"],["href","#/home",1,"navbar-brand"],[1,"nc-icon","nc-bank"],["href","#/dashboard",1,"navbar-brand"],[1,"nav-item"],["href","https://youtu.be/YHNyeX1We70",1,"nav-link"],[1,"nc-icon","nc-alert-circle-i"],["href","#/signup","class","btn btn-default btn-round",4,"ngIf"],["href","#/signup","class","btn btn-outline-danger btn-round",4,"ngIf"],["href","#/signup","class","btn btn-outline-neutral btn-round",4,"ngIf"],["href","#/signup",1,"btn","btn-default","btn-round"],["href","#/signup",1,"btn","btn-outline-danger","btn-round"],["href","#/signup",1,"btn","btn-outline-neutral","btn-round"],[1,"nav-link"],[1,"nc-icon","nc-settings-gear-65"],["ngbDropdown","",1,"d-inline-block","dropdown"],["id","dropdownBasic1","ngbDropdownToggle","",1,"nav-link"],[1,"nc-icon","nc-bell-55"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1",1,"dropdown-danger"],[1,"dropdown-header"],[1,"dropdown-item"]],template:function(e,t){1&e&&(_o(0,"nav",0),_o(1,"div",1),_o(2,"div",2),vo(3,oU,3,0,"a",3),vo(4,sU,3,0,"a",4),_o(5,"button",5),Ao("click",(function(){return t.sidebarToggle()})),Co(6,"span",6),Co(7,"span",6),Co(8,"span",6),wo(),wo(),_o(9,"div",7),_o(10,"ul",8),vo(11,uU,4,0,"li",9),vo(12,fU,4,3,"li",9),vo(13,dU,3,0,"li",9),vo(14,pU,13,0,"li",9),wo(),wo(),wo(),wo()),2&e&&(la(3),bo("ngIf",t.preLogin()),la(1),bo("ngIf",!t.preLogin()),la(7),bo("ngIf",t.preLogin()),la(1),bo("ngIf",t.preLogin()),la(1),bo("ngIf",!t.preLogin()),la(1),bo("ngIf",!t.preLogin()))},directives:[sp,Bl,fp,hp,cp],styles:[""]}),mU),yU=((vU=function(){function e(){_classCallCheck(this,e),this.test=new Date}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||vU)},vU.\u0275cmp=en({type:vU,selectors:[["app-footer"]],decls:9,vars:4,consts:[[1,"footer","footer-black"],[1,"container"],[1,"row"],[1,"footer-nav"],[1,"credits","ml-auto"],[1,"copyright"]],template:function(e,t){1&e&&(_o(0,"footer",0),_o(1,"div",1),_o(2,"div",2),_o(3,"nav",3),Co(4,"ul"),wo(),_o(5,"div",4),_o(6,"span",5),Yo(7),hu(8,"date"),wo(),wo(),wo(),wo(),wo()),2&e&&(la(7),Jo(" ",fu(8,1,t.test,"yyyy"),", S\u0113pi\u014d SPQR "))},pipes:[Yl],styles:[""]}),vU);function bU(e,t){1&e&&Co(0,"app-footer")}var kU,_U,wU,CU=((wU=function(){function e(t,n,r,a,i){_classCallCheck(this,e),this.renderer=t,this.router=n,this.document=r,this.element=a,this.location=i}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this,t=this.element.nativeElement.children[0].children[0];this._router=this.router.events.filter((function(e){return e instanceof fv})).subscribe((function(t){window.outerWidth>991?window.document.children[0].scrollTop=0:window.document.activeElement.scrollTop=0,e.navbar.sidebarClose()})),this.renderer.listen("window","scroll",(function(e){window.scrollY>150||window.pageYOffset>150?t.classList.remove("navbar-transparent"):t.classList.add("navbar-transparent")}));var n=window.navigator.userAgent;if(n.indexOf("Trident/")>0)var r=n.indexOf("rv:"),a=parseInt(n.substring(r+3,n.indexOf(".",r)),10);a&&document.getElementsByTagName("body")[0].classList.add("ie-background")}},{key:"removeFooter",value:function(){var e=this.location.prepareExternalUrl(this.location.path());return"signup"!==(e=e.slice(1))&&"nucleoicons"!==e}}]),e}()).\u0275fac=function(e){return new(e||wU)(go(Ss),go(Tg),go(Dc),go(_s),go(Qc))},wU.\u0275cmp=en({type:wU,selectors:[["app-root"]],viewQuery:function(e,t){var n;1&e&&Su(gU,!0),2&e&&xu(n=Tu())&&(t.navbar=n.first)},decls:3,vars:1,consts:[[4,"ngIf"]],template:function(e,t){1&e&&(Co(0,"app-navbar"),Co(1,"router-outlet"),vo(2,bU,1,0,"app-footer",0)),2&e&&(la(2),bo("ngIf",t.removeFooter()))},directives:[gU,Ng,Bl,yU],styles:[""]}),wU),xU=((_U=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:_U}),_U.\u0275inj=Qe({factory:function(e){return new(e||_U)},imports:[[$l,bf,zp,YW.forRoot({apiKey:"AIzaSyCKpzKVPi0W_Ba6YNW9mxFHxqAPseEX9sM"})]]}),_U),SU=((kU=function e(){_classCallCheck(this,e)}).\u0275mod=an({type:kU,bootstrap:[CU]}),kU.\u0275inj=Qe({factory:function(e){return new(e||kU)},providers:[],imports:[[Rh,zp,bf,Ug,xU,iU]]}),kU);(function(){if(Pr)throw new Error("Cannot enable prod mode after platform setup.");Mr=!1})(),Th().bootstrapModule(SU)}},[[0,0]]]);